{
  "ACFDT RPA calculations": {
    "description": "The webpage explains how to calculate the adiabatic-connection-fluctuation-dissipation theorem (ACFDT) and random-phase approximation (RPA) ground-state energies using VASP, detailing both a four-step procedure and an all-in-one approach, along with important settings, caveats, and convergence considerations.", 
    "detailed_description": "The adiabatic-connection-fluctuation-dissipation theorem (ACFDT) can be used to derive the random-phase approximation (RPA).\nThe ACFDT-RPA ground-state energy\nE\nR\nP\nA\n{\\displaystyle E_{\\mathrm{RPA}}}\nis the sum of the ACFDT-RPA correlation energy\nE\nc\n{\\displaystyle E_{c}}\nand the Hartree-Fock (HF) energy\nE\nE\nX\nX\n{\\displaystyle E_{\\mathrm{EXX}}}\nevaluated non self-consistently using Kohn-Sham orbitals computed within density-functional theory (DFT):\nE\nR\nP\nA\n=\nE\nc\n+\nE\nE\nX\nX\n{\\displaystyle E_{\\mathrm{RPA}}=E_{\\mathrm{c}}+E_{\\mathrm{EXX}}}\n.\nNote that, here\nE\nE\nX\nX\n{\\displaystyle E_{\\mathrm{EXX}}}\nincludes also the Hartree energy, the kinetic energy, as well as the Ewald energy of the ions, whereas often in literature\nE\nE\nX\nX\n{\\displaystyle E_{\\mathrm{EXX}}}\nrefers only to the exact-exchange (EXX) energy evaluated using DFT orbitals.\nIf\nALGO\n=RPA is set in the\nINCAR\nfile, VASP  calculates the correlation energy within RPA. To this end, VASP first calculates the independent-particle response function, using the unoccupied states given in the\nWAVECAR\nfile, and then determines the correlation energy using the plasmon-fluctuation equation:\nE\nc\n=\n1\n2\nπ\n∫\n0\n∞\n[\nT\nr\nln\n⁡\n(\n1\n−\nχ\n(\ni\nω\n)\nV\n)\n+\nχ\n(\ni\nω\n)\nV\n]\nd\nω\n{\\displaystyle E_{c} = \\frac{1}{2 \\pi} \\int_{0}^{\\infty}[ \\mathrm{Tr} \\, \\ln(1-\\chi( {\\rm i} \\omega) V) + \\chi( {\\rm i} \\omega) V ]\\, d \\omega}\n.\nMore information about the theory behind the RPA is found\nhere\n.\nGeneral recipe to calculate ACFDT-RPA total energies\nThe ACFDT-RPA total energies can be computed in a four-step procedure or in an all-in-one approach. The all-in-one approach is available as of VASP.6 and can be done in one single step.\nBoth procedures comprise a self-consistent DFT calculation, diagonalizing the KS Hamiltonian, and the RPA calculation itself. While the all-in-one approach is very convenient, there are several caveats discussed below.\nFour-step procedure to calculate ACFDT-RPA total energy\nThis four-step procedure is the standard procedure in VASP.5, and is also available in VASP.6 by setting\nNBANDS\nin the RPA step.\nStep 1:\na standard DFT run.\nAll occupied orbitals (and as usual in VASP, a few unoccupied orbitals) of the DFT Hamiltonian are calculated. For instance,\nEDIFF\n= 1E-8 # required for convergence of RPA total energies\nISMEAR\n= 0 ;\nSIGMA\n= 0.05\nWarning:\nThe convergence of DFT eigenenergies influences the convergence of the RPA correlation energy.\nTip:\nUse the Perdew-Burke-Ernzerhof (PBE) pseudopotentials with a small\nEDIFF\nand avoid\nISMEAR\n>0.\nThe DFT run can be done with your favorite setup, but we recommend attaining very high precision (small\nEDIFF\ntag) and to use a small smearing width (\nSIGMA\ntag), and to avoid higher-order Methfessel-Paxton smearing (see also\nISMEAR\n). That is because Methfessel-Paxton smearing can lead to negative one-electron occupancies, which can result in unphysical correlation energies. We suggest using\nPBE\norbitals as input for the ACFDT-RPA run, but other choices, e.g., local-density-approximation (LDA) or\nhybrids\n, are possible as well. For hybrid functionals, we suggest carefully considering the caveats mentioned in Ref.\n[1]\n. Specifically, the RPA dielectric matrix yields too weak screening for hybrid functionals, which potentially deteriorates RPA results.\nStep 2:\nCompute the HF energy\nE\nE\nX\nX\n{\\displaystyle E_{\\mathrm{EXX}}}\nusing the DFT orbitals\n. That is, e.g.,\nALGO\n= EIGENVAL ;\nNELM\n= 1\nLWAVE\n= .FALSE.                !\nWAVECAR\nnot written\nLHFCALC\n= .TRUE. ;\nAEXX\n= 1.0  !\nALDAC\n= 0.0\nISMEAR\n= 0 ;\nSIGMA\n= 0.05\nHere,\nLWAVE\n= .FALSE. avoids an accidental update of the\nWAVECAR\nfile. Also, VASP automatically sets\nALDAC\n= 1-\nAEXX\n, i.e., for\nAEXX\n= 1.0,\nALDAC\n= 0.0.\nTip:\nFor insulators and semiconductors with a sizable gap, faster k-point convergence of the HF energy can be obtained by setting\nHFRCUT\n=-1, although this slows convergence for metals.\nStep 3:\nCompute a sufficient number of unoccupied states.\nIn the\nOUTCAR\nfile of Step 1, search for\nmaximum number of plane-waves:\nand run VASP again with the following\nINCAR\nfile to determine the unoccupied states by exact diagonalization of the KS Hamiltonian. The KS Hamiltonian must be the same as in step 1, which might be DFT or hybrid.\nNBANDS\n= maximum number of plane-waves (times 2 for vasp_gam)\nALGO\n= Exact    ! exact diagonalization\nEDIFF\n= 1E-8 # required for convergence of RPA total energies\nLOPTICS\n= .TRUE.\nISMEAR\n= 0 ;\nSIGMA\n= 0.05\nFor calculations using\nvasp_gam\n, that is the gamma-point only version of VASP,\nNBANDS\nmust be set to twice the\nmaximum number of plane-waves:\nfound in the\nOUTCAR\nfile of Step 1. For metals, we recommend to avoid setting\nLOPTICS\n=.TRUE., since this slows down k-point convergence .\nStep 4:\nCalculate the ACFDT-RPA correlation energy.\nNBANDS\n=  maximum number of plane-waves\nALGO\n= ACFDT\nNOMEGA\n= 12     ! default\nISMEAR\n= 0 ;\nSIGMA\n= 0.05\nThe number of imaginary-frequency and imaginary-time-grid points\nNOMEGA\nis usually set to 8-24. For large gap insulators\nNOMEGA\n= 8 will suffice, while for semiconductors 10-12 suffices.\nImportant:\nFor VASP 6.X,\nNBANDS\nmust be set in this step.\nAll-in-one approach to calculate ACFDT-RPA total energy\nVASP will read the\nWAVECAR\nfile, perform a self-consistent DFT calculation by iterating until convergence is reached, diagonalize the DFT Hamiltonian in the basis set spanned by all KS orbitals, and finally proceed with the RPA calculation. The all-in-one approach is only available as of VASP.6, and it is particularly convenient for the RPAR and GWR algorithms. An example\nINCAR\nfile is\nALGO\n= RPAR\nEDIFF\n= 1E-8  # required for convergence of RPA total energies\nISMEAR\n= 0 ;\nSIGMA\n= 0.05\nNOMEGA\n= 8-24    ! for large gap insulators\nNOMEGA\n= 8 will suffice, for semiconductors 10-12 suffices\nLOPTICS\n= .TRUE. ! optional\nLPEAD\n= .TRUE.   ! required for 6.1 and 6.2 if\nLOPTICS\n= .TRUE.\nWarning:\nThe tag\nNBANDS\nmust not be set in the\nINCAR\nfile.\nWarning:\nThe convergence of DFT eigenenergies influences the convergence of the RPA correlation energy.\nTip:\nUse the Perdew-Burke-Ernzerhof (PBE) pseudopotentials with a small\nEDIFF\nand avoid\nISMEAR\n>0.\nThe head of the dielectric function can be calculated only for insulators by setting the\nLOPTICS\ntag and only the Perturbation-Expression-After-Discretization (PEAD) method is supported, see\nLPEAD\n. Furthermore,\nEDIFF\nshould be small to calculate the DFT orbitals with high precision. Although it is not strictly required, we recommend starting the calculation from a well-converged DFT\nWAVECAR\nfile.\nThere are several caveats to the all-in-one approach:\nThere is no general support for ACFDT/RPA on top of hybrid functionals. In VASP\n≤\n{\\displaystyle \\leq}\n6.2, only LDA and gradient corrected functionals are supported. As of VASP 6.2, the all-in-one approach can be used for Hartree-Fock-type calculations, as well as hybrid functionals without range separation. However, range-separated hybrid functionals (including HSE,\nLMODELHF\n) yield erroneous results or potentially even crash. Please compare the total energies in a standard DFT/hybrid functional calculation against the energies obtained for the mean-field step in the all-in-one approach: The energies must be exactly the same. If they differ, fall back to the four-step procedure that is explained above.\nTo select the new all-in-one approach, it is important \"\nnot to set\nNBANDS\n\" in the RPA step. If\nNBANDS\nis set in the\nINCAR\nfile, VASP.6 proceeds with reading the\nWAVECAR\nfile found in the directory (if not present, random orbitals are used!), and then calculates the correlation energy using these orbitals and one-electron energies.\nThe basis set used in the diagonalization is strictly given by all plane waves. That is, there is no option to reduce the basis set size as one can by setting\nNBANDS\nin Step 3 and Step 4 of the four-step procedure.\nThe exchange energy is only calculated if the low-scaling RPA is selected.\nAs of VASP 6.3, the head of the dielectric function (G=0 component) can be calculated by setting\nLOPTICS\n= .TRUE.\nIn the all-in-one procedure, VASP automatically sets\nLMAXFOCKAE\nand\nNMAXFOCKAE\n. This changes the energies for hybrid functionals and Hartree-Fock slightly. Hence, you need to set\nLMAXFOCKAE\n= 4 also in Step 1 of the four-step procedure to obtain the same results as in the all-in-one procedure.\nOutput of ACFDT-RPA total energy\nThe ACFDT-RPA total energy is calculated for 8 different energy cutoffs and a linear regression is used to extrapolate the results to the infinite cutoff limit, see\nsection below\n. A successful RPA calculation writes the following lines into the\nOUTCAR\nfile:\ncutoff energy     smooth cutoff   RPA   correlation   Hartree contr. to MP2\n---------------------------------------------------------------------------------\n316.767           316.767      -17.5265976349      -26.2640927215\n301.683           301.683      -17.3846505665      -26.0990489039\n287.317           287.317      -17.2429031341      -25.9344769084\n273.635           273.635      -17.0686574017      -25.7325162480\n260.605           260.605      -16.8914915810      -25.5277026697\n248.195           248.195      -16.7202601717      -25.3302982602\n236.376           236.376      -16.5559849344      -25.1415392478\n225.120           225.120      -16.3635400223      -24.9210737434\nlinear regression\nconverged value                          -19.2585393615      -28.2627347266\nHere, the third and fourth columns correspond to the correlation energy (for that specific energy cutoff) in the RPA and the direct second-order Møller–Plesset (MP2) approximation, i.e., the second-order term in RPA. The corresponding results of the linear regression are found in the line starting with\nconverged value\n.\nLow-scaling ACFDT/RPA algorithm\nVirtually the same tags and procedures apply to the low-scaling RPA algorithm implemented in VASP 6\n[2]\n. However,\nALGO\n=ACFDT or\nALGO\n=RPA needs to be replaced by either\nALGO\n=ACFDTR or\nALGO\n=RPAR.\nWith this setting VASP calculates the independent-particle polarizability\nχ\n(\ni\nω\n)\n{\\displaystyle  \\chi(i\\omega) }\nusing Green's functions\nG\n(\ni\nτ\n)\n{\\displaystyle G(i\\tau)}\non the imaginary time axis\ni\nτ\n{\\displaystyle i\\tau}\nby the contraction formula\n[3]\nχ\n(\ni\nτ\nm\n)\n=\n−\nG\n(\ni\nτ\nm\n)\nG\n(\n−\ni\nτ\nm\n)\n{\\displaystyle\n\\chi(i\\tau_m) = -G(i\\tau_m)G(-i\\tau_m)\n}\nSubsequently, a compressed Fourier transformation on the imaginary axes\nτ\nm\n,\nω\nn\n{\\displaystyle \\tau_m,\\omega_n}\nyields\nχ\n(\ni\nω\nn\n)\n=\n∑\nm\n=\n1\nN\nγ\nn\nm\nχ\n(\ni\nω\nm\n)\n{\\displaystyle\n\\chi(i\\omega_n) = \\sum_{m=1}^{N} \\gamma_{nm} \\chi(i\\omega_m)\n}\nThe remaining step is the evaluation of the correlation energy and is the same as described above.\nCrucial to this approach is the accuracy of the Fourier transformation from\nχ\n(\ni\nτ\n)\n→\nχ\n(\ni\nω\n)\n{\\displaystyle \\chi(i\\tau)\\to \\chi(i\\omega)}\n, which in general depends on two factors: First, the grid order\nN\n{\\displaystyle N}\nthat can be set by\nNOMEGA\nin the\nINCAR\nfile. Here, similar choices as for the\nALGO\n=ACFDT are recommended. Second, the grid points\nτ\nm\n,\nω\nn\n{\\displaystyle \\tau_m,\\omega_n}\nand Fourier matrix\nγ\nn\nm\n{\\displaystyle \\gamma_{nm}}\nhave to be optimized for the same interval as spanned by all possible transition energies in the polarizability. The minimum (maximum) transition energy can be set with the\nOMEGAMIN\n(\nOMEGATL\n) tag and should be smaller (larger) than the bandgap, i.e., the maximum transition energy, of the previous DFT calculation. VASP determines these values automatically and writes it in the\nOUTCAR\nafter the lines\nResponse functions by GG contraction:\nThese values should be checked for consistency. Furthermore, we recommend inspecting the grid and transformation errors by looking for the following lines in the\nOUTCAR\nfile\nnu_ 1=  0.1561030E+00 ERR=   0.6327933E-05 finished after   1 steps\nnu_ 2= ...\nMaximum error of frequency grid:  0.3369591E-06\nEvery frequency point will have a similar line as shown above for the first point. The value after\nERR=\ncorresponds to the maximum Fourier-transformation error and should be of similar order as the maximum integration error of the frequency grid.\nOutput of low-scaling ACFDT/RPA\nSelecting the low-scaling RPA algorithm, VASP computes the total energy in the RPA and writes the following output\n-----------------------------------------------------\nHF-free energy      FHF    =       -25.11173505 eV\nHF+RPA corr. energy TOTEN  =       -36.96463791 eV\nHF+E_corr(extrapolated)    =       -37.70506951 eV\nThe line\nHF+RPA corr. energy TOTEN\ncontains the total energy calculated with the largest cutoff\nENCUTGW\n.\nThe line\nHF+E_corr(extrapolated)\ncontains the total energy with the extrapolated value for the RPA correlation energy.\nThe line\nFHF\ndenotes the exact exchange contribution to the total energy. This contribution is determined with an electronic density\nusing\nLMAXFOCKAE\n. For most systems the resulting energy is in very good agreement with the reference EXX energy obtained in\nstep 2 described above\n. As of version 6.5.2, exact compatibility with this step can be reached using\nLFOCKSTD\n.\nTip:\nSelect exact one-centre terms for the electronic density in\nexact exchange energies\nwith\nLFOCKSTD\nas of version 6.5.2.\nSingles contribution to the correlation energy\nThe low-scaling RPA algorithm also allows for the determination of the so-called singles contribution,\n[4]\n[5]\nto the total energy represented by following diagrams:\nIn most textbooks\n[6]\nthis contribution is assumed to be zero. Ren et al.\n[5]\npointed out that this is true only in the Hartree-Fock basis set. The singles contribution is non-vanishing for other basis sets.\nThe singles contribution is calculated for\nLSINGLES\n=.TRUE.. In this case following additional lines can be found in OUTCAR:\nHF single shot energy change        -1.23182672\nrenormalized HF singles             -1.23310555\nHere, the first line contains the value of the singles as proposed by Klimeš et al.,\n[4]\nwhile the second line contains the singles contribution of Ren et al.\n[5]\n. In most cases we found that the two values are exceedingly close to each other, which can be understood in the way how the propagator is renormalized.\n[4]\nOptional: RPA Forces\nOptionally, RPA forces can be calculated by adding following line to the\nINCAR\nfile:\nLRPAFORCE\n= .TRUE.\nFor RPA forces the change in the one-electron density is required.\n[7]\nThis is automatically performed with the linear-response routine within VASP.\nAfter a successful run, the following block of data is found in the\nOUTCAR\nfile.\nPOSITION                                       TOTAL RPA FORCE (eV/Angst)\n-----------------------------------------------------------------------------------\n0.17542     -0.22348      0.17542        -0.292069      7.581315     -0.292069\n1.12850      1.31044      1.12850         0.304683     -7.605527      0.304683\n-----------------------------------------------------------------------------------\ntotal drift:                                0.012614     -0.024212      0.012614\nSUGGESTED UPDATED POSCAR (direct coordinates)  step\n-----------------------------------------------------------------------------------\n-0.00958461  -0.00958461   0.13485779         0.04179056   0.04179056   0.00283088\n0.25787833   0.25787833   0.22191754        -0.04337198  -0.04337198   0.00431513\nThe suggested updated positions are also written to the CONTCAR file (if\nNSW\n=0). The updated positions are obtained by multiplying the RPA-forces with the parameter\nDAMP_NEWTON\nand the inverse of the DFT-Hessian (which is also calculated during the RPA force calculations) and adding the resultant vector to the current positions.\nDAMP_NEWTON\ncurrently defaults to 0.8, but the user might want to change this to 1.0 (no damping), or smaller values if instabilities are observed. The CONTCAR file can be copied to the POSCAR file, and a few such RPA calculations should recover the groundstate structure. Alternatively, standard relaxations (\nIBRION\n=1-4) or even MD's can be performed.\nTip:\nUse\nLFOCKSTD\nto improve total energies and RPA forces as of version 6.5.2.\nCaveats: Noise in Energies and RPA Forces\nGenerally, the energy calculated by the RPA can be quite noisy as a function of the ionic positions, in particular, if\nPRECFOCK\n= FAST and\nNMAXFOCKAE\n= 1 is set (these are the default values for RPA calculations). Most of the noise is related to the exact exchange energy. To determine if noise is affecting the results, it is useful to calculate the exchange energy separately as explained in step 2 above. If the exchange energy reported there is smooth, and the exchange energy reported by the all-in-one approach is noisy (e.g. shows odd jumps as a function of the positions or volume), it is strongly recommended to consider one or both of the options discussed below.\nCurrently, to reduce the noise in the energy and forces, it is sensible to set\nPRECFOCK\n= Normal (typically doubling the execution time and memory requirement). It is also possible to set\nLMAXFOCKAE\n= -1 (which implicitly sets\nNMAXFOCKAE\n= 0). This makes the correlation energies and the related forces less noisy, but technically less accurate (i.e. part of the correlation energy will be missing at high transition energies). Overall, RPA forces must be used carefully and only after extensive testing of all relevant parameters.\nMemory bottleneck and Parallelization\nThe cubic scaling space-time RPA algorithm requires considerably more memory than the corresponding quartic-scaling implementations, two Green's functions\nG\n(\nr\n,\nr\n′\n,\ni\nτ\nn\n)\n{\\displaystyle G({\\bf r,r'},i\\tau_n)}\nhave to be stored in real-space. To reduce the memory overhead, VASP exploits Fast Fourier Transformations (FFT) to avoid storage of the matrices on the (larger) real space grid, on the one hand. The precision of the FFT can be selected with\nPRECFOCK\n, where usually the values\nFast\nsufficient.\nOn the other hand, the code avoids storage of redundant information, i.e., both the Green's function and polarizability matrices are distributed as well as the individual imaginary grid points. The distribution of the imaginary grid points can be set by hand with the\nNTAUPAR\nand\nNOMEGAPAR\ntags, which splits the imaginary grid points\nNOMEGA\ninto\nNTAUPAR\ntime and\nNOMEGAPAR\ngroups. For this purpose both tags have to be divisors of\nNOMEGA\n.\nThe default values are usually reasonable choices provided the tag\nMAXMEM\nis set correctly and we strongly recommend to set\nMAXMEM\ninstead of\nNTAUPAR\n.\nImportant:\nAs of version 6.2,\nMAXMEM\nis estimated automatically (if not set) from the \"MemAvailable\" entry of the Linux kernel in \"/proc/meminfo\".\nThe required storage for a low-scaling RPA or GW calculation depends mostly on\nNTAUPAR\n, the number of MPI groups that share same imaginary time points. A rough estimate for the required bytes is given by\n(NGX*NGY*NGZ)*(NGX_S*NGY_S*NGZ_S) / ( NCPU  /\nNTAUPAR\n) * 16\nwhere \"NCPU\" is the number of MPI ranks used for the job,\"NGX,NGY,NGZ\" denotes the number of FFT grid points for the exact exchange and  \"NGX_S,NGY_S,NGZ_S\" the number of FFT grid points for the supercell. Note, both grids are written to the\nOUTCAR\nfile after the lines\nFFT grid for exact exchange (Hartree Fock)\nFFT grid for supercell:\nThe smaller\nNTAUPAR\nis set, the less memory per node the job requires to finish successfully.\nThe approximate memory requirement is calculated in advance and printed to screen and\nOUTCAR\nas follows:\nmin. memory requirement per mpi rank 1234 MB, per node 9872 MB\nSome Issues Particular to ACFDT-RPA Calculations on Metals\nFor metals, the RPA groundstate energy converges the fastest with respect to k-points, if the exchange (Eq. (12) in reference\n[8]\n) and correlation energy are calculated on the same k-point grid,\nHFRCUT\nis not set, and the long-wavelength contributions from the polarizability are not considered  (see reference\n[8]\n).\nTo evaluate Eq. (12), a correction energy for\nE\nE\nX\nX\n{\\displaystyle E_{\\mathrm{EXX}}}\nrelated to partial occupancies has to be added to the RPA groundstate energy:\n[8]\nE\nR\nP\nA\n=\nE\nc\n+\nE\nE\nX\nX\n+\nE\nH\nF\nc\n{\\displaystyle E_{\\mathrm{RPA}}=E_{\\mathrm{c}}+E_{\\mathrm{EXX}}+E_{\\mathrm{HFc}}}\n.\nIn vasp.5.4.1, this value is calculated for any HF type calculation (step 2) and can be found in the\nOUTCAR\nfile after the total energy (in the line starting with\nexchange ACFDT corr.  =\n).\nTo neglect the long-wavelength contributions, simply set\nLOPTICS\n=\n.FALSE.\nin the\nALGO\n=\nExact\nstep (third step), and remove the\nWAVEDER\nfiles in the directory.\nPossible tests and known issues\nExact one-centre density terms\nBeginning with version 6.5.2, it is possible to include exact one-center terms in the density for the exact exchange (EXX) component of RPA total energies and forces by enabling the\nLFOCKSTD\noption. Incorporating these one-center terms significantly enhances the accuracy of both total energies and forces-by at least an order of magnitude-compared to results obtained using finite-difference methods. Therefore, it is strongly recommended to activate\nLFOCKSTD\nfor GW and RPA calculations starting from version 6.5.2. In earlier versions, the one-center contribution to the density was managed using the\nLMAXFOCKAE\nsetting.\nBasis set convergence\nThe expression for the ACFDT-RPA correlation energy written in terms of reciprocal lattice vectors reads:\nE\nc\nR\nP\nA\n=\n∫\n0\n∞\nd\nω\n2\nπ\n∑\nq\n∈\nB\nZ\n∑\nG\n{\n(\nl\nn\n[\n1\n−\nχ\n~\n0\n(\nq\n,\ni\nω\n)\nV\n(\nq\n)\n]\n)\nG\n,\nG\n+\nV\nG\n,\nG\n(\nq\n)\nχ\n~\n0\n(\nq\n,\ni\nω\n)\n}\n{\\displaystyle E_{\\rm c}^{\\rm RPA}=\\int_{0}^{\\infty} \\frac{\\mathrm{d}\\omega}{2\\pi} \\sum_{{\\mathbf{q}}\\in \\mathbf{BZ} }\\sum_{{\\mathbf{G}}} \\left\\{(\\mathrm{ln}[1-\\tilde\\chi^0({\\mathbf{q}},\\mathrm{i}\\omega)V({\\mathbf{q}})])_{{\\mathbf{G,G}}}  +V_{{\\mathbf{G,G}}}({\\mathbf{q}})\\tilde\\chi^0({\\mathbf{q}},{\\mathrm{i}}\\omega) \\right\\} }\n.\nThe sum over reciprocal lattice vectors has to be truncated at some\nG\nm\na\nx\n{\\displaystyle \\mathbf{G}_{\\mathrm{max}}}\n, determined by\nℏ\n2\n|\nG\n+\nq\n|\n2\n2\nm\ne\n{\\displaystyle \\frac{\\hbar^2|{\\mathbf{G}}+{\\mathbf{q}}|^2}{2\\mathrm{m}_e}}\n<\nENCUTGW\n, which can be set in the\nINCAR\nfile. The default value is\n2\n3\n×\n{\\displaystyle \\frac{2}{3}\\times}\nENCUT\n, which experience has taught us not to change. For systematic convergence tests, instead increase\nENCUT\nand repeat steps 1 to 4, but be aware that the \"maximum number of plane-waves\" changes when\nENCUT\nis increased. Note that it is virtually impossible, to converge absolute correlation energies. Rather concentrate on relative energies (e.g. energy differences between two solids, or between a solid and the constituent atoms).\nSince correlation energies  converge very slowly with respect to\nG\nm\na\nx\n{\\displaystyle \\mathbf{G}_{\\rm max }}\n, VASP automatically extrapolates to the infinite basis set limit using a linear regression to the equation:\n[9]\n[8]\n[10]\nE\nc\n(\nG\n)\n=\nE\nc\n(\n∞\n)\n+\nA\nG\n3\n{\\displaystyle E_{\\mathrm{c}}({\\mathbf{G}})=E_{\\mathrm{c}}(\\infty)+\\frac{A}{{\\mathbf{G}}^3}}\n.\nFurthermore, the Coulomb kernel is smoothly truncated between\nENCUTGWSOFT\nand\nENCUTGW\nusing a simple cosine like window function (Hann window function).\nAlternatively, the basis set extrapolation can be performed by setting\nLSCK\n=.TRUE., using the squeezed Coulomb kernel method.\n[11]\nThe default for\nENCUTGWSOFT\nis 0.8\n×\n{\\displaystyle \\times}\nENCUTGW\n(again we do not recommend to change this default).\nThe integral over\nω\n{\\displaystyle \\omega}\nis evaluated by means of a highly accurate minimax integration.\n[12]\nThe number of\nω\n{\\displaystyle \\omega}\npoints is determined by the flag\nNOMEGA\n, whereas the energy range of transitions is determined by the band gap and the energy difference between the lowest occupied and highest unoccupied one-electron orbital. VASP determines these values automatically (from vasp.5.4.1 on), and the user should only carefully converge with respect to the number of frequency points\nNOMEGA\n. A good choice is usually\nNOMEGA\n=12, however, for large gap systems one might obtain\nμ\n{\\displaystyle \\mu}\neV convergence per atom already using 8 points, whereas for metals up to\nNOMEGA\n=24 frequency points are sometimes necessary, in particular, for large unit cells.\nStrictly adhere to the steps outlines above. Specifically, be aware that steps two and three require the\nWAVECAR\nfile generated in step one, whereas step four requires the\nWAVECAR\nand\nWAVEDER\nfile generated in step three (generated by setting\nLOPTICS\n=\n.TRUE.\n).\nConvergence with respect to the number of plane waves can be rather slow, and we recommend to test the calculations carefully. Specifically, the calculations should be performed at the default energy cutoff\nENCUT\n, and at an increased cutoff (ideally the default energy cutoff\n×\n1.3\n{\\displaystyle \\times 1.3}\n). Another issue is that energy volume-curves are sometimes not particularly smooth. In that case, the best strategy is to set\nENCUT\n= 1.3 times default energy cutoff\nENCUTGWSOFT\n= 0.5 times default energy cutoff\nwhere the default energy cutoff is the usual one (maximum ENMAX in POTCAR files). The frequency integration also needs to be checked carefully, in particular for small gap systems (some symmetry broken atoms) convergence can be rather slow, since the one-electron band gap can be very small, requiring a very small minimum\nω\n{\\displaystyle \\omega}\nin the frequency integration.\nK-point convergence: Spline interpolation\nMind:\nESF_SPLINES\nis available as of VASP.6.5.0\nIt is possible to use spline interpolation to improve upon k-point integration errors by rewriting the\nRPA correlation energy as an integral\nE\nc\nR\nP\nA\n=\n∑\nq\n∈\nB\nZ\n∑\nG\nS\n(\nq\n+\nG\n)\n{\\displaystyle\nE_c^{{\\rm  RPA}}= \\sum_{{\\mathbf{q}}\\in \\mathbf{BZ} }\\sum_{{\\mathbf{G}}} S({\\bf q+G})\n}\nover the electronic structure factor:\nS\n(\nq\n+\nG\n)\n=\n∫\nd\nω\n{\n(\nl\nn\n[\n1\n−\nχ\n~\n0\n(\nq\n,\ni\nω\n)\nV\n(\nq\n)\n]\n)\nG\n,\nG\n+\nV\nG\n,\nG\n(\nq\n)\nχ\n~\n0\n(\nq\n,\ni\nω\n)\n}\n{\\displaystyle\nS({\\bf q}+{\\bf G}) =\\int {\\rm d}\\omega\n\\left\\{(\\mathrm{ln}[1-\\tilde\\chi^0({\\mathbf{q}},\\mathrm{i}\\omega)V({\\mathbf{q}})])_{{\\mathbf{G,G}}}  +V_{{\\mathbf{G,G}}}({\\mathbf{q}})\\tilde\\chi^0({\\mathbf{q}},{\\mathrm{i}}\\omega) \\right\\}\n}\nIf\nESF_SPLINES\n=T is set, the code stores the electronic structure factor on a coarse grid defined by\nKPOINTS\nand performs a tricubic spline interpolation towards finer q-grids iteratively. After each iteration the RPA correlation energy is evaluated and compared to the result of previous interpolation.\nIf the difference in energy is smaller than\nESF_CONV\nwithin\nESF_NINTER\ninterpolation steps, the code considers the q-point integration to be converged and reports the result to\nOUTCAR\nin the following format\ncutoff energy     smooth cutoff   RPA   correlation   Hartree contr. to MP2  RPA spline-interp.\n-----------------------------------------------------------------------------------------------------\n166.667           133.333      -12.9738715106      -19.7255874374      -13.4968000908\n158.730           126.984      -12.8840657072      -19.6294580403      -13.4017404001\n151.172           120.937      -12.7775593388      -19.5151822998      -13.3005326847\n143.973           115.178      -12.6604147404      -19.3892142669      -13.1868498210\n137.117           109.694      -12.5530911576      -19.2733151174      -13.0861120393\n130.588           104.470      -12.4659186304      -19.1786165194      -12.9778587892\n124.369            99.495      -12.3690601643      -19.0725742983      -12.8709666989\n118.447            94.758      -12.2461267475      -18.9372318755      -12.7590723870\nlinear regression\nconverged value                          -14.0340307585      -20.8751715586      -14.5828037654\nThe last column contains the result from the spline interpolation for the selected energy cutoffs reported in the first column.\nWarning:\nDelete\nWAVEDER\nfor this method.\nNote that this method is incompatible with k-p perturbation theory, where the\nlargest q-point integration error\nlim\nq\n→\n0\nχ\n~\nG\nG\n′\n0\n(\nq\n,\ni\nω\n)\n⋅\nV\nG\nG\n′\n(\nq\n)\n{\\displaystyle\n\\lim_{\\bf q\\to 0} \\tilde\\chi^0_{{\\bf G G}'}({\\bf q},{\\rm i}\\omega) \\cdot {\\bf V}_{\\bf G G'}({\\bf q})\n}\nis added explicitly to the RPA integral.\nThis long-wave contribution is stored in\nWAVEDER\n, and VASP assumes you want to add this term if the file is present in the working directory.\nAlso, the long-wave limit is ill-defined for metallic systems, in contrast to the spline interpolation method.\nMind:\nESF_SPLINES\ncan be used for metals.\nNevertheless, for insulators, we still recommend using\nWAVEDER\nand not set\nESF_SPLINES\nfor efficiency reasons.\nRelated Tags and Sections\nALGO\nfor response functions and\nACFDT\ncalculations\nNOMEGA\n,\nNOMEGAR\nnumber of frequency points\nLHFCALC\n, switches on HF calculations\nLOPTICS\n, required in the DFT step to store head and wings\nENCUTGW\n, to set cutoff for response functions\nENCUTGWSOFT\nPRECFOCK\ncontrols the FFT grids in HF, GW, RPA calculations\nNTAUPAR\ncontrols the number of imaginary time groups in space-time GW and RPA calculations\nNOMEGAPAR\ncontrols the number of imaginary frequency groups in space-time GW and RPA calculations\nMAXMEM\nsets the available memory per MPI rank on each node\nLFINITE_TEMPERATURE\nswitches on Matsubara (finite temperature) formalism\nESF_SPLINES\nuses tricubic spline interpolation of electronic structure factor to accelerate k-point convergence\nLFOCKSTD\nexact one-centre terms in EXX part of total energy and RPA forces\nReferences\n↑\nJ. Paier, M. Marsman, and G. Kresse, Phys. Rev. B\n78\n, 121201 (2008).\n↑\nM. Kaltak, J. Klimeš, and G. Kresse, Phys. Rev. B\n90\n, 054115 (2014).\n↑\nH. N. Rojas, R. W. Godby, and R. J. Needs, Phys. Rev. Lett.\n74\n, 1827 (1995).\n↑\na\nb\nc\nJ. Klimeš, M. Kaltak, and G. Kresse, J. Chem. Phys.\n143\n, 102816 (2015).\n↑\na\nb\nc\nX. Ren, P. Rinke, G. E. Scuseria, and M. Scheffler, Phys. Rev. B\n88\n, 035120 (2013).\n↑\nR. D. Mattuck, Dover Books on Physics (2012).\n↑\nB. Ramberger, T. Schäfer and G. Kresse, Phys. Rev. Lett\n118\n, 106403 (2017).\n↑\na\nb\nc\nd\nJ. Harl, L. Schimka, and G. Kresse, Phys. Rev. B\n81\n, 115126 (2010).\n↑\nJ. Harl and G. Kresse, Phys. Rev. B\n77\n, 045136 (2008).\n↑\nJ. Klimeš, M. Kaltak, and G. Kresse, Phys. Rev. B\n90\n, 075125 (2014).\n↑\nS. Riemelmoser, M. Kaltak, and G. Kresse, JCP\n152(13)\n, 134103 (2020).\n↑\nM. Kaltak, J. Klimeš, and G. Kresse, J. Chem. Theory Comput.\n10\n, 2498-2507 (2014)."
  }, 
  "Andersen thermostat": {
    "description": "The web page describes the Andersen thermostat method for molecular dynamics simulations, which couples the system to a fictitious heat bath through stochastic collisions that randomly rescale particle momenta according to the Boltzmann distribution at a desired temperature.", 
    "detailed_description": "In the approach proposed by Andersen\n[1]\nthe system is thermally coupled to a fictitious heat bath with the desired temperature. The coupling is represented by stochastic collisions that act occasionally on randomly selected particles. In particular the momentum of the\nlucky\nparticle at every collision step is instantaneously chosen at random from the Boltzmann distribution at the selected temperature. The collision probability is defined as an average number of collisions per atom and time-step and the collision frequency occurs with the following distribution\nP\n(\nt\n)\n=\nν\ne\n−\nν\nt\n.\n{\\displaystyle\nP(t)=\\nu e^{-\\nu t}.\n}\nThe exponent of this the distribution (\nν\nt\n{\\displaystyle \\nu t}\n) is controlled by the flag\nANDERSEN_PROB\n. Since\nt\n{\\displaystyle t}\nis the time step in the calculation\nANDERSEN_PROB\nhas to be scaled if the time step changes. The total number of collisions with the heat-bath is written out to the file\nREPORT\nfor each MD step.\nA very good implementation of the Andersen thermostat can be found in chapter 6.1.1 of reference\n[2]\n.\nThe Andersen thermostat is selected by setting\nMDALGO\n=1.\nRelated tags and articles\nMolecular-dynamics calculations\n,\nNose-Hoover thermostat\n,\nLangevin thermostat\n,\nCSVR thermostat\n,\nNose-Hoover-chain thermostat\n,\nISIF\n,\nMDALGO\n,\nANDERSEN_PROB\nReferences\n↑\nH. C. Andersen, J. Chem. Phys.\n72\n, 2384 (1980).\n↑\nD. Frenkel and B. Smit, Understanding Molecular Simulation (Academic Press, London, 1996)."
  }, 
  "Band-structure calculation using hybrid functionals": {
    "description": "This web page provides a detailed step-by-step guide for performing band-structure calculations using hybrid functionals in VASP, including instructions on setting up k-point meshes, handling convergence, and optimizing computational efficiency.", 
    "detailed_description": "Band-structure calculations\nfor\nhybrid functionals\nrequire multiple steps. Below we give a step-by-step introduction and an example. Additionally, we provide some advice to reduce computational and human effort.\nStep-by-step instructions\nFor\nhybrid functionals\n, the Hamiltonian cannot be expressed in terms of the electronic charge density alone. Instead, the Kohn-Sham orbitals on a regular\nk\nmesh are required for any calculation within the\nformalism of hybrid functionals\n. The regular\nk\nmesh must be supplied in the\nKPOINTS\nfile. Consequently, restarting a hybrid calculation requires the\nWAVECAR\nfile of the previous self-consistent-field (SCF) run. This is in contrast to\ndensity-functional theory\n(DFT), where the electronic charge density written to the\nCHGCAR\nfile suffices to restart a DFT calculation. In order to reach convergence more quickly, it is good practice to first compute the DFT result in a SCF calculation.\nStep 1 (optional):\nRun an SCF calculation to obtain a converged\nWAVECAR\nfile for DFT.\nBand-structure calculations\ngenerally compute the Kohn-Sham orbitals and eigenenergies along a path in reciprocal space which usually connects high-symmetry points in the first Brillouin zone. Some external tools\n[1]\n[2]\nhelp to identify the high-symmetry points and\nk\npoints along a high-symmetry path for materials of any symmetry.\nStep 2:\nDetermine the high-symmetry path along which VASP should compute the band structure.\nThere are two options to simultaneously supply a regular\nk\nmesh\nand\nk\npoints along a high-symmetry path to VASP.\n1. Provide an\nexplicit list of\nk\npoints\nwith zero-weighted\nk\npoints.\nHere, the explicit list of the irreducible\nk\npoints of the regular\nk\nmesh can be copied from the\nIBZKPT\nfile of a previous run to the\nKPOINTS\nfile. For instance, use the\nIBZKPT\nfile of step 1. These irreducible\nk\npoints must be weighted by their multiplicity according to the system's symmetry. Additionally, the\nk\npoints along a high-symmetry path must be added to the\nKPOINTS\nfile with the value of all weights set to zero.\n2. Provide an additional\nKPOINTS_OPT\nfile that can specify the\nhigh-symmetry path in line mode\n.\nGenerally, the\nKPOINTS\nfile and the\nKPOINTS_OPT\nfile accept the same format. But again, the regular\nk\nmesh needs to be supplied in the\nKPOINTS\nfile and the high-symmetry path in the\nKPOINTS_OPT\nfile. We therefore recommend using the\nΓ-centered mesh or Monkhorst-Pack mesh\n, and\nline mode\n, respectively.\nThe\nKPOINTS_OPT\nmethod is more convenient because it allows using the automatic generation modes for the\nk\npoints. The computational cost and memory requirement can vary for the two methods due to the scaling behaviour with the number of\nk\npoints.\nStep 3:\nSupply a regular\nk\nmesh and\nk\npoints along a high-symmetry path either using the explicit list including zero-weighted\nk\npoints or using a\nKPOINTS_OPT\nfile.\nBy default VASP uses auxiliary functions (\nHFALPHA\n) for the truncation of the\nCoulomb singularity\n, but this method leads to discontinuities in band-structure calculations. We recommend using the Coulomb truncation (\nHFRCUT\n) instead. In particular,\nHFRCUT\n=-1 converges best for systems with a band gap.\nStep 4:\nSet\nHFRCUT\nin the\nINCAR\nfile and restart the hybrid calculation from the DFT\nWAVECAR\nfile.\nStep 5:\nPlot the band structure, e.g., using\npy4vasp\n. In a python notebook in the directory of the calculation, you can execute\nimport\npy4vasp\nas\npv\ncalc\n=\npv\n.\nCalculation\n.\nfrom_path\n(\n\".\"\n)\ncalc\n.\nband\n.\nplot\n()\n# calc.band.plot(\"kpoints_opt\") # if the high-symmetry path is in KPOINTS_OPT\nRecommendations and advice\nIn case a\nKPOINTS_OPT\nfile is present, VASP computes the band energies for the\nk\npoints of the\nKPOINTS_OPT\nfile after SCF is reached within the same submitted job. Their convergence is checked independently by requiring the sum over occupied band energies not to change in two successive iterations. Hence, for the computational time, there is no advantage to restart from a converged hybrid calculation, but in principle it is possible.\nIn contrast, the method using an explicit list including zero-weighted\nk\npoints computes the band energies for all\nk\npoints at each SCF step. The convergence criterion considers the total energy and, thus, does not account for convergence of KS orbitals at zero-weighted\nk\npoints. Taking the KS orbitals of the zero-weighted\nk\npoints along the entire SCF run makes their convergence highly likely. However, restarting from a converged hybrid calculation can result in premature stopping. This can be counteracted by setting the\nNELMIN\ntag to a higher value. Especially if the hybrid calculation needs many SCF steps to reach convergence and each SCF step is very expensive when including zero-weighted\nk\npoints, one may consider to restart from a converged hybrid calculation with\nNELMIN\nset to a large number. We recommend carefully checking the convergence of the band structure in this case.\nTip:\nFor a band-structure calculation with an explicit list including zero-weighted\nk\npoints, avoid restarting from a converged hybrid\nWAVECAR\nfile.\nIt is possible to achieve very fine sampling along the\nk\npath with both methods, but there are some aspects to take into account. As mentioned, the computational cost and memory requirement can vary for the two methods due to the scaling with the number of\nk\npoints. For the\nKPOINTS_OPT\nmethod, the number of\nk\npoints treated simultaneously can be controlled by means of the\nKPOINTS_OPT_NKBATCH\ntag. For the explicit list including zero-weighted\nk\npoints, VASP may exceed the available memory if the number of zero-weighted\nk\npoints is large. In that case, split the hybrid band-structure calculation into multiple calculations. For each calculation, add part of the zero-weighted\nk\npoints.\nTip:\nMake fine sampling computationally feasible using the\nKPOINTS_OPT_NKBATCH\ntag or splitting the calculation with part of the zero-weighted\nk\npoints.\nLet us stress a significant difference between hybrid band-structure calculations and DFT band-structure calculations. The electronic charge density suffices for density functionals to define the Hamiltonian, and no regular\nk\nmesh is required during DFT band-structure calculations. However, if no regular\nk\nmesh is provided, the electronic charge density must be fixed during the DFT band-structure calculation by setting\nICHARG\n=11 in the\nINCAR\nfile.\nWarning:\nThe electronic charge density must not be fixed for any hybrid calculation, i.e., never set\nICHARG\n=11!\nTip:\nTo understand how the two methods work in practice, try using them with a DFT calculation as if it were a hybrid calculation.\nIf you forgot setting\nHFRCUT\nyou may be able to mitigate the band structure. Semi-core states can be assumed to be dispersionless but you will see the same discontinuities featured on the semi core states. By subtracting the faulty dispersion of the semi-core state from all bands, you can recover the true dispersion of the conduction bands.\nExample of\nk\npoints for hybrid band-structure calculation\nFor instance, for cubic-diamond Si with the following\nPOSCAR\nfile\ncd Si\n5.5\n0.0    0.5     0.5\n0.5    0.0     0.5\n0.5    0.5     0.0\nSi\n2\nFractional\n-0.125 -0.125 -0.125\n0.125  0.125  0.125\nwe can generate a regular k mesh using the following\nKPOINTS\nfile\nRegular k-points mesh\n0\nMonkhorst-Pack method\n3 3 3\n0 0 0\nThe resulting\nIBZKPT\nfile contains the following lines:\nAutomatically generated mesh\n4\nReciprocal lattice\n0.00000000000000    0.00000000000000    0.00000000000000             1\n0.33333333333334    0.00000000000000   -0.00000000000000             8\n0.33333333333334    0.33333333333334   -0.00000000000000             6\n-0.33333333333334    0.33333333333334    0.00000000000000            12\nFor the explicit\nk\n-points list, copy the regular\nk\nmesh from the\nIBZKPT\nfile and add, e.g., 5\nk\npoints from Γ to X with zero weight:\nExplicit k-points list\n9\nReciprocal lattice\n0.00000000000000    0.00000000000000    0.00000000000000             1\n0.33333333333334    0.00000000000000   -0.00000000000000             8\n0.33333333333334    0.33333333333334   -0.00000000000000             6\n-0.33333333333334    0.33333333333334    0.00000000000000            12\n0.00000000       0.00000000       0.00000000 0\n0.12500000       0.00000000       0.12500000 0\n0.25000000       0.00000000       0.25000000 0\n0.37500000       0.00000000       0.37500000 0\n0.50000000       0.00000000       0.50000000 0\nFor the\nKPOINTS_OPT\nmethod, the same path from Γ to X can be specified by creating the following\nKPOINTS_OPT\nfile\nk points for band structure\n5  ! intersections\nline-mode\nFractional\n0.0000000000     0.0000000000     0.0000000000 Γ\n0.5000000000     0.0000000000     0.5000000000 X\nAnd continue using the following\nKPOINTS\nfile\nRegular k-points mesh\n0\nMonkhorst-Pack method\n3 3 3\n0 0 0\nRelated tags and articles\nKPOINTS\n,\nKPOINTS_OPT\n,\nList of hybrid functionals\n,\nHybrid functionals: formalism\n,\nCoulomb singularity\nReferences\n↑\nwww.cryst.ehu.es/cryst/get_kvec.html (2022).\n↑\nwww.materialscloud.org/work/tools/seekpath (2022)."
  }, 
  "Band-structure calculation using meta-GGA functionals": {
    "description": "To perform band-structure calculations with METAGGA functionals, use the same procedure as for hybrid functionals, as both require a regular k mesh to compute the kinetic-energy density.", 
    "detailed_description": "For\nband-structure calculations\nwith\nMETAGGA\nfunctionals, follow the same procedure as for\nband-structure calculations using hybrid functionals\n. The reason is that a regular k mesh has to be provided in order to compute the kinetic-energy density.\nRelated tags and articles\nKPOINTS\n,\nKPOINTS_OPT\n,\nBand-structure calculation using hybrid functionals\nReferences"
  }, 
  "Bandgap renormalization due to electron-phonon coupling": {
    "description": "This web page details the computation of band-structure renormalization and bandgap corrections using the Allen-Heine-Cardona theory within VASP, including input parameters, convergence studies, and special considerations for polar materials.", 
    "detailed_description": "The band-structure renormalization within the nonadiabatic Allen Heine Cardona (AHC) theory is computed from the real part of the electron self-energy evaluated at the Kohn-Sham (KS) eigenvalue.\nThis calculation is activated by default when\nELPH_RUN\n= True\nand\nELPH_DRIVER\n= EL\n.\nFor the particular case where we want to determine the bandgap, we can compute the self-energy only for the states that form the gap (including all the degenerate states).\nThe selection of these states can be done automatically by VASP using\nELPH_SELFEN_GAPS\n= True\n.\nMind:\nAvailable as of VASP 6.5.0\nTip:\nThe phonon-induced renormalization of the fundamental gap can alternatively be calculated from a\nstochastic approach\n.\nBasic usage\nThe first step of an electron-phonon calculation is the\ncomputation of the electron-phonon potential\n, which corresponds to the derivatives of the KS potential with ionic displacement.\nThis calculation produces the\nphelel_params.hdf5\nfile, which is a required input for the subsequent calculation.\nThe electron-phonon matrix elements are computed using the KS states obtained from a non-self-consistent-field calculation on a dense k-point mesh.\nThis k-point mesh is specified in the\nKPOINTS_ELPH\nfile, which has the same format as the regular\nKPOINTS\nfile.\nNote that\nNBANDS\ngoverns the number of bands used in the self-consistent-field calculation, while\nELPH_NBANDS\ngoverns the number of bands that will be used in the electron-phonon calculation and are computed in the grid specified via\nKPOINTS_ELPH\n.\nThe computation of the electronic bandgap renormalization can be done using the following\nINCAR\nfile:\nPREC\n= Accurate\nENCUT\n= 500\nEDIFF\n= 1e-8\nISMEAR\n= 0; SIGMA = 0.01\nLREAL\n= .FALSE.\nLWAVE\n= .FALSE.\nLCHARG\n= .FALSE.\n#run electron-phonon calculation\nELPH_RUN\n= .TRUE.\nELPH_DRIVER\n= EL\n# use exact diagonalization and compute all the bands\nELPH_NBANDS\n= -2\nKPOINTS_OPT_MODE\n= 2\n# compute gap renormalization\nELPH_SELFEN_DELTA\n= 0.01\nELPH_SELFEN_FAN\n= .TRUE.\nELPH_SELFEN_DW\n= .TRUE.\nELPH_SELFEN_GAPS\n= .TRUE.\nTo get an accurate value while using the smallest possible amount of computational resources, we recommend performing a basis set and k-point sampling convergence study.\nThis ensures that the result is precise, provides an error estimate and reveals the computationally most favorable settings.\nThe final output of the code is reported for each combination of computational parameters using the concept of\nelectron-phonon accumulators\n.\nBasis set convergence\nFirst, we will deal with convergence of the bandgap renormalization with respect to the number of electronic states (\nNBANDS\n) and plane-waves (\nENCUT\n). To avoid a more cumbersome double-convergence with\nENCUT\nand\nELPH_NBANDS\nwe recommend setting\nELPH_NBANDS\nto be equal to the maximum number of plane-waves. This can be done automatically by setting\nELPH_NBANDS\n= -2\n.\nThe derivatives of the electron-phonon potential are contained in the\nphelel_params.hdf5\nfile on a pre-selected grid (\nNGX\n,\nNGY\n,\nNGZ\n).\nThis means that we should avoid running the electron-phonon calculation with an\nENCUT\nthat would yield a set of\nNGX\n,\nNGY\nand\nNGZ\nthat is different from the\nphelel_params.hdf5\nfile.\nWe can, however, choose a smaller\nENCUT\nand set\nNGX\n,\nNGY\nand\nNGZ\nmanually in the\nINCAR\nfile to be the same as the one in the\nphelel_params.hdf5\nfile.\nThis allows running the calculation with different values of\nENCUT\nand monitoring how that affects the final value of the bandgap renormalization.\nLet us consider an example calculation where the electron-phonon potential was generated for Silicon with an\nENCUT\n= 500\nwhich yields\nNGX\n=\nNGY\n=\nNGZ\n=28 in the primitive cell. The values of\nNGX\n,\nNGY\nand\nNGZ\nchosen by VASP can be monitored in the\nOUTCAR\nfile.\nA convergence study can be performed by running multiple calculations with\nENCUT\n=200, then 300, then 400 and finally 500.\nNGX\n= 28\n,\nNGY\n= 28\nand\nNGZ\n= 28\nare set explicitly in the\nINCAR\nfile.\nYou can verify that the calculations with a lower cutoff run faster, highlighting the importance of convergence tests for reaching a good compromise between accuracy and computational time.\nK-point sampling convergence and extrapolation to infinity\nApart from the convergence with respect to the basis set, one should perform a convergence with respect to the k-point sampling.\nThis step implies running the calculation for increasingly dense k-point meshes specified in the\nKPOINTS_ELPH\nfile.\nThe convergence behavior with respect to k-points is mostly independent of the convergence behavior with respect to the plane-wave basis.\nTherefore, it is recommended to study both types of convergence separately to save on time.\nFurthermore, we recommend extrapolating the bandgap renormalization to infinite k-point density.\nThis is most easily accomplished by plotting the value of the renormalization as a function of the inverse k-point density.\nIn addition to the k-point convergence, the broadening parameter\nELPH_SELFEN_DELTA\nshould be monitored as well.\nIn principle, this parameter should be as small as possible.\nWarning:\nChoosing\nELPH_SELFEN_DELTA\ntoo small might produce inaccurate results for numerical reasons.\nThe usual approach is to extrapolate the result to zero broadening.\nTip:\nMultiple values can be specified for\nELPH_SELFEN_DELTA\n. VASP then computes the self-energy for each of these broadenings and reports the results in the\nOUTCAR\nand\nvaspout.h5\nfiles. For each value of the broadening, a new electron\nself-energy accumulator\nis created with the corresponding settings and values reported in the\nOUTCAR\nfile. This should help simplify the convergence study.\nSpecial treatment of the dipole interaction for polar materials\nThe convergence of the bandgap renormalization for polar materials (i.e. materials with a gap and non-zero born-effective charges) is especially challenging.\nThis is because the electron-phonon potential diverges as\nq\n→\n0\n{\\displaystyle q\\rightarrow0}\n.\nThis divergence is due to long-range electrostatic interactions that are not screened by the electrons, as would be the case for metals.\nIn these cases, VASP can remove this long-range component from the electron-phonon potential in the supercell, Fourier interpolate it and add it back in the primitive cell.\nThe same\ntreatment is done for the interatomic force constants\n.\nTo activate the long-range treatment, set the following\nINCAR\ntags:\nENCUTLR\n= 50\nELPH_LR\n= 1\nIFC_LR\n= 1\nMind:\nThe long-range treatment is activated by default when the phelel_params.hdf5 file contains the dielectric tensor and born effective charges.\nTip:\nThe value of\nENCUTLR\nshould be the smallest possible for efficiency reasons, but large enough such that the final quantity does not depend on it. Avoid values of\nENCUTLR\nthat are too large, otherwise, the results might become unphysical.\nRelated tags and articles\nTransport calculations\nElectron-phonon potential from supercells\nElectron-phonon accumulators\nphelel_params.hdf5\nElectron-phonon interactions from Monte-Carlo sampling"
  }, 
  "Best practices for Bethe-Salpeter calculations": {
    "description": "This web page provides optimization strategies for improving the performance of Bethe-Salpeter Equation (BSE) calculations in VASP, tailored for both small and large unit cells, including recommendations on algorithm selection, parallelization, precision settings, energy range limitations, and computational resource management.", 
    "detailed_description": "Optimizing performance\nDue to the steep scaling of the BSE method with the system size, it is important to optimize the parameters of the calculation. Here we provide recommendations that can significantly speed up the BSE calculations in VASP.\nBelow we consider two limiting cases: small cells and large cells.\nSmall cells\nWe consider that small cells are the cells where the number of atoms doesn't exceed\neight\n.\nFor such cells, it is typical that a large number of k-points is required to obtain a converged spectrum. Hence, the following optimizations should be considered.\nUse the Lanczos algorithm\n. Diagonalizing large matrices can be too time-consuming. Thus, for large matrices (e.g. rank > 1000)  we recommend using the Lanczos (\nIBSE\n=3) or time-evolution (\nIBSE\n=1) algorithms.\nSet\nKPAR\nto the number of MPI ranks\n.\nKPAR\nin BSE divides all MPI ranks into KPAR groups, which will share the wavefunctions. Thus, if\nKPAR\n=\nnumber of MPI ranks\nall wavefunctions are stored on every MPI rank, which eliminates the need to send/receive the orbitals during the calculation of the matrix elements. For small cells, it can be greatly beneficial to distribute all wavefunctions within a small group of MPI ranks or ideally store all orbitals on every rank.\nUse\nOMEGAMAX\nto limit the energy range\n. The\nOMEGAMAX\ncan be used to exclude transitions with higher energy from the BSE calculation. This largely reduces both the memory requirement and the computational time. It is especially beneficial for systems with a strong band dispersion, where energies can strongly vary at different k-points. This, however, requires some caution as it is not guaranteed that the spectrum up to\nOMEGAMAX\nis fully converged and the convergence of the spectrum with\nOMEGAMAX\nmust be carefully investigated.\nCompile VASP with\n-Dsingle_prec_bse\n. By default, VASP stores and solves the BSE in double precision. However, if VASP is compiled with the flag\n-Dsingle_prec_bse\nthe matrix is stored and solved in single precision, which gives a factor of two in performance and halves the memory required to store the matrix.\nLarge cells\nThe following optimizations should be relevant for cells where the number of atoms is larger than\neight\n.\nUse the Lanczos algorithm\n. Diagonalizing large matrices can be very time-consuming. Thus, for large matrices, e.g. rank > 1000, we recommend using the Lanczos (\nIBSE\n=3) or time-evolution (\nIBSE\n=1) algorithms.\nUse\nNBSEBLOCKV\nand/or\nNBSEBLOCKO\n. For large cells, it is typical that the number of k-points is small and the number of bands is large. By default in VASP, the matrix elements calculation in BSE is parallelized over k-points, which might not allow for the optimal load balancing of the computational load. By using parallelization over bands, we can subdivide large blocks of data each MPI rank computes into smaller blocks thus improving the load balance.\nCompile VASP with\n-Dsingle_prec_bse\n. By default, VASP stores and solves the BSE in double precision. However, if VASP is compiled with the flag\n-Dsingle_prec_bse\nthe matrix is stored and solved in single precision, which gives a factor of two in performance and halves the memory required to store the matrix.\nUse vasp_gam\n. If possible use the gamma version of VASP as it substantially reduces the required memory and computational time.\nUse\nOMEGAMAX\nto limit the energy range\n. The\nOMEGAMAX\ncan be used to exclude transitions with higher energy from the BSE calculation. This largely reduces both the memory requirement and the computational time. It is especially beneficial for systems with a strong band dispersion, where energies can strongly vary at different k-points. This, however, requires some caution as it is not guaranteed that the spectrum up to\nOMEGAMAX\nis fully converged and the convergence of the spectrum with\nOMEGAMAX\nmust be carefully investigated.\nUse lower\nPRECFOCK\n. In large cells, the FFTs may take up the majority of the time in the calculation of the matrix elements, and reducing the FFT grid can largely speed up the calculation. For the large cells, even low precision can be found sufficiently accurate, but the convergence with\nPRECFOCK\nmust be investigated for each system.\nRelated articles\nALGO\n,\nLADDER\n,\nLHARTREE\n,\nNBANDSV\n,\nNBANDSO\n,\nNBSEBLOCKV\n,\nNBSEBLOCKO\n,\nOMEGAMAX"
  }, 
  "Bethe-Salpeter-equations calculations": {
    "description": "VASP provides a module for solving the Bethe-Salpeter equation (BSE) to calculate the frequency-dependent dielectric function with excitonic effects, which can be based on ground-state electronic structures from DFT, hybrid-functional, or GW approximations, and includes options for model BSE calculations using a model dielectric function, calculations beyond the Tamm-Dancoff", 
    "detailed_description": "VASP offers a powerful module for solving the Bethe-Salpeter (BSE) equation\n[1]\n[2]\n. The BSE can be used for obtaining the frequency-dependent dielectric function with the excitonic effects and can be based on the ground-state electronic structure in the DFT, hybrid-functional or\nGW\napproximations.\nSolving Bethe-Salpeter equation\nTo take into account the excitonic effects or the electron-hole interaction, one has to use approximations beyond the independent-particle (IP) and the random-phase approximations (\nRPA\n). In VASP, it is done via the algorithm selected by\nALGO\n= BSE. These essentially solves the same equations (Casida/Bethe-Salpeter) but differ in the way the screening of the Coulomb potential is treated. The TDHF approach uses the exact-correlation kernel\nf\nx\nc\n{\\displaystyle f_{\\rm xc}}\n, whereas BSE requires the\nW\n(\nω\n→\n0\n)\n{\\displaystyle W(\\omega \\to 0)}\nfrom a preceding\nGW\ncalculation. Thus, in order to perform  TDHF or BSE calculations, one has to provide the ground-state orbitals (\nWAVECAR\n) and the derivatives of the orbitals with respect to\nk\n{\\displaystyle k}\n(\nWAVEDER\n). In addition, the BSE calculation requires files storing the screened Coulomb kernel produced in a\nGW\ncalculation, i.e.,\nWxxxx.tmp\n.\nIn summary, both TDHF and BSE approaches require a preceding ground-state calculation, however, the TDHF does not need the preceding\nGW\nand can be performed with the DFT or hybrid-functional orbitals and energies.\nBethe-Salpeter equation calculation\nThe BSE calculations require a preceding\nGW\nstep to determine the screened Coulomb kernel\nW\nG\nG\n′\n(\nq\n,\nω\n→\n0\n)\n{\\displaystyle W_{GG'}(q,\\omega \\to 0 )}\n.  The details on\nGW\ncalculations can be found in the practical guide to\nGW\ncalculations. Here, we note that during the\nGW\ncalculation, VASP writes this kernel into the following files\nW0001.tmp, W0002.tmp, ..., W{NKPTS}.tmp\nand\nWFULL0001.tmp, WFULL0002.tmp, ..., WFULL{NKPTS}.tmp.\nThe files\nWxxxx.tmp\nstore only the diagonal terms of the kernel and are fairly small, whereas the files\nWFULLxxxx.tmp\nstore the full matrix. It is important to make sure in the\nGW\nstep that the flag\nLWAVE\n= .TRUE.  is set, so that the\nWAVECAR\nstores the one-electron\nGW\nenergies and the one-electron orbitals, if the\nGW\ncalculation is self-consistent. In the low-scaling\nGW\nalgorithm use the\nNOMEGA_DUMP\ntag to produce the\nWFULLxxxx.tmp\nfiles.\nFor the self-consistent\nGW\ncalculations the following flags should be added\nLOPTICS\n= .TRUE.\nLPEAD\n= .TRUE.\nin order to update the\nWAVEDER\nusing finite differences (\nLPEAD\n= .TRUE.). The type of\nGW\ncalculation is selected with the\nALGO\ntag, which is discussed in great detail in  the practical guide to\nGW\ncalculations.\nOnce the\nGW\nstep is completed, the BSE calculation can be performed using the following setup\nSYSTEM\n= Si\nNBANDS\n= same as in GW calculation\nISMEAR\n= 0\nSIGMA\n= 0.05\nALGO\n= BSE\nNBANDSO\n= 4       ! determines how many occupied bands are used\nNBANDSV\n= 8       ! determines how many unoccupied (virtual) bands are used\nOMEGAMAX\n= desired_maximum_excitation_energy\nConsidering that quasiparticle energies in\nGW\nconverge very slowly with the number of unoccupied bands and require large\nNBANDS\n, the number of bands included in the BSE calculation should be restricted explicitly by setting the occupied and unoccupied bands (\nNBANDSO\nand\nNBANDSV\n) included in the BSE Hamiltonian.\nVASP tries to use sensible defaults, but it is highly recommended to check the\nOUTCAR\nfile and make sure that the right bands are included.  The tag\nOMEGAMAX\nspecifies the maximum excitation energy of included electron-hole pairs and the pairs with the one-electron energy difference beyond this limit are not included in the BSE Hamiltonian.  Hint: The convergence with respect to\nNBANDSV\nand\nOMEGAMAX\nshould be thoroughly checked as the real part of the dielectric function, as well as the correlation energy, is usually very sensitive to these values, whereas the imaginary part of the dielectric function converges quickly.\nAt the beginning of the BSE calculation, VASP will try to read the\nWFULLxxxx.tmp\nfiles and if these files are not found, VASP will read the\nWxxxx.tmp\nfiles. For small isotropic bulk systems, the diagonal approximation of the dielectric screening may be sufficient and yields results very similar to the calculation with the full dielectric tensor\nWFULLxxxx.tmp\n. Nevertheless, for molecules and atoms as well as surfaces, the full-screened Coulomb kernel is strictly required.\nBoth TDHF and BSE approaches write the calculated frequency-dependent dielectric function as well as the excitonic energies in the\nvasprun.xml\nfile.\nModel BSE (mBSE)\nBSE calculations can be performed using a model dielectric function\n[3]\n[4]\n. In this approach the calculation of the screened Coulomb potential is not required. Instead, the model dielectric function can be used to describe the screening of the Coulomb potential by setting the tag\nLMODELHF\nwith parameters\nAEXX\nand\nHFSCREEN\n.\nModel BSE calculation can be performed the following steps:\nground-state calculation\nGW calculation (optional in model BSE calculation)\noptical absorption calculation via model BSE\nFor example, an optical absorption calculation of bulk Si can be performed using a model dielectric function as described in Ref.\n[4]\n.\nSYSTEM\n= Si\nISMEAR\n= 0\nSIGMA\n= 0.05\nNBANDS\n= 16      ! or any larger desired value\nALGO\n= D       ! Damped algorithm often required for HF type calculations,\nALGO\n= Normal might work as well\nLHFCALC\n= .TRUE.\nLMODELHF\n= .TRUE.\nAEXX\n= 0.083\nHFSCREEN\n= 1.22\nLOPTICS\n= .TRUE.  ! can also be done in an additional intermediate step\nIn the second step, the dielectric function is evaluated by solving the Casida equation\nSYSTEM\n= Si\nISMEAR\n= 0\nSIGMA\n= 0.05\nNBANDS\n= 16\nALGO\n= TDHF\nIBSE\n= 0\nNBANDSO\n= 4       ! number of occupied bands\nNBANDSV\n= 8       ! number of unoccupied bands\nLHARTREE\n= .TRUE.\nLADDER\n= .TRUE.\nLFXC\n= .FALSE. ! local xc kernel is disabled in mBSE\nLMODELHF\n= .TRUE.\nAEXX\n= 0.083\nHFSCREEN\n= 1.22\nCalculations beyond Tamm-Dancoff approximation\nThe TDHF and BSE calculations beyond the Tamm-Dancoff approximation (TDA)\n[5]\ncan be performed by setting the\nANTIRES\n= 2 in the\nINCAR\nfile\nSYSTEM\n= Si\nNBANDS\n= same as in GW calculation\nISMEAR\n= 0\nSIGMA\n= 0.05\nALGO\n= BSE\nANTIRES\n= 2      ! beyond Tamm-Dancoff\nLORBITALREAL\n= .TRUE.\nNBANDSO\n= 4\nNBANDSV\n= 8\nThe flag\nLORBITALREAL\n= .TRUE. forces VASP to make the orbitals\nϕ\n(\nr\n)\n{\\displaystyle  \\phi({\\bf r}) }\nreal valued at the Gamma point as well as k-points at the edges of the Brillouin zone. This can improve the performance of BSE/TDHF calculations but it should be used consistently with the ground-state calculation.\nCalculations at finite wavevectors\nVASP can also calculate the dielectric function at a\nq\n{\\displaystyle {\\bf q}}\n-vector compatible with the k-point grid (finite-momentum excitons).\nSYSTEM\n= Si\nNBANDS\n= same as in GW calculation\nISMEAR\n= 0\nSIGMA\n= 0.05\nALGO\n= BSE\nANTIRES\n= 2\nKPOINT_BSE\n= 3 -1 0 0  ! q-point index,  three integers\nLORBITALREAL\n= .TRUE.\nNBANDSO\n= 4\nNBANDSV\n= 8\nThe tag\nKPOINT_BSE\nsets the\nq\n{\\displaystyle {\\bf q}}\n-point and the shift at which the dielectric function is calculated. The first integer specifies the index of the\nq\n{\\displaystyle {\\bf q}}\n-point and the other three values shift the provided\nq\n{\\displaystyle {\\bf q}}\n-point by an arbitrary reciprocal vector\nG\n{\\displaystyle  \\bf G}\n.  The reciprocal lattice vector is supplied by three integer values\nn\ni\n{\\displaystyle  n_i}\nwith\nG\n=\nn\n1\nG\n1\n+\nn\n2\nG\n2\n+\nn\n3\nG\n3\n{\\displaystyle  {\\bf G}= n_1 {\\bf G}_1+n_2 {\\bf G}_2+n_3 {\\bf G}_3}\n. This feature is only supported as of VASP 6 (in VASP 5 the feature can be enabled, but the results are erroneous).\nMind:\nIn the limit of infinitesimal momentum\nq\n{\\displaystyle \\bf q}\n,\nε\nα\nβ\n(\nq\n→\n0\n)\n{\\displaystyle \\varepsilon_{\\alpha\\beta}(q \\to 0)}\nis a\n3\n×\n3\n{\\displaystyle 3\\times 3}\ntensor, where\nα\n=\n{\nx\n,\ny\n,\nz\n}\n{\\displaystyle \\alpha=\\{x,y,z\\}}\nand\nβ\n=\n{\nx\n,\ny\n,\nz\n}\n{\\displaystyle \\beta=\\{x,y,z\\}}\n. However, at a finite momentum\nε\n(\nq\n≠\n0\n)\n{\\displaystyle \\varepsilon(\\bf q \\neq 0)}\nis a scalar, i.e., has a single component.\nConsistency tests\nIn order to verify the results obtained in the BSE calculation, one can perform a number of consistency tests.\nFirst test: IP dielectric function\nThe BSE code can be used to reproduce the independent particle spectrum if the RPA and the ladder diagrams are switched off\nLADDER\n= .FALSE.\nLHARTREE\n= .FALSE.\nThis should yield exactly the same dielectric function as the preceding calculation with\nLOPTICS\n= .TRUE.  We recommend to set the complex shift manually in the BSE as well as the preceding optics calculations, e.g.\nCSHIFT\n= 0.4.  The dielectric functions produced in these calculations should be identical.\nSecond test: RPA dielectric function\nThe RPA/\nGW\ndielectric function can be used to verify the correctness of the RPA dielectric function calculated via the BSE algorithm.  The RPA dielectric function in the BSE code can be calculated by switching off the ladder diagrams while keeping the RPA terms, i.e., the BSE calculation should be performed with the following tags\nANTIRES\n= 2\nLHARTREE\n= .TRUE.\nLADDER\n= .FALSE.\nCSHIFT\n= 0.4\nThe same dielectric function should be obtained via the\nGW\ncode by setting these flags\nALGO\n= CHI\nNOMEGA\n= 200\nCSHIFT\n= 0.4\nMake sure that a large\nCSHIFT\nis selected as the\nGW\ncode calculates the polarizability at very few frequency points. Note that the\nGW\ncode does not use the TDA, so\nANTIRES\n= 2 is required for the TDHF/BSE calculation. In our experience, the agreement can be made practically perfect provided sufficient frequency points are used and all available occupied and virtual orbitals are included in the BSE step.\nThird test: RPA correlation energy\nThe BSE code can be used to calculate the correlation energy via the plasmon equation. This correlation energy can be compared with the\nRPA contributions\nto the correlation energies for each\nq\n{\\displaystyle {\\bf q}}\n-point, which can be found in the\nOUTCAR\nfile of the ACFDT/RPA calculation performed with\nALGO\n= RPA:\nq-point correlation energy      -0.232563      0.000000\nq-point correlation energy      -0.571667      0.000000\nq-point correlation energy      -0.176976      0.000000\nFor instance, if the BSE calculation is performed at the second\nq\n{\\displaystyle {\\bf q}}\n-point\nANTIRES\n= 2\nLADDER\n= .FALSE.\nLHARTREE\n= .TRUE.\nKPOINT_BSE\n= 2 0 0 0\nthe same correlation energy should be found in the corresponding\nOUTCAR\nfile:\nplasmon correlation energy        -0.5716670828\nFor exact compatibility,\nENCUT\nand\nENCUTGW\nshould be set to the same values in all calculations, while the head and wings of the dielectric matrix should not be included in the ACFDT/RPA calculations, i.e., remove the\nWAVEDER\nfile prior to the ACFDT/RPA calculation. In the BSE/RPA calculation removing the\nWAVEDER\nfile is not required.  Furthermore,\nNBANDS\nin the ACFDT/RPA calculation must be identical to the number of included bands\nNBANDSO\nplus\nNBANDSV\nin the BSE/RPA, so that the same number of excitation pairs are included in both calculations. Also, the\nOMEGAMAX\ntag in the BSE calculation should not be set.\nCommon issues\nIf the dielectric matrix contains only zeros in the\nvasprun.xml\nfile, the\nWAVEDER\nfile was not read or is incompatible to the\nWAVEDER\nfile. This requires a recalculation of the\nWAVEDER\nfile. This can be achieved even after\nGW\ncalculations using the following intermediate step:\nALGO\n= Nothing\nLOPTICS\n= .TRUE.\nLPEAD\n= .TRUE.\nThe flag\nLPEAD\n= .TRUE. is strictly required and enforces a \"numerical\" differentiation of the orbitals with respect to\nk\n{\\displaystyle k}\n.  Calculating the derivatives of the orbitals with respect to\nk\n{\\displaystyle k}\nanalytically is not possible at this point, since the Hamiltonian that was used to determine the orbitals is unknown to VASP.\nRelated tags and articles\nALGO\n,\nLOPTICS\n,\nLPEAD\n,\nLHFCALC\n,\nLRPA\n,\nLADDER\n,\nLHARTREE\n,\nNBANDSV\n,\nNBANDSO\n,\nOMEGAMAX\n,\nLFXC\n,\nANTIRES\n,\nNBSEEIG\n,\nBSEFATBAND\nReferences\n↑\nS. Albrecht, L. Reining, R. Del Sole, and G. Onida, Phys. Rev. Lett.\n80\n, 4510-4513 (1998).\n↑\nM. Rohlfing and S. G. Louie, Phys. Rev. Lett.\n81\n, 2312-2315 (1998).\n↑\nM. Bokdam, T. Sander, A. Stroppa, S. Picozzi, D. D. Sarma, C. Franchini, and G. Kresse, Sci. Rep.\n6\n, 28618 (2016).\n↑\na\nb\nA. Tal, P. Liu, G. Kresse, A. Pasquarello,\nAccurate optical spectra through time-dependent density functional theory based on screening-dependent hybrid functionals\n, Phys. Rev. Research\n2\n, 032019 (2020)\n↑\nT. Sander, E. Maggio, and G. Kresse,\nBeyond the Tamm-Dancoff approximation for extended systems using exact diagonalization\n, Phys. Rev. B\n92\n, 045209 (2015)."
  }, 
  "Bethe-Salpeter equation for core excitations": {
    "description": "VASP provides two methods for calculating X-ray Absorption Spectra (XAS)—the supercell core-hole (SCH) method and the Bethe-Salpeter equation (BSE) approach, with BSE offering high accuracy by explicitly including electron-hole interactions and requiring a preceding GW calculation, and involves specific input files and parameters for core excitation calculations.", 
    "detailed_description": "VASP offers two approaches for calculating the X-ray Absorption Spectra (XAS). The\nsupercell core-hole (SCH)\nmethod and the Bethe-Salpeter equation (BSE). As discussed in detail on the\ntheory page\n, within the BSE approach the electron-hole interaction or the excitonic effects are explicitly included in the dielectric function. The screening of the electron-hole interaction is described in the random phase approximation (RPA) and the Green's functions are calculated in the\nGW approximation\n. This BSE+GW approach represents the state of the art for XAS spectra calculations in solids.\nMind:\nAvailable in VASP > 6.5.1.\nSolving Bethe-Salpeter equation\nThe BSE calculations for core excitaions, similarly to BSE in the optical region, require a preceding\nG\nW\n{\\displaystyle GW}\ncalculation\n. In addition to the standard VASP input files, the following files are needed to perform a BSE calculation:\nWAVECAR\nthe quasiparticle energies and orbitals produced in the preceding\nG\nW\n{\\displaystyle GW}\ncalculation\nWxxxx.tmp\nthe RPA dielectric matrix from the preceding\nG\nW\n{\\displaystyle GW}\ncalculation\nWAVEDER\n* the orbital derivatives from the\nG\nW\n{\\displaystyle GW}\nstep, only required if the valence states are included\nThe quasiparticle energies are only calculated for the valence and conduction bands set by\nNBANDSGW\n, the energies of the core states are taken from the potentials in the\nPOTCAR\nfile. Hence, the absolute values for the core excitations are not accurate, but the overall shape and the relative positions of the spectral feature can be captured with high precision within BSE\n[1]\n[2]\n.\nThe BSE calculation workflow consists of the following steps:\nDFT calculation with a large number of empty states\nG\nW\n{\\displaystyle GW}\ncalculation to obtain the quasiparticles and the RPA dielectric tensor\nBSE calculation\nBelow you will find an example of the\nINCAR\nfile required for an XAS calculation in BSE.\nNBANDS\n= 64      ! same as in GW calculation\nISMEAR\n= 0       ! Gaussian smearing\nSIGMA\n= 0.05    ! rather small to avoid fractional occupations\nALGO\n= BSE     ! BSE algorithm\nNBANDSO\n= 0       ! zero valence states\nNBANDSV\n= 16      ! number of empty bands\nICORELEVEL\n= 2       ! enables the core states calculation\nCLNT\n= 1       ! species of the excited atom\nCLN\n= 0       ! main quantum number of the excited core state\nCLL\n= 0       ! orbital quantum number of the excited core state\nMind:\nThe core states in VASP remain frozen in the configuration for which the PAW potential was generated.\nThe intensities of the core state excitations can be too small for a correct representation with the four decimal places used in the standard output, thus VASP provides a tag that can be used to scale the dielectric function and the oscillator strengths by a factor\nCH_AMPLIFICATION\n.\nAll atoms of the selected type\nCLNT\nare excited in the BSE calculation, therefore, it is recommended to treat the excited atom as a separate species in the\nPOSCAR\nfile. It is possible to excite multiple atoms in BSE, but it increases the number of core states, i.e., the size of the problem, and it should be done only if the atoms are not equivalent in the atomic configuration. The valence states are usually not included in the XAS calculations, i.e.,\nNBANDSO\n=0. Nevertheless, the valence states can be included in BSE via tag\nNBANDSO\n.\nRecommendations and advice\nGeneral advice for running BSE calculations can be found in this\narticle\n. Specific advice for using the BSE to calculate the XAS as given below.\nBSE solvers\nThe default option for solving BSE is the exact diagonalization algorithm with\nIBSE\n=2, which is the most accurate but also most time-consuming method. Approximate solvers can yield accurate spectra at a fraction of the computational time. The most efficient approach is the iterative Lanczos algorithm, which can be selected with\nIBSE\n=3. The time-evolution algorithm (\nIBSE\n=1) can be used in the XAS calculations, but it is less efficient for spectra with a wide energy range as in the case of XANES. Both approximate solvers can only be used to obtain the spectra, but cannot be used to calculated the BSE eigenvectors.\nProcessing the results\nThe calculated dielectric function and the oscillator strength information can be found in\nvasprun.xml\nand\nvaspout.h5\n.\nCore exciton wavefunction\nThe excitons can be visualized in VASP as described in this\narticle\n. In the case of XAS, the core state is strongly localized and only the hole position can be fixed by providing the coordinate of the excited atom via the\nBSEHOLE\ntag.\nBeyond Tamm-Dancoff approximation\nThe default approximation for the BSE algorithm is the Tamm-Dancoff approximation (TDA), i.e.,\nANTIRES\n=0, which usually holds for XAS. Nevertheless, the full BSE equation without TDA can be solved by setting\nANTIRES\n=2.\nModel BSE and TDDFT\nThe dielectric function for the core states can be calculated with the model BSE approach or the Casida TDDFT formalism by selecting the algorithm\nALGO\n=TDHF. However, these approximations were found inaccurate for XANES\n[1]\n.\nComparing to the SCH\nThe spectra from the SCH calculation in the initial state approximation and the BSE calculation in the independent particle approximation (IP) can be directly compared and should be identical. The initial state approximation can be selected in SCH by setting\nICORELEVEL\n=1. The independent particle approximation (IP) can be selected in BSE by disabling both the bare and screened Coulomb interaction, i.e.,\nLADDER\n=.FALSE. and\nLHARTREE\n=.FALSE..\nRelated tags and articles\nALGO\n,\nLADDER\n,\nLHARTREE\n,\nNBANDSV\n,\nNBANDSO\n,\nOMEGAMAX\n,\nANTIRES\n,\nNBSEEIG\n,\nBSEHOLE\n,\nCLNT\n,\nCLL\n,\nCLN\n,\nICORELEVEL\n,\nBSEFATBAND\nReferences\n↑\na\nb\nM. Unzog, A. Tal, G. Kresse,\nX-ray absorption using the projector augmented-wave method and the Bethe-Salpeter equation\n, Phys. Rev. B\n106\n, 155133 (2022).\n↑\nF. Karsai, M. Humer, E. Flage-Larsen, P. Blaha, and G. Kresse, Phys. Rev. B\n98\n, 235205 (2018)."
  }, 
  "Biased molecular dynamics calculations": {
    "description": "This web page explains how to set up and use bias potentials (harmonic, step function, and Gaussian) in VASP molecular dynamics simulations by defining collective variables in the ICONST file and setting corresponding parameters in the INCAR or PENALTYPOT files, with examples and注意事项 for specific simulation protocols like metadynamics and umbrella sampling.", 
    "detailed_description": "How to\nFirst one needs to setup a\nstandard molecular dynamics\nrun. The bias potentials are supported in both the\nNVT\nand\nNpT\nMD simulations, regardless of the particular\nthermostat\nand/or\nbarostat\nsetting.\nMind:\nMind that for VASP 5.x the biased molecular dynamics runs have to be chosen by adding 10 to the chosen value of\nMDALGO\n. E.g.\nMDALGO\n=12 instead of\nMDALGO\n=2 has to be chosen for Nose-Hoover thermostat.\nThen one needs to set the geometric parameters and bias potential types. The geometric parameters ξ, also called collective variables, that are controlled via the potentials are defined in the\nICONST\nfile. The type of bias potential is also set in this file. The format of this file follows this layout:\nflag item(1) ... item(N) status\nHere\nflag\nspecifies the type of geometric parameters (bond lengths, angles, etc.),\nitem(1) ... item(N)\nthe actual geometric items (atom numbers, etc.) and  the\nstatus\nsets the type of used bias potential.\nHere\nwe advise the user to also look into the description of the full capabilities of the geometric parameters.\nTo avoid the update of the bias potential\nHILLS_BIN\n=\nNSW\nis set by default.\nNext one needs to set the parameters of the potential in the\nINCAR\n(harmonic and step function) file or in the\nPENALTYPOT\nfile (Gaussian). The following table summarizes the available potentials with their corresponding parameters:\nPotential type\nstatus\nin\nICONST\nINCAR\nparameters\nHarmonic potential\n8\nSPRING_K\n,\nSPRING_R0\n, optional\nSPRING_V0\nStep function\n4\nFBIAS_A\n,\nFBIAS_D\n, and\nFBIAS_R0\nGaussian potential\n5\nparameters set in\nPENALTYPOT\nfile\nAvailable potentials\nFig.1) Graphical representation of (a) harmonic, (b) Fermi function-shaped, and (c) and Gauss function-shaped bias potentials.\nIn the following details are given on how to control the available bias potentials in VASP that are plotted in Fig.1.\nHarmonic potentials\nA sum of Harmonic potentials (curve (a) in Fig.1)\nV\n~\n(\nξ\n1\n,\n…\n,\nξ\nM\n8\n)\n=\n∑\nμ\n=\n1\nM\n1\n2\nκ\nμ\n(\nξ\nμ\n(\nq\n)\n−\nξ\n0\nμ\n)\n2\n{\\displaystyle\n\\tilde{V}(\\xi_1,\\dots,\\xi_{M_8}) = \\sum_{\\mu=1}^{M}\\frac{1}{2}\\kappa_{\\mu} (\\xi_{\\mu}(q)-\\xi_{0\\mu})^2 \\;\n}\nwhere the sum runs over all (\nM\n8\n{\\displaystyle M_8}\n) coordinates the potential acts upon. The potential is chosen in the\nICONST\nfile by setting the\nstatus\nto 8. The parameters of the potential are the force constant\nκ\nμ\n{\\displaystyle \\kappa_{\\mu}}\n(\nSPRING_K\n) and the minimum or the potential\nξ\n0\nμ\n{\\displaystyle \\xi_{0\\mu}}\nSPRING_R0\n. These must be set in the\nINCAR\nfile. Optionally, it is possible to change the value of\nξ\n0\nμ\n{\\displaystyle \\xi_{0\\mu}}\nevery MD step at a constant rate defined via the\nINCAR\ntag\nSPRING_V0\n.\nMind:\nThe number of items defined via\nSPRING_K\n,\nSPRING_R0\n, and\nSPRING_V0\nmust be equal to\nM\n8\n{\\displaystyle M_8}\n. Otherwise, the calculation terminates with an error message.\nThis form of bias potential is employed in several simulation protocols, such as the umbrella sampling\n[1]\n, umbrella integration, or steered MD, and is useful also in cases where the\nξ\nμ\n{\\displaystyle \\xi_{\\mu}}\nvalues need to be restrained.\nStep function\nA sum of Fermi-like step functions (curve (b) in Fig.1)\nV\n~\n(\nξ\n1\n,\n…\n,\nξ\nM\n4\n)\n=\n∑\nμ\n=\n1\nM\n4\nA\nμ\n1\n+\nexp\n[\n−\nD\nμ\n(\nξ\n(\nq\n)\nξ\n0\nμ\n−\n1\n)\n]\n{\\displaystyle\n\\tilde{V}(\\xi_1,\\dots,\\xi_{M_4}) = \\sum_{\\mu=1}^{M_4}\\frac{A_{\\mu}}{1+\\text{exp}\\left [-D_{\\mu}(\\frac{\\xi(q)}{\\xi_{0\\mu}} -1) \\right ]} \\;\n}\nwhere the sum runs over all (\nM\n4\n{\\displaystyle M_4}\n) coordinates the potential acts upon. The potential is chosen in the\nICONST\nfile by setting the\nstatus\nto 4. The parameters of the potential are the height of the step (\nA\nμ\n{\\displaystyle A_{\\mu}}\nset by\nFBIAS_A\n), the slope around the point\nξ\n0\nμ\n{\\displaystyle \\xi_{0\\mu}}\n(\nD\nμ\n{\\displaystyle D_{\\mu}}\nset by\nFBIAS_D\n), and the position of the step (\nξ\n0\nμ\n{\\displaystyle \\xi_{0\\mu}}\nset by\nFBIAS_R0\n). These must be set in the\nINCAR\nfile.\nMind:\nThe number of items defined via\nFBIAS_A\n,\nFBIAS_D\n, and\nFBIAS_R0\nmust be equal to\nM\n4\n{\\displaystyle M_4}\n. Otherwise, the calculation terminates with an error message.\nThis form of potential is suitable especially for imposing restrictions on the upper (or lower) limit of the value of\nξ\n{\\displaystyle \\xi}\n.\nGaussian potential\nA sum of Gauss functions (curve (b) in Fig.1)\nV\n~\n(\nξ\n1\n,\n…\n,\nξ\nM\n)\n=\n∑\nν\n=\n1\nN\n5\nh\nν\nexp\n[\n−\n∑\nμ\n=\n1\nM\n5\n(\nξ\nμ\n(\nq\n)\n−\nξ\n0\nν\n,\nμ\n)\n2\n2\nw\nν\n2\n]\n,\n{\\displaystyle\n\\tilde{V}(\\xi_1,\\dots,\\xi_{M})  = \\sum_{\\nu=1}^{N_5}h_{\\nu}\\text{exp}\\left [-\\frac{\\sum_{\\mu=1}^{M_5}(\\xi_{\\mu}(q)-\\xi_{0\\nu,\\mu})^2}{2w_{\\nu}^2}  \\right ], \\;\n}\nwhere\nN\n5\n{\\displaystyle N_5}\nis the number of Gaussian functions and\nM\n5\n{\\displaystyle M_5}\nis the number of coordinates the potential acts upon. The potential is chosen in the\nICONST\nfile by setting the\nstatus\nto 5. The parameters of the potentials,\nh\nν\n{\\displaystyle h_{\\nu}}\n,\nw\nν\n{\\displaystyle w_{\\nu}}\n, and\nξ\n0\nν\n,\nμ\n{\\displaystyle \\xi_{0\\nu,\\mu}}\nare defined in the\nPENALTYPOT\nfile.\nThis type of bias potential is primarily intended for use in metadynamics, but since Gaussians can be used as basis functions for more general shapes, they can also be used to prepare various atypically shaped bias potentials.\nOutput\nThe values of all collective variables defined in the\nICONST\nfile for each MD step are listed in the\nREPORT\nfile. Check the lines after the string\nMetadynamics\n.\nExamples of usage\nLet us consider the nucleophile substitution reaction of CH\n3\n{\\displaystyle _3}\nCl with Cl\n−\n{\\displaystyle ^-}\n. The reactant is a weak van-der-Waals complex. The corresponding\nPOSCAR\nfile reads\nvdW complex CH3Cl...Cl\n1.00000000000000\n12.0000000000000000    0.0000000000000000    0.0000000000000000\n0.0000000000000000    12.0000000000000000    0.0000000000000000\n0.0000000000000000    0.0000000000000000    12.0000000000000000\nC H Cl\n1 3 2\ncart\n5.91331371  7.11364924  5.78037960\n5.81982231  8.15982106  5.46969017\n4.92222130  6.65954232  5.88978969\n6.47810398  7.03808479  6.71586385\n4.32824726  8.75151396  7.80743202\n6.84157897  6.18713289  4.46842049\nDue to the weak interactions between CH\n3\n{\\displaystyle _3}\nCl and Cl\n−\n{\\displaystyle ^-}\n, the complex can collapse at high temperatures. This can be avoided by setting an upper bound for the length of the non-bonding Cl...C interactions.\nThis can be conveniently achieved by using a Fermi-like step-shaped bias potential. To this end, we need to define the Cl...C distance, i.e., the distance between the atoms 1 and 5, as a coordinate with status 4 in the\nICONST\nfile:\nR 1 5 4\nNext, we need to set the molecular dynamics parameters and specify the bias potential parameters\nFBIAS_A\n,\nFBIAS_D\n, and\nFBIAS_R0\nin the\nINCAR\nfile:\n# Molecular dynamics part\nIBRION\n= 0\nTEBEG\n= 300\nTEEND\n= 300\nMDALGO\n= 2\nPOTIM\n= 2.0\nNSW\n= 10000\n# Bias potential part\nFBIAS_A\n= 1\nFBIAS_D\n= 50\nFBIAS_R0\n= 3.5\nSince the bias potential acts only on one internal coordinate (\nM\n4\n=\n1\n{\\displaystyle M_4=1}\n), we need to provide only one number for each of the tags. The chosen bias potential parameters\nensure that repulsive bias forces steeply increase when the C...Cl distance is increased beyond about\n3.2\nÅ\n{\\displaystyle 3.2 \\AA}\n. This causes a shortening of the distance in the next MD step. Notice that the bias force is essentially negligible for distances below\n3\nÅ\n{\\displaystyle 3 \\AA}\n.\nA careful adjustment of\nFBIAS_A\nand\nFBIAS_D\nis needed to ensure that (i) the bias force is large enough to effectively limit the value of\nξ\n{\\displaystyle \\xi}\n, and (ii) the interval of\nξ\n{\\displaystyle \\xi}\nvalues for which the bias forces are significant is broad enough to avoid overcoming via random fluctuations.\nA suitable setting can be found by noting that the maximal bias force of\nD\nA\n4\nξ\n0\n{\\displaystyle \\frac{D\\,A}{4\\xi_0}}\nis exerted on the system at the point\nξ\n=\nξ\n0\n{\\displaystyle \\xi = \\xi_{0}}\n. This can be seen by inspecting the analytical expression for the potential.\nRelated methods in VASP\nMetadynamics\n: In contrast to the methods discussed on this page metadynamics continuously updates the bias potential of the system to push it into unvisited parts of phase space.\nInterface pinning\n: This employs a bias potential to pin the state of an interface between a solid and a liquid. This method uses entirely different\nINCAR\ntags than the bias potentials presented on this page.\nReferences\n↑\nG. M. Torrie and J. P. Valleau, J. Comp. Phys.\n23\n, 187 (1977)."
  }, 
  "Blue moon ensemble calculations": {
    "description": "This web page explains how to compute blue moon ensemble averages in constrained molecular dynamics simulations, including the output interpretation, mathematical expressions involved, and example commands for calculating free energy gradients and unbiased potential energy averages.", 
    "detailed_description": "The information needed to determine the blue moon ensemble averages within a\nConstrained molecular dynamics\ncan be obtained by setting\nLBLUEOUT\n=.TRUE., cf.\nblue moon ensemble\nfor details of the theory. The following output is written for each MD step in the file\nREPORT\n:\n>Blue_moon\nlambda        |z|^(-1/2)    GkT           |z|^(-1/2)*(lambda+GkT)\nb_m>  0.585916E+01  0.215200E+02 -0.117679E+00  0.123556E+03\nwith the four numerical terms indicating\nλ\nξ\nk\n{\\displaystyle \\lambda_{\\xi_k}}\n,\n|\nZ\n|\n−\n1\n/\n2\n{\\displaystyle |Z|^{-1/2}}\n,\n(\nk\nB\nT\n2\n|\nZ\n|\n∑\nj\n=\n1\nr\n(\nZ\n−\n1\n)\nk\nj\n∑\ni\n=\n1\n3\nN\nm\ni\n−\n1\n∇\ni\nξ\nj\n⋅\n∇\ni\n|\nZ\n|\n)\n{\\displaystyle \\left ( \\frac{k_B T}{2 |Z|} \\sum_{j=1}^{r}(Z^{-1})_{kj} \\sum_{i=1}^{3N} m_i^{-1}\\nabla_i \\xi_j \\cdot \\nabla_i |Z| \\right ) }\n, and\n(\n|\nZ\n|\n−\n1\n/\n2\n[\nλ\nk\n+\nk\nB\nT\n2\n|\nZ\n|\n∑\nj\n=\n1\nr\n(\nZ\n−\n1\n)\nk\nj\n∑\ni\n=\n1\n3\nN\nm\ni\n−\n1\n∇\ni\nξ\nj\n⋅\n∇\ni\n|\nZ\n|\n]\n)\n{\\displaystyle \\left ( |Z|^{-1/2} [\\lambda_k +\\frac{k_B T}{2 |Z|} \\sum_{j=1}^{r}(Z^{-1})_{kj} \\sum_{i=1}^{3N} m_i^{-1}\\nabla_i \\xi_j \\cdot \\nabla_i |Z|] \\right ) }\n, respectively.\nMind:\n(\n1\n2\n|\nZ\n|\n∑\nj\n=\n1\nr\n(\nZ\n−\n1\n)\nk\nj\n∑\ni\n=\n1\n3\nN\nm\ni\n−\n1\n∇\ni\nξ\nj\n⋅\n∇\ni\n|\nZ\n|\n)\n{\\displaystyle  \\left ( \\frac{1}{2 |Z|} \\sum_{j=1}^{r}(Z^{-1})_{kj} \\sum_{i=1}^{3N} m_i^{-1}\\nabla_i \\xi_j \\cdot \\nabla_i |Z| \\right ) }\nis defined as\nG\n{\\displaystyle  G }\nin the\nREPORT\nfile. This is an arbitrary character and has no relation to Green's functions, reciprocal lattice vectors, etc.\nNote that one line introduced by the string 'b_m>' is written for each constrained coordinate. With this output, the free energy gradient with respect to the fixed coordinate\nξ\nk\n{\\displaystyle {\\xi_k}}\ncan conveniently be determined (by the equation given above) as a ratio between averages of the last and the second numerical terms. In the simplest case when only one constraint is used, the free energy gradient can be obtained as follows:\ngrep b_m REPORT |awk 'BEGIN {a=0.;b=0.} {a+=$5;b+=$3} END {print a/b}'\nAs an example of a blue moon ensemble average, let us consider the calculation of an unbiased potential energy average from constrained MD. For simplicity, only a single constraint is assumed. Here we extract\n|\nZ\n|\n−\n1\n/\n2\n{\\displaystyle |Z|^{-1/2}}\nfor each step and store the data in an auxiliary file zet.dat:\ngrep b_m REPORT |awk '{print $3}' > zet.dat\nHere we extract potential energy for each step and store the data in an auxiliary file energy.dat:\ngrep e_b REPORT |awk '{print $3}' > energy.dat\nFinally, the weighted average is determined according to the first formula shown above:\npaste energy.dat zet.dat |awk 'BEGIN {a=0.;b=0.} {a+=$1*$2;b+=$2} END {print a/b}'"
  }, 
  "Born effective charges": {
    "description": "This web page explains the concept of Born effective charges in periodic systems, their mathematical definition in terms of polarization and electric field derivatives, and how they can be calculated using the VASP software through finite electric field or density functional perturbation theory methods.", 
    "detailed_description": "The change in polarization from the displacement of an atom is not uniquely defined in periodic systems, where atoms are repeated in different cells and the charge can be generalized.\n[1]\nBorn effective charges are one way of defining this dynamical charge.\nIntroduction\nThe dynamical charge is defined as the cell volume\nΩ\n, multiplied by the partial derivative of the macroscopic polarization\nP\nin the direction\ni\nwith respect to a rigid displacement of the sublattice of atoms\nκ\nin the direction\nj\n.\nHowever, the polarization is not uniquely defined in periodic systems and depends on the macroscopic electric field\nE\ni\n{\\displaystyle \\mathcal{E}_i}\nfixed by the periodic boundary conditions. The Born effective charge\nZ*\nis the partial derivative of the polarization with respect to position\nu\nfor zero macroscopic electric field.\n[2]\nAs polarization is the first derivative of the total energy with respect to the macroscopic electric field,\nZ*\nmay be rearranged in terms of the partial derivative of the force\nF\nin direction\nj\non atom\nκ\nwith respect to\nE\ni\n{\\displaystyle \\mathcal{E}_i}\n:\nZ\nκ\n,\ni\nj\n∗\n=\nΩ\ne\n∂\nP\ni\n∂\nu\nκ\n,\nj\n(\nq=0\n)\n=\n1\ne\n∂\nF\nκ\n,\nj\n∂\nE\ni\n,\ni\n,\nj\n=\nx\n,\ny\n,\nz\n{\\displaystyle\nZ_{\\kappa,ij}^*\n=\\frac{\\Omega}{e} \\frac{\\partial \\mathcal{P}_i} {\\partial u_{\\kappa,j}(\\textbf{q=0})}\n=\\frac{1}{e} \\frac{\\partial F_{\\kappa,j}}{\\partial \\mathcal{E}_i},\n\\qquad\n{i,j=x,y,z}\n}\nMind:\nThe\n*\ndoes not denote a complex conjugate,\nZ*\nis always a real quantity.\nZ*\nis given in units of\n|\ne\n|\n{\\displaystyle \\vert e \\vert}\nin VASP.\nVASP outputs\nZ\nij\n⋆\nwith\ni\nfor the macroscopic electric field, and\nj\nfor the direction of the force. In literature,\nZ\nji\n⋆\nis commonly seen, with the force direction\nj\nfollowed by the electric field direction\ni\n. Note, py4vasp follows the latter notation\nZ\nji\n⋆\nfor historic reasons.\nHow to calculate\nThere are two ways of computing Born effective charges in VASP. The first is done using\nLCALCEPS\n, where a finite electric field is applied along the three cartesian directions and the resultant forces on the atoms are calculated:\nLCALCEPS\n= .TRUE.\nThe other approach is done using\nLEPSILON\n, where the derivative of the wavefunction with respect to an electric field is calculated using density functional perturbation theory (DFPT):\nLEPSILON\n= .TRUE.\nThese may be used in combination with\nIBRION\nto obtain additional dielectric properties:\nIBRION\n= 5 or 6 ! Calculated using finite differences.\nIBRION\n= 7 or 8 ! Calculated using DFPT\nFor more details, see the pages for each tag. The Born effective charges including local field effects will be given in the\nOUTCAR\nfile:\nBORN EFFECTIVE CHARGES (including local field effects) (in |e|, cummulative output)\nExcluding local field effects\nPreviously, the local field effects have been included, that is changes in the orbitals due to the electric field induce changes in the Hartree- and exchange-correlation potentials. This may be limited to changes in the Hartree potential, by specifying:\nLRPA\n= .TRUE.\nLCALCEPS\n= .TRUE. ! N.B.\nLEPSILON\ndoes not output the final Born effective charges.\nThis prints out the Born effective charges excluding local field effects:\nBORN EFFECTIVE CHARGES (excluding local field effects) (in |e|, cummulative output)\nThese are calculated normally but remain hidden unless explicitly specified.\nRelated tags and articles\nLEPSILON\n,\nLCALCEPS\n,\nIBRION\n,\nLRPA\n,\nBerry phases and finite electric fields\nReferences\n↑\nPh. Ghosez, J.-P. Michenaud, and X. Gonze,\nDynamical atomic charges: The case of AB⁢O3 compounds\n, Phys. Rev. B\n58\n, 6224 (1998).\n↑\nX. Gonze and C. Lee,\nDynamical matrices, Born effective charges, dielectric permittivity tensors, and interatomic force constants from density-functional perturbation theory\n, Phys. Rev. B\n55\n, 10355 (1997)."
  }, 
  "Calculating the chemical shieldings": {
    "description": "This web page details the calculation of chemical shielding tensors in nuclear magnetic resonance (NMR) using the linear response method (LCHIMAG), emphasizing convergence criteria, input parameters, and practical considerations for accurate results in both insulating and metallic systems.", 
    "detailed_description": "The chemical shielding tensor\nσ\nis the relation between the induced and external magnetic fields and describes how much the electrons shield the nuclei from an external field. The absolute chemical shielding is calculated by linear response using\nLCHIMAG\n[1]\n[2]\n. The chemical shielding is directly related to the chemical shift\nδ\nrecorded in nuclear magnetic resonance (NMR), cf.\nNMR category page\nand\nLCHIMAG\npage for details, and, indirectly, to the resonance frequency. The theory is covered in the\nNMR category page\nand\nLCHIMAG\npage.\nWarning:\nThe chemical shifts are calculated from the orbital magnetic response under the assumption that the system is an insulator. Smearing schemes intended for metals can generate nonsense.\nStep-by-step instructions\nThe chemical shielding is calculated post-self-consistent field (post-SCF) using\nLCHIMAG\n. A well-converged SCF calculation is therefore crucial. The chemical shielding is very sensitive to several input parameters that must all be independently tested.\nStep 1 (optional):\nCalculate the chemical shielding using a previously converged calculation\nSince the chemical shielding is calculated post-SCF, you can use a previously converged\nWAVECAR\nwith\nISTART\n= 1 and\nNELM\n= 1. The corresponding density,\nCHGCAR\nis calculated from the\nWAVECAR\nfile before the first elementary step so it need not be included.\nStep 2 (optional):\nDetermine a suitable energetic break value\nThe break condition for the self-consistency step\nEDIFF\nstrongly influences the chemical shielding. A setting of\nEDIFF\n= 1E-8 eV is generally recommended. Convergence is taken to be within 0.1 ppm.\nStep 3:\nConverge the plane-wave basis\nA large plane-wave energy cutoff is required to fully converge the chemical shieldings. Perform multiple calculations while increasing the basis set size, as defined in\nENCUT\n, incrementally (e.g., by 100 eV intervals). Convergence should be aimed to be within 0.1 ppm, although this will not be feasible for heavier elements.\nStep 4:\nConverge the\nk\npoint mesh\nSimilar to the basis, the\nk\npoint mesh can strongly influence the chemical shielding. The\nk\npoint mesh should be increased incrementally, i.e., 1x1x1, 2x2x2, 3x3x3, until convergence within 0.1 ppm is achieved. It is only necessary to converge the\nk\npoint mesh for crystals, gas-phase molecules should use the Γ-point only.\nStep 5:\nCompare to experiment\nThe purpose of these calculations is to compare to experiment. However, the calculated absolute chemical shieldings are not directly comparable to the measured chemical shift due to the lack of a reference. To avoid bias from any single calculation, a series of calculated and their corresponding experimental values are used. The experimental chemical shifts are plotted against the calculated chemical shieldings as is found in Fig. 3 of Ref.\n[3]\n.\nRecommendations and advice\nCalculating the chemical shielding requires tightly converged settings. As described in the step-wise introduction above, converging with respect to\nEDIFF\n,\nENCUT\n, and the\nk\npoint mesh is very important. There are a few additional settings that should be considered.\nPAW pseudopotentials\nThe standard PAW pseudopotentials\nPOTCAR\nused are sufficient for calculating the chemical shielding. The GIPAW is applied using the projector functions and partial waves that are stored in the regular\nPOTCAR\nfiles. The completeness of these projector functions and partial waves determines the quality of the results. Using slightly different types of\nPOTCAR\n, e.g., GW (\n*_GW\n) or with additional valence (\n*_sv\n,\n*_pv\n), can change the calculated shielding by a few ppm for the first and second row\nsp\n-bonded elements (except for H).\nThe PAW reconstruction with all-electron partial waves is crucial for calculating the field on the nucleus. It is therefore important to use a consistent exchange-correlation functional and so\nLEXCH\nin the\nPOTCAR\nshould not be overwritten with an explicit\nGGA\ntag in the\nINCAR\nif possible.\nInsufficient memory\nFor calculating the chemical shieldings, speed had been favored over saving memory, resulting in insufficient memory occasionally. Since the linear response calculation is parallel over\nk\npoints, this can be used to economize on memory by performing a regular SCF calculation at high accuracy on the full\nk\npoint mesh and saving the\nCHGCAR\nfile. Using\nICHARG\n= 11\nstart a chemical shielding calculation for each individual\nk\npoint in the first Brillouin zone (IBZ) separately, starting from\nCHGCAR\n. The shieldings can then be calculated as a\nk\npoint weighted average of the symmetrized shieldings of the individual\nk\npoints.\nAdditional tags\nTo ensure tight precision, the precision should be set to\nPREC\n= Accurate\n, rather than\nNormal\n.\nSeveral additional\nINCAR\ntags should be considered. Specifically,\nLASPH\nshould be set to\n.TRUE.\n, turning on the non-spherical contributions to the gradient of the density inside the PAW spheres. Occasionally, e.g. for systems containing H or first-row elements, and short bonds, the two-center contributions to the augmentation currents in the PAW spheres are important. In this case,\nLLRAUG\n= .TRUE. should be used\n[4]\n[5]\n.\nCalculating the chemical shift can also be sped up by utilizing parallelisation. If you are using multiple k-points, then you can treat these in parallel using\nKPAR\n, reducing the overall calculation time.\nImportant:\nThe treatment of the orbital magnetism is non-relativistic. This is suitable for light nuclei.\nThe standard POTCARs are scalar-relativistic and account partially for relativistic effects.\nThe accuracy can be improved using\nLBONE\n, which restores the small B-component of the wave function inside the PAW spheres.\nSpin-orbit coupling is not implemented for chemical shift calculations.\nExample scripts for convergence tests\nSeveral tests are necessary to obtain various NMR parameters. Make sure to change the example\nINCAR\nfiles to include the tags for your desired calculation. We provide some example scripts below:\nEnergetic break criterion tests\nFor converging the energetic break criterion for a single ionic step (\nEDIFF\n), start with the 1E-4 and then increase by orders of magnitude:\nEnergetic break criterion:\nINCAR.nmr\nPREC\n= Accurate\nENCUT\n= 400.0\nEDIFF\n= 1E-4\nISMEAR\n= 0;\nSIGMA\n= 0.1\nLREAL\n= A\nLCHIMAG\n= .TRUE.\nDQ\n= 0.001\nICHIBARE\n= 1\nLNMR_SYM_RED\n= .TRUE.\nNLSPLINE\n= .TRUE.\nScript to loop through\nEDIFF\nfrom 1E-4 eV to 1E-8 eV:\nfor a in 4 5 6 7 8\ndo\ncp INCAR.nmr INCAR\nsed -i \"s/1E-4/1E-$a/g\" INCAR\nmpirun -np 4 $PATH_TO_EXECUTABLE/vasp_std\ncp OUTCAR OUTCAR.$a\ndone\nk\n-points tests\nFor converging\nk\npoints, start with the Γ-point and increase the\nk\n-point mesh incrementally:\nInitial Γ-only mesh:\nKPOINTS.nmr\nC\n0\nG\n1 1 1\n0 0 0\nScript to go through\nk\n-point meshes from Γ-only to 8x8x8:\nfor a in 1 2 4 6 8\ndo\ncp KPOINTS.nmr KPOINTS\nsed -i \"s/1 1 1/$a $a $a/g\" KPOINTS\nmpirun -np 4 $PATH_TO_EXECUTABLE/vasp_std\ncp OUTCAR OUTCAR.$a\ndone\nEnergy cutoff tests\nFor converging the energy cutoff, start with the value of ENMAX given in the\nPOTCAR\nfile and then increase incrementally in steps of 100 eV:\nInitial\nINCAR\n:\nINCAR.nmr\nPREC\n= Accurate\nENCUT\n= 400.0\nEDIFF\n= 1E-8\nISMEAR\n= 0;\nSIGMA\n= 0.1\nLREAL\n= A\nLCHIMAG\n= .TRUE.\nDQ\n= 0.001\nICHIBARE\n= 1\nLNMR_SYM_RED\n= .TRUE.\nNLSPLINE\n= .TRUE.\nScript to loop through\nENCUT\nfrom 400 eV to 800 eV:\nfor a in 400 500 600 700 800\ndo\ncp INCAR.nmr INCAR\nsed -i \"s/400/$a/g\" INCAR\nmpirun -np 4 $PATH_TO_EXECUTABLE/vasp_std\ncp OUTCAR OUTCAR.$a\ndone\nReferences\n↑\nC. J. Pickard and F. Mauri,\nAll-electron magnetic response with pseudopotentials: NMR chemical shifts\n, Phys. Rev. B\n63\n, 245101 (2001).\n↑\nJ. R. Yates, C. J. Pickard, and F. Mauri,\nCalculation of NMR chemical shifts for extended systems using ultrasoft pseudopotentials\n, Phys. Rev. B\n76\n, 024401 (2007).\n↑\nG. A. de Wijs, R. Laskowski, P. Blaha, R. W. A. Havenith, G. Kresse, and M. Marsman,\nNMR shieldings from density functional perturbation theory: GIPAW versus all-electron calculations\n, J. Chem. Phys.\n146\n, 064115 (2017).\n↑\nF. Vasconcelos, G.A. de Wijs, R. W. A. Havenith, M. Marsman, and G. Kresse,\nFinite-field implementation of NMR chemical shieldings for molecules: Direct and converse gauge-including projector-augmented-wave methods\n, J. Chem. Phys.\n139\n, 014109 (2013).\n↑\nG.A. de Wijs, G. Kresse, R. W. A. Havenith, and M. Marsman,\nComparing GIPAW with numerically exact chemical shieldings: The role of two-center contributions to the induced current\n, J. Chem. Phys.\n155\n, 234101 (2021)."
  }, 
  "Calculating the electric field gradient": {
    "description": "This web page explains how to calculate and interpret electric field gradients (EFGs) and quadrupole coupling constants (Cq) for quadrupolar nuclei using computational methods like DFT, with a focus on convergence criteria, structural sensitivity, and comparison to experimental data from techniques such as NMR, NQR, and Mössbauer spectroscopy.", 
    "detailed_description": "Nuclei with a spin > ± ½ are called quadrupolar nuclei. They have a non-spherical shape and therefore a non-zero electric field gradient (EFG) at the nucleus. The EFG is calculated using\nLEFG\n[1]\n. By including the quadrupole moment of the isotopes, the quadrupole coupling constants\nC\nq\ncan be calculated (multiple definitions exist in the literature, ensure that you are correctly comparing). These are measured using nuclear quadrupole resonance (NQR) spectroscopy, a type of zero- to ultralow-field (ZULF) NMR, NMR, and Mössbauer spectroscopy. The theory is covered in the\nNMR category page\nand\nLEFG\npage.\nStep-by-step instructions\nThe electric field gradient is calculated post-self-consistent field (post-SCF) using\nLEFG\n. A well-converged SCF calculation is therefore crucial. The electric field gradient is very sensitive to several input parameters that must all be independently tested. In particular, small differences in the structure can make big differences to\nV\nz\nz\n{\\displaystyle V_{zz}}\n, up to 50 %\n[1]\n; see the Advice section for more details. Make sure to have a well-optimized structure before you begin the convergence tests.\nStep 1 (optional):\nCalculate the chemical shielding using a previously converged calculation\nSince the chemical shielding is calculated post-SCF, you can use a previously converged\nWAVECAR\nwith\nISTART\n= 1 and\nNELM\n= 1. The corresponding density,\nCHGCAR\nis calculated from the\nWAVECAR\nfile before the first elementary step so it need not be included.\nStep 2a:\nDefine the nuclear quadrupolar moments\nThe calculated electric field gradients are not observable in experiment. Instead, the quadrupolar coupling constant can be calculated so long as the nuclear quadrupolar moments are defined in\nQUAD_EFG\n. Each species in your\nPOSCAR\nfile should be defined; there is no need to define each individual ion. A short table of values can be found in Ref.\n[2]\n.\nStep 2b (optional):\nDetermine a suitable energetic break value\nThe break condition for the self-consistency step\nEDIFF\nstrongly influences the chemical shielding. A setting of\nEDIFF\n= 1E-8 eV is generally recommended. Convergence is taken to be within 0.1 ppm.\nStep 3:\nConverge the plane-wave energy cutoff\nA large plane-wave energy cutoff is required to fully converge the electric field gradient. Perform multiple calculations while increasing the basis set size, as defined in\nENCUT\n, incrementally (e.g., by 100 eV intervals). Convergence should be aimed to be within 3 significant figures, although this will not be feasible for heavier elements.\nStep 4:\nConverge the\nk\npoint mesh\nSimilar to the basis, the\nk\npoint mesh can strongly influence the coupling constant. The\nk\npoint mesh should be increased incrementally, i.e., 1x1x1, 2x2x2, 3x3x3, until convergence within 3 significant figures is achieved. It is only necessary to converge the\nk\npoint mesh for crystals, gas-phase molecules should use the Γ-point only.\nStep 5:\nCompare to experiment\nThe purpose of these calculations is to compare directly to experiment. The EFG that has been calculated is not directly measurable but the quadrupolar coupling constants\nC\nq\nare.\nRecommendations and advice\nCalculating the electric field gradient requires tightly converged settings. As described in the step-wise introduction above, converging with respect to\nEDIFF\n,\nENCUT\n, and the\nk\npoint mesh is very important. There are a few additional settings that should be considered.\nMind:\nBe aware of some specifics relevant to the implementation used:\nSeveral definitions of\nC\nq\n{\\displaystyle C_q}\nare used in the NMR community, ensure that you are comparing between the same definitions in calculation and experiment.\nFor heavy nuclei inaccuracies are to be expected due to an incomplete treatment of relativistic effects.\nStructure\nThe electric field gradient can be\nextremely\ndependent on structure, to the extent that using the experimental structure can improve results. A small difference in the positions of atoms can make a huge difference to the EFG. For the O in TiO\n2\nrutile, a shift in position from 0.305 in internal coordinates to 0.3025 made a difference of 50 % to\nV\nz\nz\n{\\displaystyle V_{zz}}\nfor the Ti\n[1]\n. This is an atypical case but highlights the importance of using a\nwell-optimized structure\n, ideally the experimental structure if available. This extreme sensitivity to the structure is indicative of why the quadrupolar coupling constant is so useful for determining information about a system's chemical environment.\nPAW pseudopotentials\nThe standard\nPAW pseudopotentials\nPOTCAR\nused are sufficient for calculating the electric field gradient. Using\nGW pseudopotentials\ncan significantly improve results. Semi-core electrons can be important, so\nPOTCAR\nfiles with\n*_pv\nor\n*_sv\ncan improve the results, as will the explicit inclusion of augmentation channels with\nd\n{\\displaystyle d}\n-projectors.\nAdditional tags\nTo ensure tight precision, the precision should be set to\nPREC\n= Accurate\n, rather than\nNormal\n.\nThe\nLASPH\nshould be set to\n.TRUE.\n, turning on the non-spherical contributions to the gradient of the density inside the PAW spheres.\nExample scripts for convergence tests\nSeveral tests are necessary to obtain various NMR parameters. Make sure to change the example\nINCAR\nfiles to include the tags for your desired calculation. We provide some example scripts below:\nImportant:\nMake sure to replace the\nQUAD_EFG\nin the\nINCAR\nwith the values for the isotopes in your system.\nEnergetic break criterion tests\nFor converging the energetic break criterion for a single ionic step (\nEDIFF\n), start with the 1E-4 and then increase by orders of magnitude:\nEnergetic break criterion:\nINCAR.nmr\nENCUT\n= 400\nISMEAR\n= 0;\nSIGMA\n= 0.01\nEDIFF\n= 1E-4\nPREC\n= Accurate\nLASPH\n= .TRUE.\nLEFG\n= .TRUE.\nQUAD_EFG\n= 0. -696. 20.44 0. 2.860  # Nuclear quadrupolar moments for Pb I N O D\nScript to loop through\nEDIFF\nfrom 1E-4 eV to 1E-8 eV:\nfor a in 4 5 6 7 8\ndo\ncp INCAR.nmr INCAR\nsed -i \"s/1E-4/1E-$a/g\" INCAR\nmpirun -np 4 $PATH_TO_EXECUTABLE/vasp_std\ncp OUTCAR OUTCAR.$a\ndone\nk\n-points tests\nFor converging\nk\npoints, start with the Γ-point and increase the\nk\n-point mesh incrementally:\nInitial Γ-only mesh:\nKPOINTS.nmr\nC\n0\nG\n1 1 1\n0 0 0\nScript to go through\nk\n-point meshes from Γ-only to 8x8x8:\nfor a in 1 2 4 6 8\ndo\ncp KPOINTS.nmr KPOINTS\nsed -i \"s/1 1 1/$a $a $a/g\" KPOINTS\nmpirun -np 4 $PATH_TO_EXECUTABLE/vasp_std\ncp OUTCAR OUTCAR.$a\ndone\nEnergy cutoff tests\nFor converging the energy cutoff, start from at least the value of ENMAX given in the\nPOTCAR\nfile and then increase incrementally in steps of 100 eV:\nInitial\nINCAR\n:\nINCAR.nmr\nENCUT\n= 400\nISMEAR\n= 0;\nSIGMA\n= 0.01\nEDIFF\n= 1E-8\nPREC\n= Accurate\nLASPH\n= .TRUE.\nLEFG\n= .TRUE.\nQUAD_EFG\n= 0. -696. 20.44 0. 2.860  # Nuclear quadrupolar moments for Pb I N O D\nScript to loop through\nENCUT\nfrom 400 eV to 800 eV:\nfor a in 400 500 600 700 800\ndo\ncp INCAR.nmr INCAR\nsed -i \"s/400/$a/g\" INCAR\nmpirun -np 4 $PATH_TO_EXECUTABLE/vasp_std\ncp OUTCAR OUTCAR.$a\ndone\nRelated tags and articles\nLEFG\n,\nQUAD_EFG\nReferences\n↑\na\nb\nc\nH. M. Petrilli, P. E. Blöchl, P. Blaha, and K. Schwarz,\nElectric-field-gradient calculations using the projector augmented wave method\n, Phys. Rev. B\n57\n, 14690 (1998).\n↑\nP. Pyykkö,\nYear-2017 nuclear quadrupole moments\n, Mol. Phys.\n116\n, 1328-1338 (2018)."
  }, 
  "Calculating the hyperfine-coupling constant": {
    "description": "This web page provides detailed instructions for calculating hyperfine coupling constants using post-self-consistent field methods, emphasizing convergence criteria, input parameters, and the influence of structural and computational settings on accuracy.", 
    "detailed_description": "The hyperfine coupling constant (cf. hyperfine splitting) describes the interaction between the nuclear magnetic dipole moment and the magnetic field generated by the electrons (i.e., the nuclear spin-electron spin coupling). The hyperfine coupling constant is calculated using\nLHYPERFINE\n[1]\n. The hyperfine splitting often includes the interaction between the nuclear quadrupole moment and the electric field gradient (EFG), which is calculated separately using\nLEFG\nand the description in\nperforming an EFG calculation\n. The hyperfine splitting can be measured using electron paramagnetic resonance (EPR), also called electron-spin resonance (ESR), and in atomic spectroscopy. The theory is covered in the\nNMR category page\nand\nLHYPERFINE\npage.\nStep-by-step instructions\nThe hyperfine constant is calculated post-self-consistent field (post-SCF) using\nLHYPERFINE\n. A well-converged SCF calculation is therefore crucial. The hyperfine coupling constant is sensitive to several input parameters that must all be tested.\nStep 1 (optional):\nCalculate the hyperfine constant using a previously converged calculation\nSince the hyperfine constant is calculated post-SCF, you can use a previously converged\nWAVECAR\nwith\nISTART\n= 1 and\nNELM\n= 1. The corresponding density,\nCHGCAR\nis calculated from the\nWAVECAR\nfile before the first elementary step so need not be provided.\nStep 2a:\nDefine the nuclear gyromagnetic ratios\nThe hyperfine coupling constant depends on the nuclear gyromagnetic ratios defined in\nNGYROMAG\n. Since the defaults are set to 1, the gyromagnetic ratios must be defined to obtain meaningful coupling constants. Each species in your\nPOSCAR\nfile should be defined; there is no need to define each individual ion. A short table of values can be found in Ref.\n[2]\n. For a more complete list, see the\nNGYROMAG\ntag documentation.\nStep 2b (optional):\nDetermine a suitable energetic break value\nThe break condition for the self-consistency step\nEDIFF\ndoes not strongly influence the coupling parameter for our test systems. However, it is important to confirm this for your system before performing more expensive convergence tests.\nThe hyperfine coupling constant depends on the nuclear gyromagnetic ratios defined in\nNGYROMAG\n. Since the defaults are set to 1, the gyromagnetic ratios must be defined to obtain meaningful coupling constants. Each species in your\nPOSCAR\nfile should be defined; there is no need to define each individual ion.\nUse the converged energetic break condition for all subsequent convergence tests.\nStep 3:\nConverge the plane-wave basis\nThe plane-wave basis can strongly influence the coupling constant. Unconverged values should not be compared to experiment. Perform multiple calculations while increasing the basis set size, as defined in\nENCUT\n, incrementally (e.g., by 100 eV intervals). Convergence should be aimed to be within 0.1 MHz, although this will not be feasible for heavier elements.\nUse the converged plane-wave energy cut-off for all subsequent convergence tests.\nStep 4:\nConverge the\nk\npoint mesh\nSimilar to the basis, the\nk\npoint mesh can strongly influence the coupling constant. The\nk\npoint mesh should be increased incrementally, i.e., 1x1x1, 2x2x2, 3x3x3, until convergence to within 0.1 MHz is achieved.\nUse the converged\nk-\n-point mesh for all subsequent calculations.\nStep 5:\nCompare to experiment\nThe purpose of these calculations is to compare to experiment. An example is given in Ref.\n[1]\n. It is important to include core contributions\n[3]\n, as these can account for a significant portion of the Fermi contact term. The total coupling parameter can be compared to EPR.\nStep 6 (optional):\nPerform hybrid calculations\nIn the literature, HSE06 has been shown to better localize defect states, which improves comparison to experiment relative to PBE\n[1]\n. Consider performing a hybrid calculation, if it is affordable. You will need to repeat the convergence tests described in Steps 2-4.\nMind:\nSignificant time savings can be achieved for hybrid functionals by starting from a\nWAVECAR\nfrom a GGA calculation.\nRecommendations and advice\nThe hyperfine coupling constant requires tightly converged settings. The energetic break condition\nEDIFF\nand the plane-wave energy cutoff\nENCUT\nimpact the convergence of the hyperfine coupling constant. For solid-state systems, the choice of k-point mesh\nKPOINTS\nused can also be very important. Besides these input settings, the hyperfine coupling constant is influenced by several other factors, specifically structure,\nPOTCAR\n, and method.\nStructure\nThe structure defined in\nPOSCAR\nwill impact the hyperfine constant in two ways. The first and most important is that cells that are too small may converge to non-magnetic systems. For example, the NV-diamond defect cannot be properly described by a 15-atom supercell (based on a 2x2x2 cell from primitive diamond). As you increase the\nk\n-point mesh, the magnetization disappears due to coupling between neighboring defect sites (i.e., increasing the k-point mesh causes the coupling to disappear (all zeros)). Be careful to use a large enough cell for your calculation, otherwise even converged settings will produce meaningless outputs. Sometimes, a non-magnetic solution is incorrectly found. If you are certain that it should be\nmagnetic\n, then you can force this by using\nNUPDOWN\nto fix the number of unpaired electrons in your system during the calculation. Ensure that the energy of the magnetic state is lower than the non-magnetic state.\nA second structural problem will come from the precise\nPOSCAR\nthat you use. Slightly different lattice parameters (10 mÅ) can change the hyperfine coupling constant by ~0.5 MHz. Make sure to use a\nwell-optimized structure\n.\nHybrid functionals\nThe calculated hyperfine coupling parameter is strongly influenced by the chosen method. PBE tends to underestimate the coupling constant relative to experiment. HSE06 and other\nhybrid functionals\nimprove this, matching well with experiment\n[1]\n. Hybrid functional localize defect states, resulting in an improved description over GGA functionals. The\nINCAR\ntags are specified\nin hybrid functionals\nand no additional tags are required. We found that the improvement for hybrid functionals is seen for both range-separated and unscreened hybrid functionals.\nPAW pseudopotential\nThe choice of\nPAW pseudopotential\ncan be important.\nGW pseudopotentials\n(i.e.\n*_GW\n) make a difference of a few ppm to the chemical shielding.\nIt is expected that using GW pseudopotentials will improve the description of the hyperfine coupling parameter for heavier elements, though it has not been tested. Additionally, for heavier elements, it is expected that using additional valence electrons (i.e.,\n*_sv\n,\n*_pv\n) will improve calculating the hyperfine coupling constant.\nAdditional tags\nThere are a few additional\nINCAR\ntags that should be used to ensure tight convergence, specifically, the precision should be set to\nPREC\n= Accurate\n, rather than\nNormal\n. We also recommend\nEDIFF\nto a minimum of\n1E-6\neV to ensure well-converged\nWAVECAR\n.\nLASPH\n= .TRUE. includes the non-spherical contributions to the gradient of the density in PAW spheres. For symmetric systems, the difference is small, a few ppm. For asymmetric systems, the difference is much larger, on the order of 10 ppm. Therefore, the non-spherical contributions must be included. However, using\nLASPH\n= .TRUE. decreases the calculated hyperfine coupling constant, weakening agreement with experiment, including in the literature where it was not previously used\n[1]\n.\nExample scripts for convergence tests\nSeveral tests are necessary to obtain converged coupling parameters. We provide some example scripts below:\nImportant:\nChange the values of\nNGYROMAG\nto your corresponding system.\nEnergetic break criterion tests\nFor converging the energetic break criterion for a single ionic step (\nEDIFF\n), start with the 1E-4 and then increase by orders of magnitude:\nEnergetic break criterion:\nINCAR.hyperfine\nPREC\n= Accurate\nENCUT\n= 400\nEDIFF\n= 1E-6\nISMEAR\n= 0; SIGMA = 0.01\nLHYPERFINE\n= .TRUE.\nNGYROMAG\n= 10.7084 3.077\nLASPH\n= .TRUE.\nISPIN\n= 2\nScript to loop through\nEDIFF\nfrom 1E-4 eV to 1E-8 eV:\nrm -f hyperfine.dat\nfor a in 4 5 6 7 8\ndo\ncp INCAR.hyperfine INCAR\nsed -i \"s/1E-4/1E-$a/g\" INCAR\nmpirun -np 4 $PATH_TO_EXECUTABLE/vasp_std\ncp OUTCAR OUTCAR.$a\ndone\nk\n-points tests\nFor converging\nk\npoints, start with the Γ-point and increase the\nk\n-point mesh incrementally:\nInitial Γ-only mesh:\nKPOINTS.hyperfine\nC\n0\nG\n1 1 1\n0 0 0\nScript to go through\nk\n-point meshes from Γ-only to 8x8x8:\nrm -f hyperfine.dat\nfor a in 1 2 4 6 8\ndo\ncp KPOINTS.hyperfine KPOINTS\nsed -i \"s/1 1 1/$a $a $a/g\" KPOINTS\nmpirun -np 4 $PATH_TO_EXECUTABLE/vasp_std\ncp OUTCAR OUTCAR.$a\ndone\nEnergy cutoff tests\nFor converging the energy cutoff, start from at least the value of ENMAX given in the\nPOTCAR\nfile and then increase incrementally in steps of 100 eV:\nInitial\nINCAR\n:\nINCAR.hyperfine\nPREC\n= Accurate\nENCUT\n= 400\nEDIFF\n= 1E-6\nISMEAR\n= 0; SIGMA = 0.01\nLHYPERFINE\n= .TRUE.\nNGYROMAG\n= 10.7084 3.077\nLASPH\n= .TRUE.\nISPIN\n= 2\nScript to loop through\nENCUT\nfrom 400 eV to 600 eV:\nrm -f hyperfine.dat\nfor a in 400 500 600\ndo\ncp INCAR.hyperfine INCAR\nsed -i \"s/400/$a/g\" INCAR\nmpirun -np 4 $PATH_TO_EXECUTABLE/vasp_std\ncp OUTCAR OUTCAR.$a\ndone\nRelated tags and articles\nLHYPERFINE\n,\nNGYROMAG\nReferences\n↑\na\nb\nc\nd\ne\nK. Szasz, T. Hornos, M. Marsman, and A. Gali,\nHyperfine coupling of point defects in semiconductors by hybrid density functional calculations: The role of core spin polarization\n, Phys. Rev. B,\n88\n, 075202 (2013).\n↑\nGyromagnetic ratio, www.wikipedia.org (2025)\n↑\nO. V. Yazyev, I. Tavernelli, L. Helm, and U. R. Roethlisberger,\nCore spin-polarization correction in pseudopotential-based electronic structure calculations\n, Phys. Rev. B\n71\n, 115110 (2006)."
  }, 
  "Calculating the magnetic susceptibility": {
    "description": "This web page explains how to calculate the magnetic susceptibility of materials using the VASP software, detailing the necessary convergence tests, input parameters, and post-processing steps for accurate results.", 
    "detailed_description": "The\nmagnetic susceptibility\nχ\n{\\displaystyle \\chi}\nis the degree of magnetization of a material in response to an applied magnetic field. It is a bulk property, in contrast to the chemical shielding, which is for each nucleus. Like the chemical shielding, the magnetic susceptibility is calculated by linear response using\nLCHIMAG\n[1]\n[2]\n, so they will both be shown in the same\nOUTCAR\nfile. The magnetic susceptibility is measured using the Guoy balance (or method); alternatively, an Evans or Faraday balance can be used. The theory is covered in the\nNMR category page\nand\nLCHIMAG\npage.\nStep-by-step instructions\nThe magnetic susceptibility is calculated post-self-consistent field (post-SCF) using\nLCHIMAG\n. A well-converged SCF calculation is therefore crucial. The magnetic susceptibility can be sensitive to several input parameters that must all be independently tested.\nStep 1 (optional):\nCalculate the magnetic susceptibility using a previously converged calculation\nSince the magnetic susceptibility is calculated post-SCF, you can use a previously converged\nWAVECAR\nwith\nISTART\n= 1 and\nNELM\n= 1. The corresponding density,\nCHGCAR\nis calculated from the\nWAVECAR\nfile before the first elementary step so it need not be included.\nStep 2 (optional):\nDetermine a suitable energetic break value\nThe break condition for the self-consistency step\nEDIFF\nstrongly influences the magnetic susceptibility. A setting of\nEDIFF\n=\n1E-8\neV is generally recommended. Convergence is taken to be within 0.01 (dimensionless units).\nStep 3:\nConverge the plane-wave basis\nA larger than standard plane-wave energy cutoff is required to fully converge the magnetic susceptibility. Perform multiple calculations while increasing the basis set size, as defined in\nENCUT\n, incrementally (e.g., by 100 eV intervals). Convergence should be aimed to be within 0.01 (dimensionless units). The magnetic susceptibility is less dependent on the energy cutoff than the chemical shielding is.\nStep 4:\nConverge the\nk\npoint mesh\nSimilar to the basis, the\nk\npoint mesh can strongly influence the magnetic susceptibility. The\nk\npoint mesh should be increased incrementally, i.e., 1x1x1, 2x2x2, 3x3x3, until convergence within 0.01 (dimensionless units) is achieved. It is slightly more dependent on\nk\npoint mesh than the chemical shieldings are.\nStep 5:\nCompare to experiment\nThe purpose of these calculations is to compare to the experiment. The computed magnetic susceptibilities can be directly compared to the measured magnetic susceptibility, in contrast to the chemical shielding\n[3]\n.\nRecommendations and advice\nCalculating the magnetic susceptibilities requires tightly converged settings. As described in the step-wise introduction above, converging with respect to\nEDIFF\n,\nENCUT\n, and the\nk\npoint mesh is very important. There are a few additional settings that should be considered. Since the same tag is used, much of the advice for chemical shieldings is applicable for the magnetic susceptibility.\nPAW pseudopotentials\nThe standard\nPAW pseudopotentials\nPOTCAR\nused are sufficient for calculating the magnetic susceptibility. Small differences on the order of 0.1 (dimensionless units) are seen when using slightly different types of\nPOTCAR\n, e.g., GW (\n*_GW\n).\nAdditional tags\nTo ensure tight precision, the precision should be set to\nPREC\n= Accurate\n, rather than\nNormal\n. There is one additional tag,\nICHIBARE\nthat can be used, though the default is usually sufficient and increases the computational load significantly.\nExample scripts for convergence tests\nSeveral tests are necessary to obtain various NMR parameters. Make sure to change the example\nINCAR\nfiles to include the tags for your desired calculation. We provide some example scripts below:\nEnergetic break criterion tests\nFor converging the energetic break criterion for a single ionic step (\nEDIFF\n), start with the 1E-4 and then increase by orders of magnitude:\nEnergetic break criterion:\nINCAR.nmr\nPREC\n= Accurate\nENCUT\n= 400.0\nEDIFF\n= 1E-4\nISMEAR\n= 0;\nSIGMA\n= 0.1\nLREAL\n= A\nLCHIMAG\n= .TRUE.\nDQ\n= 0.001\nICHIBARE\n= 1\nLNMR_SYM_RED\n= .TRUE.\nNLSPLINE\n= .TRUE.\nScript to loop through\nEDIFF\nfrom 1E-4 eV to 1E-8 eV:\nfor a in 4 5 6 7 8\ndo\ncp INCAR.nmr INCAR\nsed -i \"s/1E-4/1E-$a/g\" INCAR\nmpirun -np 4 $PATH_TO_EXECUTABLE/vasp_std\ncp OUTCAR OUTCAR.$a\ndone\nk\n-points tests\nFor converging\nk\npoints, start with the Γ-point and increase the\nk\n-point mesh incrementally:\nInitial Γ-only mesh:\nKPOINTS.nmr\nC\n0\nG\n1 1 1\n0 0 0\nScript to go through\nk\n-point meshes from Γ-only to 8x8x8:\nfor a in 1 2 4 6 8\ndo\ncp KPOINTS.nmr KPOINTS\nsed -i \"s/1 1 1/$a $a $a/g\" KPOINTS\nmpirun -np 4 $PATH_TO_EXECUTABLE/vasp_std\ncp OUTCAR OUTCAR.$a\ndone\nEnergy cutoff tests\nFor converging the energy cutoff, start from at least the value of ENMAX given in the\nPOTCAR\nfile and then increase incrementally in steps of 100 eV:\nInitial\nINCAR\n:\nINCAR.nmr\nPREC\n= Accurate\nENCUT\n= 400.0\nEDIFF\n= 1E-8\nISMEAR\n= 0;\nSIGMA\n= 0.1\nLREAL\n= A\nLCHIMAG\n= .TRUE.\nDQ\n= 0.001\nICHIBARE\n= 1\nLNMR_SYM_RED\n= .TRUE.\nNLSPLINE\n= .TRUE.\nScript to loop through\nENCUT\nfrom 400 eV to 800 eV:\nfor a in 400 500 600 700 800\ndo\ncp INCAR.nmr INCAR\nsed -i \"s/400/$a/g\" INCAR\nmpirun -np 4 $PATH_TO_EXECUTABLE/vasp_std\ncp OUTCAR OUTCAR.$a\ndone\nRelated tags and articles\nLCHIMAG\n,\nLVGVCALC\n,\nLVGVAPPL\nReferences\n↑\nC. J. Pickard and F. Mauri,\nAll-electron magnetic response with pseudopotentials: NMR chemical shifts\n, Phys. Rev. B\n63\n, 245101 (2001).\n↑\nJ. R. Yates, C. J. Pickard, and F. Mauri,\nCalculation of NMR chemical shifts for extended systems using ultrasoft pseudopotentials\n, Phys. Rev. B\n76\n, 024401 (2007).\n↑\nF. Mauri, S. G. Louie,\nMagnetic Susceptibility of Insulators from First Principles\n, Phys. Rev. Lett.\n76\n, 4246 (1996)."
  }, 
  "Calculation of atoms": {
    "description": "This web page provides detailed instructions for setting up and performing atomic calculations using the VASP software, including guidelines for input files (INCAR, POSCAR, POTCAR, KPOINTS), cell size recommendations, spin polarization, convergence settings, and methods to accurately determine atomic ground state energies.", 
    "detailed_description": "The following files are needed for the calculation of atoms\nINCAR\nPOSCAR\nPOTCAR\nKPOINTS\nBefore using a pseudopotential intensively it is not only necessary to check it in different bulk phases but the pseudopotential should also reproduce exactly the eigenvalues and the total energy of the free atom for which it was created. If energy cutoff and cell size are sufficient, the agreement between the atomic reference calculation and a calculation using VASP is normally better than 1 meV. Calculations for an atom are relatively fast and unproblematic in most cases.\nFor the calculation only the\nΓ\n{\\displaystyle \\Gamma}\npoint should be used i.e. the\nKPOINTS\nfile should have the following contents:\nMonkhorst Pack\n0\nMonkhorst Pack\n1  1  1\n0  0  0\nThe size of the cell depends on the element in question. Some values for reliable results are compiled in Tab. 1.\nCellsize\nAluminum\n14\nÅ\n{\\displaystyle \\AA}\nPotassium\n12\nÅ\n{\\displaystyle \\AA}\nCopper, Rhodium, Palldium ...\n10\nÅ\n{\\displaystyle \\AA}\nNitrogen\n7\nÅ\n{\\displaystyle \\AA}\nCarbon\n8\nÅ\n{\\displaystyle \\AA}\nTab. 1: Typical convenient settings  for the cellsize for a calculation of atoms.\nA simple cubic cell can be often enough but it is usually recommended to use nearly cubic cells with minimal orthorombic distortion. This can be important for some atoms due to higher degrees of freedom for relaxation. An example\nPOSCAR\nfile should look like:\natom\n1\n10.00000    .00000    .00000\n.00000  10.00100    .00000\n.00000    .00000  10.00200\n1\ncart\n0    0    0\nDue to the large cell\nNGX\n,\nNGY\n,\nNGZ\nand\nNGXF\n,\nNGYF\n,\nNGZF\nneed to be increased. This can be most easily achieved by setting\nPREC\n=\nAccurate\nor\nPREC\n=\nHigh\n.\nThe\nINCAR\nfile can be very simple:\nSYSTEM\n= Pd: atom\n#Electronic minimisation\nENCUT\n= 200.00 eV  #energy cut-off for the calculation\nEDIFF\n=   1E-04    #stopping-criterion for ELM\nNELMDL\n=  5\n#Ionic parameters\nPOMASS\n= 106.42     #mass (not really used in this case)\nZVAL\n=  10.00     #valence\n#DOS related values\nISMEAR\n=    0\nSIGMA\n= 0.1   #use smearing method\nThe only difference to the bulk calculation is that Gaussian smearing must be used now. You might set\nSIGMA\nto a very small value; this is necessary if atomic orbitals are almost degenerated. Another important point is spin polarization which can also lead to different energies in many cases. To turn on spin polarization additionally set\nISPIN\n=2 in the\nINCAR\nfile.\nMind\n: Look at the right value for the energy. It is\nnot\nF\n=\nE\n+\nσ\nS\n{\\displaystyle F=E+ \\sigma S}\n, which contains a \"meaningless\" entropy term, but the energy\nE\n{\\displaystyle E}\n. If\nSIGMA\nis very small both values are the same, but for extremely small\nSIGMA\nvalues VASP might have difficulties to converge to the correct atomic ground state.\nOn the start of an atomic calculation it is useful to delay the charge mixing for a large number of steps (in the example\nINCAR\nfile above 5 steps by specifying\nNELMDL\n=5) because the initial charge density corresponds already to the atomic charge density for which the pseudopotential was generated. It is also convenient to perform a calculation for a fixed atomic charge density (\nICHARG\n=12) as a first test. In some rare cases the real LDA ground state might differ from the configuration for which the pseudopotential was generated. For the atomic all electron reference calculation the occupancies are set by hand (for Pd\ns\n1\nd\n9\n{\\displaystyle s^1d^9}\nwas chosen to be the reference configuration, which is not the LDA ground state of the atom). In this case it is necessary\nto set the occupancies for VASP also by hand. This can be done by including the following lines in the\nINCAR\nfile:\nISMEAR\n= -2\nFERWE\n=  5*0.9  0.5\n(5*0.9 is interpreted as 0.9 0.9 0.9 0.9 0.9). To find out the ordering of the eigenvalues it might be necessary to perform a calculation with\nICHARG\n=12 (i.e. fixed atomic charge density), or have a look on the information supplied with your pseudopotential. After a successful atomic calculation compare the differences between the eigenvalues with those obtained by the pseudopotential generation program. Also check the total energy, the differences should be smaller than 20 meV.\n'\nMind\n:} We have found that the size of the cell can be reduced if one special point is used instead of the\nΓ\n{\\displaystyle \\Gamma}\npoint, i.e. if the\nKPOINTS\nfile has the following contents:\nMonkhorst Pack\n0\nMonkhorst Pack\n2  2  2\n0  0  0\nThe reasons for this behaviour are: Due to the finite size of the cell a band dispersion exists i.e. the atomic eigenvalues split and form a band with finite width. To first order the center of the band lies exactly at the position of the atomic eigenvalues. Using the\nΓ\n{\\displaystyle \\Gamma}\n-point the eigenvalues at the bottom of the band are obtained. If the special point (0.25,0.25,0.25) 2\nπ\n/\na\n{\\displaystyle \\pi/a}\nis used instead of the\nΓ\n{\\displaystyle \\Gamma}\n-point, the energy of the center of the band is obtained. Nevertheless we recommend this setting only for absolute experts: in most cases the degeneracy of the p- and d-orbitals is removed and only the mean value of the eigenvalues remains physically significant. In this cases it is also necessary to increase\nSIGMA\nor to set the partial occupancies by hand!\nDetermining the groundstate energy of atoms\nThe\nPOTCAR\nfile contains information on the energy of the atom in the reference configuration (i.e. the configuration for which the pseudopotential was generated). Total energies calculated by VASP are with respect to this configuration. The reference calculation, however, did not allow for spin-polarisation or broken symmetry solutions, which usually lower the energy for gradient corrected of hybrid functionals. To include these effects properly, it is required to calculate the lowest energy magnetic groundstate using VASP.\nUnfortunately convergence to the symmetry broken spin polarized groundstate can be relatively slow in VASP. The following\nINCAR\nfile worked reasonably well for most elements:\nISYM\n= 0      # no symmetry\nISPIN\n= 2     # allow for spin polarisation\nVOSKOWN\n= 1   # this is important, in particular for GGA\n# but not required for PBE potentials\nISMEAR\n= 0    # Gaussian smearing, otherwise negative occupancies might come up\nSIGMA\n= 0.002 # tiny smearing width to safely break symmetry\nAMIX\n= 0.2    # mixing set manually\nBMIX\n= 0.0001\nNELM\n= 100    # often many steps are required\nICHARG\n= 1\nExecute VASP twice to three times, consecutively with this input file until energies are converged. Furthermore, we recommend to use large slightly non-cubic cells, i.e.\n12.000\n{\\displaystyle 12.000 }\nÅ\n{\\displaystyle \\AA}\n×\n{\\displaystyle  \\times }\n12.001\n{\\displaystyle 12.001}\nÅ\n{\\displaystyle \\AA}\n×\n{\\displaystyle \\times}\n12.002\n{\\displaystyle 12.002}\nÅ\n{\\displaystyle \\AA}\n. In some cases, we also found it advantageously to use direct energy minimization instead of charge-density mixing\nALGO\n= D\nLSUBROT\n= .FALSE.\nNELM\n= 500\nTIME\n= 0.2\nor\nALGO\n= A\nLSUBROT\n= .FALSE.\nNELM\n= 500\nTIME\n= 0.2\nAlways check for convergence, and whether all occupancies are 0 or 1."
  }, 
  "Calculation of dimers": {
    "description": "This web page describes a computational method for simulating dimer systems using density functional theory, emphasizing the importance of accurate dimer distance calculations for validating potential transferability and providing specific input parameters for performing constant velocity molecular dynamics simulations with VASP.", 
    "detailed_description": "Reproducing accurate dimer distances is an important difficult benchmark for a potential. If a potential works accurately for dimers and bulk calculations, one can be quite confident that the potential possesses excellent transferability. For the simulation of the dimers, one can use the\nΓ\n{\\displaystyle \\Gamma}\npoint and displace the second atom along the diagonal direction. Generally bonding length and vibrational frequency have to be compared with accurate reference data. It is recommended to perform these calculations using the constant velocity molecular dynamic mode (i.e.\nIBRION\n=2,\nSMASS\n=-2). This mode speeds up the calculation because the wave functions are extrapolated and predicted using information from previous steps. The\nINCAR\nfile must contain additional lines to perform the constant velocity MD:\n#ionic relaxation\nNSW\n= 10     #number of steps for IOM\nSMASS\n= -2   #constant velocity MD\nPOTIM\n= 1    #time-step for ionic-motion\nIn addition to the positions the\nPOSCAR\nfile must also contain velocities:\ndimer\n1\n10.00000    .00000    .00000\n.00000  10.00000    .00000\n.00000    .00000  10.00000\n2\ncart\n0       0       0\n1.47802 1.47802 1.47802\ncart\n0       0       0\n-.02309 -.02309 -.02309\nFor this\nPOSCAR\nfile the starting distance is 2.56\nÅ\n{\\displaystyle \\AA}\n, in each step the distance is reduced by 0.04\nÅ\n{\\displaystyle \\AA}\n, leading to a final distance of 2.20\nÅ\n{\\displaystyle \\AA}\n. The obtained energies can be fitted to a Morse potential.\nMind: In some rare cases like C\n2\n, the calculation of the dimer turns out to be problematic. For this case the LUMO (lowest unoccupied molecular orbital) and the HOMO (highest occupied molecular orbital) cross at a certain distance, and are actually degenerate, if the total energy is used as a variational quantity (i.e.\nσ\n→\n0\n{\\displaystyle \\sigma \\to 0}\n). Within the finite temperature LDA these difficulties are avoided, but interpreting the results is not easy because of the finite entropy (for C\n2\nsee Ref.\n[1]\n).\nReferences\n↑\nM.R. Pederson and K.A. Jackson, Phys. Rev. B\n43\n, 7312 (1991)."
  }, 
  "Choosing pseudopotentials": {
    "description": "This web page provides detailed guidance on selecting appropriate pseudopotentials (POTCARs) for DFT calculations, emphasizing the importance of balancing computational cost, accuracy, and transferability based on the element, chemical bonding, property of interest, and calculation method, with specific recommendations for different elements and scenarios.", 
    "detailed_description": "Several\npseudopotential variants labeled by suffixes\nexist for many elements. When making a choice, it is necessary to balance computational cost, accuracy, and transferability.\nTo set up a minimal working example of your calculation, follow\nprepare a POTCAR\n.\nTry to create a smaller test calculation and perform your own tests to confirm if the quantity of interest is sensitive to the choice of the pseudopotential. It might be possible to opt for a computationally cheaper\nPOTCAR\nand gain performance. On the other hand, it could be necessary to opt for a computationally demanding setup to obtain correct results.\nWith the\naspects described in the next section\nin mind, carefully look over the\nrecommendations for each group in the periodic table\n.\nAspects to refine the choice of pseudopotentials\nAspect 1:\nThe bond lengths and the valency of the ions.\nShort bonds will require harder potentials, and semicore states might have to be treated as valence for certain chemical bonding. For some elements, variants for specific valency exist; for example, the suffix\n_2 or _3\ncan be used to describe\nfixed divalent or trivalent Lanthanides\n.\nAspect 2:\nThe physical or chemical property of interest.\nIf you are only interested in a rough\nstructure optimization\n, soft potentials (\n_s\n) with minimal valency may suffice. This approach might also work for\nphonon calculations\nthat rely on large supercells.\nOn the other hand, when optimizing a magnetic structure, it may be necessary to include semicore states in the valence (\n_pv and _sv\n).\nFor the computation of\noptical properties\n, it is crucial to use\nGW potentials\n.\nAspect 3:\nThe method or algorithm used in your calculation.\nFor any calculation involving unoccupied states significantly above the Fermi energy, the\n_GW variants\nof potentials are superior and should be used. Particularly, all kinds of\ncalculations within many-body perturbation theory\nneed a high number of\nempty bands\n. Therefore, when GW, BSE, etc. is performed, the\nGW potentials\nshould be used throughout the workflow.\nHartree-Fock and hybrid caluclations\nshould\nnot\nbe performed with soft potentials (\n_s\n). Moreover, any calculations where you switch the\nexchange-correlation functional\nshould\nnot\nbe performed with soft potentials (\n_s\n).\nFor standard DFT-ground-state calculations, using\n_GW or _h\npotentials is usually unnecessary unless, e.g., the property of interest or geometry of the structure demands it.\nRecommendations and advice\nRecommended PAW potentials\nThe table directly below highlights recommended PAW potentials in\nbold\n.\nThese potentials are\nnot ideal\nfor calculations involving a large number of excited states as needed, e.g., for\noptical properties\nor\nmany-body perturbation theory\n.\nStandard PBE potentials (potpaw.64)\nPotential name\nNumber of valence electrons\nValence electron configuration\nENAMX [eV]\nH\n1\n1\ns\n1\n250.0\nH.25\n0.25\n1\ns\n0.25\n250.0\nH.33\n0.33\n1\ns\n0.33\n250.0\nH.42\n0.42\n1\ns\n0.42\n250.0\nH.5\n0.5\n1\ns\n0.5\n250.0\nH.58\n0.58\n1\ns\n0.58\n250.0\nH.66\n0.66\n1\ns\n0.66\n250.0\nH.75\n0.75\n1\ns\n0.75\n250.0\nH1.25\n1.25\n1\ns\n1.25\n250.0\nH1.33\n1.33\n1\ns\n1.33\n250.0\nH1.5\n1.5\n1\ns\n1.5\n250.0\nH1.66\n1.66\n1\ns\n1.66\n250.0\nH1.75\n1.75\n1\ns\n1.75\n250.0\nH_AE\n1\n1\ns\n1\n1000.0\nH_h\n1\n1\ns\n1\n700.0\nH_s\n1\n1\ns\n1\n200.0\nHe\n2\n1\ns\n2\n478.896\nHe_AE\n2\n1\ns\n2\n2135.871\nLi\n1\n2\ns\n1\n140.0\nLi_sv\n3\n1\ns\n2\n2\ns\n1\n499.034\nBe\n2\n2\ns\n1.99\n2\np\n0.01\n247.543\nBe_sv\n4\n1\ns\n2\n2\ns\n1.99\n2\np\n0.01\n308.768\nB\n3\n2\ns\n2\n2\np\n1\n318.614\nB_h\n3\n2\ns\n2\n2\np\n1\n700.0\nB_s\n3\n2\ns\n2\n2\np\n1\n269.245\nC\n4\n2\ns\n2\n2\np\n2\n400.0\nC_h\n4\n2\ns\n2\n2\np\n2\n741.689\nC_s\n4\n2\ns\n2\n2\np\n2\n273.911\nN\n5\n2\ns\n2\n2\np\n3\n400.0\nN_h\n5\n2\ns\n2\n2\np\n3\n755.582\nN_s\n5\n2\ns\n2\n2\np\n3\n279.692\nO\n6\n2\ns\n2\n2\np\n4\n400.0\nO_h\n6\n2\ns\n2\n2\np\n4\n765.519\nO_s\n6\n2\ns\n2\n2\np\n4\n282.853\nF\n7\n2\ns\n2\n2\np\n5\n400.0\nF_h\n7\n2\ns\n2\n2\np\n5\n772.626\nF_s\n7\n2\ns\n2\n2\np\n5\n289.837\nNe\n8\n2\ns\n2\n2\np\n6\n343.606\nNa\n1\n3\ns\n1\n101.968\nNa_pv\n7\n2\np\n6\n3\ns\n1\n259.561\nNa_sv\n9\n2\ns\n2\n2\np\n6\n3\ns\n1\n645.64\nMg\n2\n3\ns\n2\n200.0\nMg_pv\n8\n2\np\n6\n3\ns\n2\n403.929\nMg_sv\n10\n2\ns\n2\n2\np\n6\n3\ns\n2\n495.223\nAl\n3\n3\ns\n2\n3\np\n1\n240.3\nSi\n4\n3\ns\n2\n3\np\n2\n245.345\nP\n5\n3\ns\n2\n3\np\n3\n255.04\nP_h\n5\n3\ns\n2\n3\np\n3\n390.202\nS\n6\n3\ns\n2\n3\np\n4\n258.689\nS_h\n6\n3\ns\n2\n3\np\n4\n402.436\nCl\n7\n3\ns\n2\n3\np\n5\n262.472\nCl_h\n7\n3\ns\n2\n3\np\n5\n409.136\nAr\n8\n3\ns\n2\n3\np\n6\n266.408\nK_pv\n7\n3\np\n6\n4\ns\n1\n116.731\nK_sv\n9\n3\ns\n2\n3\np\n6\n4\ns\n1\n259.264\nCa_pv\n8\n3\np\n6\n4\ns\n2\n119.559\nCa_sv\n10\n3\ns\n2\n3\np\n6\n4\ns\n2\n266.622\nSc\n3\n3\nd\n2\n4\ns\n1\n154.763\nSc_sv\n11\n3\ns\n2\n3\np\n6\n3\nd\n2\n4\ns\n1\n222.66\nTi\n4\n3\nd\n3\n4\ns\n1\n178.33\nTi_pv\n10\n3\np\n6\n3\nd\n3\n4\ns\n1\n222.335\nTi_sv\n12\n3\ns\n2\n3\np\n6\n3\nd\n3\n4\ns\n1\n274.61\nV\n5\n3\nd\n4\n4\ns\n1\n192.543\nV_pv\n11\n3\np\n6\n3\nd\n4\n4\ns\n1\n263.673\nV_sv\n13\n3\ns\n2\n3\np\n6\n3\nd\n4\n4\ns\n1\n263.673\nCr\n6\n3\nd\n5\n4\ns\n1\n227.08\nCr_pv\n12\n3\np\n6\n3\nd\n5\n4\ns\n1\n265.681\nCr_sv\n14\n3\ns\n2\n3\np\n6\n3\nd\n5\n4\ns\n1\n395.471\nMn\n7\n3\nd\n6\n4\ns\n1\n269.864\nMn_pv\n13\n3\np\n6\n3\nd\n6\n4\ns\n1\n269.864\nMn_sv\n15\n3\ns\n2\n3\np\n6\n3\nd\n6\n4\ns\n1\n387.187\nFe\n8\n3\nd\n7\n4\ns\n1\n267.882\nFe_pv\n14\n3\np\n6\n3\nd\n7\n4\ns\n1\n293.238\nFe_sv\n16\n3\ns\n2\n3\np\n6\n3\nd\n7\n4\ns\n1\n390.558\nCo\n9\n3\nd\n8\n4\ns\n1\n267.968\nCo_pv\n15\n3\np\n6\n3\nd\n8\n4\ns\n1\n271.042\nCo_sv\n17\n3\ns\n2\n3\np\n6\n3\nd\n8\n4\ns\n1\n390.362\nNi\n10\n3\nd\n9\n4\ns\n1\n269.532\nNi_pv\n16\n3\np\n6\n3\nd\n9\n4\ns\n1\n367.986\nCu\n11\n3\nd\n10\n4\ns\n1\n295.446\nCu_pv\n17\n3\np\n6\n3\nd\n10\n4\ns\n1\n368.648\nZn\n12\n3\nd\n10\n4\ns\n2\n276.723\nGa\n3\n4\ns\n2\n4\np\n1\n134.678\nGa_d\n13\n3\nd\n10\n4\ns\n2\n4\np\n1\n282.691\nGa_h\n13\n3\nd\n10\n4\ns\n2\n4\np\n1\n404.601\nGe\n4\n4\ns\n2\n4\np\n2\n173.807\nGe_d\n14\n3\nd\n10\n4\ns\n2\n4\np\n2\n310.294\nGe_h\n14\n3\nd\n10\n4\ns\n2\n4\np\n2\n410.425\nAs\n5\n4\ns\n2\n4\np\n3\n208.702\nAs_d\n15\n3\nd\n10\n4\ns\n2\n4\np\n3\n288.651\nSe\n6\n4\ns\n2\n4\np\n4\n211.555\nBr\n7\n4\ns\n2\n4\np\n5\n216.285\nKr\n8\n4\ns\n2\n4\np\n6\n185.331\nRb_pv\n7\n4\np\n6\n4\nd\n0.001\n5\ns\n0.999\n121.882\nRb_sv\n9\n4\ns\n2\n4\np\n6\n4\nd\n0.001\n5\ns\n0.999\n220.112\nSr_sv\n10\n4\ns\n2\n4\np\n6\n4\nd\n0.001\n5\ns\n1.999\n229.353\nY_sv\n11\n4\ns\n2\n4\np\n6\n4\nd\n2\n5\ns\n1\n202.626\nZr_sv\n12\n4\ns\n2\n4\np\n6\n4\nd\n3\n5\ns\n1\n229.898\nNb_pv\n11\n4\np\n6\n4\nd\n4\n5\ns\n1\n208.608\nNb_sv\n13\n4\ns\n2\n4\np\n6\n4\nd\n4\n5\ns\n1\n293.235\nMo\n6\n4\nd\n5\n5\ns\n1\n224.584\nMo_pv\n12\n4\np\n6\n4\nd\n5\n5\ns\n1\n224.584\nMo_sv\n14\n4\ns\n2\n4\np\n6\n4\nd\n5\n5\ns\n1\n242.676\nTc\n7\n4\nd\n6\n5\ns\n1\n228.694\nTc_pv\n13\n4\np\n6\n4\nd\n6\n5\ns\n1\n263.523\nTc_sv\n15\n4\ns\n2\n4\np\n6\n4\nd\n6\n5\ns\n1\n318.703\nRu\n8\n4\nd\n7\n5\ns\n1\n213.271\nRu_pv\n14\n4\np\n6\n4\nd\n7\n5\ns\n1\n240.049\nRu_sv\n16\n4\ns\n2\n4\np\n6\n4\nd\n7\n5\ns\n1\n318.855\nRh\n9\n4\nd\n8\n5\ns\n1\n228.996\nRh_pv\n15\n4\np\n6\n4\nd\n8\n5\ns\n1\n247.408\nPd\n10\n4\nd\n9\n5\ns\n1\n250.925\nPd_pv\n16\n4\np\n6\n4\nd\n9\n5\ns\n1\n250.925\nAg\n11\n4\nd\n10\n5\ns\n1\n249.844\nAg_pv\n17\n4\np\n6\n4\nd\n10\n5\ns\n1\n297.865\nCd\n12\n4\nd\n10\n5\ns\n2\n274.336\nIn\n3\n5\ns\n2\n5\np\n1\n95.934\nIn_d\n13\n4\nd\n10\n5\ns\n2\n5\np\n1\n239.211\nSn\n4\n5\ns\n2\n5\np\n2\n103.236\nSn_d\n14\n4\nd\n10\n5\ns\n2\n5\np\n2\n241.083\nSb\n5\n5\ns\n2\n5\np\n3\n172.069\nTe\n6\n5\ns\n2\n5\np\n4\n174.982\nI\n7\n5\ns\n2\n5\np\n5\n175.647\nXe\n8\n5\ns\n2\n5\np\n6\n153.118\nCs_sv\n9\n5\ns\n2\n5\np\n6\n6\ns\n1\n220.318\nBa_sv\n10\n5\ns\n2\n5\np\n6\n5\nd\n0.01\n6\ns\n1.99\n187.181\nLa\n11\n4\nf\n0.0001\n5\ns\n2\n5\np\n6\n5\nd\n0.9999\n6\ns\n2\n219.292\nLa_s\n9\n5\np\n6\n5\nd\n1\n6\ns\n2\n136.53\nCe\n12\n4\nf\n1\n5\ns\n2\n5\np\n6\n5\nd\n1\n6\ns\n2\n273.042\nCe_3\n11\n5\ns\n2\n5\np\n6\n5\nd\n1\n6\ns\n2\n176.506\nCe_h\n12\n4\nf\n1\n5\ns\n2\n5\np\n6\n5\nd\n1\n6\ns\n2\n299.9\nPr\n13\n4\nf\n2.5\n5\ns\n2\n5\np\n6\n5\nd\n0.5\n6\ns\n2\n337.25\nPr_3\n11\n5\ns\n2\n5\np\n6\n5\nd\n1\n6\ns\n2\n181.719\nPr_h\n13\n4\nf\n2.5\n5\ns\n2\n5\np\n6\n5\nd\n0.5\n6\ns\n2\n400.742\nNd\n14\n4\nf\n3.5\n5\ns\n2\n5\np\n6\n5\nd\n0.5\n6\ns\n2\n338.34\nNd_3\n11\n5\ns\n2\n5\np\n6\n5\nd\n1\n6\ns\n2\n182.619\nNd_h\n14\n4\nf\n3.5\n5\ns\n2\n5\np\n6\n5\nd\n0.5\n6\ns\n2\n402.016\nPm\n15\n4\nf\n4.5\n5\ns\n2\n5\np\n6\n5\nd\n0.5\n6\ns\n2\n340.358\nPm_3\n11\n5\ns\n2\n5\np\n6\n5\nd\n1\n6\ns\n2\n176.959\nPm_h\n15\n4\nf\n4.5\n5\ns\n2\n5\np\n6\n5\nd\n0.5\n6\ns\n2\n404.406\nSm\n16\n4\nf\n5.5\n5\ns\n2\n5\np\n6\n5\nd\n0.5\n6\ns\n2\n341.177\nSm_3\n11\n5\ns\n2\n5\np\n6\n5\nd\n1\n6\ns\n2\n177.087\nSm_h\n16\n4\nf\n5.5\n5\ns\n2\n5\np\n6\n5\nd\n0.5\n6\ns\n2\n405.382\nEu\n17\n4\nf\n6.5\n5\ns\n2\n5\np\n6\n5\nd\n0.5\n6\ns\n2\n344.705\nEu_2\n8\n5\np\n6\n6\ns\n2\n99.328\nEu_3\n9\n5\np\n6\n5\nd\n1\n6\ns\n2\n129.057\nEu_h\n17\n4\nf\n6.5\n5\ns\n2\n5\np\n6\n5\nd\n0.5\n6\ns\n2\n403.212\nGd\n18\n4\nf\n7.5\n5\ns\n2\n5\np\n6\n5\nd\n0.5\n6\ns\n2\n342.859\nGd_3\n9\n5\np\n6\n5\nd\n1\n6\ns\n2\n154.332\nGd_h\n18\n4\nf\n7.5\n5\ns\n2\n5\np\n6\n5\nd\n0.5\n6\ns\n2\n407.403\nTb\n19\n4\nf\n8.5\n5\ns\n2\n5\np\n6\n5\nd\n0.5\n6\ns\n2\n340.855\nTb_3\n9\n5\np\n6\n5\nd\n1\n6\ns\n2\n155.613\nTb_h\n19\n4\nf\n8.5\n5\ns\n2\n5\np\n6\n5\nd\n0.5\n6\ns\n2\n405.043\nDy\n20\n4\nf\n9.5\n5\ns\n2\n5\np\n6\n5\nd\n0.5\n6\ns\n2\n341.547\nDy_3\n9\n5\np\n6\n5\nd\n1\n6\ns\n2\n155.713\nDy_h\n20\n4\nf\n9.5\n5\ns\n2\n5\np\n6\n5\nd\n0.5\n6\ns\n2\n405.886\nHo\n21\n4\nf\n10.5\n5\ns\n2\n5\np\n6\n5\nd\n0.5\n6\ns\n2\n343.845\nHo_3\n9\n5\np\n6\n5\nd\n1\n6\ns\n2\n154.137\nHo_h\n21\n4\nf\n10.5\n5\ns\n2\n5\np\n6\n5\nd\n0.5\n6\ns\n2\n415.91\nEr\n22\n4\nf\n11.5\n5\ns\n2\n5\np\n6\n5\nd\n0.5\n6\ns\n2\n346.295\nEr_2\n8\n5\np\n6\n6\ns\n2\n119.75\nEr_3\n9\n5\np\n6\n5\nd\n1\n6\ns\n2\n155.037\nEr_h\n22\n4\nf\n11.5\n5\ns\n2\n5\np\n6\n5\nd\n0.5\n6\ns\n2\n429.583\nTm\n23\n4\nf\n12.5\n5\ns\n2\n5\np\n6\n5\nd\n0.5\n6\ns\n2\n344.206\nTm_3\n9\n5\np\n6\n5\nd\n1\n6\ns\n2\n149.221\nTm_h\n23\n4\nf\n12.5\n5\ns\n2\n5\np\n6\n5\nd\n0.5\n6\ns\n2\n419.812\nYb\n24\n4\nf\n13.5\n5\ns\n2\n5\np\n6\n5\nd\n0.5\n6\ns\n2\n344.312\nYb_2\n8\n5\np\n6\n6\ns\n2\n112.578\nYb_3\n9\n5\np\n6\n5\nd\n1\n6\ns\n2\n188.359\nYb_h\n24\n4\nf\n13.5\n5\ns\n2\n5\np\n6\n5\nd\n0.5\n6\ns\n2\n409.285\nLu\n25\n4\nf\n14\n5\ns\n2\n5\np\n6\n5\nd\n1\n6\ns\n2\n255.695\nLu_3\n9\n5\np\n6\n5\nd\n1\n6\ns\n2\n154.992\nHf\n4\n5\nd\n3\n6\ns\n1\n220.334\nHf_pv\n10\n5\np\n6\n5\nd\n3\n6\ns\n1\n220.334\nHf_sv\n12\n5\ns\n2\n5\np\n6\n5\nd\n4\n237.444\nTa\n5\n5\nd\n4\n6\ns\n1\n223.667\nTa_pv\n11\n5\np\n6\n5\nd\n4\n6\ns\n1\n223.667\nW\n6\n5\nd\n5\n6\ns\n1\n223.057\nW_sv\n14\n5\ns\n2\n5\np\n6\n5\nd\n5\n6\ns\n1\n223.057\nRe\n7\n5\nd\n6\n6\ns\n1\n226.216\nRe_pv\n13\n5\np\n6\n5\nd\n6\n6\ns\n1\n226.216\nOs\n8\n5\nd\n7\n6\ns\n1\n228.022\nOs_pv\n14\n5\np\n6\n5\nd\n7\n6\ns\n1\n228.022\nIr\n9\n5\nd\n8\n6\ns\n1\n210.864\nPt\n10\n5\nd\n9\n6\ns\n1\n230.283\nPt_pv\n16\n5\np\n6\n5\nd\n9\n6\ns\n1\n294.607\nAu\n11\n5\nd\n10\n6\ns\n1\n229.943\nHg\n12\n5\nd\n10\n6\ns\n2\n233.204\nTl\n3\n6\ns\n2\n6\np\n1\n90.14\nTl_d\n13\n5\nd\n10\n6\ns\n2\n6\np\n1\n237.053\nPb\n4\n6\ns\n2\n6\np\n2\n97.973\nPb_d\n14\n5\nd\n10\n6\ns\n2\n6\np\n2\n237.835\nBi\n5\n6\ns\n2\n6\np\n3\n105.037\nBi_d\n15\n5\nd\n10\n6\ns\n2\n6\np\n3\n242.839\nPo\n6\n6\ns\n2\n6\np\n4\n159.707\nPo_d\n16\n5\nd\n10\n6\ns\n2\n6\np\n4\n264.565\nAt\n7\n6\ns\n2\n6\np\n5\n161.43\nRn\n8\n6\ns\n2\n6\np\n6\n151.497\nFr_sv\n9\n6\ns\n2\n6\np\n6\n7\ns\n1\n214.54\nRa_sv\n10\n6\ns\n2\n6\np\n6\n7\ns\n2\n237.367\nAc\n11\n6\ns\n2\n6\np\n6\n6\nd\n1\n7\ns\n2\n172.351\nTh\n12\n5\nf\n1\n6\ns\n2\n6\np\n6\n6\nd\n1\n7\ns\n2\n247.306\nTh_s\n10\n5\nf\n1\n6\np\n6\n6\nd\n1\n7\ns\n2\n169.363\nPa\n13\n5\nf\n1\n6\ns\n2\n6\np\n6\n6\nd\n2\n7\ns\n2\n252.193\nPa_s\n11\n5\nf\n1\n6\np\n6\n6\nd\n2\n7\ns\n2\n193.466\nU\n14\n5\nf\n2\n6\ns\n2\n6\np\n6\n6\nd\n2\n7\ns\n2\n252.502\nU_s\n14\n5\nf\n2\n6\ns\n2\n6\np\n6\n6\nd\n2\n7\ns\n2\n209.23\nNp\n15\n5\nf\n3\n6\ns\n2\n6\np\n6\n6\nd\n2\n7\ns\n2\n254.26\nNp_s\n15\n5\nf\n3\n6\ns\n2\n6\np\n6\n6\nd\n2\n7\ns\n2\n207.713\nPu\n16\n5\nf\n4\n6\ns\n2\n6\np\n6\n6\nd\n2\n7\ns\n2\n254.353\nPu_s\n16\n5\nf\n4\n6\ns\n2\n6\np\n6\n6\nd\n2\n7\ns\n2\n207.83\nAm\n17\n5\nf\n5\n6\ns\n2\n6\np\n6\n6\nd\n2\n7\ns\n2\n255.875\nCm\n18\n5\nf\n6\n6\ns\n2\n6\np\n6\n6\nd\n2\n7\ns\n2\n257.953\nCf\n20\n5\nf\n8\n6\ns\n2\n6\np\n6\n6\nd\n2\n7\ns\n2\n414.614\nThe following table highlights recommended PAW potentials for calculations involving many states above the Fermi energy in\nbold\n.\nThey are optimized for scattering properties high above the Fermi level and thus have advantages if many unoccupied states are involved, as for\noptical properties\nor\nmany-body perturbation theory\n. Some results indicate that these GW potentials are also more accurate for ground-state-DFT calculations\n[1]\n, but the results should be very comparable with the standard potentials in most cases. Unless the uttermost accuracy is required, it is usually not worth paying the extra computational cost required\n[2]\nfor the GW potentials compared to their standard counterparts.\nGW potentials (potpaw.64)\nPotential name\nNumber of valence electrons\nValence electron configuration\nENAMX [eV]\nH_GW\n1\n1\ns\n1\n300.0\nH_GW_new\n1\n1\ns\n1\n536.615\nH_h_GW\n1\n1\ns\n1\n700.0\nHe_GW\n2\n1\ns\n2\n405.78\nLi_AE_GW\n3\n1\ns\n2\n2\np\n1\n433.699\nLi_GW\n1\n2\ns\n1\n112.104\nLi_sv_GW\n3\n1\ns\n2\n2\np\n1\n433.699\nBe_GW\n2\n2\ns\n1.9999\n2\np\n0.001\n247.543\nBe_sv_GW\n4\n1\ns\n2\n2\np\n2\n537.454\nB_GW\n3\n2\ns\n2\n2\np\n1\n318.614\nB_GW_new\n3\n2\ns\n2\n2\np\n1\n318.614\nB_h_GW\n3\n2\ns\n2\n2\np\n1\n731.373\nC_GW\n4\n2\ns\n2\n2\np\n2\n413.992\nC_GW_new\n4\n2\ns\n2\n2\np\n2\n433.983\nC_h_GW\n4\n2\ns\n2\n2\np\n2\n741.689\nC_s_GW\n4\n2\ns\n2\n2\np\n2\n304.843\nN_GW\n5\n2\ns\n2\n2\np\n3\n420.902\nN_GW_new\n5\n2\ns\n2\n2\np\n3\n452.633\nN_h_GW\n5\n2\ns\n2\n2\np\n3\n755.582\nN_s_GW\n5\n2\ns\n2\n2\np\n3\n312.986\nO_GW\n6\n2\ns\n2\n2\np\n4\n414.635\nO_GW_new\n6\n2\ns\n2\n2\np\n4\n466.797\nO_h_GW\n6\n2\ns\n2\n2\np\n4\n765.519\nO_s_GW\n6\n2\ns\n2\n2\np\n4\n334.664\nF_GW\n7\n2\ns\n2\n2\np\n5\n487.698\nF_GW_new\n7\n2\ns\n2\n2\np\n5\n480.281\nF_h_GW\n7\n2\ns\n2\n2\np\n5\n848.626\nNe_GW\n8\n2\ns\n2\n2\np\n6\n432.275\nNe_s_GW\n8\n2\ns\n2\n2\np\n6\n318.26\nNa_sv_GW\n9\n2\ns\n2\n2\np\n6\n3\np\n1\n372.853\nMg_GW\n2\n3\ns\n2\n126.143\nMg_pv_GW\n8\n2\np\n6\n3\ns\n2\n403.929\nMg_sv_GW\n10\n2\ns\n2\n2\np\n6\n3\nd\n2\n429.893\nAl_GW\n3\n3\ns\n2\n3\np\n1\n240.3\nAl_sv_GW\n11\n2\ns\n2\n2\np\n6\n3\ns\n2\n3\np\n1\n411.109\nSi_GW\n4\n3\ns\n2\n3\np\n2\n245.345\nSi_sv_GW\n12\n2\ns\n2\n2\np\n6\n3\ns\n2\n3\np\n2\n547.578\nP_GW\n5\n3\ns\n2\n3\np\n3\n255.04\nS_GW\n6\n3\ns\n2\n3\np\n4\n258.689\nCl_GW\n7\n3\ns\n2\n3\np\n5\n262.472\nAr_GW\n8\n3\ns\n2\n3\np\n6\n290.599\nK_sv_GW\n9\n3\ns\n2\n3\np\n6\n3\nd\n1\n248.998\nCa_sv_GW\n10\n3\ns\n2\n3\np\n6\n3\nd\n2\n281.43\nSc_sv_GW\n11\n3\ns\n2\n3\np\n6\n3\nd\n3\n378.961\nTi_sv_GW\n12\n3\ns\n2\n3\np\n6\n3\nd\n4\n383.774\nV_sv_GW\n13\n3\ns\n2\n3\np\n6\n3\nd\n5\n382.321\nCr_sv_GW\n14\n3\ns\n2\n3\np\n6\n3\nd\n6\n384.932\nMn_GW\n7\n3\nd\n6\n4\ns\n1\n278.466\nMn_sv_GW\n15\n3\ns\n2\n3\np\n6\n3\nd\n7\n384.627\nFe_GW\n8\n3\nd\n7\n4\ns\n1\n321.007\nFe_sv_GW\n16\n3\ns\n2\n3\np\n6\n3\nd\n8\n387.837\nCo_GW\n9\n3\nd\n8\n4\ns\n1\n323.4\nCo_sv_GW\n17\n3\ns\n2\n3\np\n6\n3\nd\n9\n387.491\nNi_GW\n10\n3\nd\n9\n4\ns\n1\n357.323\nNi_sv_GW\n18\n3\ns\n2\n3\np\n6\n3\nd\n10\n389.645\nCu_GW\n11\n3\nd\n10\n4\ns\n1\n417.039\nCu_sv_GW\n19\n3\ns\n2\n3\np\n6\n3\nd\n10\n4\ns\n1\n467.331\nZn_GW\n12\n3\nd\n10\n4\ns\n2\n328.191\nZn_sv_GW\n20\n3\ns\n2\n3\np\n6\n3\nd\n10\n4\ns\n2\n401.665\nGa_GW\n3\n4\ns\n2\n4\np\n1\n134.678\nGa_d_GW\n13\n3\nd\n10\n4\ns\n2\n4\np\n1\n404.602\nGa_sv_GW\n21\n3\ns\n2\n3\np\n6\n3\nd\n10\n4\ns\n2\n4\np\n1\n404.602\nGe_GW\n4\n4\ns\n2\n4\np\n2\n173.807\nGe_d_GW\n14\n3\nd\n10\n4\ns\n2\n4\np\n2\n375.434\nGe_sv_GW\n22\n3\ns\n2\n3\np\n6\n3\nd\n10\n4\ns\n2\n4\np\n2\n410.425\nAs_GW\n5\n4\ns\n2\n4\np\n3\n208.702\nAs_sv_GW\n23\n3\ns\n2\n3\np\n6\n3\nd\n10\n4\ns\n2\n4\np\n3\n415.313\nSe_GW\n6\n4\ns\n2\n4\np\n4\n211.555\nSe_sv_GW\n24\n3\ns\n2\n3\np\n6\n3\nd\n10\n4\ns\n2\n4\np\n4\n469.344\nBr_GW\n7\n4\ns\n2\n4\np\n5\n216.285\nBr_sv_GW\n25\n3\ns\n2\n3\np\n6\n3\nd\n10\n4\ns\n2\n4\np\n5\n475.692\nKr_GW\n8\n4\ns\n2\n4\np\n6\n252.232\nRb_sv_GW\n9\n4\ns\n2\n4\np\n6\n4\nd\n1\n221.197\nSr_sv_GW\n10\n4\ns\n2\n4\np\n6\n4\nd\n2\n224.817\nY_sv_GW\n11\n4\ns\n2\n4\np\n6\n4\nd\n3\n339.758\nZr_sv_GW\n12\n4\ns\n2\n4\np\n6\n4\nd\n4\n346.364\nNb_sv_GW\n13\n4\ns\n2\n4\np\n6\n4\nd\n5\n353.872\nMo_sv_GW\n14\n4\ns\n2\n4\np\n6\n4\nd\n6\n344.914\nTc_sv_GW\n15\n4\ns\n2\n4\np\n6\n4\nd\n7\n351.044\nRu_sv_GW\n16\n4\ns\n2\n4\np\n6\n4\nd\n8\n348.106\nRh_GW\n9\n4\nd\n8\n5\ns\n1\n247.408\nRh_sv_GW\n17\n4\ns\n2\n4\np\n6\n4\nd\n9\n351.206\nPd_GW\n10\n4\nd\n9\n5\ns\n1\n250.925\nPd_sv_GW\n18\n4\ns\n2\n4\np\n6\n4\nd\n10\n356.093\nAg_GW\n11\n4\nd\n10\n5\ns\n1\n249.844\nAg_sv_GW\n19\n4\ns\n2\n4\np\n6\n4\nd\n11\n354.43\nCd_GW\n12\n4\nd\n10\n5\ns\n2\n254.045\nCd_sv_GW\n20\n4\ns\n2\n4\np\n6\n4\nd\n10\n5\ns\n2\n361.806\nIn_d_GW\n13\n4\nd\n10\n5\ns\n2\n5\np\n1\n278.624\nIn_sv_GW\n21\n4\ns\n2\n4\np\n6\n4\nd\n10\n5\ns\n2\n5\np\n1\n366.771\nSn_d_GW\n14\n4\nd\n10\n5\ns\n2\n5\np\n2\n260.066\nSn_sv_GW\n22\n4\ns\n2\n4\np\n6\n4\nd\n10\n5\ns\n2\n5\np\n2\n368.778\nSb_GW\n5\n5\ns\n2\n5\np\n3\n172.069\nSb_d_GW\n15\n4\nd\n10\n5\ns\n2\n5\np\n3\n263.1\nSb_sv_GW\n23\n4\ns\n2\n4\np\n6\n4\nd\n10\n5\ns\n2\n5\np\n3\n372.491\nTe_GW\n6\n5\ns\n2\n5\np\n4\n174.982\nTe_sv_GW\n24\n4\ns\n2\n4\np\n6\n4\nd\n10\n5\ns\n2\n5\np\n4\n376.618\nI_GW\n7\n5\ns\n2\n5\np\n5\n175.647\nI_sv_GW\n25\n4\ns\n2\n4\np\n6\n4\nd\n10\n5\ns\n2\n5\np\n5\n381.674\nXe_GW\n8\n5\ns\n2\n5\np\n6\n179.547\nXe_sv_GW\n26\n4\ns\n2\n4\np\n6\n4\nd\n10\n5\ns\n2\n5\np\n6\n400.476\nCs_sv_GW\n9\n5\ns\n2\n5\np\n6\n5\nd\n1\n198.101\nBa_sv_GW\n10\n5\ns\n2\n5\np\n6\n5\nd\n1\n6\ns\n1\n267.02\nLa_GW\n11\n4\nf\n0.2\n5\ns\n2\n5\np\n6\n5\nd\n0.8\n6\ns\n2\n313.688\nCe_GW\n12\n4\nf\n1\n5\ns\n2\n5\np\n6\n5\nd\n1\n6\ns\n2\n304.625\nHf_sv_GW\n12\n5\ns\n2\n5\np\n6\n5\nd\n4\n309.037\nTa_sv_GW\n13\n5\ns\n2\n5\np\n6\n5\nd\n5\n286.008\nW_sv_GW\n14\n5\ns\n2\n5\np\n6\n5\nd\n6\n317.132\nRe_sv_GW\n15\n5\ns\n2\n5\np\n6\n5\nd\n7\n317.012\nOs_sv_GW\n16\n5\ns\n2\n5\np\n6\n5\nd\n8\n319.773\nIr_sv_GW\n17\n5\ns\n2\n5\np\n6\n5\nd\n9\n319.843\nPt_GW\n10\n5\nd\n9\n6\ns\n1\n248.716\nPt_sv_GW\n18\n5\ns\n2\n5\np\n6\n5\nd\n10\n323.669\nAu_GW\n11\n5\nd\n10\n6\ns\n1\n248.344\nAu_sv_GW\n19\n5\ns\n2\n5\np\n6\n5\nd\n11\n306.658\nHg_sv_GW\n20\n5\ns\n2\n5\np\n6\n5\nd\n10\n6\ns\n2\n312.028\nTl_d_GW\n15\n5\ns\n2\n5\nd\n10\n6\ns\n2\n6\np\n1\n237.053\nTl_sv_GW\n21\n5\ns\n2\n5\np\n6\n5\nd\n10\n6\ns\n2\n6\np\n1\n316.583\nPb_d_GW\n16\n5\ns\n2\n5\nd\n10\n6\ns\n2\n6\np\n2\n237.809\nPb_sv_GW\n22\n5\ns\n2\n5\np\n6\n5\nd\n10\n6\ns\n2\n6\np\n2\n317.193\nBi_GW\n5\n6\ns\n2\n6\np\n3\n146.53\nBi_d_GW\n17\n5\ns\n2\n5\nd\n10\n6\ns\n2\n6\np\n3\n261.876\nBi_sv_GW\n23\n5\ns\n2\n5\np\n6\n5\nd\n10\n6\ns\n2\n6\np\n3\n323.513\nPo_d_GW\n18\n5\ns\n2\n5\nd\n10\n6\ns\n2\n6\np\n4\n267.847\nPo_sv_GW\n24\n5\ns\n2\n5\np\n6\n5\nd\n10\n6\ns\n2\n6\np\n4\n326.618\nAt_d_GW\n17\n5\nd\n10\n6\ns\n2\n6\np\n5\n266.251\nAt_sv_GW\n25\n5\ns\n2\n5\np\n6\n5\nd\n10\n6\ns\n2\n6\np\n5\n328.529\nRn_d_GW\n18\n5\nd\n10\n6\ns\n2\n6\np\n6\n267.347\nRn_sv_GW\n26\n5\ns\n2\n5\np\n6\n5\nd\n10\n6\ns\n2\n6\np\n6\n329.758\nSelecting a pseudopotential set\nGenerally, we recommend using the latest release of pseudopotentials.\nTip:\nFor compatibility reasons or to accurately reproduce another calculation, you might need to use another (older) pseudopotential release. Consult the list of\navailable pseudopotentials\n.\nHydrogen-like atoms with fractional valence\nTwelve hydrogen-like potentials are supplied for a valency between 0.25 and 1.75. Further potentials might become available, c.f.\navailable pseudopotentials\n. These are useful, e.g., to passivate dangling surface bonds.\nMind:\nThe\nPOTCAR\nfiles restrict the number of digits for the valency (typically 2, at most 3 digits). Therefor, using three H.33 potentials does yield 0.99 electrons and not 1.00 electron. This can cause undesirable hole- or electron-like states. Set the\nNELECT\ntag in the\nINCAR\nfile to correct the total number of electrons.\nFirst-row elements\nFor the 1st row elements B, C, N, O, and F, three potential versions exist, the plain one, a hard version, and a soft version. For most purposes, the standard version of PAW potentials is most appropriate. They yield reliable results for energy cutoffs between 325 and 400 eV, where 370-400 eV are required to predict vibrational properties accurately. Binding geometries and energy differences are already well reproduced at 325 eV. The typical bond-length errors for first row dimers (N\n2\n, CO, O\n2\n) are about 1% compared to more accurate DFT calculations. The\nhard pseudopotentials (_h)\ngive results that are essentially identical to the best DFT calculations presently available (FLAPW, or Gaussian with very large basis sets). The\nsoft potentials (_s)\nare optimized to work around 250-280 eV. They yield reliable description for most oxides, such as V\nx\nO\ny\n, TiO\n2\n, CeO\n2\n, but fail to describe some structural details in zeolites, i.e., cell parameters, and volume.\nFor Hartree-Fock (HF) and hybrid-functional calculations, we strictly recommend using the standard, standard GW, or hard potentials. For instance, the O_s potential can cause unacceptably large errors even in transition metal oxides. Generally, the soft potentials are less transferable from one exchange-correlation functional to another and often fail when the exact exchange needs to be calculated.\nTip:\nIf dimers with short bonds are present in the system (H\n2\nO, O\n2\n, CO, N\n2\n, F\n2\n, P\n2\n, S\n2\n, Cl\n2\n), we recommend using the _h potentials. Specifically, C_h, O_h, N_h, F_h, P_h, S_h, Cl_h, or their _GW counterparts. Otherwise, the standard version is often the best choice for first-row elements.\nAlkali and alkali-earth elements (simple metals)\nFor Li (and Be), a standard potential and a potential that treats the 1\ns\nshell as valence states are available (Li_sv, Be_sv). One should use the _sv potentials for many applications since their transferability is much higher than the standard potentials.\nFor the other alkali and alkali-earth elements, the semi-core\ns\nand\np\nstates should be treated as valence states as well. For lighter elements (Na-Ca), it is usually sufficient to treat the 2\np\nand 3\np\nstates as valence states (_pv), respectively. For Rb-Sr, the 4\ns\n, 4\np\n, and  5\ns\n, 5\np\nstates, must be treated as valence states (_sv).\nTip:\nFor alkali and alkali-earth metals, the _sv variants should be chosen, other than for very light elements Na, Mg, K, and Ca, where _pv is usually sufficient.\np-elements\nFor Ga, Ge, In, Sn, Tl-At, the lower-lying\nd\nstates should be treated as valence states (_d potential). For these elements, alternative potentials that treat the\nd\nstates as core states are also available but should be used with great care.\nd-elements\nFor the\nd\nelements, applies the same as for the alkali and earth-alkali metals: the semi-core\np\nstates and possibly the semi-core\ns\nstates should be treated as valence states. In most cases, however, reliable results can be obtained even if the semi-core states are kept frozen.\nWhen to switch from X_pv potentials to the X potentials depends on the required accuracy and the row for the 3\nd\nelements, even the Ti, V, and Cr potentials give reasonable results but should be used with uttermost care. 4\nd\nelements are the most problematic, and we advise using the X_pv potentials up to Tc_pv. For 5\nd\nelements the 5\np\nstates are rather strongly localized (below 3 Ry), since the 4\nf\nshell becomes filled. One can use the standard potentials starting from Hf, but we recommend performing test calculations. For some elements, X_sv potentials are available (,e.g., Nb_sv, Mo_sv, Hf_sv). These potentials usually have very similar energy cutoffs as the _pv potentials and can also be used. For HF-type and hybrid-functional calculations, we strongly recommend using the\n_sv and _pv\npotentials whenever possible.\nTip:\nAs a rule of thumb the\np\nstates should be treated as valence states for d-elements, if their eigenenergy\nϵ\n{\\displaystyle \\epsilon}\nlies above 3 Ry.\nf-elements\nDue to self-interaction errors,\nf\nelectrons are not handled well by the presently available density functionals. In particular, partially filled\nf\nstates are often incorrectly described. For instance, all\nf\nstates are pinned at the Fermi-level, leading to large overbinding for Pr-Eu and Tb-Yb. The errors are largest at quarter and three-quarter filling, e.g., Gd is handled reasonably well since 7 electrons occupy the majority\nf\nshell. These errors are DFT and not VASP related.\nParticularly problematic is the description of the transition from an itinerant (band-like) behavior observed at the beginning of each period to localized states towards the end of the period. For the 4\nf\nelements, this transition occurs already in La and Ce, whereas the transition sets in for Pu and Am for the 5\nf\nelements. A routine way to cope with the inabilities of present DFT functionals to describe the localized 4\nf\nelectrons is to place the 4\nf\nelectrons in the core. Such potentials are available and described below; however, they are expected to fail to describe magnetic properties arising\nf\norbitals. Furthermore, PAW potentials in which the\nf\nstates are treated as valence states are available, but these potentials are expected to fail to describe electronic properties when\nf\nelectrons are localized. In this case, one might treat electronic correlation effects more carefully, e.g., by employing hybrid functionals or introducing on-site Coulomb interaction.\nFor some elements,\nsoft versions (_s)\nare available as well. The semi-core\np\nstates are always treated as valence states, whereas the semi-core\ns\nstates are treated as valence states only in the standard potentials. For most applications (oxides, sulfides), the standard version should be used since the soft versions might result in\ns\nghost-states close to the Fermi-level (,e.g., Ce_s in ceria). The soft versions are, however, expected to be sufficiently accurate for calculations on intermetallic compounds.\nLanthanides with fixed valence\nIn addition, special GGA potentials are supplied for Ce-Lu, in which\nf\nelectrons are kept frozen in the core, which is an attempt to treat the localized nature of\nf\nelectrons. The number of f electrons in the core equals the total number of valence electrons minus the formal valency. For instance, according to the periodic table, Sm has a total of 8 valence electrons, i.e., 6\nf\nelectrons and 2\ns\nelectrons. In most compounds, Sm adopts a valency of 3; hence 5\nf\nelectrons are placed in the core when the pseudopotential is generated. The corresponding potential can be found in the directory Sm_3. The formal valency n is indicted by _n, where n is either 3 or 2. Ce_3 is, for instance, a Ce potential for trivalent Ce (for tetravalent Ce, the standard potential should be used).\nWarning:\nf\n-elements are notoriously hard to describe with DFT due to self-interaction errors in the strongly localized orbitals. Placing some, or all, 4\nf\nelectrons in the core can rectify this issue, but then the description of magnetism will fail and transferability will suffer.\nTip:\nIf you are not interested in 4\nf\n-magnetism, and know the valency of your lanthanide, use the _2 or _3 potentials.\nTest your setup\nEven if you have taken a lot of care to optimize your pseudopotential choice, it is always good to perform some test calculations with other potentials, if necessary on a small prototype system. You might realize that you need extra accuracy, or that you are leaving performance on the table by using unnecessarily hard\nPOTCARs\nfor your problem.\nRelated tags and sections\nPOTCAR\n,\nPrepare a POTCAR\n,\nAvailable pseudopotentials\nTheoretical background:\nPseudopotentials\n,\nProjector-augmented-wave formalism\nReferences\n↑\nEmanuele Bosoni, Louis Beal, Marnik Bercx, Peter Blaha, Stefan Blügel, Jens Bröder, Martin Callsen, Stefaan Cottenier, Augustin Degomme, Vladimir Dikan, Kristjan Eimre, Espen Flage-Larsen, Marco Fornari, Alberto Garcia, Luigi Genovese, Matteo Giantomassi, Sebastiaan P. Huber, Henning Janssen, Georg Kastlunger, Matthias Krack, Georg Kresse, Thomas D. Kühne, Kurt Lejaeghere, Georg K. H. Madsen, Martijn Marsman, Nicola Marzari, Gregor Michalicek, Hossein Mirhosseini, Tiziano M. A. Müller, Guido Petretto, Chris J. Pickard, Samuel Poncé, Gian-Marco Rignanese, Oleg Rubel, Thomas Ruh, Michael Sluydts, Danny E. P. Vanpoucke, Sudarshan Vijay, Michael Wolloch, Daniel Wortmann, Aliaksandr V. Yakutovich, Jusong Yu, Austin Zadoks, Bonan Zhu, Giovanni Pizzi,\nHow to verify the precision of density-functional-theory implementations via reproducible and universal workflows\n, Nat Rev Phys 6, 45–58 (2024).\n↑\nFor the potpaw_PBE.64 potential set,\nENMAX\nis on average ~26 eV (~11%) and\nEAUG\n~210 eV (~42%) larger for the GW potentials compared to their standard counterparts with the same valency."
  }, 
  "Computing the phonon dispersion and DOS": {
    "description": "This web page provides detailed step-by-step instructions for computing phonon dispersion relations and phonon density of states (DOS) using VASP, including methods for calculating force constants via finite differences or DFPT, handling polar materials with LO-TO splitting, and specifying dielectric properties for accurate phonon calculations.", 
    "detailed_description": "After computing the force constants using the\nfinite differences\nor\ndensity-functional-perturbation theory\n(DFPT) approaches, it is possible to compute the phonon dispersion relation as well as the phonon density of states (DOS).\nThis is accomplished by Fourier interpolating the interatomic force constants from a supercell calculation to the primitive cell.\nPhonon dispersion: Step-by-step instructions\nStep 1: Compute the force constants\nThere are two possible approaches for computing the force constants and then building the dynamical matrix:\nUsing\nfinite differences\nwith\nIBRION\n= 5, 6\n.\nUsing\nDFPT\nwith\nIBRION\n= 7, 8\n.\nThese calculations must be performed in a supercell so that the force constants vanish at large distances.\nImportant:\nThe phonon frequencies need to be converged with respect to the supercell size.\nStep 2: Provide\nq\n-points along a high-symmetry path\nCreate a\nQPOINTS\nfile containing a\nq\n-points path at which the phonon dispersion is computed.\nThis is accomplished using the\nline mode\nof the\nKPOINTS\n-file format.\nStep 3: Compute the phonon dispersion\nTo compute the phonon dispersion, set\nLPHON_DISPERSION\n= true\nin the\nINCAR\nfile.\nThe amount of information written to the\nOUTCAR\nfile can be tuned using the\nPHON_NWRITE\ntag.\nReading of force constants\nSteps 1-3 can be performed in one VASP calculation.\nHowever, generating the finite displacements in the supercell to compute force constants is time-consuming.\nIt is possible to skip that step by providing force constants from a previous run.\nRename the\nvaspout.h5\noutput file from the previous calculation to\nvaspin.h5\n, set\nLPHON_READ_FORCE_CONSTANTS\n= True\nLPHON_DISPERSION\n= True\nand provide a\nQPOINTS\nfile.\nPhonon DOS: Step-by-step instructions\nStep 1: Compute the force constants\nSame as\nabove\n.\nThis can be skipped by providing force constants in\nvaspin.h5\nand setting\nLPHON_READ_FORCE_CONSTANTS\n= True\n.\nStep 2: Specify a uniform\nq\n-point mesh\nCreate a\nQPOINTS\nfile that specifies a sufficiently dense, uniform\nq\n-point mesh.\nStep 3: Compute the DOS\nSet\nPHON_DOS\n> 0\nin the\nINCAR\nfile. The DOS is computed between\n[\nω\nmin\n−\n5\nσ\n,\nω\nmax\n+\n5\nσ\n]\n{\\displaystyle [\\omega_{\\text{min}}-5\\sigma,\\omega_{\\text{max}}+5\\sigma]}\nwith\nω\nmin\n{\\displaystyle \\omega_{\\text{min}}}\nand\nω\nmax\n{\\displaystyle \\omega_{\\text{max}}}\nthe lowest and highest phonon frequency and\nσ\n{\\displaystyle \\sigma}\nthe broadening (\nPHON_SIGMA\n).\nThe number of energy points in this energy range is specified by the\nPHON_NEDOS\ntag. To use a Gaussian-smearing method for the computation of the DOS set\nPHON_DOS\n= 1\nor to use the tetrahedron method set\nPHON_DOS\n= 2\n.\nPolar materials\nIf the material is polar, i.e., two or more atoms in the unit cell carry non-zero Born effective charge tensors, the long-range dipole-dipole interaction has to be treated by\nEwald summation\n.\nThis is achieved by setting\nLPHON_POLAR\n= True\n, supplying the static dielectric tensor (\nPHON_DIELECTRIC\n) and the Born-effective charges (\nPHON_BORN_CHARGES\n).\nThe values for these dielectric properties have to be obtained from a separate VASP calculation in the unit cell setting\nLEPSILON\nor\nLCALCEPS\n.\nImportant:\nMake sure to properly converge this unit-cell calculation with respect to the k-point mesh (\nKPOINTS\n) and the electronic cutoff energy (\nENCUT\n) since the optical phonon frequencies depend strongly on the dielectric properties.\nOptionally, specify a reciprocal space cutoff radius (\nPHON_G_CUTOFF\n) for the Ewald summation.\nObtaining the dielectric properties\nAfter a successful linear-response calculation using either\nLEPSILON\nor\nLCALCEPS\n, VASP writes the Born effective charge tensor and the ion-clamped static dielectric tensor to\nOUTCAR\n,\nvasprun.xml\nand\nvaspout.h5\n.\nMind:\nThe\nvaspout.h5\nfile is only available if VASP is compiled with\nHDF5 support\n.\nHere is an example output for a system consisting of two atoms per cell (MgO) in the\nOUTCAR\nfile:\nMACROSCOPIC STATIC DIELECTRIC TENSOR (including local field effects in DFT)\n------------------------------------------------------\n3.130368    -0.000000    -0.000000\n0.000000     3.130368     0.000000\n-0.000000     0.000000     3.130368\nand\nBORN EFFECTIVE CHARGES (including local field effects) (in |e|, cummulative output)\n---------------------------------------------------------------------------------\nion    1\n1     1.97026     0.00000    -0.00000\n2    -0.00000     1.97026     0.00000\n3    -0.00000     0.00000     1.97026\nion    2\n1    -1.97026    -0.00000     0.00000\n2     0.00000    -1.97026    -0.00000\n3     0.00000    -0.00000    -1.97026\nThe corresponding XML entries in the\nvasprun.xml\nfile can be queried with the following XPath queries:\n/modeling/calculation/array[@name=\"born_charges\"]\n/modeling/calculation/varray[@name=\"dielectric_dft\"]\nFinally, the same information is also available in the\nvaspout.h5\nbinary file at the following dataset locations:\nresults/born_charges/born_charges\nresults/dielectric/dielectric_dft\nSpecifying the dielectric properties as input\nOnce the Born effective charges and the ion-clamped static dielectric tensor have been retrieved, they need to be specified in the\nINCAR\nfile of the supercell calculation via their respective tags (\nPHON_BORN_CHARGES\nand\nPHON_DIELECTRIC\n).\nEach tensor is specified row by row as a list of real numbers.\nLine breaks can optionally be inserted using the \"\n\\\n\" character to improve readability.\nFor example, the values from the MgO calculation above could be specified as follows:\nPHON_DIELECTRIC = \\\n3.13036840     -0.00000000     -0.00000000 \\\n0.00000000      3.13036840      0.00000000 \\\n-0.00000000      0.00000000      3.13036840\nPHON_BORN_CHARGES = \\\n1.97025920     -0.00000000     -0.00000000 \\\n0.00000000      1.97025920      0.00000000 \\\n-0.00000000      0.00000000      1.97025920 \\\n\\\n-1.97025920      0.00000000      0.00000000 \\\n-0.00000000     -1.97025920     -0.00000000 \\\n0.00000000     -0.00000000     -1.97025920\nLO-TO splitting\nPhonon dispersion relation of MgO (rock-salt) comparing calculations with and without long-range (LR) dipole corrections. Notice the strong splitting of frequencies at the Γ-point.\nPhonon dispersion relation of AlN (wurtzite) comparing calculations with and without long-range (LR) dipole corrections. Notice the discontinuities around the Γ-point.\nAs described on the\ntheory page\n, the presence of long-range electrostatic interactions leads to the splitting of the longitudinal optical (LO) from the transverse optical (TO) phonon modes.\nOnce the required dielectric properties are provided and\nLPHON_POLAR\n= True\nis set, VASP automatically considers the long-range dipole-dipole contributions to the interatomic force constants for phonon calculations.\nTo illustrate the importance of long-range dipole corrections, we show two calculations of phonons in polar materials with strong LO-TO splitting.\nFirst is MgO, which forms an ionic rock-salt crystal structure (face-centered cubic).\nThe corresponding figure shows a comparison against a calculation that does not include the long-range dipole corrections.\nBoth calculations were performed in a\n4x4x4\nsupercell with only the Γ-point in the k-point mesh.\nIn the case of MgO, the magnitude of the LO-TO splitting is considerably large, on the same order of magnitude as the LO phonon frequencies.\nNotice also the improved smoothness of the phonon bands when long-range corrections are included.\nOtherwise the interpolation procedure is prone to overshooting, resulting in unwanted oscillations.\nThe second example is AlN in the hexagonal wurtzite structure.\nThis structure is less isotropic than the rock-salt structure of MgO.\nIn this case, the Born effective charges and dielectric constants associated with different spatial directions can be different.\nThe phonon frequencies obtained by including the long-range dipole corrections are therefore more dependent on the direction of the phonon wave vector,\nq\n{\\displaystyle \\mathbf{q}}\n.\nThis results in discontinuities around the Γ-point when\nq\n→\n0\n{\\displaystyle \\mathbf{q} \\to \\mathbf{0}}\n, as shown in the accompanying figure.\nRelated tags and articles\nQPOINTS\n,\nLPHON_DISPERSION\n,\nPHON_NWRITE\n,\nLPHON_POLAR\n,\nPHON_DIELECTRIC\n,\nPHON_BORN_CHARGES\n,\nPHON_G_CUTOFF"
  }, 
  "Computing the work function": {
    "description": "This web page explains how to compute the work function of a surface using Density Functional Theory (DFT) calculations with VASP, detailing the required inputs, best practices, and step-by-step procedures for accurate determination of the vacuum potential and Fermi energy.", 
    "detailed_description": "The work function is defined as the work needed to move an electron from a surface to a point in vacuum sufficiently far away from this surface.\nIt is a central quantity in surface science, vacuum science, catalysis, and other related fields as it characterizes a given surface; illustrating the presence of impurities, adsorbates, and possible surface reconstruction.\nIt is typically measured using surface science techniques such as thermionic emission, the Kelvin probe method, etc.\nIt has also served as an important measure in various theoretical models about metallic surfaces.\nOn this page, we describe how to compute the work function using outputs from a DFT calculation performed using VASP.\nWe detail best practices, required\nINCAR\ntags, and possible pitfalls.\nMind:\nThe work function is a property of a surface, not a bulk property. Hence, the content of this page only applies to systems with reduced dimensionality (such as surfaces), i.e., systems where there is expected to be a charge-density-free region in at least one direction of the cell.\nRequired quantities\nThe work function,\nΦ\n{\\textstyle \\Phi}\n, is computed using the expression,\nΦ\n=\ne\nϕ\nv\na\nc\nu\nu\nm\n−\nε\nF\n{\\displaystyle\n\\Phi = e\\phi_{\\mathrm{vacuum}} - \\varepsilon_{\\mathrm{F}}\n}\nwhere\nϕ\nv\na\nc\nu\nu\nm\n{\\textstyle \\phi_{\\mathrm{vacuum}}}\nis the vacuum potential, i.e., the potential sufficiently far away from a surface, such that if an electron were to be placed at this position, it would not feel the presence of the surface.\nε\nF\n{\\textstyle \\varepsilon_{F}}\nis the Fermi level of the surface, and\ne\n{\\textstyle e}\nis the charge on the electron (equal to 1 in atomic units).\nIn the next section, we describe how\nϕ\nv\na\nc\nu\nu\nm\n{\\textstyle \\phi_{\\mathrm{vacuum}}}\nand\nε\nF\n{\\textstyle \\varepsilon_{F}}\nare determined from the\nLOCPOT\nand\nOUTCAR\nfiles, respectively.\nStep-by-step instructions\nStep 1\n: Ensure that the chosen structure has a large enough atom-free, i.e., charge-density-free, and field-free region in the direction normal to the surface.\nA good rule of thumb is to center the atoms in your cell and have anywhere between 8–12 Å of vacuum on either side in this direction.\nWarning:\nAn insufficiently large vacuum region causes a field within the vacuum region and, thus, leads to inaccurate values of the vacuum potential (see point 3).\nStep 2\n: Perform a ground-state-DFT calculation. We suggest setting\nPREC\n=Accurate.\nIf your cell has a net dipole moment, (i.e., it is not symmetric along the direction of the surface normal),\nwe suggest switching on the dipole correction by using the following INCAR tags:\nLDIPOL\n,\nIDIPOL\n,\nDIPOL\n.\nThe use of the dipole correction is crucial to obtaining a flat field-free region in the potential (\nc.f\n. next point).\nIn addition to these tags, set the\nLVHAR\n=T to output only the Hartree and ionic potentials to the\nLOCPOT\nfile or set\nWRT_POTENTIAL\n=hartree ionic\nto store the potentials in the\nvaspout.h5\nfile.\nTip:\nWe recommend using only the Hartree and ionic potentials as the exchange-correlation potential decays very slowly in the vacuum region. Using the sum of the Hartree and ionic potentials allows for determining the work function with significantly less vacuum requirements (and hence lower computational cost).\nStep 3\n: Compute the vacuum potential.\nAverage the contents of the\nLOCPOT\nor the /results/potential/hartree and /results/potential/ionic datasets of the\nvaspout.h5\nfile along the lattice vectors of the surface, (i.e., both directions perpendicular to the surface normal).\nFind the field-free region by determining the region of space where the potential remains constant.\nThis value of the potential is the vacuum potential.\nTip:\nThere exist two vacuum potential regions, one for either direction of the surface normal. Depending on your system, one of the directions may be more relevant than another.\nStep 3b\n: Alternatively, VASP can compute the vacuum potential when you set\nLVACPOTAV\n=T in the INCAR file.\nYou can then\ngrep\nfor the output in the\nOUTCAR\nfile\ngrep upper OUTCAR\nwhich gives the following example output:\nvacuum level on the upper side and lower side of the slab         8.049         7.778\nStep 4\n: Determine the Fermi energy.\nThe Fermi energy is written directly to the\nOUTCAR\nfile.\ngrep\nfor the following lines in the\nOUTCAR\nto get the Fermi energy in eV.\ngrep \"Fermi energy\" OUTCAR\nExample\nVacuum potential referenced to the Fermi energy plotted against the distance along the surface normal. Insets to the figure show the work function for (red) a clean Pt(111) surface (blue) Pt(111) with a carbon atom adsorbed on only one surface termination (atom center ~15 Å on the\nx\naxis).\nConsider an example of a carbon atom adsorbed on an\nfcc\n-Pt(111) surface. The structure of such a system is\nPt16C\n1.0000000000000000\n5.5437171645025325    0.0000000000000000    0.0000000000000000\n0.0000000000000000    4.8009998958550284    0.0000000000000000\n0.0000000000000000    0.0000000000000000   20.0000000000000000\nPt C\n16 1\nDirect\n0.1250000000000000    0.0833333333333334    0.3302590208582500\n0.6250000000000000    0.0833333333333334    0.3302590208582500\n0.3749999999999999    0.5833333333333334    0.3302590208582500\n0.8750000000000001    0.5833333333333334    0.3302590208582500\n0.3749999999999999    0.2500000000000000    0.4434196736194167\n0.8750000000000001    0.2500000000000000    0.4434196736194167\n0.1250000000000000    0.7500000000000000    0.4434196736194167\n0.6250000000000000    0.7500000000000000    0.4434196736194167\n0.1250000000000000    0.4166666666666667    0.5565803263805833\n0.6250000000000000    0.4166666666666667    0.5565803263805833\n0.3749999999999999    0.9166666666666666    0.5565803263805833\n0.8750000000000001    0.9166666666666666    0.5565803263805833\n0.1250000000000000    0.0833333333333334    0.6697409791417500\n0.6250000000000000    0.0833333333333334    0.6697409791417500\n0.3749999999999999    0.5833333333333334    0.6697409791417500\n0.8750000000000001    0.5833333333333334    0.6697409791417500\n0.0000000000000000    0.0000000000000000    0.7597409791417501\nThe bottom and top surfaces are not identical: one is clean, and the other has carbon adsorbed on it. Since the system has a net dipole moment, we need to use the dipole correction in our calculation.\nAn example\nINCAR\nfile for this system is,\nLDIPOL\n= T\nIDIPOL\n= 3\nDIPOL\n= 0.5 0.5 0.5\nLVHAR\n= T\nPREC\n= Accurate\nThe Figure to the right shows a representative example of the vacuum potential obtained by averaging the contents of\nLOCPOT\n.\nThis potential is referenced to the Fermi energy and is plotted against the distance along the surface normal (\nx\naxis) for two systems,\nfcc\nPt(111) surface (in blue) and Pt(111) surface with a carbon atom adsorbed on one surface termination (Pt(111)-C*).\nThe vacuum potentials are flat, (i.e., constant), on either side (magnified in insets).\nThe work function on either side of the slab is annotated in the insets as\nΦ\n{\\textstyle \\Phi}\n. It is equal for both sides of the clean slab but slightly higher for the case of Pt(111)-C*.\nRelated tags and articles\nLOCPOT\n,\nLDIPOL\n,\nIDIPOL\n,\nDIPOL\n,\nLVHAR\n,\nWRT_POTENTIAL"
  }, 
  "Constrained molecular dynamics calculations": {
    "description": "Geometric constraints can be applied in NVT or NpT molecular dynamics simulations using the ICONST file with STATUS=0 entries, and can be combined with restraints, bias potentials, and other features, though lattice vector constraints are not allowed in NVT simulations.", 
    "detailed_description": "Geometric constraints are introduced by defining one or more entries with the STATUS parameter set to 0 in the\nICONST\n-file. Constraints can be used within a standard NVT or NpT MD setting introduced by\nMDALGO\n=1|2|3. Note that fixing geometric parameters related to lattice vectors is not allowed within an NVT simulation (VASP would terminate with an error message). Constraints can be combined with restraints, time-dependent bias potentials (\nMetadynamics\n), monitored coordinates and other elements available within the context of MD."
  }, 
  "Constructing Wannier orbitals": {
    "description": "This web page explains the concept and application of Wannier orbitals in studying chemical bonding and electronic structure, focusing on the Wannierization process using VASP through methods like LOCPROJ and SCDM, and detailing how to generate and orthonormalize Wannier functions using singular-value decomposition for accurate electronic band structure interpolation.", 
    "detailed_description": "Wannier orbitals\nare an important tool to study chemical bonding.\nThey also form the basis of various interpolation techniques.\nAs a quick summary, a Wannier orbital\n|\nw\nm\nR\n⟩\n{\\displaystyle |w_{m\\mathbf{R}}\\rangle}\nis a function obtained from a linear combination of the Bloch (Kohn-Sham) orbitals\n|\nψ\nn\nk\n⟩\n{\\displaystyle |\\psi_{n\\mathbf{k}}\\rangle}\n:\n|\nw\nm\nR\n⟩\n=\n∑\nn\nk\ne\n−\ni\nk\n⋅\nR\nU\nm\nn\nk\n|\nψ\nn\nk\n⟩\n,\n{\\displaystyle\n|w_{m\\mathbf{R}}\\rangle =\n\\sum_{n\\mathbf{k}}\ne^{-i\\mathbf{k}\\cdot\\mathbf{R}}\nU_{mn\\mathbf{k}}\n|\\psi_{n\\mathbf{k}}\\rangle,\n}\nwhere the unitary matrix\nU\nm\nn\nk\n{\\displaystyle U_{mn\\mathbf{k}}}\nis chosen such that the Wannier orbitals are localized in real space.\nThe process of finding a suitable Wannier transformation matrix\nU\nm\nn\nk\n{\\displaystyle U_{mn\\mathbf{k}}}\nis known as Wannierization.\nThis page guides you through the steps required to perform Wannierization using the approaches available in VASP.\nOne-shot Wannierization using a singular-value decomposition\nThe two main Wannierization methods are projections onto local functions using the\nLOCPROJ\ntag and the Selected-Columns-of-the-Density-Matrix (SCDM) method using the\nLSCDM\ntag.\nThe\nLOCPROJ\napproach offers fine-grained control over the Wannierization process but is also more involved for electronically complex systems.\nIn this case, projection targets have to be chosen and placed manually using the\nLOCPROJ\ntag.\nIn contrast, the SCDM approach offers very little control and instead generates Wannier orbitals automatically from a small set of input parameters\n[1]\n.\nThis is convenient for systems where the electronic character of the band structure is complicated or unknown.\nBoth approaches produce as output a matrix\nA\nm\nn\nk\n{\\displaystyle A_{mn \\mathbf{k}}}\n.\nIn the case of the\nLOCPROJ\ntag, this is the projection matrix between the Bloch orbitals and the local functions,\nβ\nm\n{\\displaystyle \\beta_m}\n:\nA\nm\nn\n,\nk\n≡\n⟨\nβ\nm\n|\nS\n~\n|\nΨ\nn\nk\n⟩\n.\n{\\displaystyle\nA_{mn, \\bf{k}} \\equiv \\langle \\beta_m | \\tilde{S} | \\Psi_{n \\bf{k}} \\rangle.\n}\nThe operator\nS\n~\n{\\displaystyle \\tilde{S}}\nis the overlap operator in the\nprojector-augmented-wave method\n.\nIn the case of the SCDM method, the matrix\nA\nm\nn\nk\n{\\displaystyle A_{mn \\mathbf{k}}}\nis the result of an iterative process that extracts local functions from the information contained in the electronic one-particle density matrix.\nIn general,\nA\nm\nn\nk\n{\\displaystyle A_{mn \\mathbf{k}}}\nis not going to be a unitary matrix.\nIt could, in principle, be used to transform the Bloch orbitals into a set of non-orthogonal Wannier orbitals.\nHowever, for many applications, it is desirable to have orthonormal Wannier orbitals, such as for Wannier interpolation.\nTherefore,\nA\nm\nn\nk\n{\\displaystyle A_{mn \\mathbf{k}}}\nneeds first to be orthonormalized.\nIn VASP, we employ a one-shot orthonormalization procedure that uses the\nsingular-value decomposition\n(SVD) of\nA\nm\nn\nk\n{\\displaystyle A_{mn \\mathbf{k}}}\n:\nA\nm\nn\nk\n=\n[\nD\nΣ\nV\n†\n]\nm\nn\nk\n,\n{\\displaystyle\nA_{mn\\mathbf{k}} = [D \\Sigma V^\\dagger]_{mn\\mathbf{k}},\n}\nwhich is then used to construct the unitary matrix\nU\nm\nn\nk\n{\\displaystyle U_{mn \\mathbf{k}}}\n:\nU\nm\nn\nk\n=\n[\nD\nV\n†\n]\nm\nn\nk\n.\n{\\displaystyle\nU_{mn\\mathbf{k}} = [DV^\\dagger]_{mn\\mathbf{k}}.\n}\nIn contrast to iterative methods (e.g., Gram-Schmidt orthogonalization), the SVD orthogonalization operates simultaneously on all local functions.\nThis ensures that the symmetry properties of the local functions encoded in\nA\nm\nn\nk\n{\\displaystyle A_{mn \\mathbf{k}}}\nare preserved during the orthonormalization procedure.\nLOCPROJ method\nTo generate Wannier orbitals using local projections, it is sufficient to specify the\nLOCPROJ\ntag with suitable projection targets.\nVASP will then apply the\none-shot orthonormalization\ninternally to obtain the Wannier transformation matrix\nU\nm\nn\nk\n{\\displaystyle U_{mn\\mathbf{k}}}\n.\nThe number of Wannier orbitals is the same as the total number of local functions.\nTip:\nYou can write the Wannier transformation matrix to disk by setting\nLWRITE_WANPROJ\n= true\n.\nThis information can then be used to perform Wannier interpolation of the electronic band structure (for example, using the\nKPOINTS_WAN\nfile).\nIt can also be passed to\nWannier90\n(more on that\nlater\n).\nTo find a good representation of the electronic band structure in terms of Wannier orbitals, it is important to choose suitable projection targets.\nIn general, this can be a difficult task as some bands hybridize and disperse, changing electronic character as a function of the Bloch vector\nk\n{\\displaystyle \\mathbf{k}}\n.\nIt is thus expedient to understand the relevant electronic bands before attempting a Wannierization using\nLOCPROJ\n.\nTo gain insight into the electronic character of certain bands, you can use the\nLORBIT\ntag.\nThis decomposes the bands into local contributions either in terms of spherical harmonics (\nLORBIT\n< 10\n) or in terms of PAW projector functions (\nLORBIT\n≥ 10\n).\nThe relevant information is written to the\nPROCAR\nfile and can be used to determine suitable projection targets for\nLOCPROJ\n.\nExample - diamond\nLet us examine a small example to highlight the procedure of determining projection targets.\nHere, we aim to Wannierize the four highest-lying valence bands of diamond.\nThis is a group of bands that is energetically isolated (they are surrounded by band gaps).\nSince there is no mixing with any other states, the Wannierization process of these four bands is relatively simple.\nWith the standard C POTCAR distributed with VASP, we can conveniently set\nNBANDS\n= 4\nto only consider those states.\nFirst, let us run a calculation with\nLORBIT\n= 1\nand\nRWIGS\n= 1.1\n.\nThis decomposes the bands into\nl\n{\\displaystyle l}\nand\nm\n{\\displaystyle m}\nquantum numbers in terms of spherical harmonics.\nWe get information on each k-point in the\nPROCAR\nfile.\nHere is the start of the file, which contains information about the Γ-point:\nPROCAR lm decomposed\n# of k-points:    8         # of bands:    4         # of ions:    2\nk-point     1 :    0.00000000 0.00000000 0.00000000     weight = 0.01562500\nband     1 # energy  -11.73066124 # occ.  2.00000000\nion      s     py     pz     px    dxy    dyz    dz2    dxz  x2-y2    tot\n1  0.508  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.508\n2  0.508  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.508\ntot    1.016  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  1.016\nband     2 # energy    9.78016466 # occ.  2.00000000\nion      s     py     pz     px    dxy    dyz    dz2    dxz  x2-y2    tot\n1  0.000  0.173  0.173  0.173  0.032  0.032  0.000  0.032  0.000  0.613\n2  0.000  0.173  0.173  0.173  0.032  0.032  0.000  0.032  0.000  0.613\ntot    0.000  0.346  0.345  0.346  0.063  0.063  0.000  0.063  0.000  1.226\nband     3 # energy    9.78126079 # occ.  2.00000000\nion      s     py     pz     px    dxy    dyz    dz2    dxz  x2-y2    tot\n1  0.000  0.305  0.011  0.202  0.002  0.037  0.000  0.056  0.000  0.613\n2  0.000  0.305  0.011  0.202  0.002  0.037  0.000  0.056  0.000  0.613\ntot    0.000  0.610  0.023  0.404  0.004  0.074  0.000  0.112  0.000  1.226\nband     4 # energy    9.78126093 # occ.  2.00000000\nion      s     py     pz     px    dxy    dyz    dz2    dxz  x2-y2    tot\n1  0.000  0.041  0.334  0.143  0.061  0.026  0.000  0.007  0.000  0.613\n2  0.000  0.041  0.334  0.143  0.061  0.026  0.000  0.007  0.000  0.613\ntot    0.000  0.081  0.668  0.287  0.122  0.052  0.000  0.015  0.000  1.226\nFrom this, we learn that the four valence bands are predominantly s-like and p-like (make sure that this is true also at the other k-points).\nThis was to be expected since carbon forms hybridized sp-3 bonds in diamond.\nWith this information, we can now specify projection targets.\nWe seek to map the four bands in the simulation to four Wannier orbitals, so we choose to setup four sp-3 hybrids on one atom.\nThe minimal INCAR file used in this example looks like this:\nISMEAR\n= 0                   ! use Gaussian smearing for insulator\nSIGMA\n= 0.01                 ! use small smearing\nNBANDS\n= 4                   ! use only 4 bands\nLOCPROJ\n= 1 : sp3 : Hy 1 4.  ! ... to map onto 4 sp-3 functions\nThe last part of the\nLOCPROJ\nsetting (\nHy 1 4.\n) specifies that we want Hydrogen-like atomic orbitals (spherical harmonics) with main quantum number\nn\n=\n1\n{\\displaystyle n = 1}\nand a diffusivity of\nα\n=\n4\n{\\displaystyle \\alpha = 4}\n.\nThe diffusivity influences the spread of the local function.\nA higher value generally results in a higher degree of localization.\nThis is beneficial for Wannier interpolation and yields Wannier orbitals of higher quality in that regard.\nTip:\nYou may also choose to use the PAW information to specify local orbitals with\nLOCPROJ\n. In this case, you should use\nLORBIT\n= 11\nto extract the relevant information from the basis.\nFor this example calculation, we use a relatively course Γ-centered regular mesh of\n4x4x4\nk-points.\nTo gauge the quality of the generated Wannier orbitals, we can plot the electronic band structure using Wannier interpolation and compare it against the ab-initio data.\nAs of VASP 6.3.0, this can conveniently be done all in one run by providing the\nKPOINTS_OPT\nand the\nKPOINTS_WAN\nfile.\nThese files are automatically read from disk and provide a way to calculate the electronic eigenvalues at specific k-points.\nKPOINTS_OPT\n: Charge density is kept fixed and the Hamiltonian is diagonalized at each provided k-point.\nKPOINTS_WAN\n: Hamiltonian is constructed, interpolated and diagonalized using the Wannier orbitals.\nImportantly, these k-points can be different from those specified in the\nKPOINTS\nfile.\nHere, we specify a k-point path through the first Brillouin zone using the\nline mode\nfor both files.\nThe results can then be read from the\nvaspout.h5\nat the following locations:\nresults/electron_eigenvalues_kpoints_opt/\nresults/electron_eigenvalues_kpoints_wan/\nThe results can be seen in the following band-structure plot:\nElectronic band structure of diamond. Comparison between ab-initio data and Wannier interpolation using LOCPROJ method.\nThe agreement between both methods is already very good.\nThe remaining differences can be systematically decreased by increasing the k-point density in the initial\nKPOINTS\nfile or by choosing a more suitable local basis.\nSCDM method\nIn contrast to the\nLOCPROJ\nmethod, the SCDM method does not rely on the specification of a local basis.\nTo activate the SCDM method, set\nLSCDM\n= true\n.\nThis will use the information contained in the electronic one-particle density matrix to construct localized functions from the original Bloch (Kohn-Sham) orbitals.\nThese localized functions are then orthonormalized using the\none-shot SVD approach\nto obtain orthonormal Wannier orbitals.\nThe number of Wannier orbitals obtained is controlled via the\nNUM_WANN\ntag.\nMind:\nYou must ensure that\nNUM_WANN\n≤\nNBANDS\nin order to have enough information to construct the Wannier orbitals.\nExample - diamond\nLet us repeat the example calculation\nshown earlier\nto obtain Wannier orbitals in diamond using the SCDM method.\nOnce again, we choose\nNBANDS\n= 4\nand we set\nNUM_WANN\n= 4\nas well.\nThe minimal\nINCAR\nfile for this example looks like this:\nISMEAR\n= 0      ! use Gaussian smearing for insulator\nSIGMA\n= 0.01    ! use small smearing\nNBANDS\n= 4      ! use only 4 bands\nNUM_WANN\n= 4    ! ... to map onto 4 Wannier orbitals\nLSCDM\n= true    ! ... using the SCDM method\nFor this example calculation, we use the same course Γ-centered regular mesh of\n4x4x4\nk-points as before.\nWe also specify the same k-point path for\nKPOINTS_OPT\nand\nKPOINTS_WAN\nto perform band-structure calculations.\nThe results can be seen in the following band-structure plot:\nElectronic band structure of diamond. Comparison between ab-initio data and Wannier interpolation using SCDM method.\nAlso in this case, the agreement between both methods is very good.\nComparison with LOCPROJ\nThe diamond example shows that a Wannierization of good quality can be achieved with both the\nLOCPROJ\nas well as the SCDM approach.\nHowever, the bands considered in that example are fully isolated from the rest of the band structure and their electronic character is well known.\nIn general, finding suitable projection targets can be a difficult and arduous task.\nThis is where the more automatic SCDM method has a clear advantage over the\nLOCPROJ\napproach.\nThe SCDM method extracts the electronic character of the bands directly from the density matrix.\nOn the other hand, the\nLOCPROJ\napproach requires the user to have a good understanding of the band structure of the material.\nHowever, specifying local functions via\nLOCPROJ\nalso has advantages over the SCDM method.\nFirst, there is very little control over the orbitals that the SCDM method generates because the number of calculational parameters is so small.\nThis can be undesirable if the location, shape or symmetry of the Wannier orbital is important.\nWith\nLOCPROJ\n, you can choose the kind of orbital much more freely, for example, to study chemical bonding.\nSecond, SCDM orbitals do not generally obey the same symmetries as the crystal or as molecular bonds.\nThis is because the SCDM procedure employs an iterative scheme for choosing \"optimal\" localized functions one after the other (this is based on a rank-revealing QR decomposition).\nAs such, orbitals that should be symmetrically equivalent such as the hybridized\nsp-3\norbitals in the case of diamond end up being slightly different from each other.\nConsequently, the Wannier interpolation of the electronic band structure using SCDM orbitals will not be able to perfectly reproduce degeneracies since the underlying symmetries are broken.\nUsually, this difference is comparatively small but it is something to keep in mind.\nDisentanglement\nWhen\nNBANDS\n>\nNUM_WANN\nor when the bands are not energetically isolated, Wannierization becomes more involved.\nThe difficulty lies in determining which electronic states to select when transforming the initial Bloch orbitals to the Wannier orbitals.\nThis process is known as disentanglement.\nWhen using the\nLOCPROJ\nor SCDM methods, disentanglement can be achieved by applying a smooth cutoff or weight function to the electronic states during the Wannierization process.\nLoosely speaking, electronic states with a larger weight will be fitted more accurately.\nIn VASP, we currently support three types of cutoff functions that can be selected via\nCUTOFF_TYPE\n,\nerfc\n,\ngaussian\nand\nfermi\n.\nThe tags\nCUTOFF_MU\nand\nCUTOFF_SIGMA\ncontrol the position,\nμ\n{\\displaystyle \\mu}\n, and width,\nσ\n{\\displaystyle \\sigma}\n, of these cutoff functions, respectively.\nThe complementary error function and Fermi function are particularly useful in scenarios where the band structure does not have a gap above the relevant energies, such as in metals.\nThe Gaussian function is useful for extracting a Wannier representation from a group of bands that is not surrounded by any gaps, below or above.\nExample - SCDM Wannierization of LiF\nElectronic band structure of LiF. Comparison between ab-initio data and Wannier interpolation using SCDM method.\nLiF is an insulator with a wide band gap.\nThe Wannierization of the valence states in isolation is as simple as shown\nearlier\n.\nHowever, the lowest-lying conduction states are relatively dispersive and hybridize with higher-lying states.\nThis renders the Wannierization of these conduction bands difficult without disentanglement.\nTo obtain the lowest lying conduction bands of LiF, we choose the\nerfc\ncutoff function with an appropriate\nμ\n{\\displaystyle \\mu}\nand\nσ\n{\\displaystyle \\sigma}\n.\nBy default, VASP chooses reasonable default values for these parameters.\nHowever, in order to get a good Wannier fit of the band structure, both\nμ\n{\\displaystyle \\mu}\nand\nσ\n{\\displaystyle \\sigma}\nshould be chosen carefully by the user through trial and error.\nAs a rule of thumb, the smooth edge of the complementary error function should be positioned such that states below it are to be fitted more accurately.\nFor this example, we have chosen\nμ\n=\n10\neV\n{\\displaystyle \\mu = 10 \\text{eV}}\nand\nσ\n=\n0.1\neV\n{\\displaystyle \\sigma = 0.1 \\text{eV}}\n, which places the edge of the cutoff function amidst the lowest-lying conduction bands with a relatively sharp edge.\nThe minimal\nINCAR\nfile for this example is provided below:\nISMEAR\n= 0           ! use Gaussian smearing for insulator\nSIGMA\n= 0.01         ! use small smearing\nNBANDS\n= 16          ! use 16 bands, including unoccupied states\nNUM_WANN\n= 9         ! ... to map to 9 Wannier orbitals\nLSCDM\n= true         ! ... using the SCDM method\nCUTOFF_TYPE\n= erfc   ! choose erfc cutoff function\nCUTOFF_MU\n= 10       ! ... and place it at 10 eV\nCUTOFF_SIGMA\n= 0.1   ! ... with a width of 0.1 eV\nThe initial k-point mesh is chosen to be\n8x8x8\nΓ-centered.\nThe Wannier-interpolated band structure compares favorably against the ab-initio data below\nμ\n{\\displaystyle \\mu}\nand starts to diverge from it more and more above\nμ\n{\\displaystyle \\mu}\n.\nThis is a general trend with these kinds of calculations and is an unavoidable side effect of the disentanglement procedure.\nThe alternative would be a much higher and sharper cutoff that requires more Wannier states to be constructed.\nThis is however not generally advisable as it can negatively affect the quality of the Wannierization.\nTip:\nA hard cutoff can be achieved by specifying a tiny\nCUTOFF_SIGMA\n.\nMind:\nThe quality of the Wannierization can depend strongly on the choice of\nCUTOFF_MU\nand\nCUTOFF_SIGMA\n. It will often take some trial and error to find reasonable parameters.\nWannier90\nWannier orbitals obtained inside VASP via the\nLOCPROJ\nor SCDM methods can be passed to\nWannier90\nfor further processing.\nWannier90 employs an iterative algorithm that generates so-called maximally-localized Wannier functions (MLWF).\nMLWFs are usually superior in terms of quality for band structure calculations.\nHowever, even though they are generated from an iterative procedure, Wannier90 still relies on good first guesses for the localized functions.\nThis is where the SCDM method can provide a suitable set of initial functions for the MLWF procedure.\nIn the case of the\nLOCPROJ\ntag, the projection matrix\nA\nm\nn\nk\n{\\displaystyle A_{mn\\mathbf{k}}}\nis passed directly to Wannier90 where the Wannier transformation is constructed.\nVASP handles the communication of the projection targets and matrix dimensions automatically.\nTo generate MLWFs from VASP orbitals, you can add the following lines to your\nINCAR\nfile:\nLWANNIER90\n= true   # or lwannier90_run = true\nWANNIER90_WIN\n= \"\ndis_num_iter = 100\nnum_iter = 100\n\"\nwhere\ndis_num_iter\nspecifies the number of iteration during Wannier90's disentanglement procedure and\nnum_iter\nthe number of iteration during the MLWF procedure.\nImportant:\nMake sure that VASP is compiled with the\nVASP2WANNIER90\nprecompiler option.\nImportant:\nWhen using the SCDM method together with Wannier90, it is recommended to set\ndis_num_iter = 0\nvia\nWANNIER90_WIN\nor in the Wannier90 input file.\nLWANNIER90\nactivates the interface between VASP and Wannier90 and writes a\nwannier90.win\ninput file that can then be read by Wannier90.\nIn addition to the basic input parameters, VASP also writes the overlap matrices\nM\nm\nn\n{\\displaystyle M_{mn}}\nand\nA\nm\nn\n{\\displaystyle A_{mn}}\nto the corresponding files,\nwannier90.mmn\nand\nwannier90.amn\n.\nM\nm\nn\n{\\displaystyle M_{mn}}\ncontains the overlaps between all pairs of Bloch orbitals.\nMeanwhile,\nA\nm\nn\n{\\displaystyle A_{mn}}\ncontains the overlaps between the Bloch orbitals and the projection targets (in this case, the SCDM orbitals obtained from VASP).\nTip:\nThe\nwannier90.mmn\nand\nwannier90.amn\nfiles can be explicitly written via\nLWRITE_MMN_AMN\n= true\n. This is switched on by default when\nLWANNIER90\n= true\n. It is unnecessary to write these files when\nLWANNIER90_RUN\n= true\nas they are directly passed to Wannier90.\nRun VASP with the above\nINCAR\ntags to generate Wannier orbitals via SCDM or\nLOCPROJ\nand to generate the required Wannier90 input files.\nAfterwards, run Wannier90 to generate MLWFs (all of this can be done in one run when setting\nLWANNIER90_RUN\n= true\n).\nAt this point, you can use the functionality available in Wannier90 to plot the band structure, the orbitals, etc.\nWhen plotting orbitals using Wannier90, in addition to\nLWRITE_MMN_AMN\n= true\n, it may also be necessary to set\nLWRITE_UNK\n= true\n.\nThis writes the cell-periodic part of the Bloch orbitals to disk.\nRelated tags and articles\nLSCDM\n,\nLOCPROJ\n,\nCUTOFF_TYPE\n,\nCUTOFF_MU\n,\nCUTOFF_SIGMA\nReferences\n↑\nA. Damle and L. Lin, Multiscale Model. Simul.,\n16(3)\n, 1392–1410 (2018)."
  }, 
  "DDsC dispersion correction": {
    "description": "The dDsC method is a density-dependent dispersion correction for DFT calculations that accounts for variations in van der Waals contributions based on the local chemical environment, using charge-density dependent dispersion coefficients and damping functions within the framework of the exchange-hole dipole moment formalism.", 
    "detailed_description": "The expression for the density-dependent energy correction dDsC\n[1]\n[2]\nis very similar to that of the\nDFT-D2\nmethod (see the equation for\nE\nd\ni\ns\np\n{\\displaystyle E_{disp}}\nfor the\nDFT-D2\nmethod). The important difference is, however, that the dispersion coefficients and damping function are charge-density dependent. The dDsC method is therefore able to take into account variations in the vdW contributions of atoms due to their local chemical environment. In this method, polarizability, dispersion coefficients, charge and charge-overlap of an atom in a molecule or solid are computed in the basis of a simplified exchange-hole dipole moment formalism\n[1]\npioneered by Becke and Johnson\n[3]\n.\nThe dDsC dispersion energy is expressed as follows:\nE\nd\ni\ns\np\n=\n−\n∑\ni\n=\n2\nN\na\nt\n∑\nj\n=\n1\ni\n−\n1\n∑\nn\n=\n3\nn\n=\n5\nf\n2\nn\n(\nb\nR\ni\nj\n)\nC\n2\nn\ni\nj\nR\ni\nj\n2\nn\nE\nd\ni\ns\np\n=\n−\n∑\ni\n=\n2\nN\na\nt\n∑\nj\n=\n1\ni\n−\n1\nf\n6\n(\nb\nR\ni\nj\n)\nC\n6\n,\ni\nj\nR\ni\nj\n6\n{\\displaystyle {{E}_{\\mathrm{disp}}}=-\\sum\\limits_{i=2}^{{{N}_\\mathrm{at}}}{\\sum\\limits_{j=1}^{i-1}\\sum\\limits_{n=3}^{n=5}{{{f}_{2n}}(b{{R}_{ij}})\\frac{C_{2n}^{ij}}{R_{ij}^{2n}}}}\n{{E}_{\\mathrm{disp}}}=-\\sum\\limits_{i=2}^{{{N}_{\\mathrm{at}}}}{\\sum\\limits_{j=1}^{i-1}\n{{{f}_{6}}(b{{R}_{ij}})\\frac{C_{6,ij}}{R_{ij}^{6}}}} }\nwhere\nN\na\nt\n{\\displaystyle N_{\\mathrm{at}}}\nis the number of atoms in the system and\nb\n{\\displaystyle b}\nis the Tang and Toennies (TT) damping factor. The damping function\nf\n6\n(\nb\nR\ni\nj\n)\n{\\displaystyle f_{6}(bR_{ij})}\nis defined as follows:\nf\n6\n(\nx\n)\n=\n1\n−\nexp\n⁡\n(\n−\nx\n)\n∑\nk\n=\n0\n6\nx\nk\nk\n!\n{\\displaystyle f_{6}(x)=1-\\exp(-x)\\sum^{6}_{k=0}\\frac{x^k}{k!}}\nand its role is to attenuate the correction at short internuclear distances. A key component of the dDsC method is the damping factor\nb\n{\\displaystyle b}\n:\nb\n(\nx\n)\n=\n2\nb\ni\nj\n,\na\ns\ny\nm\ne\na\n0\n⋅\nx\n+\n1\n{\\displaystyle b(x)=\\frac{2 b_{ij,\\mathrm{asym}}}{{{e}^{{{a}_{0}}\\cdot x}}+1} }\nwhere the fitted parameter\na\n0\n{\\displaystyle a_{0}}\ncontrols the short-range behaviour and\nx\n{\\displaystyle x}\nis the damping argument for the TT-damping factor associated with two separated atoms (\nb\ni\nj\n,\na\ns\ny\nm\n{\\displaystyle b_{ij,\\mathrm{asym}}}\n).\nThe term\nb\ni\nj\n,\na\ns\ny\nm\n{\\displaystyle b_{ij,\\mathrm{asym}}}\nis computed according to the combination rule:\nb\ni\nj\n,\na\ns\ny\nm\n=\n2\nb\ni\ni\n,\na\ns\ny\nm\n⋅\nb\nj\nj\n,\na\ns\ny\nm\nb\ni\ni\n,\na\ns\ny\nm\n+\nb\nj\nj\n,\na\ns\ny\nm\n{\\displaystyle b_{ij,\\mathrm{asym}}=2\\frac{b_{ii,\\mathrm{asym}}\\cdot b_{jj,\\mathrm{asym}}}{b_{ii,\\mathrm{asym}} + b_{jj,\\mathrm{asym}}} }\nwith\nb\ni\ni\n,\na\ns\ny\nm\n{\\displaystyle b_{ii,\\mathrm{asym}}}\nbeing estimated from  effective atomic polarizabilities:\nb\ni\ni\n,\na\ns\ny\nm\n=\nb\n0\n⋅\n1\nα\ni\n3\n{\\displaystyle {b}_{ii,\\mathrm{asym}}={b}_{0}\\cdot \\sqrt[3]{\\frac{1}{\\alpha_{i}}}}\nThe effective atom-in-molecule polarizabilities\nα\ni\n{\\displaystyle \\alpha_{i}}\nare computed from the tabulated free-atomic polarizabilities (available for the elements of the first six rows of the periodic table except of lanthanides) in the same way as in the\nTkatchenko-Scheffler method\nand\nTkatchenko-Scheffler method with iterative Hirshfeld partitioning\n, but the Hirshfeld-dominant instead of the conventional Hirshfeld partitioning is used.\nThe last element of the correction is the damping argument\nx\n{\\displaystyle x}\n:\nx\n=\n(\n2\nq\ni\nj\n+\n|\n(\nZ\ni\n−\nN\ni\nD\n)\n⋅\n(\nZ\nj\n−\nN\nj\nD\n)\n|\nr\ni\nj\n)\nN\ni\nD\n+\nN\nj\nD\nN\ni\nD\n⋅\nN\nj\nD\n{\\displaystyle x=\\left( 2{{q}_{ij}}+\\frac{|({{Z}_{i}}-N_{i}^{D})\\cdot ({{Z}_{j}}-N_{j}^{D})|}{{{r}_{ij}}} \\right)\\frac{N_{i}^{D}+N_{j}^{D}}{N_{i}^{D}\\cdot N_{j}^{D}}}\nwhere\nZ\ni\n{\\displaystyle Z_i}\nand\nN\ni\nD\n{\\displaystyle N_i^D}\nare the nuclear charge and Hirshfeld dominant population of atom\ni\n{\\displaystyle i}\n, respectively.\nThe term\n2\nq\ni\nj\n=\nq\ni\nj\n+\nq\nj\ni\n{\\displaystyle 2q_{ij} = q_{ij} + q_{ji}}\nis a covalent bond index based on the overlap of conventional Hirshfeld populations\nq\ni\nj\n=\n∫\nw\ni\n(\nr\n)\nw\nj\n(\nr\n)\nn\n(\nr\n)\nd\nr\n{\\displaystyle q_{ij}=\\int w_i({\\mathbf{r}})w_j({\\mathbf{r}})n({\\mathbf{r}})d{\\mathbf{r}}}\n, and the fractional term in the parentheses is a distance-dependent ionic bond index.\nThe Performance of PBE-dDsC in the description of the adsorption of hydrocarbons on Pt(111) has been examined in reference\n[4]\n.\nUsage\nThe dDsC correction is invoked by setting\nIVDW\n=4. The default values for damping function parameters are available for the functionals PBE (\nGGA\n=\nPE\n}) and revPBE (\nGGA\n=\nRE\n). If another functional is used, the user has to define these parameters via corresponding tags in the\nINCAR\nfile (parameters for common DFT functionals can be found in reference\n[2]\n. The following parameters can be optionally defined in the\nINCAR\nfile (the given values are the default ones):\nVDW_RADIUS\n=50.0 : cutoff radius (in\nÅ\n{\\displaystyle \\AA}\n) for pair interactions\nVDW_S6\n=13.96 : scaling factor\na\n0\n{\\displaystyle {a}_{0}}\nVDW_SR\n=1.32 : scaling factor\nb\n0\n{\\displaystyle {b}_{0}}\nMind:\nThe dDsC method has been implemented into VASP by Stephan N. Steinmann.\nThis method requires the use of\nPOTCAR\nfiles from the PAW dataset version 52 or later.\nThe input reference polarizabilities for non-interacting atoms are available only for elements of the first six rows of periodic table except of the lanthanides.\nIt is essential that a sufficiently dense FFT grid (controlled via\nNGXF\n,\nNGYF\nand\nNGZF\n) is used when using dDsC, especially for accurate gradients. We strongly recommend to use\nPREC\n=\nAccurate\nfor this type of calculations (in any case, avoid using\nPREC\n=\nLow\n).\nThe charge-density dependence of gradients is neglected. This approximation has been thoroughly investigated and validated in reference\n[5]\n.\nRelated tags and articles\nVDW_RADIUS\n,\nVDW_S6\n,\nVDW_SR\n,\nIVDW\nReferences\n↑\na\nb\nS. N. Steinmann and C. Corminboeuf, J. Chem. Phys.\n134\n, 044117 (2011).\n↑\na\nb\nS. N. Steinmann and C. Corminboeuf, J. Chem. Theory Comput.\n7\n, 3567 (2011).\n↑\nA. D. Becke and E. R. Johnson, J. Chem. Phys.\n122\n, 154104 (2005).\n↑\nS. Gautier, S. N. Steinmann, C. Michel, P. Fleurat-Lessard, and P. Sautet, Phys. Chem. Chem. Phys.\n17\n, 28921 (2015).\n↑\nE. Bremond, N. Golubev, S. N. Steinmann, and C. Corminboeuf, J. Chem. Phys.\n140\n, 18A516 (2014)."
  }, 
  "DFT-D2": {
    "description": "The web page describes the DFT-D2 method developed by Grimme for calculating dispersion corrections in density functional theory, including the mathematical formulation of the dispersion energy, damping function, parameter scaling, and implementation details in the VASP software package.", 
    "detailed_description": "In the DFT-D2 method of Grimme\n[1]\nthe correction term takes the form:\nE\nd\ni\ns\np\n=\n−\n1\n2\n∑\ni\n=\n1\nN\na\nt\n∑\nj\n=\n1\nN\na\nt\n∑\nL\n′\nC\n6\ni\nj\nr\ni\nj\n,\nL\n6\nf\nd\n,\n6\n(\nr\ni\nj\n,\nL\n)\n{\\displaystyle E_{\\mathrm{disp}} = -\\frac{1}{2}  \\sum_{i=1}^{N_{at}} \\sum_{j=1}^{N_{at}}  \\sum_{\\mathbf{L}} {}^{\\prime}  \\frac{C_{6ij}}{r_{ij,L}^{6}}  f_{d,6}({r}_{ij,\\mathbf{L}}) }\nwhere the first two summations are over all\nN\na\nt\n{\\displaystyle N_{at}}\natoms in the unit cell and the third summation is over all translations of the unit cell\nL\n=\n(\nl\n1\n,\nl\n2\n,\nl\n3\n)\n{\\displaystyle {\\mathbf{L}}=(l_1,l_2,l_3)}\nwhere the prime indicates that\ni\n≠\nj\n{\\displaystyle i\\not=j}\nfor\nL\n=\n0\n{\\displaystyle {\\mathbf{L}}=0}\n.\nC\n6\ni\nj\n{\\displaystyle C_{6ij}}\ndenotes the dispersion coefficient for the atom pair\ni\nj\n{\\displaystyle ij}\n,\nr\ni\nj\n,\nL\n{\\displaystyle {r}_{ij,\\mathbf{L}}}\nis the distance between atom\ni\n{\\displaystyle i}\nlocated in the reference cell\nL\n=\n0\n{\\displaystyle \\mathbf{L}=0}\nand atom\nj\n{\\displaystyle j}\nin the cell\nL\n{\\displaystyle L}\nand the term\nf\n(\nr\ni\nj\n)\n{\\displaystyle f(r_{ij})}\nis a damping function whose role is to scale the force field such as to minimize the contributions from interactions within typical bonding distances. In practice, the terms in the equation for\nE\nd\ni\ns\np\n{\\displaystyle E_{\\mathrm{disp}}}\ncorresponding to interactions over distances longer than a certain suitably chosen cutoff radius (\nVDW_RADIUS\n, see below) contribute only negligibly to\nE\nd\ni\ns\np\n{\\displaystyle E_{\\mathrm{disp}}}\nand can be ignored. Parameters\nC\n6\ni\nj\n{\\displaystyle C_{6ij}}\nand\nR\n0\ni\nj\n{\\displaystyle R_{0ij}}\nare computed using the following combination rules:\nC\n6\ni\nj\n=\nC\n6\ni\ni\nC\n6\nj\nj\n{\\displaystyle C_{6ij} = \\sqrt{C_{6ii} C_{6jj}}}\nand\nR\n0\ni\nj\n=\nR\n0\ni\n+\nR\n0\nj\n.\n{\\displaystyle R_{0ij} = R_{0i}+ R_{0j}. }\nThe values for\nC\n6\ni\ni\n{\\displaystyle C_{6ii}}\nand\nR\n0\ni\n{\\displaystyle R_{0i}}\nare tabulated for each element and are insensitive to the particular chemical situation (for instance,\nC\n6\n{\\displaystyle C_6}\nfor carbon in methane takes exactly the same value as that for C in benzene within this approximation). In the DFT-D2 method, a Fermi-type damping function is used:\nf\nd\n,\n6\n(\nr\ni\nj\n)\n=\ns\n6\n1\n+\ne\n−\nd\n(\nr\ni\nj\n/\n(\ns\nR\nR\n0\ni\nj\n)\n−\n1\n)\n{\\displaystyle f_{d,6}(r_{ij}) = \\frac{s_6}{1+e^{-d(r_{ij}/(s_R\\,R_{0ij})-1)}}}\nwhereby the global scaling parameter\ns\n6\n{\\displaystyle s_6}\nhas been optimized for several different DFT functionals such as PBE (\ns\n6\n=\n0.75\n{\\displaystyle s_6=0.75}\n), BLYP (\ns\n6\n=\n1.2\n{\\displaystyle s_6=1.2}\n) or B3LYP (\ns\n6\n=\n1.05\n{\\displaystyle s_6=1.05}\n). The parameter\ns\nR\n{\\displaystyle s_R}\nis usually fixed at 1.00.\nThe performance of PBE-D2 method in optimization of various crystalline systems has been tested systematically in reference\n[2]\n.\nImportant:\nIt is recommended to use the more advanced and more accurate method\nDFT-D3\n.\n[3]\nUsage\nThe DFT-D2 method is activated by setting\nIVDW\n=1 or 10 (or the obsolete\nLVDW\n=\n.TRUE.\n). Optionally, the damping function and the vdW parameters can be controlled using the following flags (the given values are the default ones):\nVDW_RADIUS\n=50.0 : cutoff radius (in\nÅ\n{\\displaystyle \\AA}\n) for pair interactions\nVDW_S6\n=0.75 : global scaling factor\ns\n6\n{\\displaystyle s_6}\n(available in VASP.5.3.4 and later)\nVDW_SR\n=1.00 : scaling factor\ns\nR\n{\\displaystyle s_R}\n(available in VASP.5.3.4 and later)\nVDW_SCALING\n=0.75 : the same as\nVDW_S6\n(obsolete as of VASP.5.3.4)\nVDW_D\n=20.0 : damping parameter\nd\n{\\displaystyle d}\nVDW_C6\n=[real array] :\nC\n6\n{\\displaystyle C_6}\nparameters (\nJ\nn\nm\n6\nm\no\nl\n−\n1\n{\\displaystyle \\mathrm{Jnm}^{6}\\mathrm{mol}^{-1}}\n) for each species defined in the\nPOSCAR\nfile\nVDW_R0\n=[real array] :\nR\n0\n{\\displaystyle R_0}\nparameters (\nÅ\n{\\displaystyle \\AA}\n) for each species defined in the\nPOSCAR\nfile\nLVDW_EWALD\n=\n.FALSE.\n: the lattice summation in\nE\nd\ni\ns\np\n{\\displaystyle E_{\\mathrm{disp}}}\nexpression is computed by means of Ewald's summation (\n.TRUE.\n) or via a real space summation over all atomic pairs within cutoff radius\nVDW_RADIUS\n(\n.FALSE.\n).  (available in VASP.5.3.4 and later)\nMind:\nThe defaults for\nVDW_C6\nand\nVDW_R0\nare defined only for elements in the first five rows of the periodic table (i.e. H-Xe). If the system contains other elements the user has to define these parameters in\nINCAR\n.\nThe defaults for parameters controlling the damping function (\nVDW_S6\n,\nVDW_SR\n,\nVDW_D\n) are available for the PBE  (\nGGA\n=PE), BP, revPBE, PBE0, TPSS, and B3LYP functionals. If any other functional is used in a DFT-D2 calculation, the value of\nVDW_S6\n(or\nVDW_SCALING\nin versions before VASP.5.3.4) has to be defined in\nINCAR\n.\nAs of VASP.5.3.4, the default value for\nVDW_RADIUS\nhas been increased from 30 to 50\nÅ\n{\\displaystyle \\AA}\n.\nEwald's summation in the calculation of\nE\nd\ni\ns\np\n{\\displaystyle E_{\\mathrm{disp}}}\ncalculation (controlled via\nLVDW_EWALD\n) is implemented according to reference\n[4]\nand is available as of VASP.5.3.4.\nRelated tags and articles\nVDW_RADIUS\n,\nVDW_S6\n,\nVDW_SR\n,\nVDW_SCALING\n,\nVDW_D\n,\nVDW_C6\n,\nVDW_R0\n,\nLVDW_EWALD\n,\nIVDW\n,\nDFT-ulg\n,\nDFT-D3\n,\nDFT-D4\nReferences\n↑\nS. Grimme, J. Comput. Chem.\n27\n, 1787 (2006).\n↑\nT. Bučko, J. Hafner, S. Lebègue, and J. G. Ángyán, J. Phys. Chem. A\n114\n, 11814 (2010).\n↑\nS. Grimme, J. Antony, S. Ehrlich, and S. Krieg, J. Chem. Phys.\n132\n, 154104 (2010).\n↑\nT. Kerber, M. Sierka, and J. Sauer, J. Comput. Chem.\n29\n, 2088 (2008)."
  }, 
  "DFT-D3": {
    "description": "The web page describes the DFT-D3 method for calculating van der Waals dispersion energy corrections in density functional theory, including its two damping variants (zero-damping and Becke-Johnson), their mathematical formulations, adjustable parameters, and implementation details in the VASP software.", 
    "detailed_description": "In the DFT-D3 method of Grimme et al.\n[1]\n, the following expression for the vdW dispersion energy-correction term is used:\nE\nd\ni\ns\np\n=\n−\n1\n2\n∑\ni\n=\n1\nN\na\nt\n∑\nj\n=\n1\nN\na\nt\n∑\nL\n′\n(\nf\nd\n,\n6\n(\nr\ni\nj\n,\nL\n)\nC\n6\ni\nj\nr\ni\nj\n,\nL\n6\n+\nf\nd\n,\n8\n(\nr\ni\nj\n,\nL\n)\nC\n8\ni\nj\nr\ni\nj\n,\nL\n8\n)\n.\n{\\displaystyle  E_{\\mathrm{disp}} = -\\frac{1}{2}  \\sum_{i=1}^{N_{at}} \\sum_{j=1}^{N_{at}} \\sum_{\\mathbf{L}}{}^\\prime \\left ( f_{d,6}(r_{ij,L})\\,\\frac{C_{6ij}}{r_{ij,{L}}^6} +f_{d,8}(r_{ij,L})\\,\\frac{C_{8ij}}{r_{ij,L}^8} \\right ).}\nUnlike in the method\nDFT-D2\n, the dispersion coefficients\nC\n6\ni\nj\n{\\displaystyle C_{6ij}}\nare geometry-dependent as they are calculated on the basis of the local geometry (coordination number) around atoms\ni\n{\\displaystyle i}\nand\nj\n{\\displaystyle j}\n. Two variants of DFT-D3, that differ in the damping functions\nf\nd\n,\nn\n{\\displaystyle f_{d,n}}\n, are available.\nDFT-D3(zero)\nIn the zero-damping variant of DFT-D3,\n[1]\ninvoked by setting\nIVDW\n=11, the damping function reads\nf\nd\n,\nn\n(\nr\ni\nj\n)\n=\ns\nn\n1\n+\n6\n(\nr\ni\nj\n/\n(\ns\nR\n,\nn\nR\n0\ni\nj\n)\n)\n−\nα\nn\n{\\displaystyle f_{d,n}(r_{ij}) = \\frac{s_n}{1+6(r_{ij}/(s_{R,n}R_{0ij}))^{-\\alpha_{n}}}}\nwhere\nR\n0\ni\nj\n=\nC\n8\ni\nj\nC\n6\ni\nj\n{\\displaystyle R_{0ij} = \\sqrt{\\frac{C_{8ij}}{C_{6ij}}}}\n, the parameters\nα\n6\n{\\displaystyle \\alpha_6}\n,\nα\n8\n{\\displaystyle \\alpha_8}\n,\ns\nR\n,\n8\n{\\displaystyle s_{R,8}}\nand\ns\n6\n{\\displaystyle s_{6}}\nare fixed at values of 14, 16, 1, and 1, respectively, while\ns\n8\n{\\displaystyle s_{8}}\nand\ns\nR\n,\n6\n{\\displaystyle s_{R,6}}\nare adjustable parameters whose values depend on the choice of the exchange-correlation functional.\nOptionally, the following parameters can be defined in the\nINCAR\nfile (the given values are the default ones):\nVDW_RADIUS\n=50.2 : cutoff radius (in\nÅ\n{\\displaystyle \\AA}\n) for pair interactions considered in the equation of\nE\nd\ni\ns\np\n{\\displaystyle  E_{\\mathrm{disp}}}\nVDW_CNRADIUS\n=20.0 : cutoff radius (in\nÅ\n{\\displaystyle \\AA}\n) for the calculation of the coordination numbers\nVDW_S8\n=[real] : damping function parameter\ns\n8\n{\\displaystyle s_8}\nVDW_SR\n=[real] : damping function parameter\ns\nR\n,\n6\n{\\displaystyle s_{R,6}}\nDFT-D3(BJ)\nIn the Becke-Johnson (BJ) damping variant of DFT-D3,\n[2]\n, invoked by setting\nIVDW\n=12, the damping function is given by\nf\nd\n,\nn\n(\nr\ni\nj\n)\n=\ns\nn\nr\ni\nj\nn\nr\ni\nj\nn\n+\n(\na\n1\nR\n0\ni\nj\n+\na\n2\n)\nn\n{\\displaystyle f_{d,n}(r_{ij}) = \\frac{s_n\\,r_{ij}^n}{r_{ij}^n + (a_1\\,R_{0ij}+a_2)^n} }\nwith\ns\n6\n=\n1\n{\\displaystyle s_6=1}\nand\na\n1\n{\\displaystyle a_1}\n,\na\n2\n{\\displaystyle a_2}\n, and\ns\n8\n{\\displaystyle s_8}\nbeing adjustable parameters. As before, the parameters\nVDW_RADIUS\nand\nVDW_CNRADIUS\ncan be used to change the default values for the cutoff radii.\nOptionally, the parameters of the damping function can be controlled using the following\nINCAR\ntags:\nVDW_S8\n=[real]\nVDW_A1\n=[real]\nVDW_A2\n=[real]\nMind:\nThe default values for the damping function parameters are available for several\nGGA\n(PBE, RPBE, revPBE and PBEsol),\nMETAGGA\n(TPSS, M06L and SCAN) and\nhybrid\n(B3LYP and PBEh/PBE0) functionals, as well as\nHartree-Fock\n. If another functional is used, the user has to define these parameters via the corresponding tags in the\nINCAR\nfile. The up-to-date list of parametrized DFT functionals with recommended values of damping function parameters can be found on the webpage\nhttps://www.chemie.uni-bonn.de/grimme/de/software/dft-d3/\nand follow the link \"List of parametrized functionals\".\nThe DFT-D3 method has been implemented in VASP by Jonas Moellmann based on the dftd3 program written by Stefan Grimme, Stephan Ehrlich and Helge Krieg. If you make use of the DFT-D3 method, please cite reference\n[1]\n. When using DFT-D3(BJ) references\n[1]\nand\n[2]\nshould also be cited. Also carefully check the more extensive list of references found on\nhttps://www.chemie.uni-bonn.de/grimme/de/software/dft-d3/\n.\nRelated tags and articles\nVDW_RADIUS\n,\nVDW_CNRADIUS\n,\nVDW_S8\n,\nVDW_SR\n,\nVDW_A1\n,\nVDW_A2\n,\nIVDW\n,\nDFT-D2\n,\nDFT-ulg\n,\nDFT-D4\nReferences\n↑\na\nb\nc\nd\nS. Grimme, J. Antony, S. Ehrlich, and S. Krieg, J. Chem. Phys.\n132\n, 154104 (2010).\n↑\na\nb\nS. Grimme, S. Ehrlich, and L. Goerigk, J. Comput. Chem.\n32\n, 1456 (2011)."
  }, 
  "DFT-D4": {
    "description": "DFT-D4 is a package that adds van-der-Waals interactions to DFT calculations in VASP by tailoring adjustable parameters to the exchange-correlation functional, enabling more accurate structure relaxation and MD simulations with minimal user intervention.", 
    "detailed_description": "DFT-D4 is an external package maintained by the Grimme group that can be\nlinked to VASP\n.\nRead the\ndocumentation\nfor more information about this package.\nDFT-D4 adds\nvan-der-Waals (vdW) interactions\nto DFT because they are not included in most exchange-correlation functionals.\nIt approximates the vdW interactions considering only the structure of the system which allows for a fast computation.\nSince every functional has different interactions between atoms, DFT-D4 tailors its adjustable parameters to the functional.\nFor more information regarding these parameters, please refer to the DFT-D4 paper.\n[1]\nUsage\nIn most cases, it is sufficient to set\nIVDW\n=13 in the\nINCAR\nfile if VASP was\ncompiled and linked to DFT-D4\n.\nInternally, VASP passes the name of the used exchange-correlation functional to DFT-D4.\nSubsequently, DFT-D4 maps this name of the functional to optimized settings for the adjustable parameters of the vdW interaction.\nVASP uses these parameters to compute the DFT-D4 energies, forces, and stresses in every ionic step and adds them to the corresponding DFT terms.\nAs a result, you can relax structures or run\nMD simulations\nwith an approximate treatment of vdW interactions.\nWarning:\nBelow, we explain how to tweak the parameters of DFT-D4. Typically, you should not modify them unless you have a very good reason, e.g., because the interface is not implemented for the exchange-correlation functional you use.\nVASP allows setting the following tags in the\nINCAR\nfile to change the strength of the vdW interaction.\nVDW_S6\n,\nVDW_S8\ndetermine the strength of the dipole-dipole and dipole-quadrupole interaction.\nVDW_A1\n,\nVDW_A2\nare scaling constants in the Becke-Johnson damping.\nReferences\n↑\nE. Caldeweyher, J.-M. Mewes, S. Ehlert, and S. Grimme,\nExtension and evaluation of the D4 London-dispersion model for periodic systems\n, Phys. Chem. Chem. Phys.\n22\n, 8499 (2020).\nRelated tags and articles\nIVDW\n,\nVDW_S6\n,\nVDW_S8\n,\nVDW_A1\n,\nVDW_A2\n,\nDFT-D3\n,\nLinking to DFT-D4"
  }, 
  "DFT-ulg": {
    "description": "The web page describes the DFT-ulg method for dispersion correction in density functional theory calculations, including its mathematical formulation, activation parameters, and usage guidelines.", 
    "detailed_description": "In the DFT-ulg method of Kim et al.\n[1]\n, the correction term takes the form:\nE\nd\ni\ns\np\n=\n−\n1\n2\ns\nl\ng\n∑\ni\n=\n1\nN\na\nt\n∑\nj\n=\n1\nN\na\nt\n∑\nL\n′\nC\n6\ni\nj\nr\ni\nj\n,\nL\n6\n+\nb\nl\ng\n(\nR\n0\ni\nj\n)\n6\n{\\displaystyle E_{\\mathrm{disp}} = -\\frac{1}{2}  s_{lg}\\sum_{i=1}^{N_{at}} \\sum_{j=1}^{N_{at}}  \\sum_{\\mathbf{L}} {}^{\\prime}  \\frac{C_{6ij}}{r_{ij,L}^{6}+b_{lg}(R_{0}^{ij})^{6}} }\nwhere the first two summations are over all\nN\na\nt\n{\\displaystyle N_{at}}\natoms in the unit cell and the third summation is over all translations of the unit cell\nL\n=\n(\nl\n1\n,\nl\n2\n,\nl\n3\n)\n{\\displaystyle {\\mathbf{L}}=(l_1,l_2,l_3)}\nwhere the prime indicates that\ni\n≠\nj\n{\\displaystyle i\\not=j}\nfor\nL\n=\n0\n{\\displaystyle {\\mathbf{L}}=0}\n.\nC\n6\ni\nj\n{\\displaystyle C_{6ij}}\ndenotes the dispersion coefficient for the atom pair\ni\nj\n{\\displaystyle ij}\n,\nr\ni\nj\n,\nL\n{\\displaystyle {r}_{ij,\\mathbf{L}}}\nis the distance between atom\ni\n{\\displaystyle i}\nlocated in the reference cell\nL\n=\n0\n{\\displaystyle \\mathbf{L}=0}\nand atom\nj\n{\\displaystyle j}\nin the cell\nL\n{\\displaystyle L}\n.\nUsage\nThe DFT-ulg method can be activated by setting\nIVDW\n=\n3\n. The parameters in the DFT-ulg method (see Ref.\n[1]\nfor details) that can be modified are listed below.\nVDW_RADIUS\n=50.0 : cutoff radius (in\nÅ\n{\\displaystyle \\AA}\n) for pair interactions\nVDW_S6\n=0.7012 : global scaling parameter\ns\nl\ng\n{\\displaystyle s_{lg}}\nVDW_D\n=0.6966 :  universal correction parameter\nb\nl\ng\n{\\displaystyle b_{lg}}\nVDW_C6\n=[real array] :\nC\n6\n{\\displaystyle C_6}\nparameters (\nJ\nn\nm\n6\nm\no\nl\n−\n1\n{\\displaystyle \\mathrm{Jnm}^{6}\\mathrm{mol}^{-1}}\n) for each species defined in the\nPOSCAR\nfile\nVDW_R0\n=[real array] :\nR\n0\n{\\displaystyle R_0}\nparameters (\nÅ\n{\\displaystyle \\AA}\n) for each species defined in the\nPOSCAR\nfile\nLVDW_EWALD\n=\n.FALSE.\n: the lattice summation in\nE\nd\ni\ns\np\n{\\displaystyle E_{\\mathrm{disp}}}\nexpression is computed by means of Ewald's summation (\n.TRUE.\n) or via a real space summation over all atomic pairs within cutoff radius\nVDW_RADIUS\n(\n.FALSE.\n).  (available in VASP.5.3.5 and later)\nMind:\nThe default value of the parameter\ns\nl\ng\n{\\displaystyle s_{lg}}\n(0.7012) was determined in conjunction with the PBE\nGGA\nfunctional\n[1]\n. Therefore, it is not recommended to use the DFT-ulg dispersion correction with a\nGGA\nfunctional other than PBE, unless\ns\nl\ng\n{\\displaystyle s_{lg}}\nis reoptimized.\nRelated tags and articles\nVDW_RADIUS\n,\nVDW_S6\n,\nVDW_D\n,\nVDW_C6\n,\nVDW_R0\n,\nLVDW_EWALD\n,\nIVDW\n,\nDFT-D2\nReferences\n↑\na\nb\nc\nH. Kim, J.-M. Choi, and W. A. Goddard, III, J. Phys. Chem. Lett.\n3\n, 360 (2012)."
  }, 
  "DFT DMFT calculations": {
    "description": "This web page provides a detailed tutorial on performing DFT+DMFT calculations using VASP and the TRIQS software library to compute the local spectral function of NiO, explaining the theoretical background, technical requirements, and step-by-step procedure for charge-self-consistent calculations.", 
    "detailed_description": "Density-functional theory plus dynamical mean-field theory (DFT+DMFT)\n[1]\nis an advanced extension of DFT that provides a more accurate treatment of strongly correlated materials including dynamical effects at finite temperature compared to\nDFT+U\n.\nDFT+DMFT calculations are not within VASP, but VASP allows to interface external DMFT codes.\nHere, we will guide through the steps to perform a DFT+DMFT calculation using the TRIQS software library\n[2]\n, more specifically the TRIQS/solid_dmft software\n[3]\n.\nIn this following HowTo, we will calculate the local spectral function\nA\n(\nω\n)\n{\\displaystyle A(\\omega)}\nof NiO using DMFT.\nMind:\nAvailable as of VASP 6.5.0\nTheory overview\nSimilarly to the\nGW method\n, DFT+DMFT relies on the\nGreen's functions formalism\n.\nBut, in contrast to\nGW\n, DMFT is working on a projected sub-space of the KS states, much like\nDFT+U\n.\nThe projection is performed in VASP in the same way it is done for the\nLDAU\ntag by projecting the KS states on localized orbitals provided by the PAW formalism:\nP\nL\n,\nν\nR\n(\nk\n)\n=\n∑\ni\n⟨\nχ\nL\nR\n|\nϕ\ni\n⟩\n⟨\np\n~\ni\n|\nΨ\n~\nν\nk\n⟩\n,\n{\\displaystyle\nP^{\\mathbf{R}}_{L,\\nu}(\\mathbf{k}) = \\sum_i \\langle \\chi^{\\mathbf{R}}_L | \\phi_i \\rangle \\langle \\tilde{p}_i | \\tilde{\\Psi}_{\\nu \\mathbf{k}} \\rangle,\n}\nwhere\n|\nχ\nL\nR\n⟩\n{\\displaystyle |\\chi^{\\mathbf{R}}_L\\rangle}\nare localized basis functions associated with each correlated site R,\n|\nϕ\ni\n⟩\n{\\displaystyle |\\phi_i \\rangle}\nare all-electron partial waves, and\n|\np\n~\ni\n⟩\n{\\displaystyle | \\tilde{p}_i\\rangle}\nare the standard PAW projectors.\nL\n{\\displaystyle L}\nis a compound index of local quantum numbers. The raw projectors are orthonormalized and connect the KS basis\nν\n{\\displaystyle \\nu}\nwith the localized orbitals\nm\n{\\displaystyle m}\n:\nP\nm\n,\nν\nR\n(\nk\n)\n{\\displaystyle P^{\\mathbf{R}}_{m,\\nu}(\\mathbf{k})}\n.\n[4]\nIn DFT+DMFT theory the central quantity is the lattice Green's function:\nG\nν\nν\n′\n(\nk\n,\ni\nω\nn\n)\n=\n[\n(\ni\nω\nn\n+\nμ\n−\nε\nν\nk\n)\nI\n^\n−\nΣ\n^\nKS\n(\nk\n,\ni\nω\nn\n)\n]\nν\nν\n′\n−\n1\n.\n{\\displaystyle\nG_{\\nu \\nu{\\prime}}(\\mathbf{k}, i\\omega_n) = \\left[ \\left( i\\omega_n + \\mu - \\varepsilon_{\\nu \\mathbf{k}} \\right) \\hat{\\mathbb{I}} - \\hat{\\Sigma}^{\\text{KS}}(\\mathbf{k}, i\\omega_n) \\right]^{-1}_{\\nu \\nu{\\prime}}.\n}\nwhere\nε\nν\nk\n{\\displaystyle \\varepsilon_{\\nu \\mathbf{k}}}\nare the KS eigenvalues,\nμ\n{\\displaystyle \\mu}\nis the chemical potential, and\nΣ\n^\nKS\n(\nk\n,\ni\nω\nn\n)\n{\\displaystyle \\hat{\\Sigma}^{\\text{KS}}(\\mathbf{k}, i\\omega_n)}\nis the DMFT calculated self-energy embedded in the KS space at a given\nk\n{\\displaystyle k}\npoint and discrete\nMatsubara frequency\ni\nω\nn\n{\\displaystyle i\\omega_n}\n. The self-energy contains the electron correlation effects calculated by DMFT. The DMFT equations are solved in the localized basis and then embedded via the projector functions:\nΣ\n^\nKS\n(\nk\n,\ni\nω\nn\n)\n=\n∑\nν\nν\n′\n|\nΨ\nν\nk\n⟩\n⟨\nΨ\nν\n′\nk\n|\n⋅\n∑\nm\nm\n′\nP\nν\n,\nm\n∗\n(\nk\n)\nΣ\nm\nm\n′\nimp\n(\ni\nω\nn\n)\nP\nm\n′\n,\nν\n′\n(\nk\n)\n.\n{\\displaystyle\n\\hat{\\Sigma}^{\\text{KS}}(\\mathbf{k}, i\\omega_n) =\n\\sum_{\\nu\\nu{\\prime}} |\\Psi_{\\nu \\mathbf{k}}\\rangle \\langle \\Psi_{\\nu{\\prime} \\mathbf{k}}|\n\\cdot \\sum_{mm{\\prime}} P^*_{\\nu, m}(\\mathbf{k}) \\Sigma^\\text{imp}_{mm{\\prime}}(i\\omega_n) P_{m{\\prime}, \\nu{\\prime}}(\\mathbf{k}) .\n}\nThe self-energy in DMFT is obtained by first extracting the local Green's function (with an initial guess of\nΣ\nimp\n{\\displaystyle \\Sigma^\\text{imp}}\n) in the localized basis:\nG\nm\nm\n′\nloc\n(\ni\nω\nn\n)\n=\n∑\nk\n∑\nν\nν\n′\nP\nm\nν\n(\nk\n)\nG\nν\nν\n′\n(\nk\n,\ni\nω\nn\n)\nP\nm\n′\nν\n′\n∗\n(\nk\n)\n{\\displaystyle\nG^{\\text{loc}}_{m m'}(i\\omega_n) = \\sum_{\\mathbf{k}} \\sum_{\\nu \\nu'} P_{m \\nu}(\\mathbf{k}) G_{\\nu \\nu'}(\\mathbf{k}, i\\omega_n) P^*_{m' \\nu'}(\\mathbf{k})\n}\nfrom which we extract a dynamic Weiss field\nG\n{\\displaystyle \\mathcal{G}}\n:\nG\nm\nm\n′\n=\n(\n[\nG\nloc\n]\n−\n1\n+\nΣ\nimp\n)\nm\nm\n′\n−\n1\n{\\displaystyle\n\\mathcal{G}_{m m '} = \\left( \\left[ \\mathbf{G}^\\text{loc} \\right]^{-1} + \\mathbf{\\Sigma}^\\text{imp} \\right)^{-1}_{m m'}\n}\nthat is used in DMFT to construct an Anderson impurity model, by supplying a local many-body Hamiltonian incorporating the local energy levels plus the interaction Hamiltonian.\nBy solving the Anderson impurity problem we obtain the impurity Green's function\nG\nm\nm\n′\nimp\n{\\displaystyle G^\\text{imp}_{m m'}}\nand the impurity self-energy\nΣ\nm\nm\n′\nimp\n{\\displaystyle \\Sigma^\\text{imp}_{m m'}}\nvia Dysons equations:\nΣ\nm\nm\n′\nimp\n=\n[\nG\n]\nm\nm\n′\n−\n1\n−\n[\nG\nimp\n]\nm\nm\n′\n−\n1\n{\\displaystyle\n\\Sigma^\\text{imp}_{m m'} = \\left[ \\mathbf{\\mathcal{G}} \\right]^{-1}_{m m'} - \\left[ \\mathbf{G}^\\text{imp} \\right]^{-1}_{m m'}\n}\nThis procedure is iterated until the DMFT self-consistency condition is satisfied:\n|\nG\ni\nm\np\n−\nG\nl\no\nc\n|\n→\n0\n{\\displaystyle\n|G^{imp}-G^{loc}| \\rightarrow 0\n}\n.\nImportantly, there is a second self-consistency condition for combined DFT+DMFT calculations. From the lattice Green's function a density matrix can be computed:\nN\nν\nν\n′\n(\nk\n)\n=\n1\nβ\n∑\ni\nω\nn\nG\nν\nν\n′\n(\nk\n,\ni\nω\nn\n)\n{\\displaystyle\nN_{\\nu \\nu'} (\\mathbf{k}) = \\frac{1}{\\beta} \\sum_{i \\omega_n} G_{\\nu \\nu'}(\\mathbf{k}, i\\omega_n)\n}\nthat is related to the DFT density by:\nρ\n(\nr\n)\n=\n∑\nk\n∑\nν\nν\n′\n⟨\nr\n|\nΨ\nν\nk\n⟩\nN\nν\nν\n′\n(\nk\n)\n⟨\nΨ\nν\n′\nk\n|\nr\n⟩\n{\\displaystyle\n\\rho(\\mathbf{r}) = \\sum_{\\mathbf{k}} \\sum_{\\nu \\nu'} \\langle \\mathbf{r} | \\Psi_{\\nu \\mathbf{k}} \\rangle N_{\\nu \\nu'}(\\mathbf{k}) \\langle \\Psi_{\\nu' \\mathbf{k}} | \\mathbf{r} \\rangle\n}\nThis implies that both the DFT charge density and the obtained DMFT density matrix have to coincide as well. This so-called charge-self-consistency condition implies that we do have to perform a charge density update after each DMFT step (using\nICHARG\n=5). These calculation are called charge self-consistent (CSC) DFT+DMFT calculations. Without the extra CSC steps one refers to the DMFT calculations as one shot (OS).\nFrom the final self-energy or Green's function the spectral function (similar to the DOS in DFT) can be computed, which can be compared to photoemission spectroscopy. DFT+DMFT also allows to calculate other spectral properties and structural properties. See Ref.\n[1]\nfor more information.\nTechnical requirements\nTo follow the tutorial VASP has to be compiled with\nHDF5 support\nand should be newer than version 6.5.0.\nAdditionally TRIQS has to be installed including its applications ctseg, maxent, dft_tools, and solid_dmft in version 3.4.0 or newer. See the following\ninstallation instructions\n. TRIQS can easiest be obtained via\nconda\n.\nMind:\nCurrently this tutorial requires the installation of the unstable branch of TRIQS/dft_tools and TRIQS/solid_dmft manually from source. The features will be part of the upcoming release 3.4.0 of TRIQS.\nStep-by-step tutorial\nNiO is a charge-transfer insulator that becomes anti-ferromagnetic at low temperatures. At higher temperatures NiO is para-magnetic and a prototypical Mott insulator. In the tutorial\nNiO LSDA+U\nDFT+U is used to calculate the low temperature magnetic state of NiO. Here, we will calculate the Mott insulating state at higher temperatures using DFT+DMFT.\nStep 1: Perform a SCF DFT calculation\nFirst we will perform a SCF DFT calculation to converge the KS wavefunction and project the KS states on localized Ni-d orbitals. We will later use the Ni-d projectors for DMFT.\nThe\nPOSCAR\nfile is:\nNiO\n4.17\n0.0000000000  0.5000000000  0.5000000000\n0.5000000000  0.0000000000  0.5000000000\n0.5000000000  0.5000000000  0.0000000000\nNi O\n1 1\nDirect\n0.0000000000  0.0000000000  0.0000000000\n0.5000000000  0.5000000000  0.5000000000\nThe\nKPOINTS\nfile is:\nAutomatically generated mesh\n0\nG\n15 15 15\nFor the\nPOTCAR\nwe are using the 'Ni_pv' and the 'O'\npseudopotentials\n.\nThe\nINCAR\nfile is:\nSYSTEM\n= NiO\nISMEAR\n= -5\nSIGMA\n= 0.01\nEDIFF\n= 1.E-10\nNELMIN\n= 35\nNBANDS\n= 32\nLORBIT\n= 14\nLMAXMIX\n= 4\nEMIN\n= -6\nEMAX\n= 18\nNEDOS\n= 5001\n# project to Ni d and O p states\nLORBIT\n= 14\nLOCPROJ\n= 1 : d : Pr\nImportantly, we specify the projectors to be created via the\nLOCPROJ\ntag for the Ni-d orbitals.\nAdditionally, we specify the\nLORBIT\ntag to be 14 to optimize the projectors in the given energy range\nEMIN\nto\nEMAX\n.\nThe number of bands is slightly increased and the convergence criteria a stringent to converge the KS wavefunction (RMS).\nThe end of the std out should look like this:\nDAV:  34    -0.113700647767E+02   -0.45929E-10    0.41728E-14  3960   0.357E-11    0.670E-04\nDAV:  35    -0.113700647767E+02    0.36380E-11    0.12336E-13  3960   0.224E-11\nLOCPROJ mode\nComputing AMN (projections onto localized orbitals)\n1 F= -.11370065E+02 E0= -.11370065E+02  d E =0.000000E+00\nwriting wavefunctions\nNote here the\nLOCPROJ mode\nmessage. Afterwards the projections are stored in the file\nvaspgamma.h5\nand\nLOCPROJ\n.\nStep 2: Convert the VASP output to TRIQS input\nWe will use the converter tool inside of TRIQS/dft_tools to convert the VASP output to a TRIQS input file. To this end, we prepare a config file\nplo.cfg\nwith the following content:\n[General]\nDOSMESH\n=\n-10\n10\n3001\n[Group 1]\nSHELLS\n=\n1\nEWINDOW\n=\n-10\n10\nBANDS\n=\n5\n14\n[\nShell\n1\n]\n# Ni d shell\nLSHELL\n=\n2\nIONS\n=\n1\nCORR\n=\nTrue\nTRANSFORM\n=\n1.0\n0.0\n0.0\n0.0\n0.0\n0.0\n1.0\n0.0\n0.0\n0.0\n0.0\n0.0\n1.0\n0.0\n0.0\n0.0\n0.0\n0.0\n1.0\n0.0\n0.0\n0.0\n0.0\n0.0\n1.0\nFor details on the config file see the\nDFT tools documentation\n. The converter can be run by creating a small python script with the following content:\nfrom\ntriqs_dft_tools.converters.vasp\nimport\nVaspConverter\nimport\ntriqs_dft_tools.converters.plovasp.converter\nas\nplo_converter\n# Generate and store PLOs\nplo_converter\n.\ngenerate_and_output_as_text\n(\n'plo.cfg'\n,\nvasp_dir\n=\n'./'\n)\n# run the converter\nConverter\n=\nVaspConverter\n(\nfilename\n=\n'vasp'\n)\nConverter\n.\nconvert_dft_input\n()\nRunning the python script via\npython converter.py\nwill create the input file\nvasp.h5\nthat can be used for the DMFT calculation.\nThe std output contains information about the localized orbitals.\nFor example the on-site density matrix is printed:\nDensity matrix:\nShell 1\nSite diag : True\nSite 1\n1.9541777     0.0000065     0.0000335     0.0000138    -0.0000181\n0.0000065     1.9541833    -0.0000361     0.0000068     0.0000650\n0.0000335    -0.0000361     1.2867504     0.0000023    -0.0000827\n0.0000138     0.0000068     0.0000023     1.9541790    -0.0000303\n-0.0000181     0.0000650    -0.0000827    -0.0000303     1.2868509\ntrace:  8.43614117771427\nImpurity density: 8.43614117771427\nWe can plot the DFT DOS from VASP together with the DOS of the projected orbitals from VASP via the following python code using py4vasp:\nimport\npy4vasp\nimport\nmatplotlib.pyplot\nas\nplt\nimport\nnumpy\nas\nnp\n# get VASP DOS\ncalc\n=\npy4vasp\n.\nCalculation\n.\nfrom_file\n(\n'scf/vaspout.h5'\n)\ndft_dos\n=\ncalc\n.\ndos\n.\nto_dict\n()\n# load projector (PLO) DOS from TRIQS\nplo_dos_Ni\n=\nnp\n.\nloadtxt\n(\n'scf/pdos_0_0.dat'\n)\nfig\n=\nplt\n.\nfigure\n(\nfigsize\n=\n(\n7\n,\n4\n),\ndpi\n=\n150\n)\nplt\n.\nplot\n(\ndft_dos\n[\n'energies'\n],\ndft_dos\n[\n'total'\n],\nlabel\n=\nr\n'VASP total DOS'\n)\n# sum PLO DOS for all orbitals\nplt\n.\nplot\n(\nplo_dos_Ni\n[:,\n0\n],\nnp\n.\nsum\n(\nplo_dos_Ni\n[:,\n1\n:],\naxis\n=\n1\n),\nlabel\n=\nr\n'PLO Ni$_\n{d}\n$'\n)\nplt\n.\nxlim\n(\n-\n10\n,\n4\n)\nplt\n.\nylim\n(\n0\n,\n12\n)\nplt\n.\nxlabel\n(\nr\n'$\\epsilon - {\\text\n{E}\n_\\text\n{F}\n}$ (eV)'\n)\nplt\n.\nylabel\n(\nr\n'states/eV'\n)\nplt\n.\nlegend\n()\nplt\n.\nshow\n()\nResulting in:\nDFT total DOS and projector DOS from TRIQS/DFT_Tools\ncapturing the Ni-d orbital character. The DMFT calculation will now use this projected DOS as input.\nStep 3: Perform a DMFT calculation\nCopy the\nvasp.h5\nfile to a new directory.\nThen, we perform first a one-shot DMFT calculation to converge the self-energy, before performing charge-density updates with VASP.\nTo perform the DMFT calculation, we will use the TRIQS/solid_dmft.\nIn general, TRIQS is only a framework which allows the user large flexibility to design their own workflows for DMFT calculations or other methods.\nHowever, we will leverage on solid_dmft flagship implementation of DMFT in TRIQS, which works by providing a toml config file and executing solid_dmft.\nThe following config file prepares the DMFT calculation to solve the DMFT equation with U=8 eV and J=1.0 eV, which are typical values for NiO (compare with the\nNiO LSDA+U\nhowto).\nCreate the 'dmft_config.toml' file with the following content:\n[general]\nseedname\n=\n\"vasp\"\njobname\n=\n\"U8.0-J1.0-beta20-qmc1e+7\"\nprec_mu\n=\n0.001\nn_iw\n=\n501\nn_tau\n=\n10001\nenforce_off_diag\n=\nfalse\nblock_threshold\n=\n0.001\nh_int_type\n=\n\"density_density\"\nh_int_basis\n=\n\"vasp\"\nU\n=\n8.0\nJ\n=\n1.0\nbeta\n=\n20\nn_iter_dmft\n=\n12\ndc_type\n=\n0\ndc\n=\ntrue\ndc_dmft\n=\nfalse\nh5_save_freq\n=\n1\n[solver]\ntype\n=\n\"ctseg\"\nlength_cycle\n=\n500\nn_warmup_cycles\n=\n1e+4\nn_cycles_tot\n=\n1e+7\nperform_tail_fit\n=\ntrue\nfit_max_moment\n=\n4\nfit_min_w\n=\n20\nfit_max_w\n=\n30\n[advanced]\ndc_fixed_value\n=\n59.0\nImportantly, we specify the electronic temperature of the calculation via the option 'beta=20' 1/eV to be half of room temperature, U/J are set to the aforementioned values, the\nseedname\nand\njobname\nspecify the input file and the output directory in which the calculation will be performed, and\nn_iter_dmft\nspecifies the number of DMFT iterations to be performed.\nThe section\n[solver]\nspecifies the solver to be used, in this case we use the CTSEG solver, and its parameters.\nThe ctseg solver is a QMC impurity solver operating on the\nMatsubara axis\n.\nPlease refer to the\nsolid_dmft documentation\nfor more details on the parameters.\nThe QMC solver parallelizes very well over MPI and we request 1e+7 Monte Carlo steps.\nTo perform the DMFT calculation we run the following command:\nmpirun solid_dmft 1>out 2>err &\nwhich will run the DMFT calculation in the background. Check the file\nout\nfor the output of the calculation.\nImportantly, solid_dmft will create a directory\njobname\nin which the file\nobservables_imp0.dat\ncan be found that monitors the most important observables per iteration.\nOn 32 cores the calculation should take around 10 minutes, and the observables file should look like this:\nit |         mu |        G(beta/2) per orbital |          orbital occs up+down |  impurity occ\n0 |   -0.00247 |   -0.00897          -0.11937 |    1.97871            1.29990 |       8.53594\n1 |   -0.00247 |   -0.00084          -0.01573 |    1.99582            1.11247 |       8.21241\n.\n.                             ...                             ...\n.\n8 |    0.05280 |   -0.00005          -0.00007 |    1.85604            1.30080 |       8.16972\n9 |    0.04979 |   -0.00004          -0.00007 |    1.84552            1.31608 |       8.16871\n10 |    0.04979 |   -0.00005          -0.00015 |    1.86526            1.28894 |       8.17367\nThe second column shows the chemical potential that is varies in each DMFT iteration to fulfill the electron count of the system.\nThe next columns monitor\nG\n(\nβ\n/\n2\n)\n{\\displaystyle G(\\beta/2)}\nper localized orbital, which monitors the spectral function at the Fermi level, to indicate metallic or insulating behavior.\nThe last columns show the orbital occupations and the impurity occupation.\nThe convergence can be monitored via the file\nconv_obs0.dat\n, which should look like this:\nit |          δμ |        δocc orb |    δimp occ |       δGimp |         δG0 |          δΣ\n1 | 0.00000e+00 |     1.87428e-01 | 3.23528e-01 | 9.60779e-01 | 1.57707e-01 | 1.08102e+01\n2 | 1.01166e-01 |     1.40548e-02 | 2.02550e-02 | 1.13418e-01 | 2.72140e-04 | 4.85790e+00\n3 | 0.00000e+00 | ... 1.17895e-01 | 1.66725e-02 | 7.43751e-02 | 1.56353e-05 | 5.93806e+00\n4 | 1.73021e-02 |     1.30454e-02 | 3.10489e-03 | 1.33409e-02 | 4.43484e-05 | 2.73892e+00\n5 | 1.80218e-02 |     5.53206e-02 | 6.96508e-03 | 3.57827e-02 | 4.51748e-05 | 7.35875e+00\n6 | 1.05675e-02 |     1.23957e-02 | 1.01379e-04 | 8.96967e-03 | 2.69797e-05 | 3.46404e+00\n...\nNote the 'δGimp' column, which shows the DMFT self-consistency condition, but also the first column 'δμ' which shows the convergence of the chemical potential.\nThe converged self-energy is stored along all other calculated properties in the file 'jobname/seedname.h5'. You can for example plot the self-energy for the Ni\ne\ng\n{\\displaystyle e_g}\nand\nt\n2\ng\n{\\displaystyle t_{2g}}\norbitals with the following code using the\nsmall helper functions on the bottom\n:\nwith\nHDFArchive\n(\n'dmft_os/U8.0-J1.0-beta20-qmc2e+7/vasp.h5'\n,\n'r'\n)\nas\nar\n:\nS_os_iw\n=\nar\n[\n'DMFT_results/last_iter/Sigma_freq_0'\n]\nfig\n,\nax\n=\nplt\n.\nsubplots\n(\n1\n,\n2\n,\nfigsize\n=\n(\n14\n,\n5\n),\ndpi\n=\n100\n,\nsharex\n=\nTrue\n)\nax\n=\nax\n.\nreshape\n(\n-\n1\n)\nplot_sigma_iw\n(\nS_os_iw\n[\n'up_0'\n],\nax\n,\ncolor\n=\n'C0'\n,\nlabel\n=\n'$t_\n{2g}\n$'\n,\nmarker\n=\n'-'\n)\nplot_sigma_iw\n(\nS_os_iw\n[\n'up_2'\n],\nax\n,\ncolor\n=\n'C1'\n,\nlabel\n=\n'$e_\n{g}\n$'\n,\nmarker\n=\n'-'\n)\nax\n[\n0\n]\n.\nset_xlim\n(\n0\n,\n30\n)\nax\n[\n0\n]\n.\nset_ylim\n(\n-\n1\n,\n2\n)\nax\n[\n1\n]\n.\nset_ylim\n(\n0\n,\n5\n)\nplt\n.\nlegend\n()\nplt\n.\nshow\n()\nThe plot should look similar to this:\nNi-d impurity self-energy from OS DMFT\nShowing the Ni\ne\ng\n{\\displaystyle e_g}\nand Ni\nt\n2\ng\n{\\displaystyle t_{2g}}\norbital self-energies separately (real part left, and imaginary part right).\nBoth show typical QMC noise at larger frequencies, with a analytic tail-fitting at frequencies larger than 20 eV.\nStep 4: Perform a CSC DFT+DMFT calculation\nNow we are ready to perform a CSC DFT+DMFT calculation. We create a new directory for the calculation and copy the following files into it:\nINCAR\n,\nPOSCAR\n,\nKPOINTS\n,\nPOTCAR\n,\nplo.cfg\n,\nCHGCAR\n,\nWAVECAR\n, and\ndmft_config.toml\n.\nsolid_dmft will run VASP for us, but we do have to specify\nhow it is run\nby adding the following section to the `dmft_config.toml` file:\n[dft]\nplo_cfg\n=\n\"plo.cfg\"\ndft_code\n=\n\"vasp\"\nprojector_type\n=\n\"plo\"\nn_iter\n=\n4\nn_cores\n=\n32\nmpi_env\n=\n\"default\"\nmpi_exe\n=\n\"/path/to/mpirun\"\ndft_exec\n=\n\"/path/to/bin/vasp_std\"\nHere, you have to change the mpi executable and VASP executable path.\nAlso make sure to adjust the number of cores to be used for the DFT calculations via the\nn_cores\noption.\nSince VASP is performing an iterative SCF calculation updating the charge density while the KS states are converged we perform a few SCF steps between each DMFT call to converge the KS states with the new charge density from DMFT via\nn_iter\n.\nAlso change the following options in the\ndmft_config.toml\nfile:\ncsc\n=\ntrue\nn_iter_dmft_first\n=\n2\nn_iter_dmft_per\n=\n2\nn_iter_dmft\n=\n20\nload_sigma\n=\ntrue\npath_to_sigma\n=\n\"/path/to/dmft-os/U8.0-J1.0-beta20-qmc1e+7/vasp.h5\"\nThis will load the sigma from the file\nvasp.h5\nin the folder\ndmft-os/U8.0-J1.0-beta20-qmc1e+7\nand instruct solid_dmft to perform a CSC calculation.\nAlso add the following lines to the\nINCAR\nfile:\nICHARG\n= 5\nAMIX\n= 0.08\nLSYNCH5\n= True\nICHARG\n=5 will enable the CSC mode in VASP to communicate with TRIQS.\nLSYNCH5\n=True allows TRIQS to write into the hdf5 file created by VASP. Additionally, it may be necessary  on some systems to set the following environment variable before running solid_dmft:\nexport HDF5_USE_FILE_LOCKING=FALSE\nThis is a general hdf5 library runtime flag allowing for simultaneous read / write access to h5 files. However, it depends on the installation of the library if this is necessary or not.\nRun the calculation via\nmpirun solid_dmft 1>out 2>err &\n.\nCheck the directory for the std output and all related DMFT files.\nYou can see that after each 2 DMFT iterations VASP is called to update the KS states for the new charge density.\nIn the observables file you will find that the orbital occupation of orbitals now slightly changes from the OS calculation, showing the effect of charge self-consistency:\nit |         mu |       G(beta/2) per orbital |       orbital occs up+down | impurity occ\n0 |    0.00278 |   -0.00754         -0.10744 |    1.95350         1.28826 |      8.43701\n1 |    0.04795 |   -0.00030         -0.00142 |    1.90322         1.22302 |      8.15570\n2 |    0.03410 |   -0.00003         -0.00136 |    1.88208         1.25063 |      8.14749\n3 |    0.00424 |   -0.00109         -0.00015 |    1.97017         1.15925 |      8.22899\n4 |    0.00043 |   -0.00011   ...   -0.00023 |    1.97342   ...   1.15596 |      8.23216\n5 |   -0.00020 |   -0.00003         -0.00039 |    1.98029         1.15228 |      8.24544\n.\n.\n.\nThe difference is also visible in the final self-energy comparing OS with CSC:\nNi-d impurity self-energy from CSC DFT+DMFT\nThe\ne\ng\n{\\displaystyle e_g}\norbital is now closer to half filling and, thus, more insulating. The large self-energy for\ni\nω\nn\n→\n0\n{\\displaystyle i \\omega_n \\rightarrow 0}\nis signaling a pole in the self-energy at\nω\n=\n0\n{\\displaystyle \\omega=0}\ntypical for a Mott insulator.\nStep 5: calculating the local spectral function\nNext, we are ready to calculate the local spectral function\nA\n(\nω\n)\n{\\displaystyle A(\\omega)}\nof NiO for the Ni-d orbitals.\nThis is the easiest post-processing step, since we can simply calculate the local spectral function based on the impurity Green's function\nG\nm\nm\n′\nimp\n{\\displaystyle G^\\text{imp}_{m m'}}\n.\nHowever, since the impurity solver works on the Matsubara axis, we have to find an analytic continuation of the Green's function to the real frequency axis.\nThe analytic continuation is done using a maximum entropy method in the\nTRIQS/maxent\npackage.\nPrepare a little script in the calculation folder utilizing the post processing functions of solid_dmft:\nimport\nsolid_dmft.postprocessing.maxent_gf_imp\nas\ngimp_maxent\nAimp_csc_w\n=\ngimp_maxent\n.\nmain\n(\nexternal_path\n=\n'vasp.h5'\n,\nomega_min\n=-\n30\n,\nomega_max\n=\n15\n,\nmaxent_error\n=\n0.03\n,\nsum_spins\n=\nTrue\n,\nn_points_maxent\n=\n400\n,\nn_points_alpha\n=\n20\n)\nThe script utilizes MPI for parallelization so run it via\nmpirun python gimp_maxent.py\n.\nThe script will write the local spectral function into the `\nvasp.h5\nfile.\nWe can now plot it via the following code:\n# load the results\nwith\nHDFArchive\n(\n'dmft_csc/vasp.h5'\n,\n'r'\n)\nas\nar\n:\nA_imp_csc_w\n=\nar\n[\n'DMFT_results/last_iter/Aimp_maxent_0'\n]\nfig\n,\nax\n=\nplt\n.\nsubplots\n(\n1\n,\n1\n,\nfigsize\n=\n(\n10\n,\n5\n),\ndpi\n=\n100\n)\nax\n.\nplot\n(\nA_imp_csc_w\n[\n'mesh'\n],\nA_imp_csc_w\n[\n'Aimp_w_line_fit'\n][\n'total_0'\n][\n0\n,\n0\n,:],\nlabel\n=\n'Ni $t_\n{2g}\n$'\n)\nax\n.\nplot\n(\nA_imp_csc_w\n[\n'mesh'\n],\nA_imp_csc_w\n[\n'Aimp_w_line_fit'\n][\n'total_2'\n][\n0\n,\n0\n,:],\nlabel\n=\n'Ni $e_\n{g}\n$'\n)\nax\n.\nset_xlim\n(\n-\n10\n,\n10\n)\nax\n.\nset_ylim\n(\n0\n,)\nax\n.\nset_ylabel\n(\nr\n'A$_{\\text\n{proj}\n}$ states/eV'\n)\nax\n.\nset_xlabel\n(\nr\n'$\\omega$ (eV)'\n)\nplt\n.\nlegend\n()\nplt\n.\nshow\n()\nNi-d projected local spectral function from MaxEnt\nWe can see that the local spectral function is gapped with the\nt\n2\ng\n{\\displaystyle t_{2g}}\norbitals completely filled (compare with DFT initial occupations), and the\ne\ng\n{\\displaystyle e_{g}}\norbital being gapped.\nMind that this is the summed spectral function for up + down spin, with both channels being degenerate.\nFurther reading\nSimilar to DFT, DMFT calculations have many parameters that can be tuned.\nHere, all parameters were carefully chosen to converge the DMFT calculation properly, and close to experiment.\nEspecially, the double counting correction was chosen such that it best fits the experimental data.\n[5]\nTo learn more about TRIQS visit the\nTRIQS Python tutorials\npage.\nAnd for more concrete DMFT tutorials see the\nsolid_dmft tutorials\n.\nHelper functions for python\nimport\nnumpy\nas\nnp\n# plotting\nimport\nmatplotlib.pyplot\nas\nplt\n# TRIQS modules\nfrom\nh5\nimport\nHDFArchive\nfrom\ntriqs.gf\nimport\n*\nfrom\ntriqs.plot.mpl_interface\nimport\nplt\n,\noplot\ndef\nplot_sigma_iw\n(\nS_iw\n,\nax\n,\ncolor\n,\nlabel\n=\n''\n,\nmarker\n=\n'-o'\n,\nsubtract\n=\nTrue\n):\n# convert the mesh to a numpy array\nmesh\n=\nmesh_to_np_arr\n(\nS_iw\n.\nmesh\n)\nmid\n=\nlen\n(\nmesh\n)\n//\n2\nif\nsubtract\n:\nax\n[\n0\n]\n.\nplot\n(\nmesh\n[\nmid\n:],\nS_iw\n.\ndata\n[\nmid\n:,\n0\n,\n0\n]\n.\nreal\n-\nS_iw\n.\ndata\n[\n-\n1\n,\n0\n,\n0\n]\n.\nreal\n,\nmarker\n,\ncolor\n=\ncolor\n,\nlabel\n=\nlabel\n)\nelse\n:\nax\n[\n0\n]\n.\nplot\n(\nmesh\n[\nmid\n:],\nS_iw\n.\ndata\n[\nmid\n:,\n0\n,\n0\n]\n.\nreal\n,\nmarker\n,\ncolor\n=\ncolor\n,\nlabel\n=\nlabel\n)\nax\n[\n1\n]\n.\nplot\n(\nmesh\n[\nmid\n:],\n-\n1\n*\nS_iw\n.\ndata\n[\nmid\n:,\n0\n,\n0\n]\n.\nimag\n,\nmarker\n,\ncolor\n=\ncolor\n,\nlabel\n=\nlabel\n)\nax\n[\n0\n]\n.\nset_xlabel\n(\nr\n\"$i \\omega_n$ (eV)\"\n)\nax\n[\n1\n]\n.\nset_xlabel\n(\nr\n\"$i \\omega_n$ (eV)\"\n)\nax\n[\n0\n]\n.\nset_ylabel\n(\nr\n\"$Re \\Sigma (i \\omega_n)$  (eV)\"\n)\nax\n[\n1\n]\n.\nset_ylabel\n(\nr\n\"$- Im \\Sigma (i \\omega_n)$  (eV)\"\n)\nreturn\ndef\nplot_sigma_w\n(\nS_w\n,\nax\n,\ncolor\n,\nlabel\n=\n''\n,\nmarker\n=\n'-'\n,\nsubtract\n=\nTrue\n):\nmesh\n=\nmesh_to_np_arr\n(\nS_w\n.\nmesh\n)\nmid\n=\nlen\n(\nmesh\n)\n//\n2\nif\nsubtract\n:\nax\n[\n0\n]\n.\nplot\n(\nmesh\n,\nS_w\n.\ndata\n[:,\n0\n,\n0\n]\n.\nreal\n-\nS_w\n.\ndata\n[\nmid\n,\n0\n,\n0\n]\n.\nreal\n,\nmarker\n,\ncolor\n=\ncolor\n,\nlabel\n=\nlabel\n)\nelse\n:\nax\n[\n0\n]\n.\nplot\n(\nmesh\n,\nS_w\n.\ndata\n[:,\n0\n,\n0\n]\n.\nreal\n,\nmarker\n,\ncolor\n=\ncolor\n,\nlabel\n=\nlabel\n)\nax\n[\n1\n]\n.\nplot\n(\nmesh\n,\n-\n1\n*\nS_w\n.\ndata\n[:,\n0\n,\n0\n]\n.\nimag\n,\nmarker\n,\ncolor\n=\ncolor\n,\nlabel\n=\nlabel\n)\nax\n[\n0\n]\n.\nset_xlabel\n(\nr\n\"$\\omega$ (eV)\"\n)\nax\n[\n1\n]\n.\nset_xlabel\n(\nr\n\"$\\omega$ (eV)\"\n)\nax\n[\n0\n]\n.\nset_ylabel\n(\nr\n\"$Re \\Sigma (\\omega)$  (eV)\"\n)\nax\n[\n1\n]\n.\nset_ylabel\n(\nr\n\"$- Im \\Sigma (\\omega)$  (eV)\"\n)\nreturn\ndef\nmesh_to_np_arr\n(\nmesh\n):\nfrom\ntriqs.gf\nimport\nMeshImTime\n,\nMeshReFreq\n,\nMeshImFreq\nif\nisinstance\n(\nmesh\n,\nMeshReFreq\n):\nmesh_arr\n=\nnp\n.\nlinspace\n(\nmesh\n.\nw_min\n,\nmesh\n.\nw_max\n,\nlen\n(\nmesh\n))\nelif\nisinstance\n(\nmesh\n,\nMeshImFreq\n):\nmesh_arr\n=\nnp\n.\nlinspace\n(\nmesh\n(\nmesh\n.\nfirst_index\n())\n.\nimag\n,\nmesh\n(\nmesh\n.\nlast_index\n())\n.\nimag\n,\nlen\n(\nmesh\n))\nelif\nisinstance\n(\nmesh\n,\nMeshImTime\n):\nmesh_arr\n=\nnp\n.\nlinspace\n(\n0\n,\nmesh\n.\nbeta\n,\nlen\n(\nmesh\n))\nelse\n:\nraise\nAttributeError\n(\n'input mesh must be either MeshReFreq, MeshImFreq, or MeshImTime'\n)\nreturn\nmesh_arr\nRelated tags and articles\nvaspgamma.h5\n,\nGAMMA\n,\nICHARG\n,\nMatsubara formalism\nReferences\n↑\na\nb\nG. Kotliar, S. Y. Savrasov, K. Haule, V. S. Oudovenko, O. Parcollet, and C. A. Marianetti,\nElectronic structure calculations with dynamical mean-field theory\n, Rev. Mod. Phys.\n78\n, 865 (2006)\n↑\nO. Parcollet, M. Ferrero, T. Ayral, H. Hafermann, I. Krivenko, L. Messio and P. Seth, Computer Physics Communications\n196\n, 398 (2015).\n↑\nM. E. Merkel, A. Carta, S. Beck and Alexander Hampel, Journal of Open Source Software\n7\n, 77 (2022).\n↑\nM. Schüler, O.E. Peil, G.J. Kraberger, R. Pordzik, M. Marsman, G. Kresse, T.O. Wehling, and M. Aichhorn, J. Phys.: Condens. Matter\n30\n, 475901 (2018).\n↑\nM. Karolak, G. Ulm, T. Wehling, V. Mazurenko, A. Poteryaev, and A. Lichtenstein,\nDouble counting in LDA+DMFT—The example of NiO\n, J. Electron Spectros. Relat. Phenomena\n118\n, 11 (2010)."
  }, 
  "Dipole corrections for defects in solids": {
    "description": "This web page discusses the challenges and corrections needed for accurately calculating the energies of charged defects in semiconductors using supercell models, particularly addressing the effects of spurious electrostatic interactions between periodic images, the influence of dielectric constants, and the importance of applying dipole and quadrupole corrections to minimize errors—especially in cases involving small lattice constants, low dielectric constants", 
    "detailed_description": "Similar to the case of charged atoms and molecules in a large cubic box also charged defects in semiconductors impose the problem of potentially slow convergence of the results with respect to the supercell size due to spurious electrostatic interaction between defects in neighboring supercells. Generally,\nthe errors are less dramatic than for charged atoms or molecules since the\ncharged defect is embedded in a dielectric medium (bulk) and all spurious\ninteractions between neighboring cells are scaled down by the bulk dielectric\nconstant\nε\n{\\displaystyle \\varepsilon}\n. Hence, the total error might remain small (order of 0.1\neV) and one has not to worry too much about spurious electrostatic interactions\nbetween neighboring cells. However, there exist three critical cases where one\nshould definitely start to worry (and to apply dipole corrections):\nSemiconductors containing first-row elements since they possess rather small lattice constants and hence the distance between two neighboring defects is smaller than in most other semiconductor materials (though one should note that the smaller lattice constant alone must not yet increase the errors dramatically since the leading scaling is\n1\n/\nL\n{\\displaystyle 1/L}\n, only the contributions scaling\n1\n/\nL\n3\n{\\displaystyle 1/L^3}\nmay become dangerous for small cells).\nSemiconductors with a rather small dielectric constant\nε\n{\\displaystyle \\varepsilon}\n.\nHigh-charge states like 3+, 4+, 3- or 4- since the spurious interactions scale (approximately) proportional to the square of the total cell charge, e.g., for a 4+ state the error is about 16 times larger than for a 1+ state!\nThe worst case one can ever think of is that all three conditions mentioned\nabove are fulfilled simultaneously. In this case the corrections can amount to\nthe order of several eV (instead of the otherwise typical order of few 0.1 eV)!\nIn principle it is possible to apply the same procedure as in the case of\ncharged atoms and molecules in vacuum. However, with the current implementation one has to care about following things and following restrictions apply:\nUnfortunately a full correction is only possible for cubic cells, the only contribution which can always be corrected for any arbitrary cell shape, is the monopole-monopole interaction. However, for intermediate cell sizes the quadrupole-monopole interaction is not always negligible (it can reach the order of minus 30-40 % of the monopole-monopole term). Therefore, whenever possible the use of cubic cells is recommended. Otherwise one should try to use as large as possible cells (the dipole-dipole and monopole-quadrupole interactions scale like\n1\n/\nL\n3\n{\\displaystyle 1/L^3}\nand therefore, for larger cells a monopole-monopole correction alone becomes more and more reliable).\nThe corrections are only reasonable if the defect-induced perturbation of the charge density is strictly localized around the defect, i.e., if only the occupation of localized defect states is changed. Whenever the problem occurs that (partially) wrong bands (e.g. delocalized conduction band or valence band states instead of defect states) are occupied the calculated corrections become meaningless (the correction formulas are not valid for overlapping charges)! Therefore one should first calculate       the difference between the charge densities of the charged defect cell and the ideal unperturbed bulk cell and check the localization of this difference charge (in between the defects the difference must vanish within the numerical error bars for the charge densities)!\nDon't forget to scale down all results by the bulk dielectric constant\nε\n{\\displaystyle \\varepsilon}\n! Yet, there is no possibility to enter any dielectric constant, all corrections are calculated and printed for\nε\n=\n1\n{\\displaystyle \\varepsilon=1}\n. Therefore, the corrected total energies printed after the final electronic iteration are meaningless! Hence, you should first calculate the energies without any corrections and later you have to add the corrections\nby hand\nusing the output printed in the\nOUTCAR\nfile. You must search for a line\nDIPCOR: dipole corrections for dipole\nand following lines. There you find the dipole moment, the quadrupole moment and the energy corrections. One should note that strictly one has to take the dielectric constant calculated by first-principles methods. Since VASP does not yet allow a simple calculation of dielectric constants, however, you have to use the experimental value (or values taken from other calculations). This empirism introduces slight uncertainties in your energy corrections. However, one can expect that the uncertainty should rarely exceed 5-10% since dielectric constants taken from experiment and those obtained from first-principles calculations usually agree very well (often within the order of 1-3%).\nThe dipole-dipole plus quadrupole-monopole corrections printed in\nOUTCAR\nare meaningless in their original form! We have to calculate a correction for the defect-induced multipoles, but since we have also included the surrounding bulk a quadrupole moment associated with the corresponding charge (extending over the whole cell!) is also included in the printed quadrupole moment (and in the corresponding energy corrections). Since in systems with cubic symmetry dipoles are forbidden by symmetry a dipole moment can only be defect induced (and only if the cubic symmetry is broken by atomic relaxations). In order to obtain the correct (usually quadrupole-monopole interaction only) energy correction, one has to proceed as follows:\nOne has to calculate the quadrupole moment for an ideal bulk cell (neutral!) by setting\nIDIPOL\n=4 and\nDIPOL\n= same as in the defect cell (search for the line containing\nTr[quadrupol] ...\nin the\nOUTCAR\nfile).\nThe corresponding quadrupole moment has to be subtracted from the quadrupole moment printed for the charged defect cell. The difference corresponds to the defect-induced part of the quadrupole moment.\nIf no dipole-dipole interaction is present you can now simply scale down the energy printed on the line\ndipol+quadrupol energy correction ...\nin the\nOUTCAR\nfile by the ratio\ndefect-induced quadrupole/total cell quadrupole\nsince this interaction is proportional to the quadrupole moment. After this scaling you should end up with reasonable numbers (usually smaller than the monopole-monopole correction printed on the line containing\nenergy correction for charged system ...\nin the\nOUTCAR\nfile).\nAdd now the corrected value for the quadrupole-monopole interaction to the calculated monopole-monopole interaction energy (and finally scale the sum wit\n1\n/\nε\n{\\displaystyle 1/\\varepsilon}\n).\nThe whole procedure is even more complicated if a dipole moment occurs also, since then only the quadrupole-monopole term has to be corrected but the dipole-dipole term is already correct!\nBut you can easily help yourself: Take simply a cell of the same dimension and calculate a free ion (does not matter which one) of the same charge state (if this causes trouble try the opposite state, e.g. 4+ instead of 4-, but don't forget then to take the opposite sign for the printed monopole quadrupole energy since this energy is proportional to the cell charge). The calculation will provide a quadrupole moment and a certain quadrupole-monopole interaction energy. Since this energy is proportional to the quadrupole moment (times total cell charge) you can estimate the proportionality constant with which one has to multiply the quadrupole moment in order to obtain the corresponding monople-quadrupole interaction for the given cell size by dividing the energy by the quadrupole moment. Multiplying this constant by the quadrupole moment of the defect cell you can now calculate the quadrupole-monopole contribution alone and the dipole-dipole contribution is then known too. The dipole-dipole contribution will be kept and the defect-induced quadrupole-monopole contribution has to be added to this (just multiply the proportionality constant with the defect-induced} quadrupole moment).\nThen you finally end up with the correct values for all interactions (which have to be summed again and rescaled with\n1\n/\nε\n{\\displaystyle 1/\\varepsilon}\n). It's currently a clumsy procedure but it works satisfactorily.\nAny potential correction (\nLDIPOL\n=\n.TRUE.\n) is currently impossible! Hence you can only use\nLDIPOL\n=\n.FALSE.\n! The reasons are:\nFirst the downscaling with\nε\n{\\displaystyle \\varepsilon}\nis missing and second the correction is not calculated from the defect-induced multipoles but from the total monopoles of the defect cell containing at least a meaningless quadrupole contribution (one had to subtract the quadrupole moment of the ideal cell before calculating any correction potential, but this is not yet implemented in the routine dipol.F). However, one has to expect that the potential corrections do not change the results dramatically ...\nBesides charged defects there's another critical type of defects which may cause serious trouble (and for which one should also apply dipole corrections):\nneutral defects\nor\ndefect complexes of low symmetry\n. For such defects a dipole moment may occur leading to considerable dipole-dipole interactions. Though they fall off like\n1\n/\nL\n3\n{\\displaystyle 1/L^3}\nthey might not be negligible (even for somewhat larger cells) if the induced dipole moment is rather large. The worst case that can happen is a defect complex with two (or more) rather distant defects (separated by distances of the order of nearest-neighbor bond lengths or larger) with a strong charge transfer between the defects forming the complex (e.g., one defect might possess the charge state 2+ and the other one the charge state 2-). This can easily happen for defect complexes representing acceptor-donor pairs. The most critical cases are again given for semiconductors with rather small lattice constants, rather small dielectric constants and for any defect complex causing strong charge transfers. Again the same restrictions and comments hold as stated above for charged cells:\nYou may currently only use cubic cells,\nLDIPOL\n=\n.FALSE.\nand you have to rescale the correction printed in\nOUTCAR\nby the bulk dielectric constant\nε\n{\\displaystyle \\varepsilon}\n(i.e., the printed energies are again meaningless and have to be corrected\nby hand\n). There is only one point which might help, that is since in cubic cells any dipole moment can only be defect-induced no additional corrections are necessary (in contrast to the monopole-quadrupole energies of charged cells).  *The other bad news is that for such defect complexes it may sometimes be hard to find the correct\ncenter of mass\n(\nDIPOL\nin\nINCAR\nfile) for the defect induced charge perturbation (it's usually more easy for single point defects since\nDIPOL\n=\nposition of the point defect\nis the correct choice). This introduces some uncertainties and one might try different values for\nDIPOL\n(the one giving the minimum correction should be the correct one).\nDIPOL\nis internally aligned to the position of the closest FFT-grid point in real space. Hence, the position\nDIPOL\nis only determined within distances corresponding to the FFT-grid spacing (controlled by\nNGXF\n,\nNGYF\n, and\nNGZF\n). This might also play a certain role if for charged single point defects the position of the defect is not chosen to be (0,0,0)! In this case\nDIPOL\nmight correspond to a position lying slightly off the position of the defect what may also introduces inaccuracies in the calculation of the electrostatic interactions (i.e., apparent dipole moments may occur which should be zero if the correct position\nDIPOL\nwould have been chosen). In this case you should whenever possible try to adjust your FFT-grid in such a way that the position of the defect matches exactly some FFT-grid point in real space or otherwise never use any other (point) defect position than (0,0,0)...\nA\nfinal note\nhas to be made: besides the electrostatic interactions there exist also spurious elastic interactions between neighboring cells which (according to a simple\nelastic dipole lattice model\n) should scale like\n1\n/\nL\n3\n{\\displaystyle 1/L^3}\n(leading order). Therefore, the corrected values may still show a certain variation with respect to the supercell size. One can check the relaxation energies (elastic energies) separately by calculating (and correcting) also unrelaxed cells (defect plus remaining atoms in their ideal bulk positions). If the k-point sampling is sufficient to obtain well-converged results (with respect to the BZ integration) one might even try to extrapolate the elastic interaction energies empirically by plotting the relaxation energies versus\n1\n/\nL\n3\n{\\displaystyle 1/L^3}\n(hopefully a linear function; if not try to plot it against\n1\n/\nL\n5\n{\\displaystyle 1/L^5}\nand look whether it matches a linear function) and taking the value for\n1\n/\nL\n→\n0\n{\\displaystyle 1/L \\rightarrow 0}\n(i.e. the axis offset). However, usually the remaining errors due to spurious elastic interactions can be expected to be small (rarely larger than about 0.1 eV) and the extrapolation towards\nL\n→\n∞\n{\\displaystyle L \\rightarrow \\infty}\nmay also be rather unreliable if the results are not perfectly converged with respect to the k-point sampling (though one should note that this may then hold for the electrostatic corrections too)."
  }, 
  "Electron-energy-loss spectrum": {
    "description": "This web page explains how electron-energy-loss spectroscopy (EELS) is used to probe material excitations by analyzing the interaction of incoming electrons with the material's electronic structure, and describes the theoretical framework and computational methods—particularly using VASP at various levels of approximation such as DFT and TDDFT—to calculate the macroscopic dielectric function and extract EELS spectra.", 
    "detailed_description": "One of the many ways in which it is possible to probe neutral excitations in a material is by injecting electrons into the sample. These are called electron-energy-loss spectroscopy experiments, where the incoming electron can create bound electron-hole pairs (i.e. excitons), plasmons, or even higher-order multi-pair excitations.\nThe incoming electron acts as an external potential,\nV\ne\nx\nt\n(\nr\n′\n,\nt\n′\n)\n{\\displaystyle V_\\mathrm{ext}(\\mathbf r', t')}\n, which induces a charge density in the material,\nρ\ni\nn\nd\n(\nr\n,\nt\n)\n{\\displaystyle \\rho_\\mathrm{ind}(\\mathbf r, t)}\n. Within linear-response theory these two quantities can be related by the reducible polarisability function,\nχ\n{\\displaystyle \\chi}\n, via a Green-Kubo relation\nρ\ni\nn\nd\n(\nr\n,\nt\n)\n=\n∫\nd\n3\nr\n′\nd\nt\nχ\n(\nr\n,\nt\n,\nr\n′\n,\nt\n′\n)\nV\ne\nx\nt\n(\nr\n′\n,\nt\n′\n)\n.\n{\\displaystyle\n\\rho_\\mathrm{ind}(\\mathbf r, t) = \\int \\mathrm d^3r'\\mathrm d t \\chi(\\mathbf r, t,\\mathbf r', t')V_\\mathrm{ext}(\\mathbf r', t').\n}\nIf the external potential is taken as proportional to a plane-wave of momentum\nq\n{\\displaystyle \\mathbf q}\n, then the electron energy-loss spectrum (EELS) can be taken from the imaginary part of the inverse\ndielectric function\n,\nϵ\n−\n1\n(\nq\n,\nω\n)\n{\\displaystyle \\epsilon^{-1}(\\mathbf q,\\omega)}\n, since\nϵ\n−\n1\n=\n1\n+\nv\nχ\n{\\displaystyle \\epsilon^{-1} = 1 + v\\chi}\nE\nE\nL\nS\n(\nq\n,\nω\n)\n=\n−\nI\nm\n[\nϵ\n−\n1\n(\nq\n,\nω\n)\n]\n.\n{\\displaystyle\n\\mathrm{EELS}(\\mathbf q,\\omega) = -\\mathrm{Im}\\left[\\epsilon^{-1}(\\mathbf q,\\omega)\\right].\n}\nInclusion of local fields\nIn general, the microscopic quantity\nϵ\n−\n1\n{\\displaystyle \\epsilon^{-1}}\nis a function of two coordinates, i.e.\nϵ\n−\n1\n:=\nϵ\n−\n1\n(\nr\n,\nr\n′\n,\nω\n)\n{\\displaystyle \\epsilon^{-1} := \\epsilon^{-1}(\\mathbf r , \\mathbf r', \\omega)}\n. This has important consequences on inhomogeneous systems where a homogeneous, constant, external electric field can induce fluctuations at the interatomic scale, and thus create\nmicroscopic fields\n. A direct consequence of the inhomogeneous character of the system is that in reciprocal space\nϵ\n{\\displaystyle \\epsilon}\nhas to be written as\nϵ\nG\n,\nG\n′\n(\nq\n,\nω\n)\n{\\displaystyle \\epsilon_{\\mathbf G, \\mathbf G'}(\\mathbf q, \\omega)}\n, where\nG\n{\\displaystyle  \\mathbf G}\nis a reciprocal lattice vector. The microscopic fields are then the\nG\n≠\n0\n{\\displaystyle \\mathbf G \\neq 0}\ncomponents of the tensor.\nFrom\nϵ\n−\n1\n=\n1\n+\nv\nχ\n{\\displaystyle \\epsilon^{-1} = 1 + v\\chi}\nit is possible to see that a problem arises when\nq\n→\n0\n{\\displaystyle \\mathbf q \\to 0}\n, i.e. the optical limit. In reciprocal space, this equation becomes\nϵ\nG\n,\nG\n′\n−\n1\n(\nq\n,\nω\n)\n=\nδ\nG\n,\nG\n′\n+\n4\nπ\n|\nq\n+\nG\n|\n2\nχ\nG\n,\nG\n′\n(\nq\n,\nω\n)\n{\\displaystyle\n\\epsilon^{-1}_{\\mathbf G, \\mathbf G'}(\\mathbf q, \\omega) = \\delta_{\\mathbf G, \\mathbf G'} + \\frac{4\\pi}{|\\mathbf q + \\mathbf G|^2}\\chi_{\\mathbf G, \\mathbf G'}(\\mathbf q, \\omega)\n}\nwhere\nv\n(\nq\n+\nG\n)\n=\n4\nπ\n/\n|\nq\n+\nG\n|\n2\n{\\displaystyle v(\\mathbf q + \\mathbf G) = 4\\pi/|\\mathbf q + \\mathbf G|^2}\nis the Coulomb potential. At\nq\n=\n0\n{\\displaystyle \\mathbf q= 0}\n, all components without microscopic fields are divergent. To circumvent this issue, the evaluation of\nϵ\n−\n1\n{\\displaystyle \\epsilon^{-1}}\nis replaced the Coulomb potential with\nv\n¯\n(\nq\n+\nG\n)\n=\n{\n0\n,\nG\n=\n0\n4\nπ\n/\n|\nq\n+\nG\n|\n2\n,\nG\n≠\n0\n,\n{\\displaystyle\n\\bar v(\\mathbf q + \\mathbf G) = \\left\\{\n\\begin{array}{ll}\n0, & \\mathbf G=0 \\\\\n4\\pi/|\\mathbf q + \\mathbf G|^2, & \\mathbf G\\neq 0\n\\end{array}\n\\right.,\n}\nleaving the\nv\n0\nχ\n00\n{\\displaystyle v_0\\chi_{00}}\ncomponent to be dealt with separately and then added at the end.\nMicro-macro connection and relation to measured quantities\nIt is important to note that the actual measured quantity,\nϵ\nM\n(\nq\n,\nω\n)\n{\\displaystyle \\epsilon_\\mathrm{M}(\\mathbf q, \\omega)}\n, does not depend on the microscopic fields\n[1]\n. To connect both the microscopic and macroscopic quantities, an averaging procedure is taken out, so that\nϵ\nM\n(\nq\n,\nω\n)\n=\n1\nϵ\nG\n=\n0\n,\nG\n′\n=\n0\n−\n1\n(\nq\n,\nω\n)\n.\n{\\displaystyle\n\\epsilon_{\\mathrm M}(\\mathbf q,\\omega) = \\frac{1}{\\epsilon_{\\mathbf G = 0, \\mathbf G'=0}^{-1}(\\mathbf q,\\omega)}.\n}\nSince VASP computes the macroscopic function, EELS can be extracted from the final result via\nE\nE\nL\nS\n(\nω\n)\n=\n−\nI\nm\n[\n1\nϵ\nM\n(\nq\n,\nω\n)\n]\n{\\displaystyle\n\\mathrm{EELS}(\\omega) = -\\mathrm{Im}\\left[\\frac{1}{\\epsilon_{\\mathrm M}(\\mathbf q,\\omega)}\\right]\n}\nNote that the inclusion of local fields and the connection to the macroscopic observable must be considered regardless of the level of approximation to the polarisability function,\nχ\n{\\displaystyle \\chi}\n. Within VASP, this can be done at several levels of approximation, which are discussed in the next section.\nComputing EELS with VASP\nEELS from density functional theory (DFT)\nThe simplest calculation that yields a macroscopic dielectric function is a ground state calculation using DFT, with the tags\nNBANDS\nand\nLOPTICS\n. Using bulk silicon as an example with the following\nINCAR\nSYSTEM\n= Si\nNBANDS\n= 48\nISMEAR\n= 0 ;\nSIGMA\n= 0.1\nALGO\n= N\nLOPTICS\n= .TRUE.\nCSHIFT\n= 0.4\nthe macroscopic dielectric function can be extracted from the vasprun.xml file at the end of the calculation by first running the following script\nawk\n'BEGIN{i=0} /<dielectricfunction comment=\"density-density\">/,\\\n/<\\/dielectricfunction>/ \\\n{if ($1==\"<r>\") {a[i]=$2 ; b[i]=($3+$4+$5)/3 ; c[i]=$4 ; d[i]=$5 ; i=i+1}} \\\nEND{for (j=0;j<i/2;j++) print a[j],b[j],b[j+i/2]}'\nvasprun.xml > dielectric_function.DFT.dat\nwhich writes the trace of the tensor to a file called\ndielectric_function.DFT.dat\n. Plotting the EEL spectrum can be done with visualization software like Gnuplot, using the following command as an example:\np\n'dielectric_function.DFT.dat'\nu\n1\n:\n(\n$2\n/\n(\n$2\n**2+\n$3\n**2\n))\nw l lc rgb\n'black'\nt\n'DFT'\nImaginary part of the inverse macroscopic dielectric function for bulk Si from DFT.\nThe results of this DFT calculation should be analyzed with the following considerations in mind. Firstly, this calculation is performed only for\nq\n=\n0\n{\\displaystyle \\mathbf q = 0}\n, with no local fields considered. Because of this, the dielectric function from DFT is often called the\nindependent particle random-phase approximation dielectric function\n. Secondly, no interactions between electrons and holes are included in the evaluation of the dielectric function. To account for both local-field effects and the electron-hole interaction, approximations beyond DFT must be taken into account.\nPlotting the EELS can also be done using\npy4vasp\nas a Python module. Take the next script as an example, where the\nvaspout.h5\nhad its name changed to\nvaspout.DFT.h5\n:\nimport\npy4vasp\nimport\nnumpy\nas\nnp\nimport\nmatplotlib.pyplot\nas\nplt\ncalc\n=\npy4vasp\n.\nCalculation\n.\nfrom_file\n(\n'vaspout.DFT.h5'\n)\nenergies\n=\ncalc\n.\ndielectric_function\n.\nread\n(\n''\n)[\n'energies'\n]\n# Only the xx-component of the dielectric function is read\nepsilon\n=\ncalc\n.\ndielectric_function\n.\nread\n(\n''\n)[\n'dielectric_function'\n][\n1\n][\n1\n][:]\neels\n=\n-\nnp\n.\nimag\n(\n1.0\n/\nepsilon\n)\nplt\n.\nplot\n(\nenergies\n,\neels\n,\nlabel\n=\n'DFT'\n)\nplt\n.\nylabel\n(\nr\n'-Im[$\\epsilon^{-1}_M$]'\n)\nplt\n.\nxlabel\n(\n'Energy loss [eV]'\n)\nplt\n.\nlegend\n()\nplt\n.\nshow\n()\nEEL spectrum from DFT plotted with py4vasp.\nNote that for the case of bulk Silicon, since the material is centrosymmetric, it suffices to plot one component of the 3x3 tensor. For non-symmetric systems, it is better to take the trace of the dielectric function.\nEELS from time-dependent density functional theory (TDDFT)\nVASP can compute the macroscopic dielectric function employing\nTDDFT calculations\nusing different functionals. Such calculations not only account for the electron-hole interaction beyond the independent particle level but also include local fields and can be performed at points in the Brillouin zone other than\nΓ\n{\\displaystyle \\Gamma}\n.\nThe evaluation of\nϵ\nM\n{\\displaystyle \\epsilon_{\\mathrm M}}\nis performed via Casida's equation, set with\nALGO\n=TDHF in the\nINCAR\n. The following\nINCAR\nwill be used as an example, where the electron-hole interaction is included using a\nmodel dielectric function\n. The specific solver that details how\nϵ\nM\n{\\displaystyle \\epsilon_\\mathrm{M}}\nis built is chosen with the tag\nIBSE\n. Other options are available, with more information to be found on the\nBethe-Salpeter equations page\n.\nSYSTEM\n= Si\nISMEAR\n= 0\nSIGMA\n= 0.1\nNBANDS\n= 48\nALGO\n= TDHF\nCSHIFT\n= 0.4\nIBSE\n= 0\nNBANDSO\n= 4       ! number of occupied bands\nNBANDSV\n= 8       ! number of unoccupied bands\nLHARTREE\n= .TRUE.\nLADDER\n= .TRUE.\nLFXC\n= .FALSE.\nLMODELHF\n= .TRUE.\nAEXX\n= 0.083\nHFSCREEN\n= 1.22\nAt the end of the calculation, the dielectric function can be extracted from the vasprum.xml or\nvaspout.h5\nfiles. Results are shown at the end of the next subsection in order to compare TDDFT and many-body perturbation theory approaches.\nEELS from many-body perturbation theory (MBPT)\nThe addition of electron-hole interactions to the dielectric function can also be done performing\ncalculations at the MBPT level\n, with\nALGO\n=BSE. The caveat is that VASP requires a previous\nGW calculation\nin order to generate the\nWFULLxxxx.tmp\nfiles, where the dielectric screening is stored.\nLike in the TDDFT case, users can select which algorithm to use when evaluating\nϵ\nM\n{\\displaystyle \\epsilon_\\mathrm{M}}\nvia the tag\nIBSE\n. In the\nINCAR\nfile used as an example below, the exact diagonalization solver is employed\nSYSTEM\n= Si\nISMEAR\n= 0\nSIGMA\n= 0.1\nNBANDS\n= 48\nALGO\n= BSE\nCSHIFT\n= 0.4\nIBSE\n= 2\nNBANDSO\n= 4       ! number of occupied bands\nNBANDSV\n= 8       ! number of unoccupied bands\nLHARTREE\n= .TRUE.\nLADDER\n= .TRUE.\nand the same number of virtual and occupied states are used, but now, no information is given about any parameters to model the electron-hole interaction.\nExtracting the data at the end of the calculation can be done for both MBPT and TDDFT using the following script. Edit it to use the right vasprun.xml file.\nawk\n'BEGIN{i=0} /<dielectricfunction>/,\\\n/<\\/dielectricfunction>/ \\\n{if ($1==\"<r>\") {a[i]=$2 ; b[i]=($3+$4+$5)/3 ; c[i]=$4 ; d[i]=$5 ; i=i+1}} \\\nEND{for (j=0;j<i/2;j++) print a[j],b[j],b[j+i/2]}'\nvasprun.BSE.xml > dielectric_function.BSE.dat\nMind:\nIf both TDDFT and MBPT calculations are run in the same directory, VASP will overwrite the vasprun.xml and\nvaspout.h5\nfiles, making it impossible to compare both calculations. Please be sure to either change the name of this file after each calculation or perform both calculations in different directories.\nPlotting both results can be done in gnuplot using\np 'dielectric_function.BSE.dat' u 1:($2/($2**2+$3**2)) w l lc rgb 'black' t 'BSE', \\\n'dielectric_function.TDHF.dat' u 1:($2/($2**2+$3**2)) w l lc rgb 'red' t 'TDHF'\nwhich results in the following figure.\nImaginary part of the inverse macroscopic dielectric function for bulk Si from both BSE and TDHF at\nΓ\n{\\displaystyle \\Gamma}\n-point.\nBoth spectra look very similar, the differences is due to the treatment of the electron-hole interaction in both TDDFT and BSE case. This is both, a consequence of the appropriate choice of\nAEXX\nand\nHFSCREEN\nparameters, as well as the fact that bulk Silicon is a centrosymmetric material, so the model dielectric function works well here. However, while the use of a model (diagonal) dielectric function is well suited for bulk Silicon, for systems with lower symmetry, the off-diagonal elements that are ignored here will be important and can lead to larger discrepancies in the results from TDDFT and MBPT.\nTo plot the EEL spectrum with\npy4vasp\n, it should be noted that the type of calculation has to be specified when reading the dielectric function. It is simply a matter of editing the following script\nimport\npy4vasp\nimport\nnumpy\nas\nnp\nimport\nmatplotlib.pyplot\nas\nplt\ncalc_bse\n=\npy4vasp\n.\nCalculation\n.\nfrom_file\n(\n'vaspout.BSE_Q1.h5'\n)\ncalc_tdhf\n=\npy4vasp\n.\nCalculation\n.\nfrom_file\n(\n'vaspout.TDHF_Q1.h5'\n)\n# The type of calculation must be specified, with the addition of the 'BSE' string\nenergies\n=\ncalc_bse_q1\n.\ndielectric_function\n.\nread\n(\n'BSE'\n)[\n'energies'\n]\nepsilon_bse\n=\ncalc_bse\n.\ndielectric_function\n.\nread\n(\n'BSE'\n)[\n'dielectric_function'\n][\n1\n][\n1\n][:]\n# The type of calculation must be specified, with the addition of the 'TDHF' string\nepsilon_tdhf\n=\ncalc_tdhf\n.\ndielectric_function\n.\nread\n(\n'TDHF'\n)[\n'dielectric_function'\n][\n1\n][\n1\n][:]\neels_bse\n=\n-\nnp\n.\nimag\n(\n1.0\n/\nepsilon_bse\n)\neels_tdhf\n=\n-\nnp\n.\nimag\n(\n1.0\n/\nepsilon_tdhf\n)\nplt\n.\nplot\n(\nenergies\n,\neels_bse\n,\n''\n,\nlabel\n=\n'BSE'\n)\nplt\n.\nplot\n(\nenergies\n,\neels_tdhf\n,\n''\n,\nlabel\n=\n'TDHF'\n)\nplt\n.\nylabel\n(\nr\n'-Im[$\\epsilon^{-1}_M$]'\n)\nplt\n.\nxlabel\n(\n'Energy loss [eV]'\n)\nplt\n.\nlegend\n()\nplt\n.\nshow\n()\nwhich will produce the following plot for EELS.\nEELS plot using\npy4vasp\nfor bulk Si from both BSE and TDHF at\nΓ\n{\\displaystyle \\Gamma}\n-point.\nCalculations at finite momentum\nWarning:\nWith VASP, finite momentum calculations at TDDFT or BSE level, i.e.\nALGO\n=TDHF or BSE, must always use\nANTIRES\n=2 regardless of the solver, functional, or approximation used for the electron-hole interaction. Otherwise, the results will be unphysical!\nThe macroscopic dielectric function can be evaluated at other points in the Brillouin zone. First, it is important to check the point list in the\nOUTCAR\nor\nIBZKPT\nfrom the ground-state calculation. In the\nOUTCAR\nthe points are listed  in this section\nSubroutine IBZKPT returns following result:\n===========================================\nFound\n16\nirreducible k-points:\nFollowing reciprocal coordinates:\nCoordinates               Weight\n0\n.000000\n0\n.000000\n0\n.000000\n1\n.000000\n0\n.166667\n0\n.000000\n0\n.000000\n8\n.000000\n0\n.333333\n0\n.000000\n0\n.000000\n8\n.000000\n...\nwith the first three entries being the reduced coordinates, the fourth entry being the weight of the respective point. The same information is also repeated in the\nIBZKPT\nfile, where the points are listed as\nAutomatically generated mesh\n16\nReciprocal lattice\n0\n.00000000000000\n0\n.00000000000000\n0\n.00000000000000\n1\n0\n.16666666666667\n0\n.00000000000000\n0\n.00000000000000\n8\n0\n.33333333333334\n0\n.00000000000000\n0\n.00000000000000\n8\n...\nThe point at which\nϵ\nM\n(\nq\n,\nω\n)\n{\\displaystyle \\epsilon_M(\\mathbf q,\\omega)}\nis going to be computed is then selected in the\nINCAR\nfile with the tag\nKPOINT_BSE\n. The syntax is\nKPOINT_BSE = index_of_k-point  n1 n2 n3\nwhere the first entry is the index of the point on the list found in the\nOUTCAR\nor\nIBZKPT\nfiles, and\nn\ni\n,\ni\n=\n1\n,\n2\n,\n3\n{\\displaystyle n_i,\\, i=1,2,3}\noptional integer arguments. If present, these three indices can be used the evaluate the dielectric function at a k point outside of the first Brillouin zone corresponding to\nk\n+\nn\n1\nb\n1\n+\nn\n2\nb\n2\n+\nn\n3\nb\n3\n.\n{\\displaystyle  \\bold{k} + n_{1} \\bold{b}_{1}+ n_{2} \\bold{b}_{2} + n_{3} \\bold{b}_{3}. }\nStill using bulk silicon as an example, the following\nINCAR\nevaluates\nϵ\nM\n(\nq\n,\nω\n)\n{\\displaystyle \\epsilon_M(\\mathbf q,\\omega)}\nat the second k-point on the list\nSYSTEM\n= Si\nNBANDS\n= 48\nNBANDSO\n= 4 ;\nNBANDSV\n= 8\nISMEAR\n= 0 ;\nSIGMA\n= 0.1\nEDIFF\n= 1E-8\nALGO\n= BSE\nLADDER\n= .TRUE.\nLHARTREE\n= .TRUE.\nANTIRES\n= 2\nCSHIFT\n= 0.4\nIBSE\n= 2\nKPOINT_BSE\n= 2\nOMEGAMAX\n= 30\nExtracting the dielectric function from the vasprun.xml file is done similarly as\nΓ\n{\\displaystyle \\Gamma}\n-point calculations, but with a small caveat that the dielectric function now only has one single component. Use the following script\nawk\n'BEGIN{i=0} /<dielectricfunction>/,\\\n/<\\/dielectricfunction>/ \\\n{if ($1==\"<r>\") {a[i]=$2 ; b[i]=$3 ; c[i]=$4 ; d[i]=$5 ; i=i+1}} \\\nEND{for (j=0;j<i/2;j++) print a[j],b[j],b[j+i/2]}'\nvasprun.xml > dielectric_function.TDHF.dat\nto extract the data and plot the EELS result using Gnuplot.\nImaginary part of the inverse macroscopic dielectric function for bulk Si from both BSE and TDHF for\nKPOINT_BSE\n=2. In this example it corresponds to the coordinates\n(\n0.5\n,\n0.0\n,\n0.0\n)\n{\\displaystyle (0.5,0.0,0.0)}\nin reciprocal space.\nMuch like calculations at\nΓ\n{\\displaystyle \\Gamma}\n, results from model TDDFT are very close to those from MBPT. The reduction in intensity for spectra away from\nΓ\n{\\displaystyle \\Gamma}\nis normal. This is due to the fact that matrix elements are now away from the dipole approximation.\nTo plot the same results with\npy4vasp\n, the new shape of the dielectric function has to be taken into account, and so no indexing is added to the epslion array\nimport\npy4vasp\nimport\nnumpy\nas\nnp\nimport\nmatplotlib.pyplot\nas\nplt\ncalc_bse\n=\npy4vasp\n.\nCalculation\n.\nfrom_file\n(\n'vaspout.BSE.h5'\n)\ncalc_tdhf\n=\npy4vasp\n.\nCalculation\n.\nfrom_file\n(\n'vaspout.TDHF.h5'\n)\nenergies\n=\ncalc_bse\n.\ndielectric_function\n.\nread\n(\n'BSE'\n)[\n'energies'\n]\n# Notice that the dielectric function no has a single component, so there is no need for indexing the\n# array\nepsilon_bse\n=\ncalc_bse\n.\ndielectric_function\n.\nread\n(\n'BSE'\n)[\n'dielectric_function'\n]\nepsilon_tdhf\n=\ncalc_tdhf\n.\ndielectric_function\n.\nread\n(\n'TDHF'\n)[\n'dielectric_function'\n]\neels_bse\n=\n-\nnp\n.\nimag\n(\n1.0\n/\nepsilon_bse\n)\neels_tdhf\n=\n-\nnp\n.\nimag\n(\n1.0\n/\nepsilon_tdhf\n)\nplt\n.\nplot\n(\nenergies\n,\neels_bse\n,\n''\n,\nlabel\n=\n'BSE'\n)\nplt\n.\nplot\n(\nenergies\n,\neels_tdhf\n,\n''\n,\nlabel\n=\n'TDHF'\n)\nplt\n.\nylabel\n(\nr\n'Im[$\\epsilon^{-1}_M$]'\n)\nplt\n.\nxlabel\n(\n'Energy loss [eV]'\n)\nplt\n.\nlegend\n()\nplt\n.\nshow\n()\nwhich will generate the following plot.\nEELS plot for\nKPOINT_BSE\n=2 using py4vasp.\nRelated Tags and Sections\nALGO\n,\nLOPTICS\n,\nLHFCALC\n,\nLADDER\n,\nLHARTREE\n,\nNBANDSV\n,\nNBANDSO\n,\nOMEGAMAX\n,\nLFXC\n,\nANTIRES\n,\nBSE calculations\n,\nTime-dependent density-functional theory calculations\nReferences\n↑\nG. Onida, L. Reining, and A. Rubio,\nElectronic excitations: density-functional versus many-body Green's-function approaches\n, Rev. Mod. Phys.\n74\n, 2 (2002)."
  }, 
  "Electron-phonon interactions from Monte-Carlo sampling": {
    "description": "This webpage explains how to calculate electron-phonon interactions using Monte Carlo sampling and the ZG configuration method in VASP 6.0+, including step-by-step instructions for input file setup, temperature settings, and the choice between one-shot (ZG) and full MC sampling methods.", 
    "detailed_description": "Mind:\nThis feature is only available from VASP 6.0 or higher.\nFor the theory on electron-phonon interactions from Monte-Carlo (MC) sampling please click\nhere\n.\nFirst of all this method needs a sufficiently large supercell.\nIt also involves phonon calculations for the\nΓ\n{\\displaystyle \\Gamma}\npoint (see\nPhonons from finite differences\n). So many tags in the\nINCAR\nwill be used from the phonon calculations.\nThe first implementation of electron-phonon interactions from MC sampling in VASP is found in Ref.\n[1]\n.\nThe original publication of the ZG configuration (one-shot method) is found in Ref.\n[2]\n.\nStep-by-step instructions\nStep 1\n: Run a single calculation to create the\nPOSCAR\nfile(s) with special positions either belonging to the ZG configuration method or MC sampling. To enable electron-phonon interactions from MC methods\nPHON_LMC\n=\n.TRUE.\nhas to be set in the\nINCAR\nfile. Also,\nIBRION\n=6 has to be selected (the sampling methods are currently only implemented for\nIBRION\n=6). The description of the remaining required\nINCAR\ntags for each method is given below. Both methods produce\nPOSCAR\nfiles with different distorted Wycoff positions but unchanged Brillouin matrix. The ZG configuration method produces one structure for each temperature defined in\nPHON_TLIST\n. The files are labeled as\nPOSCAR.T=TEMP.\nThe MC sampling code produces many\nPOSCAR\nfiles at a given temperature defined by\nTEBEG\n. The files are labeled as\nPOSCAR.T=TEBEG.NUMBER\nwhere NUMBER runs from 1 to\nPHON_NSTRUCT\n.\nStep 2\n: Run calculation for the previously created\nPOSCAR\nfiles on the desired observable. These calculations can be anything that is suitable for an MC sum\n⟨\nO\n(\nT\n)\n⟩\n=\n1\nn\n∑\ni\n=\n1\nn\nO\n(\nx\nT\nMC,i\n)\n{\\displaystyle \\langle O(T)\\rangle = \\frac{1}{n} \\sum\\limits_{i=1}^{n} O(x_{T}^{\\textrm{MC,i}})}\n, for example, band gap calculations, absorption spectra calculations, etc.\nStep 3 (optional)\n: Calculate the desired observable for the original \"pristine\" supercell. This step can be necessary when changes to an observable due to electron-phonon interactions are required. An example of such a calculation is the calculation of the band-gap renormalization due to electron-phonon interactions.\nStep 4 (optional)\n: If MC sampling was used, average the results over the number of structures created in step 1 (\nPHON_NSTRUCT\n).\nZG configuration (one-shot sampling)\nM. Zacharias and F. Giustino\n[2]\nintroduced a one-shot method (named ZG configuration after the authors). This method is an approximation to full MC sampling. It only uses a single distorted structure and hence it is computationally much cheaper than the full MC sampling. It retains an accuracy very close to the full MC sampling for converged supercell sizes. For example, we showed that for the zero-point renormalization of the band gap, the accuracy is within 5 meV between the ZG configurations and the full MC sampling\n[1]\n. Hence we suggest using this method preferably, when convergence of the supercell size is hard to achieve or the 5 meV accuracy is enough.\nTo select the ZG configuration\nPHON_NSTRUCT\n=0 has to be set in the\nINCAR\nfile.\nThe number of different temperatures and the list of temperatures (in K) have to be provided using the tags\nPHON_NTLIST\nand\nPHON_TLIST\n, respectively, in the\nINCAR\nfile. An example would look like:\nPHON_NTLIST\n= 4\nPHON_TLIST\n= 0.0 100.0 200.0 350.0\nThis makes the simultaneous calculation of the ZG configuration at several temperatures possible.\nAn example\nINCAR\nfile for a temperature range from 0-700 K (with step size of 100 K) is given as:\nSystem\n= DEFAULT\nPREC\n= Accurate\nISMEAR\n= 0;\nSIGMA\n= 0.1;\nIBRION\n= 6\nPHON_NTLIST\n= 8\nPHON_TLIST\n= 0.0 100.0 200.0 300.0 400.0 500.0 600.0 700.0\nPHON_NSTRUCT\n= 0\nPHON_LMC\n= .TRUE.\nFull MC sampling\nThe tag\nPHON_NSTRUCT\nsets the number of structures generated due to the MC sampling. Convergence of the observable with respect to this number should be monitored.\nThe tag\nTEBEG\n=0 is also needed to choose the temperature at which the sampling is run.\nAdditionally, the\nPHON_LBOSE\ncan be set\n.TRUE.\nor\n.FALSE.\n(default\nPHON_LBOSE\n=\n.TRUE.\n), which selects Bose-Einstein or Maxwell-Boltzmann statistics, respectively.\nA sample\nINCAR\nfile for 0 K looks like the following:\nSystem = DEFAULT\nPREC\n= Accurate\nISMEAR\n= 0;\nSIGMA\n= 0.1;\nIBRION\n= 6\nPHON_LMC\n= .TRUE.\nPHON_NSTRUCT\n= 100\nTEBEG\n= 0.0\nRelated tags and articles\nPHON_LBOSE\nPHON_LMC\nPHON_NSTRUCT\nPHON_NTLIST\nPHON_TLIST\nBand-structure renormalization\nTransport calculations\nReferences\n↑\na\nb\nF. Karsai, M. Engel, E. Flage-Larssen, and G. Kresse, New J. of Phys.\n20\n, 123008 (2018).\n↑\na\nb\nM. Zacharias and F. Giustino, Phys. Rev. B\n94\n, 075125 (2016)."
  }, 
  "Electron-phonon potential from supercells": {
    "description": "This web page explains the computation of the electron-phonon potential using finite atomic displacements in a supercell, either through VASP internal methods or in combination with the phelel package, detailing workflows, considerations for convergence and compatibility, and the generation of the phelel_params.hdf5 file for subsequent electron-phonon calculations in the primitive cell.", 
    "detailed_description": "The computation of the electron-phonon potential,\n∂\nν\nq\nV\n(\nr\n)\n{\\displaystyle \\partial_{\\nu \\mathbf{q}} V(\\mathbf{r})}\n, is a prerequisite for the calculation of the electron-phonon matrix element:\ng\nm\nn\nk\n,\nν\nq\n≡\n⟨\nψ\nm\nk\n+\nq\n|\n∂\nν\nq\nV\n|\nψ\nn\nk\n⟩\n.\n{\\displaystyle\ng_{mn \\mathbf{k}, \\nu \\mathbf{q}}\n\\equiv\n\\langle\n\\psi_{m \\mathbf{k} + \\mathbf{q}} |\n\\partial_{\\nu \\mathbf{q}} V |\n\\psi_{n \\mathbf{k}}\n\\rangle\n.\n}\n∂\nν\nq\nV\n{\\displaystyle \\partial_{\\nu \\mathbf{q}} V}\nis computed from a supercell calculation by means of Fourier interpolation while the Bloch orbitals,\nψ\nn\nk\n(\nr\n)\n{\\displaystyle \\psi_{n \\mathbf{k}}(\\mathbf{r})}\n, are computed directly in the primitive cell.\nThe supercell calculation and the primitive-cell calculation are performed in two separate VASP runs.\nThis page provides an overview of the supercell calculation and how the electron-phonon potential can be calculated.\nFor information regarding the electron-phonon calculation in the primitive cell, consult the documentation on\nphonon-induced bandstructure renormalization\nand on\nphonon-mediated transport\n.\nMind:\nAvailable as of VASP 6.5.0\nTip:\nThe entire workflow of initializing a calculation, computing the electron-phonon potential in the supercell and performing subsequent electron-phonon calculations in the primitive cell can be facilitated by\nvelph\n.\nvelph\nis a command-line tool included in the\nphelel\npython package. It helps guide you through the process step by step and ensures a certain level of consistency between the required VASP calculations.\nFinite displacements in the supercell\nGeneral workflow when running electron-phonon calculations using perturbation theory. Notice that both the \"VASP only\" workflow as well as the \"VASP + phelel\" workflow produce the same kind of data in\nphelel_params.hdf5\n.\nThe electron-phonon potential is computed from finite atomic displacements in a sufficiently large supercell.\nIn this case, sufficient means that the effects of an atomic displacement become negligible at about half the supercell size.\nUsually, converging the phonon frequencies is a good way of finding a supercell that is sufficiently large.\nPolar materials can exhibit long-range electrostatic interactions that go beyond reasonable supercell sizes.\nIn this case, a\ncorrection scheme\nexists that explicitly treats the long-range dipole interactions and works with smaller cells.\nCurrently, there are two complementary ways to calculate the electron-phonon potential.\nOne relies solely on VASP, while the other uses VASP in combination with\nphelel\n.\nBoth approaches calculate the derivative of the Kohn-Sham potential in real space via the displacement of atoms.\nHowever, they may differ in terms of flexibility and computational performance.\nBelow, we describe the general workflow of each approach and highlight their advantages and disadvantages.\nRegardless of which approach is chosen, the output is always written to the\nphelel_params.hdf5\nbinary file.\nThis file can then be read during a VASP calculation in the primitive unit cell to compute electron-phonon interactions.\nVASP internal driver\nThis way of calculating the electron-phonon potential is activated by setting\nELPH_POT_GENERATE\n= True\nin the\nINCAR\nfile.\nIt utilizes the VASP-internal finite-difference driver that is activated by setting\nIBRION\n= 6\nin the\nINCAR\nfile.\nThe atomic displacement directions are automatically determined by VASP.\nAs usual,\nPOTIM\nand\nNFREE\ncan be used to control the displacement amount and finite-difference stencil, respectively.\nThis is the same procedure used to calculate\nphonons from finite differences\nand many of the same considerations regarding performance and accuracy apply in this case.\nTherefore, phonon frequencies are a great way to test the convergence with respect to supercell size.\nMind:\nCurrently, VASP generates more displacements with\nELPH_POT_GENERATE\n= True\nand\nIBRION\n= 6\nthan would be required in principle. This will be improved in a future version of the code.\nOnce the electron-phonon potential is obtained, it is automatically mapped to the primitive cell.\nThe results are stored in the\nphelel_params.hdf5\nfile.\nBy default, the primitive cell used for this mapping is the one determined by VASP during the supercell calculation.\nIt is possible to choose a different primitive unit cell by explicitly specifying its lattice vectors using the\nELPH_POT_LATTICE\nINCAR\ntag.\nMind:\nThe cell specified via\nELPH_POT_LATTICE\nmust be a valid primitive cell of the underlying lattice.\nIn any case, the relevant primitive-cell structure is written to the\nCONTCAR_ELPH\nfile.\nThis file can be used as the\nPOSCAR\nof the subsequent electron-phonon calculation in the primitive cell.\nThis way, it is guaranteed that the primitive-cell calculation is compatible with the information contained in the\nphelel_params.hdf5\nfile.\nThe electron-phonon potential is stored on a real-space FFT grid in the\nphelel_params.hdf5\nfile.\nIt is currently necessary to match the FFT grid dimensions of this potential to the FFT grid dimensions (\nNGX\n,\nNGY\n,\nNGZ\n) of the primitive cell that is used to perform the subsequent electron-phonon calculation.\nBy default, VASP determines appropriate FFT grid dimensions automatically during the supercell calculation based on the current\nENCUT\n.\nThe result should be compatible with a primitive-cell calculation that uses the same\nENCUT\n.\nTip:\nThe\nPREC\nINCAR\ntag influences the size of the FFT mesh. Therefore, it is recommended to choose the same\nPREC\nfor both the supercell as well as the primitive-cell calculation.\nIt is possible to manually supply the FFT grid dimensions of the target unit cell during the supercell calculation via\nELPH_POT_FFT_MESH\n.\nInformation regarding the primitive cell and the FFT grid dimensions for electron-phonon calculations is also reported in the\nOUTCAR\nfile and the\nvaspout.h5\nfile.\nThe format is explained on the\nELPH_POT_GENERATE\npage.\nVASP and phelel\nIn this approach to calculating the electron-phonon potential, the ionic displacements are determined externally using\nphelel\n.\nFor people who are familiar with phonon calculations using VASP and\nphonopy\n, this workflow will look very familiar.\nIn general, this allows for greater flexibility.\nHere, we demonstrate a common workflow that suffices for most purposes.\nFor a complete list of features, we refer to the documentation of\nphelel\n.\nAs an example,\nphelel -d --dim 2 2 2 -c POSCAR-unitcell --pm\nautomatically determines displacement directions for a 2x2x2 supercell based on symmetry considerations.\nTip:\nWe recommend the use of the\n--pm\noption, which generates positive and negative displacements for each displacement direction.\nFor each displacement, phelel creates a corresponding supercell\nPOSCAR\nfile (\nPOSCAR-XXX\n, where\nXXX\nlabels the different displacements).\nIn addition, the file\nSPOSCAR\nis created which contains the supercell geometry in equilibrium.\nFor each of the generated POSCAR files, create a separate directory and run VASP there with\nELPH_PREPARE\n= True\nset in the\nINCAR\nfile.\nThis setting instructs VASP to write the potential as well as other important information to disk.\nFinally, run phelel to combine all the data from the individual directories to obtain the electron-phonon potential, for example,\nphelel --fft-mesh 18 18 18 --cd perfect/ disp-001/ disp-002/\nHere,\nperfect\n,\ndisp-001\nand\ndisp-002\nare the directories corresponding to the equilibrium and displaced supercell calculations, respectively.\n--fft-mesh\nspecifies the FFT grid dimensions (\nNGX\n,\nNGY\n,\nNGZ\n) to be used in the final electron-phonon calculation in the primitive cell.\nThe electron-phonon potential is Fourier interpolated from the FFT grid in the supercell to the supplied grid via a non-uniform FFT.\nThe results are written to the\nphelel_params.hdf5\nfile.\nRelated tags and articles\nBand-structure renormalization\nTransport calculations\nphelel_params.hdf5\nElectron-phonon interactions from Monte-Carlo sampling"
  }, 
  "Electrostatic corrections": {
    "description": "This web page explains how to apply electrostatic corrections in VASP for systems with net charge or dipole moments, particularly in surface, molecule, and slab calculations, to improve convergence and accuracy by using tags like `LDIPOL`, `IDIPOL`, and `DIPOL`, while also detailing limitations and step-by-step setup instructions.", 
    "detailed_description": "For charged cells or for calculations of molecules and surfaces with a large dipole moment, the energy converges very slowly with respect to the size\nL\n{\\displaystyle L}\nof the supercell. Using methods discussed by Makov\net al.\n[1]\nand Neugebauer\net al.\n[2]\n, VASP can correct for the leading errors (in many details, we have taken a more general approach, though).\nSuggested combination of tags for electrostatic corrections\nIn cases where the system has no net charge and no net dipole moment, no specific tags need to be set and this section can be skipped.\nBulk\nIf the system has a net dipole or net charge, please follow the recommendations of\nthis\nwiki page.\nSurfaces\nIf the system has a net dipole moment, a combination of\nIDIPOL\n=1,2,3 and\nLDIPOL\ntags may be used. The former corrects the energies, while the latter corrects the potential and forces. Optionally,\nDIPOL\nmay be set. The following options may be used to improve convergence for this case.\n1. Use any of these tags only after pre-converging the orbitals without the\nLDIPOL\ntag\n2. The center of charge should be set in the\nINCAR\nfile (\nDIPOL\n= center of mass)\n3. Ensure that the cell is sufficiently large to determine the dipole moment with sufficient accuracy (see\nDIPOL\n). If the cell is too small, the charge might slash through the vacuum, causing very slow convergence. Often convergence improves with the size of the supercell.\nWarning:\nSurface calculations with a net charge result in total energies that do not converge. Relative energies may still be useful.\nWires\nNot implemented.\nMolecules\nIf the system has a net dipole moment, use the\nLDIPOL\ntag. The former corrects the energies, while the latter corrects the potential and forces. Optionally,\nDIPOL\nmay be set.\nCurrent limitations\nFor the current implementation, there are several restrictions; please read carefully:\nCharged systems:\nQuadrupole corrections are only correct for cubic supercells (this means that the calculated 1/\nL\n3\ncorrections are wrong for charged supercells if the supercell is non-cubic). In addition, we have found empirically that for charged systems with excess electrons (\nNELECT\n>\nNELECT\nneutral\n) more reliable results can be obtained if the energy after correction of the linear error (1/\nL\n) is plotted against 1/\nL\n3\nto extrapolate results manually for\nL\n→∞. This is due to the uncertainties in extracting the quadrupole moment of systems with excess electrons.\nPotential corrections are only possible for orthorhombic cells (at least the direction in which the potential is corrected must be orthogonal to the other two directions).\nStep-by-step instructions\nUsing the dipole correction for slab calculations\nIn this section, we discuss step-by-step instructions to use the dipole corrections for slab calculations.\nStep 1:\nCreate a system which has enough vacuum on either side of the surface normal. An example for such a structure is shown below, for an fcc-Aluminium with a carbon adsorbed on one of its surface terminations.\nAl3C\n1.0000000000000000\n2.8637824638055176    0.0000000000000000    0.0000000000000000\n1.4318912319027588    2.4801083645679673    0.0000000000000000\n0.0000000000000000    0.0000000000000000   20.0000000000000000\nAl C\n3 1\nDirect\n0.8333333333333333    0.5000000000000000    0.3380865704891008\n0.1666666666666666    0.8333333333333334    0.4550000000000000\n0.4999999999999999    0.1666666666666667    0.5719134295108992\n0.4999999999999999    0.1666666666666667    0.6619134295108993\nNote that the system has plenty of vacuum on either side. This empty space is important for the potential corrections needed for the\nLDIPOL\ntag.\nStep 2:\nSwitch on the dipole corrections to the energy, potential and forces. Optionally set the\nDIPOL\nLDIPOL    = T\nIDIPOL    = 3\nDIPOL     = 0.5 0.5 0.5\nStep 3 (Optional):\nView the dipole moment for the system using the following bash command,\ngrep dipolmoment OUTCAR | tail -1\nIn this example, we get the following output:\ndipolmoment           0.000000      0.000000      0.128389 electrons x Angstroem\nwhich refers to the dipole moment along the three axes. Consistent with the\nPOSCAR\nused in this example, only the last axis has a non-zero dipole moment.\nRelated Tags and Sections\nNELECT\n,\nEPSILON\n,\nDIPOL\n,\nIDIPOL\n,\nLDIPOL\n,\nLMONO\n,\nEFIELD\nExamples that use this tag\nReferences\n↑\nG. Makov and M. C. Payne, Phys. Rev. B 51, 4014 (1995).\n↑\nJ. Neugebauer and M. Scheffler, Phys. Rev. B 46, 16067 (1992)."
  }, 
  "Energy vs volume Volume relaxations and Pulay stress": {
    "description": "The web page explains the Pulay stress—its origin, effects on plane-wave DFT calculations (especially in VASP), and methods to mitigate its impact on stress tensor accuracy, volume relaxation, and equation of state fitting.", 
    "detailed_description": "If you are doing energy-volume calculations or cell shape and volume relaxations you must understand the Pulay stress and related problems.\nThe Pulay stress arises from the fact that the plane-wave basis set is not complete with respect to changes in the volume. Thus, unless absolute convergence with respect to the basis set has been achieved - the diagonal components of the stress tensor are incorrect. This error is often called \"Pulay stress\". The error is almost isotropic (i.e. the same for each diagonal component), and for a finite basis set it tends to decrease volume compared to fully converged calculations (or calculations with a constant energy cutoff).\nThe Pulay stress and related problems affect the behavior of VASP and any plane wave code in several ways: First, it evidently affects the stress tensor calculated by VASP, i.e. the diagonal components of the stress tensor are incorrect, unless the energy cutoff is very large (ENMAX=1.3 *default is usually a safe setting to obtain a reliable stress tensor). In addition, it should be noted that all volume/cell shape relaxation algorithms implemented in VASP work with a constant basis set. In that way, all energy changes are strictly consistent with the calculated stress tensor, and this, in turn, results in an underestimation of the equilibrium volume unless a large plane wave cutoff is used. Keeping the basis set constant during relaxations has also some strange effect on the basis set. Initially, all G-vectors within a sphere are included in the basis. If the cell shape relaxation starts the direct and reciprocal lattice vectors change. This means that although the number of reciprocal G-vectors in the basis is kept fixed, the length of the G-vectors changes, changing indirectly the energy cutoff. Or to be more precise, the shape of the cutoff region becomes an ellipsoid. Restarting VASP after a volume relaxation causes VASP to adopt a new \"spherical\" cutoff sphere and thus the energy changes discontinuously.\nOne thing which is important to understand is that problems due to the Pulay stress can often be neglected if only volume conserving relaxations are performed. This is because the Pulay stress is usually almost uniform and it, therefore, changes the diagonal elements of the stress tensor only by a certain constant amount (see below). In addition, many calculations have shown that Pulay stress-related problems can also be reduced by performing calculations at different volumes using the same energy cutoff for each calculation (this is what VASP does by default) and fitting the final energies to an equation of state. This of course implies that the number of basis vectors is different at each volume. Calculations with many plane-wave codes have shown that such calculations yield reliable results for the lattice constants and the bulk modulus and other elastic properties even at relatively modest energy cutoffs. Constant energy cut-off calculations are less prone to errors caused by the basis set incompleteness than constant basis set calculations. But it should be kept in mind that volume changes and cell shape changes must be rather large in order to obtain reliable results from this method because within the limit of very small distortions the energy changes obtained with this method are equivalent to those obtained from the stress tensor and are therefore affected by the Pulay stress. Only volume changes of the order of 5-10 % guarantee that the errors introduced by the basis set incompleteness are averaged out.\nMind:\nThere are two newer wiki articles that have been written on this subject:\nVolume relaxation\nand\nPulay stress\nPulay Stress\nHow to calculate the Pulay stress\nThe Pulay stress shows only a weak dependency on volume and the ionic configuration. It is mainly determined by the composition. The simplest way to estimate the Pulay stress is to relax the structure with a large basis-set (\n1.3\n×\n{\\displaystyle 1.3\\times}\ndefault cutoff is usually sufficient, or\nPREC\n=\nHigh\nin VASP.4.4). Then re-run VASP for the final relaxed positions and cell parameters with the default cutoff or the desired cutoff. Look for the line 'external pressure' in the\nOUTCAR\nfile:\nexternal pressure =    -100.29567 kB\nThe corresponding (negative) pressure gives a good estimation of the Pulay stress.\nAccurate bulk relaxations with internal parameters (one)\nThe general message is: whenever possible avoid volume relaxation at the default energy cutoff. Either increase the basis set by setting\nENCUT\nmanually in the\nINCAR\nfile, or use the method two suggested below. This avoids doing volume relaxations at all. If volume relaxations are the only possible and feasible option please use the following step by step procedure (which minimizes errors to a minimum):\nRelax from starting structure (\nISMEAR\nshould be 0 or 1).\nStart a second relaxation from previous\nCONTCAR\nfile (re-relaxation).\nAs a final step, perform one more energy calculation using the tetrahedron method switched on (i.e.\nISMEAR\n=-5), to obtain highly accurate energies (no relaxation for the final run). Possibly increase the energy cutoff even further.\nA few things should be remarked here: never used the energy obtained at the end of a relaxation run, if you allow for cell shape relaxations (the final basis set might not correspond to the desired spherical cutoff sphere). Instead, perform one additional static run after completing the relaxation.\nIf the relaxation will yield a structure with reasonably small structural \"errors\", the final error in the energy of step 3 is only of second-order (with respect to the structural errors). If you take the energy directly from the relaxation run, errors are usually significantly larger. Another important point is that the most reliable results for the relaxation are obtained if the starting cell parameters are very close to the final cell parameters. If different runs yield different results, then the one run that started from the configuration, which was closest to the relaxed structure, is the most reliable one.\nWe strongly recommend doing any volume (and to a lesser extent cell shape) relaxation with an increased basis set.\nENCUT\n=\n1.3\n×\n{\\displaystyle 1.3\\times}\ndefault cutoff is reasonable accurate in most cases.\nPREC\n=\nHigh\ndoes also increase the energy cutoff by a factor of 1.25. At an increased cutoff the Pulay-stress correction is usually not required.\nFinally, if the default cutoff is used for the relaxation, the\nPSTRESS\ntag should be set in the\nINCAR\nfile: evaluate the Pulay stress along the guidelines given in the previous section and add an input line to the\nINCAR\nfile reading (usually a negative number):\nPSTRESS\n= Pulay stress\nFrom now on all\nSTRESS\noutput of VASP is corrected by simply subtracting\nPSTRESS\n. In addition, all volume relaxations will take\nPSTRESS\ninto account.\nIt should be said again, use\nPSTRESS\nonly if increasing the cutoff is not a viable option for some reason.\nAccurate bulk relaxations with internal parameters (two)\nIt is possible to avoid volume relaxation in many cases: The method we have used quite often in the past is to relax the structure (cell shape and internal parameters) for a set of fixed volumes (\nISIF\n=4). The final equilibrium volume and the ground-state energy can be obtained by a fit to an equation of state. The reason why this method is better than volume relaxation is that the Pulay stress is almost isotropic, and thus adds only a constant value to the diagonal elements of the stress tensor. Therefore, the relaxation for a fixed volume will yield highly accurate structures.\nThe outline for such a calculation is almost the same as in the previous section. But in this case, one has to do the calculations for a set of fixed volumes. At first sight, this seems to be much more expensive than method number one (outlined in the previous section). But in many cases, the additional costs are only small, because the internal parameters do not change very much from volume to volume. The following steps have to be done in these calculations:\nSelect one volume and relax from starting structure keeping the volume fixed (\nISIF\n=4;\nISMEAR\n=0 or 1).\nStart a second relaxation from the previous\nCONTCAR\nfile (if the initial cell shape was reasonable this step can be skipped if the cell shape is kept fixed, you never have run VASP twice).\nAs a final step, perform one more energy calculation with the tetrahedron method switched on (\nISMEAR\n=-5), to get very accurate unambiguous energies (no relaxation for the final run).\nThe method has also other advantages, for instance, the bulk modulus is readily available. We have found in the past that this method can be used safely with the default cutoff.\nFAQ: Why is my energy vs. volume plot jagged\nThis is a very common question from people who start to do calculations with plane wave codes. There are two reasons why the energy vs. volume plot looks jagged:\nBasis set incompleteness. The basis set is discrete and incomplete, and when the volume changes, additional plane waves are added. That causes small discontinuous changes in the energy.\nSolutions:\nUse a larger plane wave cutoff: This is usually the preferred and simplest solution.\nUse more k-points : this solves the problem, because the criterion for including a plane wave in the basis set is\n|\nG\n+\nk\n|\n<\nG\nc\nu\nt\n{\\displaystyle \\vert {\\bf G} + {\\bf k} \\vert < {\\bf G}_{\\rm cut}}\n. This means at each k-point a different basis set is used, and additional plane waves are added at each k-point at different volumes. In turn, the energy vs. volume curve becomes smoother.\nA second possible reason for the jagged E(V) curve is the use of\nPREC\n=Normal. For\nPREC\n=Accurate the FFT grids are chosen such that\nH\n|\nϕ\n>\n{\\displaystyle  {\\bf H} \\vert \\phi> }\nis exactly evaluated. For\nPREC\n=Normal the FFT grids are set to 3/4 of the value that is required for an exact evaluation of\nH\n|\nϕ\n>\n{\\displaystyle  {\\bf H} \\vert \\phi> }\n. This introduces small errors because when the volume changes the FFT grids change discontinuously. In other words, at each volume a different FFT grid is used, causing the energy to jump discontinuously between different volumes.\nSolutions:\nUse PREC=Accurate, or increase the plane wave cutoff.\nSet your FFT grids manually, and choose the one that is used per default for the largest volume (obviously a laborious solution)."
  }, 
  "Improved dimer method": {
    "description": "The web page describes the implementation and usage of the Improved Dimer Method (IDM) in VASP for optimizing transition states, including setup instructions, parameter settings, and a practical example of computing the transition state for ammonia flipping.", 
    "detailed_description": "The dimer method\n[1]\nis a technique for the optimization of transition states. In VASP, the improved dimer method (IDM) by Heyden et al. is implemented, and a detailed presentation of the method can be found in their paper\n[2]\n.\nThe initial curvature along the dimer axis is computed using finite differences. The initial dimer direction must be provided (see below). The IDM procedure shown in Figure 1 is described in four steps with\nFINDIFF\n= 1:\nFigure 1. The IDM is relaxed on the potential energy surface (PES) in four ionic steps. Solid arrows show the dimer axis\nu\nξ\nand solid circles the structure for which the forces are calculated in the step. The empty circles and dashed lines indicate the structures and dimer axes from the previous steps. The dotted arrow in\n(d)\nrepresents the dimer axis on rotation by φ\nmin\n.\na)\nAn initial direction\nu\nξ\nis taken from the most negative vibrational mode of the trial structure. The trial structure is the first point\nq\n.\nb)\nAn additional point on the potential energy surface (PES) forward along the trial direction is defined\nq\n+ δ\nu\nξ\n. The first and second points together define the dimer.\nc)\nThe dimer is then rotated on the PES about\nq\nby angle φ\n1\nto\nq̃\nsuch that its axis is parallel to the direction of maximal negative curvature.\nd)\nA new direction is defined by rotating\nu\nξ\nby φ\nmin\nto minimize the negative curvature of the PES λ. A search direction N̅ is defined using a minimization algorithm, then a translation (optimization step) is taken in the unstable direction of N̅ to\nq\n+ εN̅, where ε is a step distance. The potential energy is is maximized along the unstable direction, (i.e., dimer axis) while it is minimized in all other directions.\nRotation followed by translation is followed iteratively until convergence, i.e. the saddle point, is reached.\nThe method is invoked by setting\nIBRION\n=44 in the\nINCAR\nfile.\nFurthermore, the user must specify the direction of the unstable mode. The corresponding\n3\nN\n{\\displaystyle 3N}\ndimensional vector is defined in the\nPOSCAR\nfile after the lines with atomic coordinates and a separating blank line. Note that the dimer direction is automatically normalized, i.e., the norm of the dimer axis is irrelevant. An example of a\nPOSCAR\nfile for a simulation with the dimer method is given in the following:\nammonia flipping\n1.\n6. 0. 0.\n0. 7. 0.\n0. 0. 8.\nH N\n3 1\ncart\n-0.872954        0.000000       -0.504000        ! coordinates for atom 1\n0.000000        0.000000        1.008000\n0.872954        0.000000       -0.504000\n0.000000        0.000000        0.000000        ! coordinates for atom N\n! here we define trial unstable direction:\n0.000001    0.522103   -0.000009        ! components for atom 1\n-0.000006    0.530068    0.000000\n-0.000005    0.522067   -0.000007\n0.000001   -0.111442    0.000001        ! components for atom N\nAs in the other structural optimization algorithms in VASP, convergence is controlled through the\nEDIFFG\ntag.\nExperienced users can affect the performance of the dimer method by modifying the numerical values of the following parameters (the given example values are the default values):\nFINDIFF\n=1 Use a forward (\nFINDIFF\n=1) or central (\nFINDIFF\n=2) difference formula for the numerical differentiation to compute the curvature along the dimer direction\nDIMER_DIST\n=0.01  The step size for a numerical differentiation (in\nÅ\n{\\displaystyle \\AA}\n)\nMINROT\n=0.01 Dimer is rotated only if the predicted rotation angle is greater than\nMINROT\n(rad.)\nSTEP_SIZE\n=0.01 Trial step size for optimization step (in\nÅ\n{\\displaystyle \\AA}\n)\nSTEP_MAX\n=0.1 Trust radius (upper limit) for the optimization step (in\nÅ\n{\\displaystyle \\AA}\n)\nImportant information about the progress of optimization is written in the\nOUTCAR\nfile after the expression\nDIMER METHOD\n.\nIn particular, it is useful to check the curvature along the dimer direction, which should be a negative number (a long sequence of positive numbers usually indicates that the algorithm fails to converge to the correct transition state).\nMind:\nThe current implementation does not support lattice optimizations (\nISIF\n>2) and can be used only for the relaxation of atomic positions.\nInitial dimer axis\nThe direction of an unstable vibrational mode can be obtained by performing the vibrational analysis (\nIBRION\n=5) and taking the x-, y-, and z- components of the imaginary vibrational mode (after division by\nm\n{\\displaystyle \\sqrt{m}}\n!) parallel with the reaction coordinate. Note that in order to plot \"Eigenvectors after division by SQRT(mass)\",\nNWRITE\n=3 should be used.\nPractical example\nIn this example, the transition state for the ammonia flipping is computed. All calculations discussed here were performed using the PBE functional, Brillouin zone sampling was restricted to the gamma point. This practical example can be completed in a few seconds on a standard desktop PC. The starting structure for the IDM simulation should be a reasonable guess for the transition state. A\nPOSCAR\nfile with the initial guess for the ammonia flipping looks like this:\nammonia flipping\n1.\n6. 0. 0.\n0. 7. 0.\n0. 0. 8.\nH N\n3 1\ncart\n-0.872954        0.000000       -0.504000\n0.000000        0.000000        1.008000\n0.872954        0.000000       -0.504000\n0.000000        0.000000        0.000000\nAs an input for the dimer method, the direction of the unstable mode (dimer axis) is needed. This can be obtained by performing vibrational analysis. The\nINCAR\nfile should contain the following lines:\nNSW\n= 1\nPrec\n= Normal\nIBRION\n= 5                 ! perform vibrational analysis\nNFREE\n= 2                  ! select central differences algorithm\nPOTIM\n= 0.02               ! step for the numerical differenciation\nNWRITE\n= 3                 ! write down eigenvectors of dynamical matrix after division by SQRT(mass)\nAfter completing the vibrational analysis, we look up the hardest imaginary mode (Eigenvectors after division by SQRT(mass)!) in the\nOUTCAR\nfile:\n12 f/i=   23.224372 THz   145.923033 2PiTHz  774.681641 cm-1    96.048317 meV\nX         Y         Z           dx          dy          dz\n5.127046  0.000000  7.496000     0.000001    0.522103   -0.000009\n0.000000  0.000000  1.008000    -0.000006    0.530068    0.000000\n0.872954  0.000000  7.496000    -0.000005    0.522067   -0.000007\n0.000000  0.000000  0.000000     0.000001   -0.111442    0.000001\nand use the last three columns to define the dimer axis in the\nPOSCAR\nfile:\nammonia flipping\n1.\n6. 0. 0.\n0. 7. 0.\n0. 0. 8.\nH N\n3 1\ncart\n-0.872954        0.000000       -0.504000        ! coordinates for atom 1\n0.000000        0.000000        1.008000\n0.872954        0.000000       -0.504000\n0.000000        0.000000        0.000000        ! coordinates for atom N\n! here we define trial unstable direction:\n0.000001    0.522103   -0.000009        ! components for atom 1\n-0.000006    0.530068    0.000000\n-0.000005    0.522067   -0.000007\n0.000001   -0.111442    0.000001        ! components for atom N\nIn order to perform IDM calculation, the\nINCAR\nfile should contain the following lines:\nNSW\n= 100\nPrec\n=Normal\nIBRION\n=44           !  use the dimer method as optimization engine\nEDIFFG\n=-0.03\nWith this setting, the algorithm converges in just a few relaxation steps. Further vibrational analysis can be performed to prove that the relaxed structure is indeed a first-order saddle point (one imaginary frequency).\nMind:\nIf you perform a frequency calculation on this optimized structure, take care to consider the translational modes that are present. These will appear as small imaginary frequencies, less than 5 cm-1 in the OUTCAR file and may be recognized by the \"dx\" terms for each atom being large, while the remaining \"dy\" and \"dz\" terms are near zero (for x  translation). This will result in multiple imaginary frequencies. The goal is to have one \"large\" imaginary frequency, and then these small translational modes should be set to zero for calculating thermodynamic properties.\nFor example, the x-translation is shown below:\n11 f/i=    0.092375 THz     0.580407 2PiTHz    3.081284 cm-1     0.382030 meV\nX         Y         Z\ndx\ndy          dz\n5.127046  0.000000  7.496000\n-0.247337\n0.000339    0.008273\n0.000000  0.000000  1.008000\n-0.232726\n0.000336   -0.000038\n0.872954  0.000000  7.496000\n-0.247322\n0.000340   -0.008357\n0.000000  0.000000  0.000000\n-0.242501\n0.000341   -0.000041\nRelated tags and articles\nFINDIFF\n,\nDIMER_DIST\n,\nMINROT\n,\nSTEP_SIZE\n,\nSTEP_MAX\nReferences\n↑\nG. Henkelman and H. Jónsson,\nA dimer method for finding saddle points on high dimensional potential surfaces using only first derivatives\n, J. Chem. Phys.\n111\n, 7010–7022 (1999).\n↑\nA. Heyden, A. T. Bell, and F. J. Keil,\nEfficient methods for finding transition states in chemical reactions: Comparison of improved dimer method and partitioned rational function optimization method\n, J. Chem. Phys.\n123\n, 224101 (2005)."
  }, 
  "Interface pinning calculations": {
    "description": "The web page describes the interface pinning method in molecular dynamics simulations, which employs the $Np_zT$ ensemble with a Langevin thermostat and a Parrinello-Rahman barostat to study solid-liquid interfaces constrained in the $x$-$y$ plane, using specific order parameters and bias potentials defined by tags such as OFIELD_Q6_NEAR, OF", 
    "detailed_description": "Interface pinning\nuses the\nN\np\nz\nT\n{\\displaystyle Np_zT}\nensemble where the barostat only acts along the\nz\n{\\displaystyle z}\ndirection.\nThis ensemble uses a Langevin thermostat and a Parrinello-Rahman barostat with lattice constraints in the remaining two dimensions.\nThe solid-liquid interface must be in the\nx\n{\\displaystyle x}\n-\ny\n{\\displaystyle y}\nplane perpendicular to the action of the barostat.\nSet the following tags for the\ninterface pinning\nmethod:\nOFIELD_Q6_NEAR\nDefines the near-fading distance\nn\n{\\displaystyle n}\n.\nOFIELD_Q6_FAR\nDefines the far-fading distance\nf\n{\\displaystyle f}\n.\nOFIELD_KAPPA\nDefines the coupling strength\nκ\n{\\displaystyle \\kappa}\nof the bias potential.\nOFIELD_A\nDefines the desired value of the order parameter\nA\n{\\displaystyle A}\n.\nThe following example\nINCAR\nfile calculates the interface pinning in sodium\n[1]\n:\nTEBEG\n= 400                   # temperature in K\nPOTIM\n= 4                     # timestep in fs\nIBRION\n= 0                    # run molecular dynamics\nISIF\n= 3                      # use Parrinello-Rahman barostat for the lattice\nMDALGO\n= 3                    # use Langevin thermostat\nLANGEVIN_GAMMA_L\n= 3.0        # friction coefficient for the lattice degree of freedoms (DoF)\nLANGEVIN_GAMMA\n= 1.0          # friction coefficient for atomic DoFs for each species\nPMASS\n= 100                   # mass for lattice DoFs\nLATTICE_CONSTRAINTS\n= F F T   # fix x-y plane, release z lattice dynamics\nOFIELD_Q6_NEAR\n= 3.22         # near fading distance for function w(r) in Angstrom\nOFIELD_Q6_FAR\n= 4.384         # far fading distance for function w(r) in Angstrom\nOFIELD_KAPPA\n= 500            # strength of bias potential in eV/(unit of Q)^2\nOFIELD_A\n= 0.15               # desired value of the Q6 order parameter\nReferences\n↑\nU. R. Pedersen, F. Hummel, G. Kresse, G. Kahl, and C. Dellago, Phys. Rev. B\n88\n, 094101 (2013)."
  }, 
  "Intrinsic-reaction-coordinate calculations": {
    "description": "This web page describes the computational method for determining potential energy profiles along the intrinsic reaction coordinate (IRC) using a damped-velocity-Verlet algorithm, including input requirements, parameter settings, and a practical example of its application to an SN2 reaction using a machine-learned force field.", 
    "detailed_description": "The potential energy profiles along the\nintrinsic reaction coordinate\n(IRC) can be computed via the method of Hratchian and Schlegel\n[1]\n. The algorithm starts from the transition state and propagates the system via the damped-velocity-Verlet algorithm. The damping is realized via rescaling the velocity vector to a constant value (\nv\n0\n{\\displaystyle v_0}\n) after each propagation step. At the same time, the time step is adaptively changed so as to ensure that the trajectory generated by the algorithm does not differ from true IRC by more than the predefined tolerance factor\nΔ\n0\n{\\displaystyle \\Delta_0}\n. As an input, the structure of a well-relaxed transition state and the direction of the unstable vibration mode must be provided. For that purpose, a\nCONTCAR\nfile from an\nimproved-dimer-method\ncalculation converged with a tight relaxation criterion (e.g.,\nEDIFFG\n=-0.005) can be used. To obtain a complete energy profile along the IRC connecting two stable states, two independent calculations with positive (\nIRC_DIRECTION\n=1) and negative (\nIRC_DIRECTION\n=-1) initial displacement along the direction of the unstable mode must be performed.\nThe following parameters can be modified to affect the performance of the method:\nIRC_DIRECTION\ndirection of the initial displacement (-1|1 – negative|positive)\nIRC_STOP\nthe number of steps the energy must monotonously increase before the algorithm terminates. In order to avoid a premature termination, especially close to transition states., e.g., due to numerical noise,\nIRC_STOP\nshould always be greater than 1.\nIRC_DELTA0\nthe tolerance factor\nΔ\n0\n{\\displaystyle \\Delta_0}\nin  Å\nIRC_MINSTEP\nspecifies the lower limit for the time step in fs\nIRC_MAXSTEP\nspecifies the upper limit for the time step in fs\nIRC_VNORM0\nthe value of\nv\n0\n{\\displaystyle v_0}\nin Å/fs - the smaller the value, the closer the computed trajectory follows the true IRC (but the more ionic steps are required, which might be a limitation if the calculation is performed at a DFT level)\nMind:\nThis method is presently available only for fixed cell shape (i.e.,\nISIF\n= 2) simulations.\nMind:\nThe calculation must be initialized from a very well-relaxed transition state (\nEDIFFG\n= -0.005 or less in absolute value).\nMind:\nThis type of calculation can be also performed at the MLFF level.\nPractical example\nAs practical example, let us consider the SN2 reaction of CH\n3\nCl with Cl\n-\nfor which we wish to determine potential energy profile along IRC using machine learned forcefield trained to reproduce PBE density functional approximation. The IRC calculation consists of two independent simulations corresponding to parts of path linking transition state with reactant and with product, respectively. For practical reasons, we shall therefore run the simulations in two different directories called, say, m and p, both of which should contain\nPOSCAR\n,\nKPOINTS\n,\nPOTCAR\n,\nINCAR\nand\nML_FF\nfiles. The\nPOSCAR\nfile:\ntransition state for the SN2 reaction of CH3Cl with Cl-\n1.00000000000000\n12.0000000000000000    0.0000000000000000    0.0000000000000000\n0.0000000000000000   12.0000000000000000    0.0000000000000000\n0.0000000000000000    0.0000000000000000   12.0000000000000000\nC    H    Cl\n1     3     2\nDirect\n0.5850734246784209  0.5520914206000113  0.6939676081570985 ! coordinates for atom 1\n0.6198799799863561  0.5166828822917992  0.6192173893914401\n0.5120438703668218  0.5155341457726120  0.7311383922253840\n0.6232988535554732  0.6240585575728448  0.7315296645899942\n0.4727762112937258  0.6675904758190063  0.5870243322899322\n0.6973145053782144  0.4366510550400121  0.8010186348593505 ! coordinates for atom N\n! unstable direction optimized by the dimer method\n0.50309310E+00 -0.52116977E+00  0.48103627E+00             ! components for atom 1\n-0.29990134E-01  0.31072124E-01 -0.24160721E-01\n-0.37734828E-01  0.43431417E-01 -0.39422281E-01\n-0.41647034E-01  0.41752749E-01 -0.38921427E-01\n-0.20205452E+00  0.20762993E+00 -0.17619553E+00\n-0.19166655E+00  0.19728353E+00 -0.20233630E+00             ! components for atom N\nis simply a copy of a\nCONTCAR\nfile from a well converged improved dimer calculation. Notice that besides usual structural input,\nPOSCAR\nmust contain unstable direction that is needed to initialize the algorithm. To obtain the\nML_FF\nused in this example, the data included in compressed directory\nFile:GenerateMLFF.zip\nshould be used. The POTCAR file should be prepared for atoms C, H, and Cl and the\nKPOINTS\nfile\nAutomatic\n0\nGamma\n1  1  1\n0. 0. 0.\nThe\nINCAR\nfile located in directory m should contain the following lines:\nIBRION = 40                  # invokes the IRC calculation\nIRC_DIRECTION = -1           # negative initial direction of movement\nIRC_STOP = 20                # terminate when IRC_STOP energies in row increase\nIRC_VNORM0 = 0.0005          # affects accuracy, the smaller the better but the more\n# ionic steps needed\nNSW = 5000                   # maximal number of steps\nISIF = 2\nNELECT = 22                  # the overall charge of this\n# system is -1 hence the number\n# of electrons is increased (not really needed when\n# the calculation is done at the MLFF level)\nML_LMLFF = .TRUE.            # invoke MLFF\nML_ISTART = 2                # sets the mode of MLFF to production\nThe\nINCAR\nfile located in directory p should differ from that in directory m only in the value of parameter\nIRC_DIRECTION\n, which should be set to positive 1.\nPotential energy profile along intrinsic reaction coordinate generated in this practical example for the SN\n2\nreaction of CH\n3\nCl with Cl\n-\n.\nBoth calculations can be finished in just a few seconds and the potential energy profile along IRC shown on the figure, can be obtained by a simple post-processing. For instance, this simple  bash script ircShift.sh:\n#!/usr/bin/bash\ne0=$(grep \"IRC (A):\" m/OUTCAR|awk '{print $5}'|head -1)\ngrep \"IRC (A):\" m/OUTCAR|awk '{print $3,$5 - \"'${e0}'\"}' >tmp.tmp\ngrep \"IRC (A):\" p/OUTCAR|awk '{print $3,$5 - \"'${e0}'\"}' >>tmp.tmp\nsort -n tmp.tmp >ircShift.dat\nexecuted in a directory one level above directories m and p generates the file ircShift.dat containing data in two-column format that can be visualized using gnuplot, xmgrace, origin, or many other popular visualization tools.\nRelated tags and articles\nIRC_DIRECTION\n,\nIRC_STOP\n,\nIRC_DELTA0\n,\nIRC_MINSTEP\n,\nIRC_MAXSTEP\n,\nIRC_VNORM0\nReferences\n↑\nH. P. Hratchian and H. B. Schlegel,\nFollowing Reaction Pathways Using a Damped Classical Trajectory Algorithm\n, J. Phys. Chem. A\n106\n, 165 (2002)."
  }, 
  "LBERRY": {
    "description": "The web page explains how to calculate the electronic polarization and Born effective charges in an insulating system using the Berry phase method in VASP, including input parameters, step-by-step procedures, and an example calculation for NaF.", 
    "detailed_description": "LBERRY\n= [logical]\nDefault:\nLBERRY\n= .FALSE.\nDescription: This tag is used in the the evaluation of the Berry phase expression for the electronic polarization of an insulating system.\nAs of VASP.5.2, calculating the macroscopic polarization and Born effective charges along the lines of the following example (using\nLBERRY\n=\n.TRUE.\netc) is unnecessary. The use of\nLCALCPOL\nor\nLCALCEPS\nis much more convenient.\nSetting\nLBERRY\n=\n.TRUE.\nin the\nINCAR\nfile switches on the evaluation of the Berry phase expression for the electronic polarization of an insulating system, as modified for the application of USPP's and PAW datasets\n[1]\n[2]\n[3]\n[4]\n[5]\n[6]\n[7]\n.\nIn addition, the following keywords must be specified in order to generate the mesh of k-points:\nIGPAR = 1|2|3\nIGPAR\ntag specifies the socalled parallel or\nG\n∥\n{\\displaystyle \\bold{G}_{\\parallel}}\ndirection in the integration over the reciprocal space unit cell.\nNPPSTR = number of points on the strings in the IGPAR direction\nNPPSTR\nspecifies the number of k-points on the strings\nk\nj\n=\nk\n⊥\n+\nj\nG\n∥\n/\nN\nP\nP\nS\nT\nR\n{\\displaystyle \\bold{k}_{j} = \\bold{k}_{\\perp} + j\\bold{G}_{\\parallel}/\\mathrm{NPPSTR} }\n(with\nj\n=\n0\n,\n.\n.\n,\nN\nP\nP\nS\nT\nR\n−\n1\n{\\displaystyle  j=0,..,\\mathrm{NPPSTR}-1}\n).\nDIPOL = center of cell (fractional coordinates)\nDIPOL\nspecifies the origin with respect to which the ionic contribution to the dipole moment in the cell is calculated. When comparing changes in this contribution due to the displacement of an ion, this center should be chosen in such a way that the ions in the distorted and the undistorted structure remain on the same side of\nDIPOL\n(in terms of a minimum image convention).\nAn example: The fluorine displacement dipole (Born effective charge) in NaF\nFirst one needs to determine the electronic polarization of the undistorted NaF.\nCaluclation1:\nIt is usually convenient to calculate the self-consistent Kohn-Sham potential of the undistorted structure, using a symmetry reduced\n6\n×\n6\n×\n6\n{\\displaystyle 6\\times6\\times6}\nMonkhorst-Pack sampling of the Brillouin zone. Using for instance the following\nINCAR\nfile:\nPREC   = Med\nISMEAR = 0\nEDIFF  = 1E-6\nKPOINTS\nfile:\n6x6x6\n0\nGamma\n6 6 6\n0 0 0\nPOSCAR\nfile:\nNaF\n4.5102\n0.0 0.5 0.5\n0.5 0.0 0.5\n0.5 0.5 0.0\n1 1\nDirect\n0.0000000000000000  0.0000000000000000  0.0000000000000000\n0.5000000000000000  0.5000000000000000  0.5000000000000000\nand LDA Na_sv and F PAW datasets.\nCalculation 2:\nTo calculate the electronic contribution to the polarization, along the reciprocal lattice vector\nG\n1\n{\\displaystyle \\bold{G}_{1}}\n(i.e.\nP\n⋅\nG\n1\n{\\displaystyle  \\bold{P} \\cdot \\bold{G}_{1} }\n), add the following lines to the\nINCAR\nfile:\nLBERRY = .TRUE.\nIGPAR  = 1\nNPPSTR = 8\nDIPOL = 0.25 0.25 0.25\nSetting\nLBERRY\n=\n.TRUE.\nautomatically sets\nICHARG\n=11, i.e., the charge density of the previous calculation is read and kept fixed, and only the orbitals and one-electron eigenenergies are recalculated for the new k-point set. This is advantageous, since the number of k-points used to evaluate the Berry phase expression can be quite large, and precalculating the charge density (\nICHARG\n=11) saves significant CPU time.\nThe\nOUTCAR\nwill now contain the following lines:\ne<r>_ev=(     0.00000     0.00000     0.00000 ) e*Angst\ne<r>_bp=(     0.00000     0.00000     0.00000 ) e*Angst\nTotal electronic dipole moment: p[elc]=(     0.00000     0.00000     0.00000 ) e*Angst\nionic dipole moment: p[ion]=(     2.25510     2.25510     2.25510 ) e*Angst\nCalculations 3 and 4:\nThe procedure mentioned under Calculation 2 now has to be repeated with\nIGPAR\n=2 and\nIGPAR\n=3 (again using the charge density obtained from Calculation 1), to obtain the contributions to the electronic polarization along\nG\n2\n{\\displaystyle \\bold{G}_2}\nand\nG\n3\n{\\displaystyle \\bold{G}_{3}}\n, respectively.\nCalculations 5 to 8:\nTo calculate the change in the electronic polarization of NaF due to the displacement of the fluorine sublattice, one should repeat Calculations 1 to 4, using the following\nPOSCAR\nfile:\nNaF\n4.5102\n0.0 0.5 0.5\n0.5 0.0 0.5\n0.5 0.5 0.0\n1 1\nDirect\n0.0000000000000000  0.0000000000000000  0.0000000000000000\n0.5100000000000000  0.5100000000000000  0.4900000000000000\nThis corresponds to a displacement of the F ion by\n0.01\n×\n4.51\nÅ\n{\\displaystyle 0.01\\times 4.51\\AA}\nalong the\nz\n^\n{\\displaystyle \\hat{z}}\ndirection. The output of the Berry phase calculation using\nIGPAR\n=1 should now look similar to:\ne<r>_ev=(     0.00000     0.00000     0.00004 ) e*Angst\ne<r>_bp=(     0.00000     0.18028     0.18028 ) e*Angst\nTotal electronic dipole moment: p[elc]=(     0.00000     0.18028     0.18031 ) e*Angst\nionic dipole moment: p[ion]=(     2.25510     2.25510     1.93939 ) e*Angst\nCollecting the results:\nThe change in the electronic contribution to the polarization due to the F-sublattice displacement should be calculated as follows:\nTake the average of the\ne\n<\nr\n>\ne\nv\n{\\displaystyle e<\\mathrm{r}>_\\mathrm{ev}}\nterms obtained in calculations 2 to 4. Lets call this\ne\n<\nr\n>\ne\nv\n,\nu\nn\nd\ni\ns\nt\n{\\displaystyle e<\\mathrm{r}>_{\\mathrm{ev,undist}}}\nAdd the\ne\n<\nr\n>\nb\np\n{\\displaystyle e<\\mathrm{r}>_{\\mathrm{bp}} }\nterms obtained in calculations 2 to 4. Lets call this\ne\n<\nr\n>\nb\np\n,\nu\nn\nd\ni\ns\nt\n{\\displaystyle e<\\mathrm{r}>_{\\mathrm{bp,undist}}}\nThe electronic polarization of the undistorted structure is then given by:\ne\n<\nr\n>\ne\nl\n,\nu\nn\nd\ni\ns\nt\n=\ne\n<\nr\n>\ne\nv\n,\nu\nn\nd\ni\ns\nt\n+\ne\n<\nr\n>\nb\np\n,\nu\nn\nd\ni\ns\nt\n{\\displaystyle  e<\\mathrm{r}>_{\\mathrm{el,undist}}=e<\\mathrm{r}>_{\\mathrm{ev,undist}}+e<\\mathrm{r}>_{\\mathrm{bp,undist}} }\nRepeat the above three steps for the results obtained using the distorted structure (Calculations 6 to 8), to evaluate\ne\n<\nr\n>\ne\nv\n,\nd\ni\ns\nt\n{\\displaystyle e<\\mathrm{r}>_{\\mathrm{ev,dist}}}\n,\ne\n<\nr\n>\nb\np\n,\nd\ni\ns\nt\n{\\displaystyle e<\\mathrm{r}>_{\\mathrm{bp,dist}}}\n, and\ne\n<\nr\n>\ne\nl\n,\nd\ni\ns\nt\n{\\displaystyle e<\\mathrm{r}>_{\\mathrm{el,dist}}}\nThe change in the electronic contribution to the polarization due to the F-sublattice displacement,\ne\nΔ\n<\nr\n>\ne\nl\n{\\displaystyle e\\Delta<\\mathrm{r}>_\\mathrm{el}}\nis then given by\ne\n<\nr\n>\ne\nl\n,\nd\ni\ns\nt\n−\ne\n<\nr\n>\ne\nl\n,\nu\nn\nd\ni\ns\nt\n{\\displaystyle e<\\mathrm{r}>_{\\mathrm{el,dist}}-e<\\mathrm{r}>_{\\mathrm{el,undist}}}\nTo calculate the total change in polarization,\ne\nΔ\n<\nr\n>\n{\\displaystyle e\\Delta<\\mathrm{r}> }\n, one should account for the ionic contribution to this change. This contribution can be calculated from p[ion] as given above from\nCalculations 2 and 5:\nΔ\np\n[\ni\no\nn\n]\n=\np\n[\ni\no\nn\n]\nd\ni\ns\nt\n−\np\n[\ni\no\nn\n]\nu\nn\nd\ni\ns\nt\n{\\displaystyle  \\Delta\\mathrm{p[ion]}=\\mathrm{p[ion]}_{\\mathrm{dist}}-\\mathrm{p[ion]}_{\\mathrm{undist}} }\n.\ne\nΔ\n<\nr\n>\n{\\displaystyle  e\\Delta<\\mathrm{r}> }\nis then given by\nΔ\np\n[\ni\no\nn\n]\n+\ne\nΔ\n<\nr\n>\ne\nl\n{\\displaystyle  \\Delta \\mathrm{p[ion]}+e\\Delta<\\mathrm{r}>_\\mathrm{el} }\n. In this example we find\ne\nΔ\n<\nr\n>=\n0.04489\n{\\displaystyle  e\\Delta<\\mathrm{r}>=0.04489}\nelectrons\nÅ\n{\\displaystyle \\AA}\n. Considering that the moved F-sublattice was displaced by 0.045102\nÅ\n{\\displaystyle \\AA }\n, this calculation yields a Born effective charge for fluorine in NaF of\nZ\n∗\n=\n−\n0.995\n{\\displaystyle Z^{*}=-0.995 }\n.\nN.B.(I) In the case of spinpolarized calculations (\nISPIN\n=2),the Berry phase of the orbitals is evaluated separately for each spin direction. This means a\ngrep\non \"\n<\nr\n>\n{\\displaystyle <\\mathrm{r}> }\n\" will yield two sets of\n<\nr\n>\ne\nv\n{\\displaystyle  <\\mathrm{r}>_{\\mathrm{ev}} }\nand\n<\nr\n>\nb\np\n{\\displaystyle  <\\mathrm{r}>_{\\mathrm{bp}}}\nterms, which have to be added to oneanother to obtain the total electronic polarization of the system.\nN.B.(II) One should take care of the fact that the calculated \"Berry phase\" term\n<\nr\n>\nb\np\n{\\displaystyle  <\\mathrm{r}>_{\\mathrm{bp}}}\nalong\nG\ni\n{\\displaystyle \\mathbf{G}_{i}}\nis, in principle, obtained modulo a certain period, determined by the lattice vector\nR\ni\n{\\displaystyle  \\mathbf{R}_{i} }\n(\nR\ni\n⋅\nG\ni\n=\n2\nπ\n{\\displaystyle \\mathbf{R}_{i} \\cdot \\mathbf{G}_{i} = 2 \\pi }\n), the spin multiplicity of the orbitals, the volume of the unit cell, the number of k-point in the \"perpendicular\" grid, and some aspects of the symmetry of the system. More information on this particular aspect of the Berry phase calculations can be found in references\n[1]\n[2]\n[3]\n[4]\n[5]\n[7]\n.\nRelated tags and articles\nIGPAR\n,\nDIPOL\n,\nNPPSTR\n,\nLCALCPOL\n,\nLCALCEPS\n,\nLCALCEPS\n,\nICHARG\n,\nISPIN\nExamples that use this tag\nReferences\n↑\na\nb\nR. D. King-Smith and D. Vanderbilt, Phys. Rev. B 47, 1651 (1993).\n↑\na\nb\nD. Vanderbilt and R. D. King-Smith, Phys. Rev. B 48, 4442 (1993).\n↑\na\nb\nR. Resta, Ferroelectrtics 136, 51 (1992).\n↑\na\nb\nR. Resta, Rev. Mod. Phys. 66, 899 (1994).\n↑\na\nb\n[R. Resta, in Berry Phase in Electronic Wavefunctions, Troisième Cycle de la Physique en Suisse Romande, Année Academique 1995-96, (1996).]\n↑\n[D. Vanderbilt and R. D. King-Smith, in Electronic polarization in the ultrasoft pseudopotential formalism, Unpublished report, (1998).]\n↑\na\nb\n[Available online at\nhttp://cms.mpi.univie.ac.at/vasp/Welcome.html\n.]"
  }, 
  "LCALCEPS": {
    "description": "The web page describes the use of the `LCALCEPS` flag in VASP to calculate the ion-clamped static dielectric tensor, Born effective charge tensors, and piezoelectric tensor from the system's response to finite electric fields, with options to include or exclude local field effects and details on output and related tags.", 
    "detailed_description": "LCALCEPS\n= .TRUE. | .FALSE.\nDefault:\nLCALCEPS\n= .FALSE.\nDescription: for\nLCALCEPS\n=.TRUE. the macroscopic ion-clamped static dielectric tensor, Born effective charge tensors, and the ion-clamped piezoelectric tensor of the system are determined from the response to finite electric fields.\nFor\nLCALCEPS\n=.TRUE., VASP calculates the ion-clamped static dielectric tensor\nϵ\ni\nj\n∞\n=\nδ\ni\nj\n+\n4\nπ\nϵ\n0\n∂\nP\ni\n∂\nE\nj\n,\ni\n,\nj\n=\nx\n,\ny\n,\nz\n{\\displaystyle\n\\epsilon^\\infty_{ij}=\\delta_{ij}+\n\\frac{4\\pi}{\\epsilon_0}\\frac{\\partial P_i}{\\partial \\mathcal{E}_j},\n\\qquad\n{i,j=x,y,z}\n}\nthe Born effective charge tensors\nZ\ni\nj\n∗\n=\nΩ\ne\n∂\nP\ni\n∂\nu\nj\n=\n1\ne\n∂\nF\nj\n∂\nE\ni\n,\ni\n,\nj\n=\nx\n,\ny\n,\nz\n{\\displaystyle\nZ^*_{ij}=\\frac{\\Omega}{e}\\frac{\\partial P_i}{\\partial u_j}\n=\\frac{1}{e}\\frac{\\partial F_j}{\\partial \\mathcal{E}_i},\n\\qquad\n{i,j=x,y,z}\n}\nand the ion-clamped piezoelectric tensor of the system\ne\ni\nj\n(\n0\n)\n=\n−\n∂\nσ\ni\n∂\nE\nj\n,\ni\n=\nx\nx\n,\ny\ny\n,\nz\nz\n,\nx\ny\n,\ny\nz\n,\nz\nx\nj\n=\nx\n,\ny\n,\nz\n{\\displaystyle\ne^{(0)}_{ij}=-\\frac{\\partial \\sigma_i}{\\partial \\mathcal{E}_j},\n\\qquad\n{i=xx, yy, zz, xy, yz, zx}\\quad{j=x,y,z}\n}\nfrom the\nself-consistent response to a finite electric field\nε\n.\nIn this case, the \"response\" of the system is the change in the polarization\nP\n, the Hellmann-Feynman forces\nF\n, and the stress tensor σ. Mind the\ndefinition/sign convention of the stress tensor\n.\nIf this is combined with\nIBRION\n=6, the contribution from the ionic relaxations to the piezoelectric and dielectric tensors are calculated as well.\nTo this end VASP will perform essentially three successive calculations, with:\nEFIELD_PEAD\n=\nε\nx\n0 0\nEFIELD_PEAD\n= 0\nε\ny\n0\nEFIELD_PEAD\n= 0 0\nε\nz\nwhere, by default, VASP chooses\nε\nx\n=\nε\ny\n=\nε\nz\n=0.01 eV/Å.\nThis default may be overwritten by specifying\nEFIELD_PEAD\n=\nε\nx\nε\ny\nε\nz\nin the\nINCAR\nfile.\nThe relevant output is found in the\nOUTCAR\nfile, immediately following the lines (see the description of\nLEPSILON\n=.TRUE. as well):\nMACROSCOPIC STATIC DIELECTRIC TENSOR (including local field effects)\nBORN EFFECTIVE CHARGES (including local field effects)\nPIEZOELECTRIC TENSOR (including local field effects)\nIn the above, \"including local field effects\" pertains to the fact that changes in the orbitals due to the electric field induce changes in the Hartree- and exchange-correlation potential. One may choose to limit this to changes in the Hartree potential alone, by specifying:\nLRPA\n=.TRUE.\nThis is commonly referred to as the response within the \"Random Phase Approximation\" (RPA), or the \"neglect of local field effects\". The OUTCAR file will now contain additional sections, headed by the lines:\nMACROSCOPIC STATIC DIELECTRIC TENSOR (excluding local field effects)\nBORN EFFECTIVE CHARGES (excluding local field effects)\nPIEZOELECTRIC TENSOR (excluding local field effects)\nNote\n: For standard DFT functionals, ε\n∞\n,\nZ\n*\n, and\ne\n(0)\nmay be more easily calculated from density functional perturbation theory (see\nLEPSILON\n=.TRUE.). For functionals that depend not only on the density but also explicitly on the orbitals, like\nhybrid functionals\n, density functional perturbation theory is presently not implemented and\nLEPSILON\n=.TRUE. is not applicable.\nNote\n: The piezoelectric tensor has the wrong sign in Vasp 5.4.4 and older. The bug is fixed with\npatch.5.4.4.16052018.gz\n.\nRelated tags and articles\nLEPSILON\n,\nLCALCPOL\n,\nEFIELD_PEAD\n,\nLPEAD\n,\nIPEAD\n,\nLBERRY\n,\nIGPAR\n,\nNPPSTR\n,\nDIPOL\n,\nIBRION\n,\nBerry phases and finite electric fields\nExamples that use this tag"
  }, 
  "Langevin thermostat": {
    "description": "The web page describes the Langevin thermostat, a method used in molecular dynamics simulations to maintain a constant temperature by modifying Newton's equations of motion with friction and random forces, and explains its implementation in different thermodynamic ensembles (NVT and NpT) using specific parameters like LANGEVIN_GAMMA and MDALGO=3.", 
    "detailed_description": "The Langevin thermostat\n[1]\n[2]\n[3]\nmaintains the temperature through a modification of Newton's equations of motion\nr\ni\n˙\n=\np\ni\n/\nm\ni\np\ni\n˙\n=\nF\ni\n−\nγ\ni\np\ni\n+\nf\ni\n,\n{\\displaystyle\n\\dot{r_i} = p_i/m_i \\qquad\n\\dot{p_i} = F_i - {\\gamma}_i\\,p_i + f_i,\n}\nwhere\nF\ni\nis the force acting on atom\ni\ndue to the interaction potential, γ\ni\nis a friction coefficient, and\nf\ni\nis a random force simulating the random kicks by the damping of particles between each other due to friction. The random numbers are chosen from a Gaussian distribution with the following variance\nσ\ni\n2\n=\n2\nm\ni\nγ\ni\nk\nB\nT\n/\nΔ\nt\n{\\displaystyle\n\\sigma_i^2 = 2\\,m_i\\,{\\gamma}_i\\,k_B\\,T/{\\Delta}t\n}\nwith Δ\nt\nbeing the time-step used in the MD to integrate the equations of motion. Obviously, Langevin dynamics is identical to the classical Hamiltonian in the limit of vanishing γ.\nNVT ensemble\n:\nThe friction coefficient is set by the\nLANGEVIN_GAMMA\nparameter.\nNpT ensemble\n:\nAs for the\nNVT ensemble\nthe\nLANGEVIN_GAMMA\nparameter has to be set. If the\nNpT ensemble\nis used (by setting\nISIF\n=3) additionally the friction coefficient of the lattice\nLANGEVIN_GAMMA_L\nhas to be provided too.\nThe Langevin thermostat is selected by MDALGO=3.\nRelated tags and articles\nMolecular-dynamics calculations\n,\nAndersen thermostat\n,\nNose-Hoover thermostat\n,\nCSVR thermostat\n,\nNose-Hoover-chain thermostat\n,\nISIF\n,\nMDALGO\n,\nLANGEVIN_GAMMA\n,\nLANGEVIN_GAMMA_L\nReferences\n↑\nM. P. Allen and D. J. Tildesley,\nComputer simulation of liquids\n(Oxford university press: New York, 1991).\n↑\nW. G. Hoover, A. J. C. Ladd, and B. Moran, Phys. Rev. Lett.\n48\n, 1818 (1982).\n↑\nD. J. Evans, J. Chem. Phys.\n78\n, 3297 (1983)."
  }, 
  "List of hybrid functionals": {
    "description": "This web page details the various hybrid exchange-correlation functionals available in the Vienna Ab initio Simulation Package (VASP), including range-separated, dielectric-dependent, and unscreened hybrids, along with their respective input parameters and recommended settings for accurate electronic structure calculations.", 
    "detailed_description": "A certain number of\nunscreened and screened hybrid functionals\nare available in VASP, and furthermore if VASP is\ncompiled\nwith the library of exchange-correlation functionals Libxc, then most of the existing hybrid functionals can be used\n[1]\n. Examples of\nINCAR\nfiles are shown below. Since VASP.6.4.0 it is possible to use hybrid functionals that mix meta-GGA and Hartree-Fock exchange. Note that it is in general recommended to use the PBE\nPOTCAR\nfiles for hybrid functionals.\nRange-separated hybrid functionals\nHSE06\n[2]\nLHFCALC\n= .TRUE.\nGGA\n= PE\nHFSCREEN\n= 0.2\nwith the default values\nAEXX\n=0.25,\nAGGAX\n=1-\nAEXX\n=0.75,\nAGGAC\n=1, and\nALDAC\n=1.\nHSE03\n[3]\n[4]\n[5]\nLHFCALC\n= .TRUE.\nGGA\n= PE\nHFSCREEN\n= 0.3\nwith the default values\nAEXX\n=0.25,\nAGGAX\n=1-\nAEXX\n=0.75,\nAGGAC\n=1, and\nALDAC\n=1.\nHSEsol\n[6]\nLHFCALC\n= .TRUE.\nGGA\n= PS\nHFSCREEN\n= 0.2\nwith the default values\nAEXX\n=0.25,\nAGGAX\n=1-\nAEXX\n=0.75,\nAGGAC\n=1, and\nALDAC\n=1.\nDielectric-dependent hybrid (DDH) functional\n[7]\n[8]\nLMODELHF\n= .TRUE.\nAEXX\n=\nε\n−\n1\n{\\displaystyle \\varepsilon^{-1}}\nHFSCREEN\n=\nμ\n{\\displaystyle \\mu}\nGGA\n= PE\nwhere\nε\n−\n1\n{\\displaystyle \\varepsilon^{-1}}\nis the inverse dielectric constant and\nμ\n{\\displaystyle \\mu}\nis the range-separation parameter. See a detailed description of the DDH functionals in the documentation for the\nLMODELHF\ntag.\nRSHXLDA\n[9]\nLHFCALC\n= .TRUE.\nLRHFCALC\n= .TRUE.\nGGA\n= CA (or PZ)\nHFSCREEN\n= 0.75 # Optimal value for solids\nwith the default values\nAEXX\n=1,\nAGGAX\n=1-\nAEXX\n=0,\nAGGAC\n=1, and\nALDAC\n=1.\nRSHXPBE\n[10]\nLHFCALC\n= .TRUE.\nLRHFCALC\n= .TRUE.\nGGA\n= PE\nHFSCREEN\n= 0.91 # Optimal value for the enthalpies of formation of molecules\nwith the default values\nAEXX\n=1,\nAGGAX\n=1-\nAEXX\n=0,\nAGGAC\n=1, and\nALDAC\n=1.\nUnscreened hybrid functionals\nPBEh (PBE0)\n[11]\n[12]\n[13]\nLHFCALC\n= .TRUE.\nGGA\n= PE\nwith the default values\nAEXX\n=0.25,\nAGGAX\n=1-\nAEXX\n=0.75,\nAGGAC\n=1, and\nALDAC\n=1.\nB3LYP\n[14]\nwith VWN3 (or VWN5) for LDA correlation\nLHFCALC\n= .TRUE.\nGGA\n= B3 (or B5)\nAEXX\n= 0.2\nAGGAX\n= 0.72\nAGGAC\n= 0.81\nALDAC\n= 0.19\nwith the default value\nALDAX\n=1-\nAEXX\n=0.8.\nB3PW91\n[15]\n(using Libxc, see the tag\nLIBXC1\n)\nLHFCALC\n= .TRUE.\nGGA\n= LIBXC\nLIBXC1\n= HYB_GGA_XC_B3PW91 # or 401\nAEXX\n= 0.2\nB1-WC\n[16]\n(using Libxc, see the tag\nLIBXC1\n)\nLHFCALC\n= .TRUE.\nGGA\n= LIBXC\nLIBXC1\n= HYB_GGA_XC_B1WC # or 412\nAEXX\n= 0.16\nSCAN0\nLHFCALC\n= .TRUE.\nMETAGGA\n= SCAN\nwith the default values\nAEXX\n=0.25,\nAMGGAX\n=1-\nAEXX\n=0.75, and\nAMGGAC\n=1.\nHartree-Fock (no correlation)\nLHFCALC\n= .TRUE.\nAEXX\n= 1\nwith the default values\nAGGAX\n=1-\nAEXX\n=0,\nALDAC\n=0, and\nAGGAC\n=0.\nMind:\nNote the default values when\nLHFCALC\n=.TRUE.:\nALDAX\n,\nAGGAX\nand\nAMGGAX\nare set to 1-\nAEXX\n.\nALDAC\n,\nAGGAC\nand\nAMGGAC\nare set to 0 if\nAEXX\n=1 or to 1 if\nAEXX\n≠\n{\\displaystyle \\neq}\n1.\nRelated tags and articles\nGGA\n,\nMETAGGA\n,\nLIBXC1\n,\nLIBXC2\n,\nAEXX\n,\nALDAX\n,\nALDAC\n,\nAGGAX\n,\nAGGAC\n,\nAMGGAX\n,\nAMGGAC\n,\nLHFCALC\n,\nHFSCREEN\n,\nLMODELHF\n,\nLRHFCALC\n,\nHybrid functionals: formalism\nReferences\n↑\nhttps://libxc.gitlab.io/functionals/\n↑\nA. V. Krukau , O. A. Vydrov, A. F. Izmaylov, and G. E. Scuseria, J. Chem. Phys.\n125\n, 224106 (2006).\n↑\nJ. Heyd, G. E. Scuseria, and M. Ernzerhof, J. Chem. Phys.\n118\n, 8207 (2003).\n↑\nJ. Heyd and G. E. Scuseria, J. Chem. Phys.\n121\n, 1187 (2004).\n↑\nJ. Heyd, G. E. Scuseria, and M. Ernzerhof, J. Chem. Phys.\n124\n, 219906 (2006).\n↑\nL. Schimka, J. Harl, and G. Kresse, J. Chem. Phys.\n134\n, 024116 (2011).\n↑\nW. Chen, G. Miceli, G.M. Rignanese, and A. Pasquarello,\nNonempirical dielectric-dependent hybrid functional with range separation for semiconductors and insulators\n, Phys. Rev. Mater.\n2\n, 073803 (2018).\n↑\nZ.H. Cui, Y.C. Wang, M.Y. Zhang, X. Xu, and H. Jiang,\nDoubly Screened Hybrid Functional: An Accurate First-Principles Approach for Both Narrow- and Wide-Gap Semiconductors\nJ. Phys. Chem. Lett.,\n9\n, 2338-2345  (2018).\n↑\nI. C. Gerber, J. G. Ángyán, M. Marsman, and G. Kresse,\nRange separated hybrid density functional with long-range Hartree-Fock exchange applied to solids\n, J. Chem. Phys.\n127\n, 054101 (2007).\n↑\nI. C. Gerber and J. G. Ángyán,\nHybrid functional with separated range\n, Chem. Phys. Lett.\n415\n, 100 (2005).\n↑\nJ. P. Perdew, M. Ernzerhof, and K. Burke, J. Chem. Phys.\n105\n, 9982 (1996).\n↑\nM. Ernzerhof and G. E. Scuseria, J. Chem. Phys.\n110\n, 5029 (1999).\n↑\nC. Adamo and V. Barone, Phys. Rev. Lett.,\n110\n, 6158 (1999).\n↑\nP. J. Stephens, F. J. Devlin, C. F. Chabalowski, and M. J. Frisch, J. Phys. Chem.\n98\n, 11623 (1994).\n↑\nA. D. Becke, J. Chem. Phys.\n98\n, 5648 (1993).\n↑\nD. I. Bilc, R. Orlando, R. Shaltaf, G.-M. Rignanese, J. Iniguez, and P. Ghosez, Phys. Rev. B\n77\n, 165107 (2008)."
  }, 
  "MDALGO": {
    "description": "The web page details the various molecular dynamics simulation protocols available in VASP through the MDALGO tag, including descriptions and setup instructions for different ensembles (NVE, NVT), thermostats (Nose-Hoover, Andersen), constrained dynamics, slow-growth methods, metadynamics, and biased molecular dynamics.", 
    "detailed_description": "MDALGO\n= 0 | 1 | 2 | 3 | 4 | 5 | 11 | 21 | 13\nDefault:\nMDALGO\n= 0\nDescription:\nMDALGO\nspecifies the molecular-dynamics-simulation protocol (in case\nIBRION\n=0 and VASP was compiled with\n-Dtbdyn\n).\nMDALGO\n=0: Standard molecular dynamics\nShould provide the same results as\nMDALGO\n=2 (\nNose-Hoover thermostat\n). The difference is that it is a different implementation and works also without the precompiler flag\n-Dtbdyn\n.\nNVE ensemble\nTo perform a calculation in the NVE ensemble:\nSet the standard MD-related tags:\nIBRION\n=0,\nTEBEG\n,\nPOTIM\n, and\nNSW\n.\nSet\nMDALGO\n=0 and set\nSMASS\n=-3.\nMDALGO\n=1: Andersen thermostat\nFor the description of the Andersen thermostat see:\nAndersen thermostat\n.\nThe Andersen thermostat is only available for the NVT ensemble.\nStandard molecular dynamics in\nFor a standard molecular dynamics run with Anderson thermostat, one has to:\nSet the standard MD-related tags:\nIBRION\n=0,\nTEBEG\n,\nPOTIM\n, and\nNSW\n.\nSet\nMDALGO\n=1, and choose an appropriate setting for\nANDERSEN_PROB\nConstrained molecular dynamics\nFor a description of constrained molecular dynamics see\nConstrained molecular dynamics\n.\nFor a constrained molecular dynamics run with Andersen thermostat, one has to:\nSet the standard MD-related tags:\nIBRION\n=0,\nTEBEG\n,\nPOTIM\n, and\nNSW\nSet\nMDALGO\n=1, and choose an appropriate setting for\nANDERSEN_PROB\nDefine geometric constraints in the\nICONST\n-file, and set the STATUS parameter for the constrained coordinates to 0\nWhen the free-energy gradient is to be computed, set\nLBLUEOUT\n=.TRUE.\nSlow-growth approach\nFor a description of slow-growth approach see\nSlow-growth approach\n.\nFor a slow-growth simulation, one has to perform a calcualtion very similar to\nConstrained molecular dynamics\nbut additionally the transformation velocity-related\nINCREM\n-tag for each geometric parameter with\nSTATUS=0\nhas to be specified:\nSet the standard MD-related tags:\nIBRION\n=0,\nTEBEG\n,\nPOTIM\n, and\nNSW\nSet\nMDALGO\n=1, and choose an appropriate setting for\nANDERSEN_PROB\nDefine geometric constraints in the\nICONST\n-file, and set the STATUS parameter for the constrained coordinates to 0\nWhen the free-energy gradient is to be computed, set\nLBLUEOUT\n=.TRUE.\nSpecify the transformation velocity-related\nINCREM\n-tag for each geometric parameter with\nSTATUS=0\n.\nMonitoring geometric parameters\nGeometric parameters with\nSTATUS = 7\nin the\nICONST\n-file are monitored during the MD simulation.\nThe corresponding values are written onto the\nREPORT\n-file, for each MD step, after the lines following the string\nMonit_coord\n.\nSometimes it is desirable to terminate the simulation if all values of monitored parameters get larger that some predefined upper and/or lower limits. These limits can be set by the user by means of the\nVALUE_MAX\nand\nVALUE_MIN\n-tags.\nTo monitor geometric parameters during an MD run:\nSet the standard MD-related tags:\nIBRION\n=0,\nTEBEG\n,\nPOTIM\n, and\nNSW\n.\nSet\nMDALGO\n=1, and choose an appropriate setting for\nANDERSEN_PROB\n.\nDefine geometric constraints in the\nICONST\n-file, and set the\nSTATUS\nparameter for the constrained coordinates to 7.\nOptionally, set the upper and/or lower limits for the coordinates, by means of the\nVALUE_MAX\nand\nVALUE_MIN\n-tags, respectively.\nMetadynamics\nFor a description of metadynamics see\nMetadynamics\n.\nFor a metadynamics run with Andersen thermostat, one has to:\nSet the standard MD-related tags:\nIBRION\n=0,\nTEBEG\n,\nPOTIM\n, and\nNSW\n.\nSet\nMDALGO\n=1 (or\nMDALGO\n=11 in VASP 5.x), and choose an appropriate setting for\nANDERSEN_PROB\n.\nSet the parameters\nHILLS_H\n,\nHILLS_W\n, and\nHILLS_BIN\n.\nDefine collective variables in the\nICONST\n-file, and set the\nSTATUS\nparameter for the collective variables to 5.\nIf needed, define the bias potential in the\nPENALTYPOT\n-file.\nThe actual time-dependent bias potential is written to the\nHILLSPOT\n-file, which is updated after adding a new Gaussian. At the beginning of the simulation, VASP attempts to read the initial bias potential from the\nPENALTYPOT\n-file. For the continuation of a metadynamics run, copy\nHILLSPOT\nto\nPENALTYPOT\n. The values of all collective variables for each MD step are listed in\nREPORT\n-file, check the lines after the string\nMetadynamics\n.\nBiased molecular dynamics\nFor a description of biased molecular dynamics see\nBiased molecular dynamics\n.\nFor a biased molecular dynamics run with Andersen thermostat, one has to:\nSet the standard MD-related tags:\nIBRION\n=0,\nTEBEG\n,\nPOTIM\n, and\nNSW\n.\nSet\nMDALGO\n=1 (or\nMDALGO\n=11 in VASP 5.x), and choose an appropriate setting for\nANDERSEN_PROB\n.\nIn order to avoid updating of the bias potential, set\nHILLS_BIN\n=\nNSW\n.\nDefine collective variables in the\nICONST\n-file, and set the\nSTATUS\nparameter for the collective variables to 5.\nDefine the bias potential in the\nPENALTYPOT\n-file if necessary.\nThe values of all collective variables for each MD step are listed in the\nREPORT\n-file, check the lines after the string\nMetadynamics\n.\nSpecial case: NVE ensemble\nNVE ensemble calculations can be also run by selecting the Anderson thermostat and setting the update collision probability (\nANDERSEN_PROB\n) to zero.\nTo run an NVE ensemble:\nSet the standard MD-related tags:\nIBRION\n=0,\nTEBEG\n,\nPOTIM\n, and\nNSW\n.\nSet\nMDALGO\n=1 and\nANDERSEN_PROB\n=0.0.\nMDALGO\n=2: Nose-Hoover thermostat\nFor the description of the Nose-Hoover thermostat see:\nNose-Hoover thermostat\n.\nThe Nose-Hoover thermostat is currently only available for the NVT ensemble.\nStandard molecular dynamics\nFor a standard molecular dynamics run with Nose-Hoover thermostat, one has to:\nSet the standard MD-related tags:\nIBRION\n=0,\nTEBEG\n,\nPOTIM\n, and\nNSW\n.\nSet\nMDALGO\n=2, and choose an appropriate setting for\nSMASS\n.\nConstrained molecular dynamics\nFor a description of constrained molecular dynamics see\nConstrained molecular dynamics\n.\nFor a constrained molecular dynamics run with Nose-Hoover thermostat, one has to:\nSet the standard MD-related tags:\nIBRION\n=0,\nTEBEG\n,\nPOTIM\n, and\nNSW\n.\nSet\nMDALGO\n=2, and choose an appropriate setting for\nSMASS\n.\nDefine geometric constraints in the\nICONST\n-file, and set the STATUS parameter for the constrained coordinates to 0.\nWhen the free-energy gradient is to be computed, set\nLBLUEOUT\n=.TRUE.\nSlow-growth approach\nFor a description of slow-growth approach see\nSlow-growth approach\n.\nFor a slow-growth approach run with Nose-Hoover thermostat, one has to:\nSet the standard MD-related tags:\nIBRION\n=0,\nTEBEG\n,\nPOTIM\n, and\nNSW\nSet\nMDALGO\n=2, and choose an appropriate setting for\nSMASS\nDefine geometric constraints in the\nICONST\n-file, and set the\nSTATUS\nparameter for the constrained coordinates to 0\nWhen the free-energy gradient is to be computed, set\nLBLUEOUT\n=.TRUE.\nSpecify the transformation velocity-related\nINCREM\n-tag for each geometric parameter with\nSTATUS=0\nMonitoring geometric parameters\nGeometric parameters with\nSTATUS = 7\nin the\nICONST\n-file are monitored during the MD simulation.\nThe corresponding values are written onto the\nREPORT\n-file, for each MD step, after the lines following the string\nMonit_coord\n.\nSometimes it is desirable to terminate the simulation if all values of monitored parameters get larger that some predefined upper and/or lower limits. These limits can be set by the user by means of the\nVALUE_MAX\nand\nVALUE_MIN\n-tags.\nTo monitor geometric parameters during an MD run:\nSet the standard MD-related tags:\nIBRION\n=0,\nTEBEG\n,\nPOTIM\n, and\nNSW\nSet\nMDALGO\n=2, and choose an appropriate setting for\nSMASS\nDefine geometric constraints in the\nICONST\n-file, and set the\nSTATUS\nparameter for the constrained coordinates to 7\nOptionally, set the upper and/or lower limits for the coordinates, by means of the\nVALUE_MAX\nand\nVALUE_MIN\n-tags, respectively.\nMetadynamics\nFor a description of metadynamics see\nMetadynamics\n.\nFor a metadynamics run with Nose-Hoover thermostat, one has to:\nSet the standard MD-related tags:\nIBRION\n=0,\nTEBEG\n,\nPOTIM\n, and\nNSW\n.\nSet\nMDALGO\n=2 (or\nMDALGO\n=21 in VASP 5.x), and choose an appropriate setting for\nSMASS\n.\nSet the parameters\nHILLS_H\n,\nHILLS_W\n, and\nHILLS_BIN\n.\nDefine collective variables in the\nICONST\n-file, and set the\nSTATUS\nparameter for the collective variables to 5.\nIf needed, define the bias potential in the\nPENALTYPOT\n-file.\nThe actual time-dependent bias potential is written to the\nHILLSPOT\n-file, which is updated after adding a new Gaussian. At the beginning of the simulation, VASP attempts to read the initial bias potential from the\nPENALTYPOT\n-file. For the continuation of a metadynamics run, copy\nHILLSPOT\nto\nPENALTYPOT\n. The values of all collective variables for each MD step are listed in\nREPORT\n-file, check the lines after the string\nMetadynamics\n.\nBiased molecular dynamics\nFor a description of biased molecular dynamics see\nBiased molecular dynamics\n.\nFor a biased molecular dynamics run with Nose-Hoover thermostat, one has to:\nSet the standard MD-related tags:\nIBRION\n=0,\nTEBEG\n,\nPOTIM\n, and\nNSW\n.\nSet\nMDALGO\n=2 (or\nMDALGO\n=21 in VASP 5.x), and choose an appropriate setting for\nSMASS\n.\nIn order to avoid updating of the bias potential, set\nHILLS_BIN\n=\nNSW\n.\nDefine collective variables in the\nICONST\n-file, and set the\nSTATUS\nparameter for the collective variables to 5.\nDefine the bias potential in the\nPENALTYPOT\n-file.\nThe values of all collective variables for each MD step are listed in the\nREPORT\n-file, check the lines after the string\nMetadynamics\n.\nMDALGO\n=3: Langevin thermostat\nFor the description of the Langevin thermostat see:\nLangevin thermostat\n.\nThe Langevin thermostat is available for\nNVT\nand\nNpT\nensembles.\nNVT\n-simulation with Langevin thermostat\nTo run an\nNVT\n-simulation with a Langevin thermostat, one has to:\nSet the standard MD-related tags:\nIBRION\n=0,\nTEBEG\n,\nPOTIM\n, and\nNSW\n.\nSet\nISIF\n=2.\nSet\nMDALGO\n=3 to invoke the Langevin thermostat.\nSpecify friction coefficients for all species in the\nPOSCAR\nfile, by means of the\nLANGEVIN_GAMMA\n-tag.\nNpT\n-simulation with Langevin thermostat\nThe Langevin dynamics in the isobaric-isothermal ensemble is calculated by the method of Parrinello and Rahman\n[1]\n[2]\n(see\nNpT ensemble\nfor more descriptions) combined with a\nLangevin thermostat\n.\nTo run an NpT-simulation (Parinello-Rahman dynamics) with a Langevin thermostat, one has to:\nSet the standard MD-related tags:\nIBRION\n=0,\nTEBEG\n,\nPOTIM\n, and\nNSW\n.\nSet\nISIF\n=3 to allow for relaxation of the cell volume and shape. At the moment, dynamics with\nfixed volume+variable shape\n(\nISIF\n=4) or\nfixed shape+variable volume\n(\nISIF\n=7) are not available.\nSet\nMDALGO\n=3 to invoke the Langevin thermostat.\nSpecify friction coefficients for all species in the\nPOSCAR\nfile, by means of the\nLANGEVIN_GAMMA\n-tag.\nSpecify a separate set of friction coefficient for the lattice degrees-of-freedom, using the\nLANGEVIN_GAMMA_L\n-tag.\nSet a mass for the lattice degrees-of-freedom, using the\nPMASS\n-tag.\nOptionally, one may define an external pressure (in kB), by means of the\nPSTRESS\n-tag.\nNote that the advanced simulation protocols, such metadynamics, or geometric constraints and restraints are available within the\nMDALGO\n=3 setting.\nStochastic boundary conditions\nIn some cases it is desirable to study approach of initially non-equilibrium system to equilibrium. Examples of such simulations include the impact problems when a particle with large kinetic energy hits a surface or calculation of friction force between two surfaces sliding with respect to each other. As shown by Toton\net al.\n[3]\n, this type of problems can be studied using the stochastic boundary conditions (SBC) derived from the generalized Langevin equation by Kantorovich and Rompotis.\n[4]\nIn this approach, the system of interest is divided into three regions: (a) fixed atoms, (b) the internal (Newtonian) atoms moving according to Newtonian dynamics, and (c) a buffer region of Langevin atoms (\ni.e.\n, atoms governed by\nLangevin equations of motion\n) located between (a) and (b).\nThe role of the Langevin atoms is to dissipate heat, while the fixed atoms are needed solely to create the correct potential well for the Langevin atoms to move in. The Newtonian region should include all atoms relevant to the process under study: in the case of the impact problem, for instance, the Newtonian region should contain atoms of the molecule hitting the surface and several uppermost layers of the material forming the surface. Performing molecular dynamics with such a setup guarantees that the system (possibly out of equilibrium initially) arrives at the appropriate canonical distribution.\nTo run a simulation with stochastic boundary conditions, one has to:\nSet the standard MD-related tags:\nIBRION\n=0,\nTEBEG\n,\nPOTIM\n, and\nNSW\nSet\nISIF\n=2\nSet\nMDALGO\n=3 to invoke the Langevin thermostat\nPrepare the\nPOSCAR\nfile in such a way that the Newtonian and Langevin atoms are treated as different species (even if they are chemically identical). In your\nPOSCAR\n, use \"selective dynamics\" and the corresponding logical flags to define the frozen and moveable atoms.\nSpecify friction coefficients γ, for all species in the\nPOSCAR\nfile, by means of the\nLANGEVIN_GAMMA\n-tag: set the friction coefficients to 0 for all fixed and Newtonian atoms, and choose a proper γ for the Langevin atoms.\nPractical example\nConsider a system consisting of 16 hydrogen and 48 silicon atoms. Suppose that eight silicon atoms are considered to be Langevin atoms and the remaining 32 Si atoms are either fixed or Newtonian atoms. The Langevin and Newtonian (or fixed) atoms should be considered as different species,\ni.e.\n, the\nPOSCAR\n-file should contain the line like this:\nSi H Si\n40 16 8\nAs only the final eight Si atoms are considered to be Langevin atoms, the\nINCAR\n-file should contain the following line defining the friction coefficients:\nLANGEVIN_GAMMA = 0.0   0.0   10.0\ni.e.\n, for all non-Langevin atoms, γ should be set to zero.\nMDALGO\n=4: Nose Hoover chains thermostat\nFor a description of Nose Hoover chains theromastat, see\nNHC thermostat\n.\nTo run an\nNVT\n-simulation with a Nose Hoover chains thermostat, one has to:\nSet the standard MD-related tags:\nIBRION\n=0,\nTEBEG\n,\nPOTIM\n, and\nNSW\nSet\nISIF\n=2\nSet\nMDALGO\n=4 to invoke the thermostat, select the number of thermostats in chain via\nNHC_NCHAINS\nand choose an appropriate setting for the thermostat parameter\nNHC_PERIOD\n.\nNote that the advanced simulation protocols, such metadynamics, or geometric constraints and restraints are available within the\nMDALGO\n=4 setting.\nMDALGO\n=5: Canonical sampling through velocity-rescaling (CSVR thermostat)\nMind:\nThis option is available as of VASP 6.4.3.\nFor a description of CSVR theromastat, see\nCSVR thermostat\n.\nTo run an\nNVT\n-simulation with a CSVR thermostat, one has to:\nSet the standard MD-related tags:\nIBRION\n=0,\nTEBEG\n,\nPOTIM\n, and\nNSW\nSet\nISIF\n=2\nSet\nMDALGO\n=5 to invoke the thermostat and choose an appropriate setting for the thermostat parameter\nCSVR_PERIOD\n.\nNote that the advanced simulation protocols, such metadynamics, or geometric constraints and restraints are available within the\nMDALGO\n=5 setting.\nMDALGO\n=13: Multiple Andersen thermostats\nUp to three user-defined atomic subsystems may be coupled with independent Andersen thermostats\n[5]\n(see remarks under\nMDALGO\n=1 as well).\nThe\nPOSCAR\nfile must be organized such that the positions of atoms of subsystem\ni+1\nare defined after those for the subsystem\ni\n, and the following flags must be set by the user:\nNSUBSYS\n=[int array]\nDefine the last atom for each subsystem (two or three values must be supplied). For instance, if total of 20 atoms is defined in the\nPOSCAR\nfile, and the initial 10 atoms belong to the subsystem 1, the next 7 atoms to the subsystem 2, and the last 3 atoms to the subsystem 3,\nNSUBSYS\nshould be defined as follows:\nNSUBSYS\n= 10 17 20\nNote that the last number in the previous example is actually redundant (clearly the last three atoms belong to the last subsystem) and does not have to be user-supplied.\nTSUBSYS\n=[real array]\nSimulation temperature for each subsystem\nPSUBSYS\n=[real array]\nCollision probability for atoms in each subsystem. Only the values 0≤\nPSUBSYS\n≤1 are allowed.\nRelated Tags and Sections\nIBRION\n,\nISIF\n,\nSMASS\n,\nANDERSEN_PROB\n,\nRANDOM_SEED\n,\nLBLUEOUT\n,\nSHAKETOL\n,\nSHAKEMAXITER\n,\nHILLS_H\n,\nHILLS_W\n,\nHILLS_BIN\n,\nINCREM\n,\nVALUE_MIN\n,\nVALUE_MAX\n,\nLANGEVIN_GAMMA\n,\nLANGEVIN_GAMMA_L\n,\nPMASS\n,\nNSUBSYS\n,\nTSUBSYS\n,\nPSUBSYS\n,\nICONST\n,\nPENALTYPOT\n,\nHILLSPOT\n,\nREPORT\nExamples that use this tag\nReferences\n↑\nM. Parrinello and A. Rahman, Phys. Rev. Lett.\n45\n, 1196 (1980).\n↑\nM. Parrinello and A. Rahman, J. Appl. Phys.\n52\n, 7182 (1981).\n↑\nD. Toton, C. D. Lorenz, N. Rompotis, N. Martsinovich, and L. Kantorovich, J. Phys.: Condens. Matter 22, 074205 (2010).\n↑\nL. Kantorovich and N. Rompotis, Phys. Rev. B 78, 094305 (2008).\n↑\nH. C. Andersen, J. Chem. Phys. 72, 2384 (1980)."
  }, 
  "MP2 calculations": {
    "description": "This web page explains how to perform MP2 correlation energy calculations in VASP by setting specific INCAR tags in three distinct steps: first determining the Hartree-Fock groundstate, then calculating virtual orbitals, and finally computing the MP2 correlation energy with appropriate parameters.", 
    "detailed_description": "By specifying\nALGO\n=\nMP2\nin the\nINCAR\nfile VASP calculates MP2 correlation energies. It is strongly recommended to calculate all virtual states spanned by the basis set before calling the MP2 routines.\nThus any MP2 calculation should proceed in three steps:\nThe first step is the determination of the occupied orbitals of the Hartree-Fock Hamiltonian. Note that MP2 requires to calculate the Hartree-Fock groundstate, and any LDA or GGA correlation should be switched off. Following specific\nINCAR\ntags have to be set:\nLHFCALC\n= .TRUE.\nAEXX\n= 1.0 ;\nALDAC\n= 0.0 ;\nAGGAC\n= 0.0\nALGO\n= D ;\nEDIFF\n= 1E-7\nNext search for maximum number of plane-waves in the\nOUTCAR\nfile and execute VASP again using the following\nINCAR\ntags:\nNBANDS\n=   maximum number of plane-waves\nLHFCALC\n= .TRUE.\nAEXX\n= 1.0 ;\nALDAC\n= 0.0 ;\nAGGAC\n= 0.0\nALGO\n= Exact ;\nNELM\n= 1 ;\nLOPTICS\n= .TRUE.\nFinally calculate the MP2 correlation energy:\nNBANDS\n=   maximum number of plane-waves\nLHFCALC\n= .TRUE. ;\nAEXX\n= 1.0 ;\nALDAC\n= 0.0\nLMAXMP2\n= 2\nThe flag LMAXMP2 specifies the maximum\nl\n{\\displaystyle l}\nquantum number for the treatment of the one-center terms. This should be set to twice the maximum of the non local component in the pseudopotential. Alternatively\nLMAXFOCKAE\ncan be set in the INCAR file. This is expected to be more efficient, but slightly less accurate. Combining\nLMAXFOCKAE\nand\nLMAXFOCKMP2\nis in principle also allowed but hardly offers any advantage over using only\nLMAXFOCKAE\nor\nLMAXFOCKMP2\n."
  }, 
  "Many-body dispersion energy": {
    "description": "The web page describes the MBD@rsSCS method for calculating many-body dispersion energy in VASP, which accounts for long-range interactions using a frequency-dependent polarizability matrix and requires specific input parameters and settings for accurate implementation.", 
    "detailed_description": "The many-body dispersion energy method (MBD@rsSCS) of Tkatchenko et al.,\n[1]\n[2]\ninvoked by setting\nIVDW\n=202, is based on the random-phase expression for the correlation energy\nE\nc\n=\n∫\n0\n∞\nd\nω\n2\nπ\nT\nr\n{\nl\nn\n(\n1\n−\nv\nχ\n0\n(\ni\nω\n)\n)\n+\nv\nχ\n0\n(\ni\nω\n)\n}\n{\\displaystyle  E_c = \\int_{0}^{\\infty} \\frac{d\\omega}{2\\pi} \\mathrm{Tr}\\left\\{\\mathrm{ln} (1-v\\chi_0(i\\omega))+v\\chi_0(i\\omega) \\right\\} }\nwhereby the response function\nχ\n0\n{\\displaystyle \\chi_0}\nis approximated by a sum of atomic contributions represented by quantum harmonic oscillators. The expression for the dispersion energy used in the VASP k-space implementation of the MBD@rsSCS method (see reference\n[3]\nfor details) is as follows:\nE\nd\ni\ns\np\n=\n−\n∫\nF\nB\nZ\nd\nk\nv\nF\nB\nZ\n∫\n0\n∞\nd\nω\n2\nπ\nT\nr\n{\nl\nn\n(\n1\n−\nA\nL\nR\n(\n0\n)\n(\nω\n)\nT\nL\nR\n(\nk\n)\n)\n}\n{\\displaystyle E_{\\mathrm{disp}} = -\\int_{\\mathrm{FBZ}}\\frac{d{\\mathbf{k}}}{v_{\\mathrm{FBZ}}} \\int_0^{\\infty} {\\frac{d\\omega}{2\\pi}} \\, {\\mathrm{Tr}}\\left \\{ \\mathrm{ln} \\left ({\\mathbf{1}}-{\\mathbf{A}}^{(0)}_{LR}(\\omega) {\\mathbf{T}}_{LR}({\\mathbf{k}}) \\right ) \\right \\} }\nwhere\nA\nL\nR\n{\\displaystyle {\\mathbf{A}}_{LR}}\nis the frequency-dependent polarizability matrix and\nT\nL\nR\n{\\displaystyle \\mathbf{T}_{LR}}\nis the long-range interaction tensor, which describes the interaction of the screened polarizabilities\nembedded in the system in a given geometrical arrangement. The components of\nA\nL\nR\n{\\displaystyle \\mathbf{A}_{LR}}\nare obtained using an atoms-in-molecule approach as employed in the pairwise\nTkatchenko-Scheffler method\n(see\nreferences\n[2]\n[3]\nfor details).\nDetails of the implementation of the MBD@rsSCS method in VASP are presented in reference\n[3]\n.\nUsage\nThe input reference data for non-interacting atoms can be optionally defined via the parameters\nVDW_ALPHA\n,\nVDW_C6\n, and\nVDW_R0\n(described by the\nTkatchenko-Scheffler method\n). This method has one free parameter (\nβ\n{\\displaystyle \\beta}\n) that must be adjusted for each exchange-correlation functional. The default value of\nβ\n{\\displaystyle \\beta}\n=0.83 corresponds to the PBE functional (\nGGA\n=PE). If another functional is used, the value of\nβ\n{\\displaystyle \\beta}\nmust be specified via\nVDW_SR\nin the\nINCAR\nfile.\nThe following optional parameters can be user-defined (the given values are the default ones):\nVDW_SR\n=0.83 : scaling parameter\nβ\n{\\displaystyle \\beta}\nLVDWEXPANSION\n=.FALSE. : writes the two- to six-body contributions to the  MBD dispersion energy in the\nOUTCAR\n(\nLVDWEXPANSION\n=\n.TRUE.\n)\nLSCSGRAD\n=.TRUE. : compute gradients (or not)\nVDW_ALPHA\n,\nVDW_C6\n,\nVDW_R0\n: atomic reference (see also\nTkatchenko-Scheffler method\n)\nITIM\n=-1: if set to +1, apply eigenvalue remapping to avoid unphysical cases where the eigenvalues of the matrix\n(\n1\n−\nA\nL\nR\n(\n0\n)\n(\nω\n)\nT\nL\nR\n(\nk\n)\n)\n{\\displaystyle \\left(1-\\mathbf{A}^{(0)}_{LR}(\\omega) {\\mathbf{T}}_{LR}({\\mathbf{k}})\\right) }\nare non-positive, see reference\n[4]\nfor details\nMind:\nThis method requires the use of\nPOTCAR\nfiles from the PAW dataset version 52 or later.\nThe input reference data for non-interacting atoms are available only for elements of the first six rows of the periodic table except of the lanthanides. If the system contains other elements, the user has to provide the free-atomic parameters for all atoms in the system via\nVDW_ALPHA\n,\nVDW_C6\nand\nVDW_R0\n(described by the\nTkatchenko-Scheffler method\n) defined in the\nINCAR\nfile.\nThe charge-density dependence of gradients is neglected.\nThis method is incompatible with the setting\nADDGRID\n=\n.TRUE.\n.\nIt is essential that a sufficiently dense FFT grid (controlled via\nNGXF\n,\nNGYF\nand\nNGZF\n) is used in the\nTkatchenko-Scheffler method\ncalculation. We strongly recommend to use\nPREC\n=\nAccurate\nfor this type of calculations (in any case, avoid using\nPREC\n=\nLow\n).\nThe method sometimes has numerical problems if highly polarizable atoms are located at short distances. In such a case the calculation terminates with an error message\nError(vdw\\_tsscs\\_range\\_separated\\_k): d\\_lr(pp)<=0\n. Note that this problem is not caused by a bug, but rather it is due to a limitation of the underlying physical model.\nAnalytical gradients of the energy are implemented (fore details see reference\n[3]\n) and hence the atomic and lattice relaxations can be performed.\nDue to the long-range nature of dispersion interactions, the convergence of energy with respect to the number of k-points should be carefully examined.\nA default value for the free-parameter of this method is available only for the PBE (\nVDW_SR\n=0.83), PBE0 (\nVDW_SR\n=0.85), HSE06 (\nVDW_SR\n=0.85), B3LYP (\nVDW_SR\n=0.64), and SCAN (\nVDW_SR\n=1.12) functionals. If any other functional is used, the value of\nVDW_SR\nmust be specified in the\nINCAR\nfile.\nRelated tags and articles\nVDW_ALPHA\n,\nVDW_C6\n,\nVDW_R0\n,\nVDW_SR\n,\nLVDWEXPANSION\n,\nLSCSGRAD\n,\nIVDW\n,\nTkatchenko-Scheffler method\n,\nSelf-consistent screening in Tkatchenko-Scheffler method\n,\nTkatchenko-Scheffler method with iterative Hirshfeld partitioning\n,\nMany-body dispersion energy with fractionally ionic model for polarizability\nReferences\n↑\nA. Tkatchenko, R. A. DiStasio, Jr., R. Car, and M. Scheffler, Phys. Rev. Lett.\n108\n, 236402 (2012).\n↑\na\nb\nA. Ambrosetti, A. M. Reilly, and R. A. DiStasio Jr., J. Chem. Phys.\n140\n, 018A508 (2014).\n↑\na\nb\nc\nd\nT. Bučko, S. Lebègue, T. Gould, and J. G. Ángyán, J. Phys.: Condens. Matter\n28\n, 045201 (2016).\n↑\nT. Gould, S. Lebègue, J. G. Ángyán, and T. Bučko, J. Chem. Theory Comput. 12, 5920 (2016)."
  }, 
  "Many-body dispersion energy with fractionally ionic model for polarizability": {
    "description": "The web page introduces the MBD@rsSCS/FI method, a variant of the many-body dispersion energy approach that uses Gould's model for frequency-dependent polarizabilities and iterative Hirshfeld partitioning to improve the accuracy of dispersion energy calculations in polar and ionic materials.", 
    "detailed_description": "A variant of\nMany-body dispersion energy\nmethod based on fractionally ionic model for polarizability of Gould\n[1]\n, hereafter dubbed MBD@rsSCS/FI, has been introduced in Ref.\n[2]\nJust like in the original MBD@rsSCS, dispersion energy in MBD@rsSCS/FI is computed using\nE\nd\ni\ns\np\n=\n−\n∫\nF\nB\nZ\nd\nk\nv\nF\nB\nZ\n∫\n0\n∞\nd\nω\n2\nπ\nT\nr\n{\nl\nn\n(\n1\n−\nA\nL\nR\n(\n0\n)\n(\nω\n)\nT\nL\nR\n(\nk\n)\n)\n}\n{\\displaystyle E_{\\mathrm{disp}} = -\\int_{\\mathrm{FBZ}}\\frac{d{\\mathbf{k}}}{v_{\\mathrm{FBZ}}} \\int_0^{\\infty} {\\frac{d\\omega}{2\\pi}} \\, {\\mathrm{Tr}}\\left \\{ \\mathrm{ln} \\left ({\\mathbf{1}}-{\\mathbf{A}}^{(0)}_{LR}(\\omega) {\\mathbf{T}}_{LR}({\\mathbf{k}}) \\right ) \\right \\} }\n.\nHowever, the two methods differ in the model used to approximate the atomic polarizabilities (\nα\np\nAIM\n{\\displaystyle \\alpha_p^{\\text{AIM}} }\n) needed to define tensor\nA\n(\n0\n)\n(\nω\n)\n(\nk\n)\n{\\displaystyle \\mathbf{A}^{(0)}(\\omega)({\\mathbf{k}}) }\n. The MBD@rsSCS makes use of the pre-computed static polarizabilities of neutral atoms (\nα\np\natom\n{\\displaystyle  \\alpha_p^{\\text{atom}} }\n)\nα\np\nAIM\n=\nα\np\natom\nV\np\neff\nV\np\natom\n{\\displaystyle \\alpha_p^{\\text{AIM}} = \\alpha_p^{\\text{atom}}\n\\frac{V^{\\text{eff}}_p}{V^{\\text{atom}}_p}}\n,\nwhereby the volume ratios between interacting and non-interacting atoms (\nV\np\neff\nV\np\natom\n{\\displaystyle  \\frac{V^{\\text{eff}}_p}{V^{\\text{atom}}_p} }\n) is obtained using conventional Hirshfeld partitioning\n[3]\n. Although the MBD@rsSCS/FI employs a similar scaling relation:\nα\np\nAIM\n(\nω\n)\n=\nα\np\nFI\n(\nω\n)\nV\np\neff\nV\np\nFI\n{\\displaystyle \\alpha_p^{\\text{AIM}}(\\omega) = \\alpha_p^{\\text{FI}}(\\omega)\n\\frac{V^{\\text{eff}}_p}{V^{\\text{FI}}_p} }\n,\nit relies on Gould's model\n[1]\nof frequency-dependent polarizabilities (\nα\np\nFI\n(\nω\n)\n{\\displaystyle  \\alpha_p^{\\text{FI}}(\\omega) }\n) and charge densities of non-interacting fractional ions combined with iterative Hirshfeld partitioning\n[4]\n. Obviously, the MBD@rsSCS and the MBD@rsSCS/FI are equivalent for non-polar systems, such as graphite, but typically yield distinctly different results for polar and ionic materials\n[2]\n.\nUsage\nThe MBD@rsSCS/FI method is invoked by setting\nIVDW\n=263. Optionally, the following parameters can be user-defined (the given values are the default ones):\nVDW_SR\n=0.83 : scaling parameter\nβ\n{\\displaystyle \\beta}\nLVDWEXPANSION\n=.FALSE. : writes the two- to six- body contributions to the  MBD dispersion energy in the\nOUTCAR\n(\nLVDWEXPANSION\n=\n.TRUE.\n)\nLSCSGRAD\n=.TRUE. : compute gradients (or not)\nVDW_R0\n: radii for atomic reference (see also\nTkatchenko-Scheffler method\n)\nITIM\n=1: if set to +1, apply eigenvalue remapping to avoid unphysical cases where the eigenvalues of the matrix\n(\n1\n−\nA\nL\nR\n(\n0\n)\n(\nω\n)\nT\nL\nR\n(\nk\n)\n)\n{\\displaystyle \\left(1-\\mathbf{A}^{(0)}_{LR}(\\omega) {\\mathbf{T}}_{LR}({\\mathbf{k}})\\right) }\nare non-positive, see reference\n[2]\nfor details\nMind:\nThis method requires the use of\nPOTCAR\nfiles from the PAW dataset version 52 or later.\nThe parametrization of reference data is available only for elements of the first six rows of the periodic table except of the lanthanides.\nThe charge-density dependence of gradients is neglected.\nThis method is incompatible with the setting\nADDGRID\n=\n.TRUE.\n.\nIt is essential that a sufficiently dense FFT grid (controlled via\nNGXF\n,\nNGYF\nand\nNGZF\n) is used. We strongly recommend to use\nPREC\n=\nAccurate\nfor this type of calculations (in any case, avoid using\nPREC\n=\nLow\n}).\nThe method has sometimes numerical problems if highly polarizable atoms are located at short distances. In such a case the calculation terminates with an error message\nError(vdw\\_tsscs\\_range\\_separated\\_k): d\\_lr(pp)<=0\n. Note that this problem is not caused by a bug, but rather it is due to a limitation of the underlying physical model.\nAnalytical gradients of the energy are implemented (fore details see reference\n[5]\n) and hence the atomic and lattice relaxations can be performed.\nDue to the long-range nature of dispersion interactions, the convergence of energy with respect to the number of k-points should be carefully examined.\nA default value for the free-parameter of this method is available only for the PBE (\nVDW_SR\n=0.83) and SCAN (\nVDW_SR\n=1.12) functionals. If any other functional is used, the value of\nVDW_SR\nmust be specified in the\nINCAR\nfile.\nRelated tags and articles\nVDW_ALPHA\n,\nVDW_C6\n,\nVDW_R0\n,\nVDW_SR\n,\nLVDWEXPANSION\n,\nLSCSGRAD\n,\nIVDW\n,\nTkatchenko-Scheffler method\n,\nSelf-consistent screening in Tkatchenko-Scheffler method\n,\nTkatchenko-Scheffler method with iterative Hirshfeld partitioning\n,\nMany-body dispersion energy\nReferences\n↑\na\nb\nT. Gould and T. Bučko,\nC6 Coefficients and Dipole Polarizabilities for All Atoms and Many Ions in Rows 1–6 of the Periodic Table\n, J. Chem. Theory Comput.\n12\n, 3603 (2016).\n↑\na\nb\nc\nT. Gould, S. Lebègue, J. G. Ángyán, and T. Bučko,\nA Fractionally Ionic Approach to Polarizability and van der Waals Many-Body Dispersion Calculations\n, J. Chem. Theory Comput.\n12\n, 5920 (2016).\n↑\nF. Hirshfeld,\nBonded-atom fragments for describing molecular charge densities\n, Theor. Chim. Acta\n44\n, 129 (1977).\n↑\nP. Bultinck, C. Van Alsenoy, P. W. Ayers, and R. Carbó Dorca, J. Chem. Phys.\n126\n, 144111 (2007).\n↑\nT. Bučko, S. Lebègue, T. Gould, and J. G. Ángyán, J. Phys.: Condens. Matter\n28\n, 045201 (2016)."
  }, 
  "Memory requirements": {
    "description": "The web page explains that VASP's high memory usage primarily comes from storing wave functions and work arrays, and suggests reducing memory requirements by adjusting parameters like NKDIM, NBANDS, NRPLWV, and the grid sizes NGXF, NGYF, NGZF.", 
    "detailed_description": "The memory requirements of VASP can easily exceed your computer facilities.\nIn this case the first step is to estimate where the excessive memory requirements\nderive from. There are two possibilities:\nStorage of wave functions: All bands for all k-points must be kept in memory at the same time. The memory requirements for the wave functions are:\nNKDIM*NBANDS*NRPLWV*16\nThe factor 16 arises from the fact that all quantities are COMPLEX*16.\nWork arrays for the representation of the charge density, local potentials, structure factor and large work arrays: A total of approximately 10 arrays is allocated on the second finer grid:\n4*(NGXF/2+1)*NGYF*NGZF*16\nOnce again all quantities are COMPLEX*16.\nTry to reduce the memory requirements by reducing the corresponding parameters.\nSee section \\ref{imp} for a discussion of the minimal requirements for\nthese parameters."
  }, 
  "Metadynamics calculations": {
    "description": "This web page explains how to set up and run metadynamics simulations in VASP using either the Andersen or Nose-Hoover thermostat, including the required input parameters, file configurations, and procedures for continuing simulations.", 
    "detailed_description": "Anderson thermostat\nFor a metadynamics run with Andersen thermostat, one has to:\nSet the standard MD-related tags:\nIBRION\n=0,\nTEBEG\n,\nPOTIM\n, and\nNSW\nSet\nMDALGO\n=1 (\nMDALGO\n=11 in VASP 5.x), and choose an appropriate setting for\nANDERSEN_PROB\nSet the parameters\nHILLS_H\n,\nHILLS_W\n, and\nHILLS_BIN\nDefine collective variables in the\nICONST\n-file, and set the\nSTATUS\nparameter for the collective variables to 5\nIf needed, define the bias potential in the\nPENALTYPOT\n-file\nThe actual time-dependent bias potential is written to the\nHILLSPOT\n-file, which is updated after adding a new Gaussian. At the beginning of the simulation, VASP attempts to read the initial bias potential from the\nPENALTYPOT\n-file. For the continuation of a metadynamics run, copy\nHILLSPOT\nto\nPENALTYPOT\n. The values of all collective variables for each MD step are listed in\nREPORT\n-file, check the lines after the string\nMetadynamics\n.\nNose-Hoover thermostat\nFor a metadynamics run with Nose-Hoover thermostat, one has to:\nSet the standard MD-related tags:\nIBRION\n=0,\nTEBEG\n,\nPOTIM\n, and\nNSW\nSet\nMDALGO\n=2 (\nMDALGO\n=21 in VASP 5.x), and choose an appropriate setting for\nSMASS\nSet the parameters\nHILLS_H\n,\nHILLS_W\n, and\nHILLS_BIN\nDefine collective variables in the\nICONST\n-file, and set the\nSTATUS\nparameter for the collective variables to 5\nIf needed, define the bias potential in the\nPENALTYPOT\n-file\nThe actual time-dependent bias potential is written to the\nHILLSPOT\n-file, which is updated after adding a new Gaussian. At the beginning of the simulation, VASP attempts to read the initial bias potential from the\nPENALTYPOT\n-file. For the continuation of a metadynamics run, copy\nHILLSPOT\nto\nPENALTYPOT\n. The values of all collective variables for each MD step are listed in\nREPORT\n-file, check the lines after the string\nMetadynamics\n.\nRelated tags and sections\nMetadynamics"
  }, 
  "Minimal reproducible example": {
    "description": "A minimal reproducible example is a simplified and complete set of input and output files used to efficiently demonstrate, reproduce, and troubleshoot issues or results in computational workflows, particularly in VASP calculations, by reducing complexity and including all necessary files and parameters.", 
    "detailed_description": "A\nminimal reproducible example\nis a set of input and output files that allow a bug, problem, or result to be demonstrated and reproduced. A crucial point is that the\nminimal reproducible example\nshould be as small and simple as possible.\nIt is helpful to create a\nminimal reproducible example\nwhen reporting an issue to a colleague, supervisor, or on the\nVASP forum\n, but also as a starting point to explore more options and features based on a known system.\nHow to create a minimal reproducible example\nStep 1\nTo reduce the complexity of a calculation, remove all preparatory and unnecessary post-processing steps from the workflow and any\nINCAR tags\nthat are unnecessary to reproduce the issue. This may mean using a different structure (\nPOSCAR\n) with fewer atoms. Or, for a magnetic calculation that may imply switching off projections (\nLORBIT\n), the use of spin-orbit coupling (\nLSORBIT\n) or perhaps an on-site Coulomb interaction (\nLDAU\n) if this is not essential to what is demonstrated. For a molecular-dynamics run, reducing the complexity may imply starting from an intermediate time step with a random seed (\nRANDOM_SEED\n) and choosing a smaller supercell.\nStep 2\nSelect parameters that reproduce the result with minimal computational effort, even though it may reduce the accuracy of the calculation. For instance, this often implies reducing (\nENCUT\n), choosing a coarser k mesh (\nKPOINTS\n), lowering\nPREC\n, etc.\nStep 3\nFinally, ensure to include\nall files to run the calculation (execution commands/submission script and input files that may include\nINCAR\n,\nPOSCAR\n,\nPOTCAR\n,\nKPOINTS\n,\nICONST\n, etc.),\nthe main output files (stdout,\nOUTCAR\n,\nREPORT\nfor molecular-dynamics runs,\nML_LOGFILE\nfor machine-learning force fields, etc.)\nand any problem-specific files that, e.g., include the specific data in focus or that extract and plot the data from the output files.\nIf the problem only occurs for specific hardware, versions of VASP, or toolchains, it is also essential to include that information.\nRelated tags and articles\nInput files\n,\nOutput files\n,\nTroubleshooting electronic convergence"
  }, 
  "Molecular dynamics calculations": {
    "description": "This web page provides a comprehensive guide to setting up and running molecular dynamics simulations in VASP, including instructions on preparing input files (POSCAR, CONTCAR, INCAR), selecting appropriate tags (IBRION, POTIM, NSW, TEBEG, ISIF, MDALGO), choosing thermostats and ensembles (NVT, NpT,", 
    "detailed_description": "To run a basic molecular dynamics calculation perform the following steps:\nChoose a\nPOSCAR\ncontaining a large enough super cell.\nIf a continuation run is performed copy\nCONTCAR\nto\nPOSCAR\nor possibly deliver initial velocities in the\nPOSCAR\nfile. They are written after the Wycoff positions in an own paragraph. If no initial velocities are provided random velocities are assumed at the beginning of the calculation. This is fully ok but the user should be aware that due to the initial random velocities the trajectories obtained from different calculations are difficult to compare.\nSet main\nINCAR\ntags:\nIBRION\n=0: Molecular dynamics calculations are enabled by setting the\nIBRION\ntag to 0.\nPOTIM\n: This tag sets the time step in fs for the molecular dynamics run.\nNSW\n: This tag sets the number of steps performed in the molecular dynamics run.\nTEBEG\n: If a thermostat is used define the desired temperature at which the molecular dynamics calculations should run.\nISIF\n(optional).\nMDALGO\n: This tag decides with which thermostat the molecular dynamics calculation is executed.  For regular molecular dynamics calculations the thermostat is selected by a one digit number (e.g. 1 for Andersen, 2 for Nose-Hoover etc.). For biased molecular dynamics, metadynamics etc. the thermostat is selected the same way from VASP 6 or higher. In VASP 5.x it is selected by a two digit number where the first digit corresponds to the thermostat analogously to regular molecular dynamics and the second digit corresponds to the molecular dynamics type (e.g. 11 metadynamics with Andersen thermostat, 21 metadynamics with Nose-Hoover thermostat etc.). The\nNVE ensemble\nis a special case. It is available by selecting the Andersen thermostat and setting no collisions with the heat bath (\nANDERSEN_PROB\n=0).\nISIF\n: In molecular dynamics calculations this tag is used to choose the\nNVT ensemble\nor\nNpT ensemble\n(the\nNVE ensemble\nis a special case!). For\nISIF\n=2 the volume is kept constant and the\nNVT ensemble\nis used. Using this tag the stress tensor is calculated and hence the pressure can be monitored. For\nISIF\n=3 the stress tensor (pressure) is kept constant and the\nNpT ensemble\nis used. Using this tag the volume is calculated and can be monitored.\nDecide which\nensemble\nto use:\nNVT ensemble\n: Set\nISIF\n=2.\nNpT ensemble\n: Set\nISIF\n=3.\nNVE ensemble\n: Set\nMDALGO\n=1 and\nANDERSEN_PROB\n=0.0.\nDecide which thermostat to use (the combination of thermostats and ensembles is given in table):\nAndersen thermostat\n: Set\nMDALGO\n=1. Also set\nANDERSEN_PROB\n>0.0 to control the stochastic update frequency of the thermostat.\nNose-Hoover thermostat\n: Set\nMDALGO\n=2. Also set\nSMASS\n>0.0 to control the coupling to the heat bath.\nLangevin thermostat\n: Set\nMDALGO\n=3. Also set\nLANGEVIN_GAMMA\n>0.0 to control the friction parameter. If the\nNpT ensemble\nis used (by setting\nISIF\n=3) additionally the friction coefficient of the lattice\nLANGEVIN_GAMMA_L\nhas to be provided too.\nNose-Hoover-chain thermostat\n: Set\nMDALGO\n=4. Also set the\nNHC_NCHAINS\n>0 to adjust the length of the Nose-Hoover chain.  With\nNHC_PERIOD\nthe period (coupling strength to the heat bath) of the Nose-Hoover chains thermostat is set.\nCSVR thermostat\n: Set\nMDALGO\n=5 and additionally adjust\nCSVR_PERIOD\n>0.\nThe following combinations of thermostats and barostats is possible:\nThermostat\nEnsemble\nAndersen\nNose-Hoover\nLangevin\nNHC\nCSVR\nMultiple Andersen\nMicrocanonical (NVE)\nMDALGO\n=1,\nANDERSEN_PROB\n=0.0\nCanonical (NVT)\nMDALGO\n=1\nMDALGO\n=2\nMDALGO\n=3\nMDALGO\n=4\nMDALGO\n=5\nMDALGO\n=13\nISIF\n=2\nISIF\n=2\nISIF\n=2\nISIF\n=2\nISIF\n=2\nISIF\n=2\nIsobaric-isothermal (NpT)\nnot available\nnot available\nMDALGO\n=3\nnot available\nnot available\nnot available\nISIF\n=3\nIsoenthalpic-isobaric (NpH)\nMDALGO\n=3,\nISIF\n=3,\nLANGEVIN_GAMMA\n=\nLANGEVIN_GAMMA_L\n=0.0\nCompilation\nTo run molecular dynamics calculation VASP has to be compiled using the\n-Dtbdyn\nprecompiler flag in the makefile.include file. A sample input using this tag would look like this:\nCPP     = $(CPP_) -DHOST=\\\"IFC9_fftw\\\" \\\n-Dkind8 -DNGXhalf  -DCACHE_SIZE=12000 -DPGF90 -Davoidalloc  \\\n-Dtbdyn"
  }, 
  "Nonlocal vdW-DF functionals": {
    "description": "The web page describes the implementation and usage of various van der Waals Density Functional (vdW-DF) methods in the VASP software package, including their formulation, available functionals, input parameters, version history, and technical considerations for accurate calculations.", 
    "detailed_description": "The vdW-DF method originally proposed by Dion\net al.\n[1]\nconsists of a semilocal or hybrid exchange-correlation functional\nE\nxc\nSL/hybrid\n{\\displaystyle E_{\\text{xc}}^{\\text{SL/hybrid}}}\nthat is augmented with a nonlocal correlation functional\nE\nc,disp\n{\\displaystyle E_{\\text{c,disp}}}\nthat approximately accounts for dispersion interactions:\nE\nxc\nvdW\n=\nE\nxc\nSL/hybrid\n+\nE\nc,disp\n,\n{\\displaystyle\nE_{\\text{xc}}^{\\text{vdW}} = E_{\\text{xc}}^{\\text{SL/hybrid}} + E_{\\text{c,disp}},\n}\nwhere\nE\nc,disp\n=\n1\n2\n∫\n∫\nn\n(\nr\n)\nΦ\n(\nr\n,\nr\n′\n)\nn\n(\nr\n′\n)\nd\n3\nr\nd\n3\nr\n′\n,\n{\\displaystyle\nE_{\\text{c,disp}} = \\frac{1}{2}\\int\\int n(\\textbf{r})\n\\Phi\\left(\\textbf{r},\\textbf{r}'\\right) n(\\textbf{r}')\nd^{3}rd^{3}r',\n}\nwith a kernel\nΦ\n{\\displaystyle \\Phi}\nthat depends on the electronic density\nn\n{\\displaystyle n}\n, its derivative\n∇\nn\n{\\displaystyle \\nabla n}\nas well as on the interelectronic distance\n|\nr\n−\nr\n′\n|\n{\\displaystyle \\left\\vert\\bf{r}-\\bf{r}'\\right\\vert}\n. In VASP, the calculation of\nE\nc,disp\n{\\displaystyle E_{\\text{c,disp}}}\nis done using the algorithm of Román-Pérez and Soler\n[2]\nthat is based on FFTs and the convolution theorem to calculate efficiently the double real-space integral. Several versions of the vdW-DF functionals proposed in the literature can be used (see list below).\nThe vdW-DF functionals are available since the 5.2.12.26May2011 version of VASP for the calculation of total energies and forces. The stress tensor calculation for the cell optimization (\nISIF\n=3) is available since the VASP 5.2.12.11Nov2011 version for spin-unpolarized systems and VASP 5.3.1 for spin-polarized systems. They have been implemented by J. Klimeš. If you make use of the vdW-DF functionals presented in this section, we ask you to cite Ref.\n[3]\n. Please also cite the original vdW-DF paper of Dion\net al.\n[1]\nand the paper of Román-Pérez and Soler\n[2]\n.\nIn versions of VASP prior to 6.4.0, a meta-GGA functional (e.g., SCAN) could be combined only with the rVV10 nonlocal functional. Conversely, a GGA functional could be combined only with the original nonlocal functional of Dion\net al.\n. This restriction is lifted since VASP.6.4.0 thanks to the introduction of the\nIVDW_NL\ntag. Since VASP.6.4.0, the spin-polarized formulation of the nonlocal vdW correlation term\n[4]\nis available. It can be switched on with the logical tag\nLSPIN_VDW\n(.FALSE. by default), however its use is limited to the the functional of Dion\net al.\n(not available for rVV10) and only when the nonlocal term is combined with a\nGGA\nfunctional. In other cases (and in prior versions of VASP), the nonlocal correlation functional is evaluated with the sum of the spin-up and spin-down electron densities.\nAn overview of the performance of the vdW-DF functionals can be found for instance in Ref.\n[3]\n[5]\n[6]\n.\nImportant:\nSome nonlocal vdW-DF result in very noisy energies, which can degrade the convergence to the electronic groundstate. Conjugate-gradient algorithms are particularly prone to show issues, such as a sudden increase in the energy. If\nALGO\n=  all (conjugate gradient algorithm) fails to converge, try to use denser FFT grids, for instance by setting\nPREC\n= Accurate.\nMind:\nFor\nVASP.6.4.2\nand prior versions it was necessary to copy the vdw_kernel.bindat file into the working directory for calculations with the van der Waals kernel corresponding to\nIVDW_NL\n=1. Otherwise, vdw_kernel.bindat was generated at the beginning of the calculation, which took several hours. However, since\nVASP.6.4.3\nit is not really necessary to copy vdw_kernel.bindat into the directory, since its calculation has been considerably accelerated (about 2 minutes with 8 MPI ranks). More details are given\nbelow\n. Note that no vdw_kernel.bindat file is needed for calculations with the rVV10 kernel (\nIVDW_NL\n=2).\nIn VASP.6.2 (and prior versions) the stress tensor is broken for rVV10 (it is correct for other vdW-DF though). From VASP.6.3.0 onwards, the stress tensor for rVV10 is correct.\nList of nonlocal vdW-DF functionals\nTo add a nonlocal correlation energy\nE\nc,disp\n{\\displaystyle E_{\\text{c,disp}}}\nto the semilocal or hybrid exchange-correlation energy (selected with the\nGGA\n,\nMETAGGA\nor\nXC\ntag) one needs to set\nLUSE_VDW\n=.TRUE. (and optionally\nIVDW_NL\n) in the\nINCAR\nfile.\nSince vdW-DF functionals tend to yield less spherical densities than standard GGA functionals, it is recommended to set\nLASPH\n=.TRUE. to get reasonably accurate contributions from the spheres around the atoms.\nExamples of\nINCAR\nfiles are shown below.\nvdW-DF\nof Dion\net al.\n[1]\n:\nGGA\n= RE\nAGGAC\n= 0.0\nLUSE_VDW\n= .TRUE.\nLASPH\n= .TRUE.\nvdW-DF2\nof Lee\net al.\n(2nd version of vdW-DF)\n[7]\n:\nGGA\n= ML\nAGGAC\n= 0.0\nLUSE_VDW\n= .TRUE.\nZAB_VDW\n= -1.8867 # the default is -0.8491\nLASPH\n= .TRUE.\noptPBE-vdW\nof Klimeš\net al.\n[8]\n:\nGGA\n= OR\nAGGAC\n= 0.0\nLUSE_VDW\n= .TRUE.\nLASPH\n= .TRUE.\noptB88-vdW\nof Klimeš\net al.\n[8]\n:\nGGA\n= BO\nPARAM1\n= 0.1833333333\nPARAM2\n= 0.22\nAGGAC\n= 0.0\nLUSE_VDW\n= .TRUE.\nLASPH\n= .TRUE.\noptB86b-vdW\nof Klimeš\net al.\n[3]\n:\nGGA\n= MK\nPARAM1\n= 0.1234\nPARAM2\n= 1.0\nAGGAC\n= 0.0\nLUSE_VDW\n= .TRUE.\nLASPH\n= .TRUE.\nBEEF-vdW\nof Wellendorff\net al.\n[9]\n:\nGGA\n= BF\nLUSE_VDW\n= .TRUE.\nZAB_VDW\n= -1.8867 # the default is -0.8491\nLASPH\n= .TRUE.\nor\nGGA\n= LIBXC\nLIBXC1\n= GGA_XC_BEEFVDW\nLUSE_VDW\n= .TRUE.\nZAB_VDW\n= -1.8867 # the default is -0.8491\nLASPH\n= .TRUE.\nNote that the GGA functional BEEF\n[9]\nis available only via an external library, either libbeef (\n-Dlibbeef\n) or Libxc (\n-DUSELIBXC\n).\nrev-vdW-DF2\n(also known as vdW-DF2-B86R) of Hamada\n[10]\n:\nGGA\n= MK\nPARAM1\n= 0.1234568 # =10/81\nPARAM2\n= 0.7114\nAGGAC\n= 0.0\nLUSE_VDW\n= .TRUE.\nZAB_VDW\n= -1.8867 # the default is -0.8491\nLASPH\n= .TRUE.\nIn the vdW-DF2, BEEF-vdW and rev-vdW-DF2 functionals, the nonlocal correlation consists of the Dion\net al.\nfunctional, but with the parameter\nZ\na\nb\n{\\displaystyle Z_{ab}}\nthat is changed from -0.8491 (the default value in VASP) to -1.8867 by setting\nZAB_VDW\n=-1.8867.\nvdW-DF-cx\nof Berland and Hyldgaard\n[11]\n:\nGGA\n= CX\nAGGAC\n= 0.0\nLUSE_VDW\n= .TRUE.\nLASPH\n= .TRUE.\nvdW-DF3-opt1\nof Chakraborty\net al.\n[12]\n:\nGGA\n= BO\nPARAM1\n= 0.1122334456\nPARAM2\n= 0.1234568 # =10/81\nAGGAC\n= 0.0\nLUSE_VDW\n= .TRUE.\nIVDW_NL\n= 3\nALPHA_VDW\n= 0.94950 # default for IVDW_NL=3 but can be overwritten by this tag\nGAMMA_VDW\n= 1.12    # default for IVDW_NL=3 but can be overwritten by this tag\nLASPH\n= .TRUE.\nvdW-DF3-opt2\nof Chakraborty\net al.\n[12]\n:\nGGA\n= MK\nPARAM1\n= 0.1234568 # =10/81\nPARAM2\n= 0.58\nAGGAC\n= 0.0\nLUSE_VDW\n= .TRUE.\nIVDW_NL\n= 4\nZAB_VDW\n= -1.8867 # the default is -0.8491\nALPHA_VDW\n= 0.28248 # default for IVDW_NL=4 but can be overwritten by this tag\nGAMMA_VDW\n= 1.29    # default for IVDW_NL=4 but can be overwritten by this tag\nLASPH\n= .TRUE.\nrVV10\nof Sabatini\net al.\n[13]\n:\nGGA\n= ML\nLUSE_VDW\n= .TRUE.\nIVDW_NL\n= 2\nBPARAM\n= 6.3     # default but can be overwritten by this tag\nCPARAM\n= 0.0093  # default but can be overwritten by this tag\nLASPH\n= .TRUE.\nSCAN+rVV10\nof Peng\net al.\n[14]\n:\nMETAGGA\n= SCAN\nLUSE_VDW\n= .TRUE.\nBPARAM\n= 15.7    # the default value is 6.3\nCPARAM\n= 0.0093  # default but can be overwritten by this tag\nLASPH\n= .TRUE.\nPBE+rVV10L\nof Peng and Perdew\n[15]\n:\nGGA\n= PE\nLUSE_VDW\n= .TRUE.\nBPARAM\n= 10      # the default value is 6.3\nCPARAM\n= 0.0093  # default but can be overwritten by this tag\nLASPH\n= .TRUE.\nr\n2\n{\\displaystyle ^2}\nSCAN+rVV10\nof Ning\net al.\n[16]\n:\nMETAGGA\n= R2SCAN\nLUSE_VDW\n= .TRUE.\nBPARAM\n= 11.95   # the default value is 6.3\nCPARAM\n= 0.0093  # default but can be overwritten by this tag\nLASPH\n= .TRUE.\nImportant technical remarks\nKernel file vdw_kernel.bindat\nUntil VASP.6.4.2\n: The calculation of the nonlocal correlation functional of Dion\net al.\n(used when\nIVDW_NL\n=1, which means for all functionals listed above except rVV10, SCAN+rVV10 and r\n2\n{\\displaystyle ^2}\nSCAN+rVV10) requires a precalculated kernel which is distributed via the VASP download portal (vdw_kernel.bindat.gz has to be decompressed). If VASP does not find this file, the kernel is calculated, which is however extremely demanding (several hours!). Thus, the kernel needs to be either copied to the VASP run directory for each calculation or can be stored in a central location and read from there. The location needs to be set in routine\nPHI_GENERATE\n. This does not work on some clusters and the kernel needs to be copied into the working directory in such cases. The distributed file uses little endian convention and can not be read on big endian machines. The big endian version of the file is available also from the VASP portal. In the case of the rVV10 nonlocal correlation functional, no precalculated kernel is required and it is calculated on the fly, which is however much less demanding than in the case of the functional of Dion\net al.\n.\nSince VASP.6.4.3\n: The calculation of the kernel for the functional of Dion\net al.\n(\nIVDW_NL\n=1), as well as for\nIVDW_NL\n=3 and 4, is tremendously faster: the default value of a parameter has been reduced (with basically no loss of accuracy) and the calculation has been parallelized (with MPI and OpenACC for GPUs). Therefore, starting a calculation without vdw_kernel.bindat file present in the directory should be no problem for the computational time, and a vdw_kernel.bindat file will be generated rather efficiently during the first iteration. Note that a file vdw_kernel.bindat that was generated for a given kernel (\nIVDW_NL\n=1, 3 or 4) can not be used for a calculation using another kernel, and in such a case the incompatibility of the vdw_kernel.bindat file will be detected and a new vdw_kernel.bindat file automatically generated to replace the incompatible one.\nPOTCAR file\nThere are no special\nPOTCAR\nfiles for the vdW-DF functionals and the PBE or LDA\nPOTCAR\nfiles can be used. Currently the evaluation of the nonlocal correlation functional is not done fully within the PAW method, but the sum of the pseudo-valence density and partial core density is used. This approximation works rather well, as is discussed in\n[3]\n, and the accuracy generally increases when the number of valence electrons is increased or when harder PAW datasets are used. For example, for adsorption it is recommended to compare the adsorption energy obtained with standard PAW datasets and more-electron\nPOTCAR\nfiles for both PBE calculations and vdW-DF calculations to assess the quality of the results.\nComputational time\nThe evaluation of the nonlocal correlation energy requires some additional time. Most of it is spent on performing FFTs to evaluate the energy and potential. Thus the additional time is determined by the number of FFT grid points, basically the size of the simulation cell. It is almost independent on the number of the atoms in the cell, but increases with the amount of vacuum in the cell. The relative increase is high for isolated molecules in large cells, but small for solids in smaller cells with many k-points.\nRelated Tags and Sections\nLUSE_VDW\n,\nIVDW_NL\n,\nLSPIN_VDW\n,\nZAB_VDW\n,\nALPHA_VDW\n,\nGAMMA_VDW\n,\nBPARAM\n,\nCPARAM\n,\nGGA\n,\nAGGAC\n,\nPARAM1\n,\nPARAM2\n,\nMETAGGA\nSee also the alternative atom-pairwise and many-body dispersion methods:\nIVDW\nReferences\n↑\na\nb\nc\nM. Dion, H. Rydberg, E. Schröder, D. C. Langreth, and B. I. Lundqvist, Phys. Rev. Lett.\n92\n, 246401 (2004).\n↑\na\nb\nG. Román-Pérez and J. M. Soler, Phys. Rev. Lett.\n103\n, 096102 (2009).\n↑\na\nb\nc\nd\nJ. Klimeš, D. R. Bowler, and A. Michaelides, Phys. Rev. B\n83\n, 195131 (2011).\n↑\nT. Thonhauser, S. Zuluaga, C. A. Arter, K. Berland, E. Schröder, and P. Hyldgaard, Phys. Rev. Lett.\n115\n, 136402 (2015).\n↑\nK. Berland, V. R. Cooper, K. Lee, E. Schröder, T. Thonhauser, P. Hyldgaard, and B. I. Lundqvist, Rep. Prog. Phys.\n78\n, 066501 (2015).\n↑\nF. Tran, L. Kalantari, B. Traoré, X. Rocquefelte, and P. Blaha, Phys. Rev. Mater.\n3\n, 0637602 (2019).\n↑\nK. Lee, E. D. Murray, L. Kong, B. I. Lundqvist, and D. C. Langreth, Phys. Rev. B\n82\n, 081101(R) (2010).\n↑\na\nb\nJ. Klimeš, D. R. Bowler, and A. Michaelides, J. Phys.: Condens. Matter\n22\n, 022201 (2010).\n↑\na\nb\nJ. Wellendorff, K. T. Lundgaard, A. Møgelhøj, V. Petzold, D. D. Landis, Jens K. Nørskov, T. Bligaard, and K. W. Jacobsen, Phys. Rev. B\n85\n, 235149 (2012).\n↑\nI. Hamada, Phys. Rev. B\n89\n, 121103 (2014).\n↑\nK. Berland and P. Hyldgaard, Phys. Rev. B\n89\n, 035412 (2014).\n↑\na\nb\nD. Chakraborty, K. Berland, and T. Thonhauser,\nNext-Generation Nonlocal van der Waals Density Functional\n, J. Chem. Theory Comput.\n16\n, 5893 (2020).\n↑\nR. Sabatini, T. Gorni, and S. de Gironcoli, Phys. Rev. B\n87\n, 041108(R) (2013).\n↑\nH. Peng, Z.-H. Yang, J. P. Perdew, and J. Sun, Phys. Rev. X\n6\n, 041005 (2016).\n↑\nH. Peng and J. P. Perdew,\nRehabilitation of the Perdew-Burke-Ernzerhof generalized gradient approximation for layered materials\n, Phys. Rev. B\n95\n, 081105(R) (2017).\n↑\nJ. Ning, M. Kothakonda, J. W. Furness, A. D. Kaplan, S. Ehlert, J. G. Brandenburg, J. P. Perdew, and J. Sun,\nWorkhorse minimally empirical dispersion-corrected density functional with tests for weakly bound systems: r\n2\n{\\displaystyle ^2}\nSCAN+rVV⁢10\n, Phys. Rev. B\n106\n, 075422 (2022)."
  }, 
  "Nose-Hoover thermostat": {
    "description": "The web page describes the Nose-Hoover thermostat method, which introduces a fictitious coordinate into the Lagrangian of a system to enable constant-temperature molecular dynamics simulations by treating the heat bath as an additional degree of freedom.", 
    "detailed_description": "In the approach by Nosé and Hoover\n[1]\n[2]\n[3]\n[4]\n, an extra degree of freedom is introduced in the Hamiltonian. The heat bath is considered as an integral part of the system and has a fictious coordinate\ns\n{\\displaystyle s}\nwhich is introduced into the Lagrangian of the system. This Lagrangian for a\nN\n{\\displaystyle N}\nparticle system is written as\nL\n=\n∑\ni\n=\n1\nN\nm\ni\n2\ns\n2\nr\n˙\ni\n2\n−\nU\n(\nr\n)\n+\nQ\n2\ns\n˙\n2\n−\ng\nk\nB\nT\nl\nn\ns\n{\\displaystyle\n\\mathcal{L} = \\sum\\limits_{i=1}^{N} \\frac{m_{i}}{2} s^{2} \\dot{\\bold{r}}_{i}^{2} - U(\\bold{r}) + \\frac{Q}{2} \\dot{s}^{2}-g k_{B} T \\mathrm{ln} \\, s\n}\nwhere\nm\ni\n{\\displaystyle m_{i}}\nand\nk\nB\n{\\displaystyle k_{B}}\nare the mass of ion\ni\n{\\displaystyle i}\nand the Boltzmann constant, respectively. The first two terms are the kinetic and potential energy of the system. The third and fourth term represent the kinetic and potential energy of the fictitious coordinate\ns\n{\\displaystyle s}\n. These terms also ensure the energy conservation of the Nose-Hoover thermostat. The parameter\ng\n{\\displaystyle g}\nis usually equal to the number of degrees of freedom of the system\ng\n=\n3\nN\n−\nN\nc\no\nn\ns\nt\nr\na\ni\nn\nt\n{\\displaystyle g=3N - N_{\\mathrm{constraint}}}\n, where\nN\nc\no\nn\ns\nt\nr\na\ni\nn\nt\n{\\displaystyle N_{\\mathrm{constraint}}}\nis equal to the number of constraint set (fixed coordinates in the\nPOSCAR\nfile). The parameter\nQ\n{\\displaystyle Q}\nis an effective \"mass\" of\ns\n{\\displaystyle s}\n, which controls the coupling of the system to the heat bath. It is set by the\nINCAR\ntag\nSMASS\n.\nThe Nose-Hoover thermostat is selected by\nMDALGO\n=2.\nRelated tags and articles\nMolecular-dynamics calculations\n,\nAndersen thermostat\n,\nLangevin thermostat\n,\nCSVR thermostat\n,\nNose-Hoover-chain thermostat\n,\nISIF\n,\nMDALGO\n,\nSMASS\nReferences\n↑\nS. Nosé, J. Chem. Phys.\n81\n, 511 (1984).\n↑\nS. Nosé, Prog. Theor. Phys. Suppl.\n103\n, 1 (1991).\n↑\nW. G. Hoover, Phys. Rev. A\n31\n, 1695 (1985).\n↑\nD. Frenkel and B. Smit, Understanding Molecular Simulation (Academic Press, London, 1996)."
  }, 
  "Not enough memory": {
    "description": "The web page provides strategies to reduce memory usage in VASP DFT calculations, including adjusting parameters like NCORE, LREAL, KPAR, and ISYM, using scaLAPACK for large systems, and monitoring memory consumption through the OUTCAR file.", 
    "detailed_description": "Nowadays, for standard DFT and hybrid functional calculations,  memory is usually not an issues.\nFurthermore, by increasing the number of cores, the memory requirements per core can be reduced significantly.\nIf memory shortage is encountered, the following steps  can be taken in order to reduce the memory requirements per core.\nFor large and many-atom systems, it is advised to increase\nNCORE\nto larger values (say to 4, 8 potentially to or even beyond the number of cores per node). This allows to decrease the memory requirements per core for the storage of the non-local projectors. Furthermore, real space projection,\nLREAL\n= A, also decreases the required memory per core.\nKPAR\nallows to distribute the k-points over cores. Unfortunately, only the calculations are distributed, but the storage of the orbitals is not distributed over cores. This means that using\nKPAR\n=1 results in the smallest memory footprint per core (but slower calculations, since VASP needs to rely on other less efficient parallelization strategies).\nSwitch of symmetrisation (\nISYM\n=0). Charge symmetrisation is done locally on each node requiring three fairly large arrays. VASP.4.4.2 (and newer versions) posses a switch to run a more memory conserving symmetrization. From VASP.5 onwards, the memory conserving version,\nISYM\n=2, is the default. Results might differ slightly from\nISYM\n=1 (usually by about 1E-5 eV).\nMake sure to use scaLAPACK if your system becomes large. If scaLAPACK is not available, VASP needs to store an\nNBANDS\nx\nNBANDS\nmatrix on each core, in order to diagonalize the Hamiltonian in the subspace of the calculated orbitals. If scaLAPACK is compiled in and used, the matrix is distributed over all cores jointly handling one k-point. Note that decreasing\nKPAR\nreduces the memory demand for this matrix (if scaLAPACK is used).\nA final hint is in place. At some key places, the VASP code reports the required memory per core in the\nOUTCAR\nfile. Please search the lines\ntotal amount of memory used by VASP MPI-rank0   457796. kBytes\n=======================================================================\nbase      :      30000. kBytes\nnonlr-proj:      12085. kBytes\nfftplans  :      29652. kBytes\ngrid      :      54584. kBytes\none-center:        211. kBytes\nwavefun   :     331264. kBytes\nand inspect how much memory VASP uses per core. \"base\" is the estimated memory use for the executable and libraries, \"nonlr-proj\" the required memory for the non-local projection operators, \"grid\" that for 3D arrays representing the charge density, potentials, etc., and \"wavefun\" the requirements for the one-electron wavefunctions (orbitals). Storage of the orbitals is usually most memory demanding."
  }, 
  "Nudged elastic bands": {
    "description": "The nudged elastic band (NEB) method is a computational technique used to determine the minimum energy path and transition states of chemical reactions or phase transitions by iteratively optimizing a series of intermediate structures between initial and final states, using spring forces to maintain equidistance and minimize energy.", 
    "detailed_description": "The nudged elastic band (NEB) method\n[1]\n[2]\nis a computational technique used for studying energy landscapes and reaction pathways in chemical reactions or phase transitions.\nIt entails creating an initial path connecting the system's initial and final states, employing a series of\nimages\nto represent intermediate configurations.\nThese images are linked by springs, forming an elastic band.\nThe method then iteratively adjusts the image positions along the band, minimizing energy until a minimum energy pathway, known as the 'nudged' path, is achieved.\nHow to set up an NEB calculation\nStep 1\nCarefully converge the fixed structures of your elastic band, i.e., the initial and the final state.\nRemember that in the subsequent steps, the elastic band will be attached to these fixed structures, so any error will affect the transition path you obtain.\nStep 2\nConstruct an initial guess for the intermediate structures.\nYou may use a script like in the\ntutorial\nor develop your own method.\nThis script in the tutorial also offers the option to remove center-of-mass motion.\nThese intermediate images should be somewhat close to the real transition path; otherwise, the optimization of the elastic band may fail.\nPlace the\nPOSCAR\nfiles corresponding to these intermediate structures in subdirectories 01, 02, etc.\nMind:\nMake sure that the\nPOSCAR\ncontains the same ordering of elements for initial, final, and intermediate states. It is highly recommended to minimize the number of images used to an absolute minimum. Convergence to the ground state is faster with fewer images. Starting with a single image between the two endpoints and increasing the number of images after the initial run has converged is often a prudent approach.\nStep 3\nCreate an\nINCAR\nfile in the root directory and set the tag\nIMAGES\nto the number of intermediate structures.\nThis will introduce tangential springs to maintain equidistance among images during the relaxation process.\nYou can control the strength with the\nSPRING\ntag, where negative values (like the default of -5) activate the NEB method.\nIt is important not to use excessively large values for\nSPRING\n, as it can hinder convergence.\nThe default value generally provides reliable results.\nYou should also set\nIBRION\n,\nISIF\n,\nNSW\n, and other.\nStep 4\nCreate the remaining input files\nKPOINTS\nand\nPOTCAR\n.\nFor the NEB method, we recommend that all input files, except the\nPOSCAR\n,\nWAVECAR\nand\nCHGCAR\nfile, reside in the root directory.\nThen, run VASP until the path is optimized.\nPossible issues and advice on how to address it\nOne challenge with the NEB method arises from its non-linear constraint, which restricts movements to a hyper-plane perpendicular to the current tangent.\nThis characteristic can lead to convergence issues with the conjugate-gradient (CG) algorithm (\nIBRION\n=2).\nIn such cases, it is advisable to use alternative algorithms like the RMM-DIIS algorithm (\nIBRION\n=1) or the quick-min algorithm (\nIBRION\n=3).\nAdditionally, the equidistant images tend to deviate from this constraint in the initial steps.\nTo address this, applying a low dimensionality parameter (\nIBRION\n=1,\nNFREE\n=2) in the initial steps or using steepest descent minimization without line optimization (\nIBRION\n=3,\nSMASS\n=2) can help pre-converge the images.\nIf all degrees of freedom are allowed to relax, (e.g., in isolated molecules or surfaces), it is crucial to ensure that the sum of all positions remains consistent across all cells.\nFailing to do so introduces artificial forces, causing the images to drift apart.\nWhile this does not affect the VASP calculations, it can complicate result visualization.\nTip:\nFor more advanced calculations, consider using the\nTransition State Tools for VASP\n.\nRelated tags and articles\nIMAGES\n,\nSPRING\n,\nIBRION\nCollective jumps of a Pt adatom on fcc-Pt (001): Nudged Elastic Band Calculation\nTS search using the NEB Method\nReferences\n↑\nG. Mills, H. Jonsson and G. K. Schenter,\nReversible work transition state theory: application to dissociative adsorption of hydrogen\n, Surf. Sci.,\n324\n, 305 (1995).\n↑\nH. Jonsson, G. Mills and K. W. Jacobsen,\nNudged Elastic Band Method for Finding Minimum Energy Paths of Transitions\n, in\nClassical and Quantum Dynamics in Condensed Phase Simulations\n, ed. B. J. Berne, G. Ciccotti and D. F. Coker (World Scientific, 1998)."
  }, 
  "Optimizing the parallelization": {
    "description": "The web page provides guidelines for optimizing the parallelization of VASP calculations by testing different setups, using specific INCAR tags like NCORE, KPAR, and IMAGES, and tailoring configurations to the system and hardware for maximum efficiency.", 
    "detailed_description": "To find the optimal\nparallelization\nsetup of a VASP calculation, it is necessary to run tests for each system, algorithm and computer architecture. Below, we offer general advice on how to optimize the parallelization.\nOptimizing the parallelization\nFor repetitive tasks,\na few iterations estimate the performance\nof the full calculation very well.\nFor example, run only a few electronic or ionic self-consistency steps (without reaching full convergence).\nCompare the time various parallelization setups need to perform these few iterations.\nTry to\nget as close as possible to the actual system\n.\nSpecifically, use the same or a very similar physical system (atoms, cell size, cutoff, ...);\nrun on the target computational hardware (CPUs, interconnect, number of nodes, ...).\nIf too many parameters are different, the parallel configuration may not be transferable to the production calculation.\nIn our experience, VASP yields the best performance by\ncombining multiple parallelization options\nbecause the parallel efficiency of each level drops near its limit.\nBy default, VASP distributes the number of bands (\nNBANDS\n) over the available MPI ranks.\nBut it is often beneficial to add parallelization of the FFTs (\nNCORE\n), parallelization over\nk\npoints (\nKPAR\n), and parallelization over separate calculations (\nIMAGES\n).\nAdditionally, there are some parallelization options for specific algorithms in VASP, e.g.,\nNOMEGAPAR\nfor parallelization over imaginary frequency points in\nG\nW\n{\\displaystyle GW}\nand RPA calculations. In summary,\nVASP parallelizes with\ntotal ranks\n=\nranks parallelizing bands\n×\nNCORE\n×\nKPAR\n×\nIMAGES\n×\nother algorithm-dependent tags\n.\n{\\displaystyle\n\\text{total ranks} = \\text{ranks parallelizing bands} \\times \\text{NCORE} \\times \\text{KPAR} \\times \\text{IMAGES} \\times \\text{other algorithm-dependent tags}.\n}\nTo optimize the parallelization, follow this recipe:\nCreate a list of the relevant\nparallelization INCAR tags\nfor the specific calculation.\nRead the documentation for each of the relevant tags\nto understand the limits and reasonable choices.\nFor any calculation involving\nelectronic minimization\n, it can be useful to first\nrun VASP with\nALGO\n=\nNone\nset in the\nINCAR\nfile. With\nALGO\n=\nNone\nthe\ncomputational setup\nfor the\nelectronic minimization\nis done without actually performing the minimization. For instance, the FFTs are planned, and the irreducible\nk\npoints of the first Brillouin zone are constructed. Therefore, some parameters, e.g., the default number of Kohn-Sham orbitals (\nNBANDS\n) and the total number of plane waves, are written to the\nOUTCAR\nfile while using barely any computational time.\nCombine the information from the documentation and the\ndry run\ninto a few possible candidates for a reasonable setup.\nRun test calculations\non a subset of the production run e.g. by reducing the number of steps.\nRun the production calculation with the best performing setup.\nFor the common case of\nelectronic minimization\ncalculations, the following rules of thumb apply:\nAim to set the number of ranks to the default value of\nNBANDS\ndivided by a small integer. Note that VASP will increase\nNBANDS\nto accommodate the number of ranks.\nChoose\nNCORE\nas a factor of the cores per node to avoid communicating between nodes for the FFTs. Mind that\nNCORE\ncannot be set with\nOpenMP\nthreading and/or the\nOpenACC GPU port\n.\nThe\nk\n-point parallelization is efficient but requires additional\nmemory\n. Given sufficient\nmemory\n, increase\nKPAR\nup to the number of irreducible\nk\npoints. Keep in mind that\nKPAR\nshould factorize the number of\nk\npoints.\nFor bulk systems with small unit cells (\nNBANDS\nis small, NKPTS=no of k points is large),\nNCORE\n= 1\nand\nKPAR\n= NKPTS\nis optimal.\nFor running on GPUs, you may try\nMPI ranks = no of GPUs\nKPAR\n= no of GPUs\nif memory allows\nOpenMP threading\ncan be quite important for the parts that still run on the host, because usually no of GPUs is rather small.\nFinally, use the\nIMAGES\ntag to split several VASP runs into separate calculations. The limit is dictated by the number of desired calculations.\nRelated tags an articles\nParallelization\n,\nKPAR\n,\nNCORE\n,\nKPAR\n,\nIMAGES\nReferences"
  }, 
  "PAW control tags": {
    "description": "The web page explains various PAW method tags in VASP, such as LMAXPAW, LMAXMIX, and ADDGRID, which control the evaluation of on-site terms, charge density mixing, and augmentation charge grids, respectively, to optimize accuracy and efficiency in electronic structure calculations.", 
    "detailed_description": "There are a few tags that control\nthe behavior of the PAW implementation.\nThe first one is\nLMAXPAW\n=\nl\n. This flag sets the maximum\nl\n-quantum number for\nthe evaluation of the on-site terms on the\nradial support grids in the PAW method. The default for\nLMAXPAW\nis\n2\n∗\nl\nm\na\nx\n{\\displaystyle 2*l_{max}}\n, where\nl\nm\na\nx\n{\\displaystyle l_{max}}\nis the maximum angular\nquantum number of the partial waves.\nA useful setting for this tag is for instance\nLMAXPAW\n=0. In this case, only spherical terms are evaluated on the\nradial grid. This does not mean that a-spherical terms\nare totally neglected, because the compensation charges\nare always expanded up to\n2\n∗\nl\nm\na\nx\n{\\displaystyle 2*l_{max}}\non the plane wave\ngrid.\nFor\nLMAXPAW\n=-1, no on-site correction terms are evaluated on the radial\nsupport grid, which effectively means that the\nbehavior of US-PP's is recovered with PAW input datasets.\nUsually this allows very efficient and fast calculations,\nand this switch might be of interest for relaxations\nand molecular dynamics runs. Energies should be evaluated\nwith the default setting for\nLMAXPAW\n.\nAn additional tag\nLMAXMIX\n=\nl\ncontrols up to which\nl\nquantum number the on-site PAW\ncharge densities are passed through the charge density mixer and written\nto the\nCHGCAR\nfile.\nThe default is\nLMAXMIX\n}=2. Higher l-quantum numbers are usually\nnot\nhandled by the mixer, i.e. a straight mixing is applied for them\n(the PAW on-site charge density for higher l quantum numbers is reset precisely\nto the value corresponding to the present orbitals). Usually,\nit is not required to increase\nLMAXMIX\n, but the following two cases\nare exceptions:\nL(S)DA+U calculations require in many cases an increase of\nLMAXMIX\nto 4 (or 6 for f-elements) in order to obtain fast convergence to the groundstate.\nThe\nCHGCAR\nfile also contains only information up to\nLMAXMIX\nfor the on-site PAW occupancy matrices. When the\nCHGCAR\nfile is read and kept fixed in the course of the calculations (\nICHARG\n=11), the results will be necessarily not identical to a self-consistent run. The deviations can be (or actually are) large for L(S)DA+U calculations. For the calculation of band structures within the L(S)DA+U approach it is strictly required to increase\nLMAXMIX\nto 4 (d elements) and 6 (f elements).\nThe second switch, that is useful in the context of the\nPAW method (and US-PP) is\nADDGRID\n.\nThe default is\nADDGRID\n=\n.FALSE.\n. If\nADDGRID\n=\n.TRUE.\nis written in the\nINCAR\nfile, an additional (third) support grid is\nused for the evaluation of the augmentation charges. This\nthird grid contains 8 times more points than the fine\ngrid\nNGXF\n,\nNGYF\n,\nNGZF\n.\nWhenever terms involving augmentation charges are evaluated, this\nthird grid is used.\nFor instance: The augmentation charge is evaluated first\nin real space on this fine grid, FFT-transformed to reciprocal space\nand then added to the total charge density on the\ngrid\nNGXF\n,\nNGYF\n,\nNGZF\n.\nThe additional grid helps to reduce the noise in the forces significantly.\nIn many cases, it even allows to perform calculations in which\nNGXF\n=\nNGX\netc. This can be achieved by setting\nENAUG\n= 1  and\nADDGRID\n=\n.TRUE.\nin the\nINCAR\nfile. The flag can also be used for US-PPs,\nin particular, to reduce the noise in the forces."
  }, 
  "Partial charge densities and STM simulations": {
    "description": "This web page explains how to calculate and use partial (band-decomposed) charge density in VASP, particularly for analyzing electronic properties and simulating scanning tunneling microscopy (STM) images, including input settings, output files, and step-by-step instructions.", 
    "detailed_description": "The partial (band-decomposed) charge density can be used to analyze the contributions of different orbitals or energy ranges to a specific region in real space. It helps in gaining insight and visualizing electronic, magnetic, or transport properties, and is especially important when simulating scanning-tunneling-microscopy (STM) images.\nIn VASP, the calculation of partial charges is a quick postprocessing step that is selected by setting\nLPARD\n= .TRUE. in the\nINCAR\nfile. It is necessary to provide a\nWAVECAR\nfrom a converged ground state calculation as an input file. To select the contributing\nk\npoints and bands, various options exist, which can be selected via the\nNBMOD\n,\nIBAND\n,\nEINT\n, and\nKPUSE\ntags.\nMind:\nAll charge densities, including the band-decomposed charge densities, are symmetrized using both the space and point group symmetries. However, when calculating partial charge from selected\nk\npoints, this can lead to wrong results due to wrong\nk\npoint weights. In that case, the symmetry must be turned off during the initial ground state calculation from which the WAVECAR is generated, as well as during the subsequent band-decomposed charge density calculation.\nWarning:\nBand-decomposed partial charge density postprocessing is not supported for noncollinear magnetic calculations (\nLNONCOLLINEAR\n= .TRUE.).\nInput tags for selecting and writing the partial charges\nThe following list briefly explains the various\nINCAR\ntags that control the behavior of the band-decomposed charge density decomposition. Please refer to the documentation of each tag for further details.\nLPARD\n: Toggles the partial charge postprocessing on or off. If only this tag is set, the valence charge density is computed for all occupied bands and written to the\nCHGCAR\nfile (without the augmentation occupancies usually written to that file).\nLPARDH5\nSwitches the output to the\nvaspout.h5\nfile. This tag is only available as of VASP.6.5.0.\nIBAND\n: An integer array specifying the bands to include in the partial charge density. If\nIBAND\nis specified,\nNBMOD\nis automatically set to the number of selected bands.\nEINT\n: Specifies an energy interval. Any energy bands with eigenvalues within this range will contribute to the calculation of the partial charge density. If the value of the\nNBMOD\ntag is set to -3, the energy values are interpreted as relative to the Fermi energy\nϵ\nf\n{\\displaystyle \\epsilon_f}\n. If the\nNBMOD\ntag is not set or is set to -2, the provided energy values will be considered as absolute total energies.\nNBMOD\n: This tag controls the mode of selecting bands that should contribute to the calculation of partial charges.\nNBMOD\n= n: Use n bands (set automatically if\nIBAND\nis used).\nNBMOD\n= 0: Use all bands (occupied and empty).\nNBMOD\n= -1: Use all occupied bands (and write to\nCHGCAR\ninstead of\nPARCHG\nif\nPARCHGH5\n= .FALSE.)\nNBMOD\n= -2: To choose the bands that contribute, you can utilize an energy interval defined by the tag\nEINT\n.\nNBMOD\n= -3: Use an energy interval relative to the Fermi energy\nϵ\nf\n{\\displaystyle \\epsilon_f}\nto select contributing bands (defined by\nEINT\n).\nKPUSE\n: Specifies which\nk\npoints are used in the evaluation of the partial charge density.\nLSEPB\n: Specifies whether to write the partial charge density for selected bands individually or merge them.\nLSEPK\n: Specifies whether to write the partial charge density for selected\nk\npoints individually or merge them.\nOutput files\nThe partial valence charge density is written in the\nPARCHG\nfile. If you want to separate the output by\nk\npoints or bands, setting\nLSEPB\nand/or\nLSEPK\nallows you to write it to multiple PARCHG.*.* files.\nIf the code is compiled with\nHDF5 support\n,\nLPARDH5\n= .TRUE.\nredirects all output to the\nvaspout.h5\nfile. In that case\npy4vasp\ncan be used to analyze the output and plot\nsimulated STM pictures\n.\nMind:\nFor spin-polarized calculations, the\nPARCHG\nand its variants hold the total density and the magnetization density. For instance, if the 4th band is selected (\nIBAND\n= 4) the first data set in the\nPARCHG\nfile corresponds to the summed density of the 4th spin up and 4th spin down orbital, whereas the second data set holds the difference between the 4th spin-up and 4th spin-down orbital (magnetization density). Hence, to obtain the charge density corresponding to a specific orbital of a specific spin channel some post-processing of the\nPARCHG\nfile might be required (building differences or sums). A simple workaround is to use\nEINT\nand specify sufficient digits to select only one orbital from either the spin-up or spin-down channel.\nStep-by-step instructions for simulating an STM picture\nIn this example, we will produce a partial charge density useful for STM picture simulation. Note that the bias voltage and tip distance from an experiment do not always translate one-to-one to the simulation.\nStep 1\n: Ensure that the ground state calculation has a well-converged charge density (low rms(c) in the standard output or the\nOSZICAR\n).\nThe\nk\npoint mesh should be well converged to get good results for STM simulations.\nStep 2\n: Copy\nPOSCAR\n,\nKPOINTS\n, and\nWAVECAR\nto a new directory.\nStep 3\n: Prepare an appropriate\nINCAR\nfile in the new directory, making sure you specify the same settings for\nENCUT\n,\nISYM\n, and\nISPIN\nas in the groundstate calculation. This could be a possible\nINCAR\n:\nSYSTEM\n= STM simulation\nENCUT\n= 520\nISPIN\n= 2\nLPARD\n= .TRUE.\nLPARDH5\n= .TRUE.\nNBMOD\n= -3\nEINT\n= -0.2 0.05\nLSEPB\n= .FALSE.\nLSEPK\n= .FALSE.\nLPARD\n= .TRUE. activates the partial charge mode and assures that the WAVECAR file is read.\nLPARDH5\n= .TRUE. redirect the output to the\nvaspout.h5\nfile allowing the use of\npy4vasp\nfor plotting the simulated STM picture.\nENCUT\nand\nISPIN\nsettings are copied over from the ground state calculation.\nNBMOD\n= -3 and\nEINT\n= -0.2 0.05 ensure that the bands from\nϵ\nf\n−\n0.2\n{\\displaystyle \\epsilon_f-0.2}\nto\nϵ\nf\n+\n0.05\n{\\displaystyle \\epsilon_f+0.05}\neV are included (corresponding to a negative bias voltage of about 0.2 Volt). The two remaining tags,\nLSEPB\nand\nLSEPK\nare set to their default values (.FALSE.) and are there for clarity only. We want to sum up the contributions of all bands in the energy range at all\nk\npoints without separating any of this information.\nStep 4\n: Run VASP. No electronic (or ionic) minimization is performed, so the calculation is rapid and does not require parallelization.\nStep 5\n: (optional, requires\npy4vasp\n): execute the following Python script in a Python environment where\npy4vasp\nis installed:\nfrom py4vasp import Calculation\ncalc = Calculation.from_file('/path/to/your/vaspout.h5')\ncalc.partial_charge.to_stm(selection='constant_height(total)', tip_height=4, supercell=[7,7])\nThis will plot the simulation of an STM image in constant height mode, with the tip 4\nÅ\nabove the surface. A 7 by 7 supercell is plotted. Under the hood, the data is pre-processed with Gaussian smoothening for the STM plot. More convenient methods are provided in\npy4vasp\nto work with the partial charge data.\nAlternative Step 5\n(optional, if VASP is compiled without HDF5 support): Load the resulting\nPARCHG\nfile with your favorite visualization program to view constant-height images by looking at slices through the data or constant current images by using isosurfaces.\nExample\nThe images below show an experimental (on the left) and a simulated (on the right) scanning tunneling image of Graphene. The experimental image was measured at room temperature in air at the Department for Earth and Environmental Sciences, LMU, and Center for NanoScience (CeNS), Munich. The simulated image was created with\npy4vasp\nat very similar settings as described in the\nsection\nabove.\nThere are tutorials to calcualte the constant height STM and constant current STM in\npart 3 of the surface tutorials\non our website.\nRelated tags and articles\nLPARD\n,\nIBAND\n,\nEINT\n,\nNBMOD\n,\nKPUSE\n,\nLSEPB\n,\nLSEPK\n,\nPARCHG\n,\nCHGCAR\n,\nWAVECAR"
  }, 
  "Phonons from density-functional-perturbation theory": {
    "description": "This web page explains how to perform phonon calculations using density-functional-perturbation theory (DFPT) in VASP by setting IBRION=7 or 8 in the INCAR file, noting that the method calculates only zone-center (Γ-point) frequencies and has limitations such as support only for LDA and GGA functionals, lack of elastic tensor determination, and", 
    "detailed_description": "The phonon calculations using\ndensity-functional-perturbation theory (DFPT)\nare carried out by setting\nIBRION\n=7 or 8\nin the\nINCAR\nfile.\nMind:\nOnly zone-center (Γ-point) frequencies are calculated.\nIn general, the DFPT routines in VASP are somewhat rudimentary and only support displacements commensurate with the supercell, i.e., so-called q=0 phonons.\nTherefore, this approach offers few advantages over computing\nphonons from finite differences\n.\nIn particular, the DFPT routines are limited to LDA and GGA functionals, and they do not determine the elastic tensors, since the perturbation with respect to the strain tensor is not implemented.\nThe only advantage of the linear response routines is that they eliminate the need to choose the magnitude of the finite displacement\nPOTIM\n.\nTherefore, it might be helpful to first calculate phonon frequencies within DFPT and then switch to the\nfinite differences approach\nin order to determine the largest displacement that will produce results compatible with the linear response routines.\nA few technical comments: VASP solves the\nlinear Sternheimer equation\nto determine the linear response of the orbitals.\nHence, unoccupied orbitals are not required.\nInternally, the VASP routines for linear response rely on finite differences in two places:\nThe first place is the determination of the second derivative of the\nexchange-correlation functional\n: Since most functionals do not support an algebraic determination of second derivatives, VASP always resorts to finite differences to determine the second-order change of the exchange correlation-potential and the PAW one-center terms for each atomic displacement.\nSecond, after VASP has determined the first-order change of the orbitals, it computes all\nsecond derivatives using finite displacements\n.\nTo this end, VASP displaces the selected atom in the selected directions\nadds the calculated linear response to the orbitals\n, and finally determines the differences in the forces and the stress tensor for positive and negative displacements.\nIt can be shown that this yields precisely the\nsecond-order force constants\nand the\ninternal strain tensor\n, respectively.\nInput\nTo use DFPT, set the tag\nIBRION\n=7 or 8\nin the\nINCAR\nfile.\nThere are two options for using the DFPT routines to compute the second-order force-constants\nIBRION\n=7, all the atoms are displaced in all three Cartesian directions,\nIBRION\n=8, uses symmetry to reduce the number of displacements.\nIf\nLEPSILON\n=.TRUE. or\nLCALCEPS\n=.TRUE., additional dielectric properties are computed.\nOutput\nThe second derivates of the total energy with respect to ionic displacements (interatomic force constants) are computed,\nthe\ndynamical matrix\nis constructed, diagonalized and the phonon modes and frequencies of the system are reported after the following lines:\nEigenvectors and eigenvalues of the dynamical matrix\n----------------------------------------------------\nThe mixed second derivative with respect to the strain and the ionic displacement (internal strain tensor) are evaluated and reported.\nAlthough the contributions from the ionic relaxations to the elastic tensor are calculated, the ion-clamped elastic tensor (rigid ion) is not determined because the perturbation with respect to the strain tensor is not implemented.\nFurthermore, the\nBorn effective charges\nare determined analytically by contracting the linear response of the orbitals over the \"polarization\" vector Eq. (30) in Ref.\n[1]\n.\nThese should agree well with the Born effective charges that were previously determined when the linear response with respect to external fields\nLEPSILON\n=.TRUE. was calculated (there are two different routes to calculate mixed derivatives).\nThe final summary output towards the end of the\nOUTCAR\nfile writes the Born effective charges determined from the linear response with respect to external fields.\nIt is possible to\nobtain the phonon dispersion at different\nq\npoints\nby computing the force constants on a sufficiently large supercell and Fourier interpolating the dynamical matrices in the primitive cell.\nIt is also possible to use phonopy\n[2]\nto use the results of a density-functional-perturbation theory calculation done with VASP.\n[3]\nMind:\nIBRION\n=7 or 8 are supported by VASP.5.1 and later versions.\nRelated tags and sections\nIBRION\n,\nLEPSILON\n,\nPhonons: Theory\n,\nPhonons from finite differences\nReferences\n↑\nM. Gajdoš, K. Hummer, G. Kresse, J. Furthmüller, and F. Bechstedt, Phys. Rev. B\n73\n, 045112 (2006).\n↑\nhttp://phonopy.github.io/phonopy/index.html (2022).\n↑\nhttp://phonopy.github.io/phonopy/vasp-dfpt.html (2022)."
  }, 
  "Phonons from finite differences": {
    "description": "This web page explains how to perform phonon calculations using the finite differences method in VASP by setting parameters such as IBRION=5 or 6 in the INCAR file, which computes second-order force constants, phonon frequencies, and modes written in the OUTCAR file, and also covers related settings like NFREE, POTIM, ISIF, and selective dynamics,", 
    "detailed_description": "The phonon calculations using a\nfinite differences approach\nare carried out by setting\nIBRION\n=5 or 6\nin the\nINCAR\nfile.\nWhen these tags are set, the second-order force constants are computed using finite differences. The\ndynamical matrix\nis constructed, diagonalized and the phonon modes and frequencies of the system are reported in the\nOUTCAR\nfile.\nIf\nISIF\n>=3, the internal strain tensors are computed as well.\nMind:\nOnly zone-center (Γ-point) frequencies are calculated.\nIt is possible to\nobtain the phonon dispersion at different\nq\npoints\nby computing the second-order force constants on a sufficiently large supercell and Fourier interpolating the dynamical matrices in the unit cell.\nInput\nThere are two options to compute the second-order force constants using finite differences:\nIBRION\n=5, all atoms are displaced in all three Cartesian directions, resulting in a significant computational effort even for moderately sized high-symmetry systems.\nIBRION\n=6, only symmetry inequivalent displacements are considered, and the remainder of the force-constants matrix is filled using symmetry operations.\nPOTIM\ndetermines the step size.  If too large values are supplied in the input file, the step size defaults to 0.015 Å (starting from VASP.5.1). Expertise shows that this is a very reasonable compromise.\nThe\nNFREE\ntag determines how many displacements are used for each direction and ion:\nNFREE\n=2 uses central differences,\ni.e.\n, each ion is displaced by a small positive and negative displacement, ±\nPOTIM\n, along each of the Cartesian directions.\nNFREE\n=4 uses four displacements along each of the Cartesian directions ±\nPOTIM\nand ±2×\nPOTIM\n.\nNFREE\n=1 uses a single displacement (this is strongly discouraged).\nIf\nISIF\n>=3, the elastic and internal strain tensors are computed.\nThe selective dynamics mode of the\nPOSCAR\nfile is presently only supported for\nIBRION\n=5; in this case, only those components of the Hessian matrix are calculated for which the selective dynamics tags are set to .TRUE. in the\nPOSCAR\nfile.\nImportant:\nThe selective dynamics always refer to the Cartesian components of the Hessian matrix, contrary to the behavior during ionic relaxation.\nFor the following\nPOSCAR\nfile, for instance,\nCubic BN\n3.57\n0.0 0.5 0.5\n0.5 0.0 0.5\n0.5 0.5 0.0\n1 1\nselective\nDirect\n0.00 0.00 0.00  F F F\n0.25 0.25 0.25  T F F\natom 2 is displaced in the\nx\n-direction only, and only the\nx\n-component of the second atom of the Hessian matrix is calculated.\nIf\nLEPSILON\n=.TRUE. or\nLCALCEPS\n=.TRUE., additional dielectric properties are computed.\nOutput\nThe phonon modes and frequencies are written to the\nOUTCAR\nfile after the following lines:\nEigenvectors and eigenvalues of the dynamical matrix\n----------------------------------------------------\nThe following lines are repeated for each normal mode and should look like the following example output:\n1 f  =   14.329944 THz    90.037693 2PiTHz  477.995462 cm-1    59.263905 meV\nX         Y         Z           dx          dy          dz\n0.000000  0.000000  0.000000     0.009046   -0.082007   -0.006117\n0.000000  2.731250  2.731250     0.009046    0.106244    0.006563\n0.000000  5.462500  5.462500     0.009046    0.082007    0.006117\n0.000000  8.193750  8.193750     0.009046   -0.106244   -0.006563\n...\n2 f  =   14.329944 THz    90.037693 2PiTHz  477.995462 cm-1    59.263905 meV\nX         Y         Z           dx          dy          dz\n0.000000  0.000000  0.000000     0.003458    0.021825   -0.093181\n0.000000  2.731250  2.731250     0.003458    0.005416    0.094689\n0.000000  5.462500  5.462500     0.003458   -0.021825    0.093181\n0.000000  8.193750  8.193750     0.003458   -0.005416   -0.094689\n...\n...\nThe first number is the label of the normal mode. If this number is followed by\nf\nit is a purely real mode, stating the mode is vibrationally stable. Otherwise, if it is followed by\nf/i\n, the mode is an imaginary mode (\"soft mode\"). These labels are followed by the eigenfrequency of the mode in different units.\nThe following table labeled by (\nx,y,z,dx,dy,dz\n) contains the Cartesian positions of the atoms and the normalized eigenvectors of the eigenmodes in Cartesian coordinates.\nThere should be 3\nN\n{\\displaystyle N}\nnormal modes, where\nN\n{\\displaystyle N}\nis the number of atoms in the supercell (\nPOSCAR\n). The modes are ordered in descending order with respect to the eigenfrequency. The last three modes are the translational modes (they are usually disregarded).\nFinally,\nIBRION\n=6 and\nISIF\n≥3 allows to calculate the elastic constants. The elastic tensor is determined by performing six finite distortions of the lattice and deriving the elastic constants from the strain-stress relationship.\n[1]\nThe elastic tensor is calculated both, for 'clamped' ions, as well, as allowing for relaxation of the ions. The elastic moduli for rigid ions are written after the line\nSYMMETRIZED ELASTIC MODULI (kBar)\nThe ionic contributions are determined by inverting the ionic Hessian matrix and multiplying with the internal strain tensor,\n[2]\nand the corresponding contributions are written after the lines:\nELASTIC MODULI CONTR FROM IONIC RELAXATION (kBar)\nThe final elastic moduli, including both, the contributions for distortions with rigid ions and the contributions from the ionic relaxations, are summarized at the very end:\nTOTAL ELASTIC MODULI (kBar)\nThere are a few caveats to this approach: most notably, the plane-wave cutoff (\nENCUT\n) needs to be sufficiently large to converge the stress tensor. This is usually only achieved if the default cutoff is increased by roughly 30%, but it is strongly recommended to increase the cutoff systematically, (e.g., in steps of 15%), until full convergence is achieved.\nPractical hints\nThe computation of the second-order force constants requires accurate\nforces\n.\nTherefore, the tag\nPREC\n=Accurate is recommended in the\nINCAR\n.\nThe\nADDGRID\n=TRUE should\nnot\nbe set without careful testing.\nA practical way to check for convergence is to monitor the Γ point (\nq\n=0) optical mode frequencies while varying the\nENCUT\n,\nPREC\n, and\nk\npoint density (\nKPOINTS\n). Additionally, compare the result to\nphonons from density-functional-perturbation theory (DFPT)\n.\nTo get the phonon frequencies quickly on the command line, simply type the following:\ngrep THz OUTCAR\nTo get an accurate phonon dispersion, perform the force-constants calculation in a large enough supercell.\nWhen increasing the size of the supercell, we recommend decreasing the\nk\n-point density in the\nKPOINTS\nfile to yield the same resolution.\nFor example, for the primitive cell of silicon, a 12x12x12 Gamma-centered\nk\n-point mesh is needed to obtain accurate phonon frequencies at the Gamma point. When replicating the unit cell to a 2x2x2 supercell, a 6x6x6\nk\npoint mesh will produce an equivalent sampling. For a 4x4x4 supercell, a 3x3x3\nk\npoint mesh will suffice.\nIt is possible to use phonopy\n[3]\nto post-process the results of a finite differences calculation done with VASP.\n[4]\nTip:\nIn contrast to\ncomputing phonons within DFPT\n, the finite difference approach can be used in combination with any\nExchange-correlation functional\n.\nIBRION\n=5, is available as of VASP.4.5,\nIBRION\n=6 starting from VASP.5.1.\nIn some older versions (pre VASP.5.1),\nNSW\n(number of ionic steps) must be set to 1 in the\nINCAR\nfile, since\nNSW\n=0 sets the\nIBRION\n=−1 regardless of the value supplied in the\nINCAR\nfile.\nAlthough VASP.4.6 supports\nIBRION\n=5-6, VASP.4.6 does not change the set of\nk\npoints automatically (often the displaced configurations require a different\nk\n-point grid). Hence, the finite difference routine might yield incorrect results in VASP.4.6.\nRelated tags and sections\nIBRION\n,\nISIF\n,\nPOTIM\n,\nPhonons: Theory\n,\nPhonons from density-functional-perturbation theory\nReferences\n↑\nY. Le Page and P. Saxe, Phys. Rev. B\n65\n, 104104 (2002).\n↑\nX. Wu, D. Vanderbilt, and D. R. Hamann, Phys. Rev. B\n72\n, 035105 (2005).\n↑\nhttp://phonopy.github.io/phonopy/index.html (2022).\n↑\nhttp://phonopy.github.io/phonopy/vasp-dfpt.html (2022)."
  }, 
  "Plugins": {
    "description": "The web page explains how to use Python plugins with VASP by writing specific Python functions in a predefined format, allowing users to modify various aspects of VASP calculations—such as structure, force, stress, and potential—without extensive code development or maintenance overhead.", 
    "detailed_description": "Implementing features over VASP carries a significant overhead, both in term of code development and maintenance.\nAn alternative approach is to use our Python plugin infrastructure. Simply write\nPython\nfunctions in a pre-defined format and VASP will recognize and execute your code while it is running.\nThis page describes the steps that you will need to write your first Python script and link it with VASP.\nPython scripting\nStart by creating a file called\nvasp_plugin.py\nin the folder in which you are running a VASP calculation.\nAn alternative route through entry-points is also possible (see below for further instructions).\nIn\nvasp_plugin.py\nimplement one or all of the following Python functions.\ndef\nstructure\n(\nconstants\n,\nadditions\n):\n\"\"\"Defines the PLUGINS/STRUCTURE interface\"\"\"\ndef\nforce_and_stress\n(\nconstants\n,\nadditions\n):\n\"\"\"Defines the PLUGINS/FORCE_AND_STRESS interface\"\"\"\ndef\nlocal_potential\n(\nconstants\n,\nadditions\n):\n\"\"\"Defines the PLUGINS/LOCAL_POTENTIAL interface\"\"\"\ndef\nmachine_learning\n():\n\"\"\"Defines the PLUGINS/MACHINE_LEARNING interface\"\"\"\ndef\noccupancies\n(\nconstants\n,\nadditions\n):\n\"\"\"Defines the PLUGINS/OCCUPANCIES interface\"\"\"\nAs the names of the input variables suggest,\nconstants\nprovides a\ndataclass\nwith quantities computed in VASP that must stay constant through the interface. Typically these include \"metadata\" such as the lattice vectors, number of grid points, etc. Some interfaces also pass in quantities such as the charge density as\nconstants\n. Please check the page of the specific plugins' tag for more details on which quantities are available as constants. Alternatively, you may print the contents of\nconstants\n.\nadditions\nstores quantities that are allowed to change in the interface. You must use the syntax\nadditions.<quantity-name> += ...\nin order to change additions. That is, quantities must be \"added\" (or subtracted) to\nadditions\ninstead assigning them a new value. We use additions for two reasons. First, it makes sure that you use the memory from VASP; otherwise assigning might create a new array in memory and return zero to VASP. Secondly, adding the values allows multiple compatible plugins running at the same time.\nThe machine-learning plugin works a bit different. Please refer to\nits documentation\nfor more details.\nEach of the above interfaces may be called by VASP depending on the following\nINCAR\ntags\nPLUGINS/FORCE_AND_STRESS\n= T        ! Modifies the force and stress at the end of the SCF loop\nPLUGINS/LOCAL_POTENTIAL\n= T         ! Modifies the local potential every SCF step\nPLUGINS/MACHINE_LEARNING\n= T        ! Replaces the VASP force/stress engine with a machine-learned interatomic potential\nPLUGINS/OCCUPANCIES\n= T             ! Modifies NELECT, EFERMI, SIGMA, ISMEAR, EMIN, EMAX, NUPDOWN at the end of the SCF loop\nPLUGINS/STRUCTURE\n= T               ! Modifies the structure at the end of the SCF loop\nNavigate to the relevant\nINCAR\ntag pages for further information.\nExposing interfaces through entry-points (advanced)\nConsider using\nentry points\nin cases where you do not want to move\nvasp_plugin.py\nto each new VASP calculation directory. This is also the approach you should take, if you want to distribute your plugin to other users. Within the group \"vasp\", add the following lines to your\npyproject.toml\nfile for each interface you would like to introduce new functions. For example, if you wanted to access the\nforce_and_stress\ninterface through an entry point, add the following lines to your\npyproject.toml\nfile,\nforce_and_stress = \"/path/to/python_function:force_and_stress\"\nRelated tags\nPLUGINS/FORCE_AND_STRESS\n,\nPLUGINS/LOCAL_POTENTIAL\n,\nPLUGINS/MACHINE_LEARNING\n,\nPLUGINS/OCCUPANCIES\n,\nPLUGINS/STRUCTURE"
  }, 
  "Practical considerations for transition state finding calculations": {
    "description": "This web page provides practical guidance for improving the accuracy and reliability of transition state energy calculations using the Nudged Elastic Band (NEB) and Intrinsic Reaction Coordinate (IRC) methods in VASP, addressing common issues such as intermediate states with lower energy, non-converging bands, and unrealistic IRC paths, along with suggested solutions.", 
    "detailed_description": "This page details a few practical considerations for obtaining accurate and reliable transition state energies using the\nNudged Elastic Band\n(NEB)\n[1]\n[2]\nand\nIntrinsic Reaction Coordinate\n(IRC)\n[3]\nmethods implemented in VASP.\nWe list a few common issues encountered when running calculations with the NEB and IRC methods and identify possible solutions.\nNEB calculations\nRestart with a better guess for the initial and final state configurations\nAn example band which shows intermediate structures with lower energy than the initial and final configurations.\nProblem\n: While performing an NEB calculation, there might be points on the band which have lower energy than that of the initial and final state configurations (corresponding to the structures that were placed in the 00 and 0x, where x is the number of\nIMAGES\nplus one). The figure on the right shows an example where the red (computed) points of the intermediate images are more stable than the initial and final configurations. The presence of these intermediate states is not an issue for the NEB methodology. However, if we are seeking to understand elementary reaction steps of one reaction event each, then we would like to have a band consisting of only one maxima and two minima (consisting of the initial and final states).\nPossible solutions\nRelax the configurations with lower energy. These structures would then correspond to new initial and final configurations. Restart the NEB with these new configurations as the endpoints of the band.\nMake sure that the NEB was run with sufficient (and commensurate to the initial and final structures) accuracy. An important requirement is a small enough\nEDIFF\n, which governs the accuracy of the forces used in the NEB method.\nBand becomes \"floppy\"\nProblem\nThe band between the\nIMAGES\nof the NEB calculation is non-monotonic and appears \"floppy\".\nIn such a scenario the interpolated band is likely to oscillate between the computed points.\nThis problem typically appears when one or more images are added to an already computed band.\nPossible solutions\nThis problem is likely caused by the value of\nSPRING\nbeing too small.\nCheck if\nEDIFF\nis accurate enough for computation of the forces.\nCheck the interpolation algorithm that you use to determine the interpolated band. A cubic spline might suffice in most cases.\nBand does not converge\nProblem\nThe calculation does not converge, i.e., the NEB method does not find a reasonable path between an initial and final state configuration.\nSometimes a completely different path is found than the desired path.\nPossible solutions\nChoose a different interpolation strategy to generate your initial guessed path\nTry the\nImproved dimer method\ninstead\nCheck if the numbering of the atoms is the initial and final configurations. Different ordering of atoms will lead to an unexpected path. Visualizing the initial interpolated path should help with diagnosing any issues related to incorrectly ordered atoms.\nChecking convergence\nProblem\nUnsure if the highest energy point in the NEB is the first order saddle point between the initial and final state configurations\nPossible solutions\nCheck if there is exactly one imaginary mode by computing the second derivatives of the energy as implemented in\nIBRION\n.\nIRC calculations\nProblem\nUnrealistic structures are generated along the IRC path\nPossible solution\nMake sure that a very tight force convergence criteria has been used to determine the transition state;\nEDIFFG\nmust be at most -0.025.\nChoose a smaller value of\nIRC_VNORM0\nso that the path conforms with the intrinsic reaction coordinate more closely.\nRelated articles\nNudged elastic bands\n,\nIRC calculations\nReferences\n↑\nG. Mills, H. Jonsson and G. K. Schenter,\nReversible work transition state theory: application to dissociative adsorption of hydrogen\n, Surf. Sci.,\n324\n, 305 (1995).\n↑\nH. Jonsson, G. Mills and K. W. Jacobsen,\nNudged Elastic Band Method for Finding Minimum Energy Paths of Transitions\n, in\nClassical and Quantum Dynamics in Condensed Phase Simulations\n, ed. B. J. Berne, G. Ciccotti and D. F. Coker (World Scientific, 1998).\n↑\nH. P. Hratchian and H. B. Schlegel,\nFollowing Reaction Pathways Using a Damped Classical Trajectory Algorithm\n, J. Phys. Chem. A\n106\n, 165 (2002)."
  }, 
  "Practical guide to GW calculations": {
    "description": "The web page provides detailed instructions and parameters for performing GW approximation calculations in VASP, including single-step and two-step procedures, input file settings, convergence considerations, and explanations of different GW methods like G0W0 and EVGW0.", 
    "detailed_description": "The\nGW approximation\nis an approximation to the self-energy. GW calculations are available as of VASP.5.X. For details on the implementation and use of the\nGW\nroutines, we recommend the papers by Shishkin\net al.\n[1]\n[2]\n[3]\nand Fuchs\net al.\n[4]\nSingle step procedure: GW in one go\nAs of VASP.6.3 all GW approximations can be run in one single run by selecting the corresponding\nALGO\ntag and omitting\nNBANDS\n), for instance like so\nSystem\n= SiC\nALGO\n= EVGW0, QPGW0, EVGW, QPGW, GW0R or GWR # use an algorithgm described below\nNELMGW\n= 1,2,.. # number of self-consistency cycles\nISMEAR\n= 0 ;\nSIGMA\n= 0.05  ! small sigma is required to avoid partial occupancies\nLOPTICS\n= .TRUE.  # for insulators, omit for metals\nNote,\nNBANDS\nmust not be present in the INCAR to select this procedure.\nImportant:\nIn older versions a two step procedure is required, where the first step is always a DFT calculation and the second step the actual GW calculation.\nThe two-step procedure is described below.\nCaveats\nThe single-step GW procedure performs a DFT step internally with an exact diagonalization of the Kohn-Sham Hamiltonian using the maximum available\nNBANDS\nsupported for the chosen\nENCUT\nvalue.\nConsequently, a large number of unoccupied bands is initialized with random plane-wave coefficients. In rare cases, this yields two linearly dependent column vectors in the Hamiltonian and results in LAPACK errors like \"ZPOTRF fails\". These errors can be prevented using the two-step GW procedure as described below. Furthermore, one can \"ramp up\" NBANDS to the maximum value by repeatedly restarting the DFT calculation from a pre-converged\nWAVECAR\nwith fewer bands.\nFirst step: DFT calculation\nGW\ncalculations always require a one-electron basis set. Usually this set is obtained from a standard DFT calculation and written into the\nWAVECAR\nfile and can be calculated for instance the following INCAR file:\nSystem\n= SiC\nNBANDS\n= 512\nISMEAR\n= 0 ;\nSIGMA\n= 0.05  ! small sigma is required to avoid partial occupancies\nLOPTICS\n= .TRUE.\nNote, that a significant number of empty bands is required for\nGW\ncalculations, so that it might be better to perform the calculations in two steps: first a standard ground-state calculation with few unoccupied orbitals only,\nSystem\n= SiC ground-state occupied orbitals\nISMEAR\n= 0 ;\nSIGMA\n= 0.05  ! small sigma is required to avoid partial occupancies\nEDIFF\n= 1E-8               ! required tight tolerance for ground-state orbitals\nand, second, a calculation of a large number of unoccupied orbitals\nSystem\n= SiC unoccupied orbitals\nALGO\n= Exact               ! use exact diagonalization of the Hamiltonian\nNELM\n= 1                   ! since we are already converged stop after one step\nNBANDS\n= 512               ! maybe even larger\nISMEAR\n= 0 ;\nSIGMA\n= 0.05  ! small sigma is required to avoid partial occupancies\nLOPTICS\n= .TRUE.\nFurthermore, note that the flag\nLOPTICS\n=.TRUE. is required to write the file\nWAVEDER\n, which contains the derivative of the orbitals with respect to\nk\n.\nThis derivative is used to construct the head and wings of the dielectric matrix employing\nk\n·\np\nperturbation theory and is important to accelerate k-point convergence for insulators and semiconductors.\nWarning:\nFor metals, in general, we recommend omitting the\nLOPTICS\ntag and removing the\nWAVEDER\nfile from the directory.\nOptional: Use Hybrid functionals\nOptionally, one can start a\nGW\ncalculation from a\nhybrid functional\n, such as HSE.\nFor hybrid functionals, the two step procedure will accordingly involve the following\nINCAR\nfiles. In the first step, converged\nHSE03\norbitals are determined (see\nhere\nfor a selection of available hybrid functionals):\nSystem\n= SiC ground-state occupied orbitals\nISMEAR\n= 0 ;\nSIGMA\n= 0.05\nALGO\n= Damped ;\nTIME\n= 0.5  ! or\nALGO\n= Conjugate\nLHFCALC\n= .TRUE. ;\nAEXX\n= 0.25 ;\nHFSCREEN\n= 0.3\nEDIFF\n= 1E-6      ! required tight tolerance for ground-state orbitals\nSecondly, determine the HSE03 orbitals for unoccupied states:\nSystem\n= SiC unoccupied orbitals\nNBANDS\n= 512      ! maybe even larger\nALGO\n= Exact\nNELM\n= 1          ! since we are already converged stop after one step\nISMEAR\n= 0 ;\nSIGMA\n= 0.05\nLHFCALC\n= .TRUE. ;\nAEXX\n= 0.25 ;\nHFSCREEN\n= 0.3\nLOPTICS\n= .TRUE. # for insulators\nSecond step: GW calculation\nThe actual\nGW\ncalculation is done in a second step. Here different\nGW\nflavors are possible and are selected with the\nALGO\ntag.\nNote that as of VASP.6 the GW\nALGO\ntags have been renamed, see\nhere\nfor VASP.5.X tags.\nSingle shot quasiparticle energies: G\n0\nW\n0\nThis is the simplest\nGW\ncalculation and computationally the most efficient one.\nA single-shot calculation is often referred to as G\n0\nW\n0\nand calculates the quasiparticle energies from a single\nGW\niteration by neglecting all off-diagonal matrix elements of the self-energy and employing a Taylor expansion of the self-energy around the DFT energies\nE\nn\nq\n(\n0\n)\n{\\displaystyle E_{n{\\bf q}}^{(0)}}\n. The corresponding equation becomes\nE\nn\nq\n=\nE\nn\nq\n(\n0\n)\n+\nZ\nn\nq\n⟨\nϕ\nn\nq\n(\n0\n)\n|\nΣ\n(\nE\nn\nq\n(\n0\n)\n)\n−\nV\nx\nc\n|\nϕ\nn\nq\n(\n0\n)\n⟩\n{\\displaystyle\nE_{n{\\bf q}} = E_{n{\\bf q}}^{(0)} + Z_{n{\\bf q}} \\langle \\phi^{(0)}_{n{\\bf q}}| \\Sigma(E_{n{\\bf q}}^{(0)}) - V_{xc} |\\phi^{(0)}_{n{\\bf q}}\\rangle\n}\nwith the renormalization factor\nZ\nn\nq\n=\n1\n1\n−\nR\ne\n⟨\nϕ\nn\nq\n(\n0\n)\n|\nΣ\n′\n(\nE\nn\nq\n(\n0\n)\n)\n|\nϕ\nn\nq\n(\n0\n)\n⟩\n{\\displaystyle\nZ_{n{\\bf q}}=\\frac{1}{1-{\\rm Re}\\langle \\phi^{(0)}_{n{\\bf q}}| \\Sigma'(E_{n{\\bf q}}^{(0)}) | \\phi^{(0)}_{n{\\bf q}}\\rangle }\n}\nIn VASP, G\n0\nW\n0\ncalculations are selected using an\nINCAR\nfile such as\nSystem\n= SiC\nNBANDS\n= 512\nISMEAR\n= 0 ;\nSIGMA\n= 0.05\nNELMGW\n= 1 ! use NELM for VASP.6.2 and older\nALGO\n= EVGW0 ! use \"GW0\" for VASP.5.X\nNOMEGA\n= 50\nMind:\nConvergence with respect to the number of empty bands\nNBANDS\nand with respect to the number of frequencies\nNOMEGA\nmust be checked carefully.\nTo avoid complicated inter-nested tests, we recommend calculating all orbitals that the plane-wave basis set allows to calculate (except for simple tests). For further reading, please consult the section on\nENCUTGW\n.\nAfter a successful G\n0\nW\n0\nrun, VASP will write the quasiparticle energies into the\nOUTCAR\nfile for a set of\nNBANDSGW\nbands for every k-point in the Brillouin zone. Look for lines similar to\nQP shifts <psi_nk| G(iteration)W_0 |psi_nk>: iteration 1\nfor sc-GW calculations column KS-energies equals QP-energies in previous step\nand V_xc(KS)=  KS-energies - (<T + V_ion + V_H > + <T+V_H+V_ion>^1  + <V_x>^1)\nk-point   1 :       0.0000    0.0000    0.0000\nband No.  KS-energies  QP-energies   sigma(KS)   V_xc(KS)     V^pw_x(r,r')   Z            occupation Imag(sigma)\n1      -7.1627      -8.3040     -14.5626     -12.7276     -21.6682       0.6219       2.0000       1.2037\n2      -2.0901      -3.4347     -15.7660     -14.2799     -21.7439       0.9048       2.0000       0.6914\n3      -2.0901      -3.4347     -15.7660     -14.2799     -21.7439       0.9048       2.0000       0.6914\n4      -2.0901      -3.4347     -15.7660     -14.2799     -21.7439       0.9048       2.0000       0.6914\n5       0.4603      -0.4663     -13.7603     -12.5200     -18.1532       0.7471       2.0000       0.2167\n6       0.4603      -0.4663     -13.7603     -12.5200     -18.1532       0.7471       2.0000       0.2167\nThe first column is the band index and the third column denotes the quasiparticle energies\nE\nn\nq\n{\\displaystyle E_{n{\\bf q}}}\n. Column two, four, five and seven refer to the DFT energies\nE\nn\nq\n(\n0\n)\n{\\displaystyle E_{n{\\bf q}}^{(0)}}\n, diagonal matrix elements of the self-energy\n⟨\nϕ\nn\nq\n(\n0\n)\n|\nΣ\n(\nω\n=\nE\nn\nq\n(\n0\n)\n)\n|\nϕ\nn\nq\n(\n0\n)\n⟩\n{\\displaystyle \\langle \\phi^{(0)}_{n{\\bf q}}|\\Sigma(\\omega=E_{n{\\bf q}}^{(0)}) |\\phi^{(0)}_{n{\\bf q}}\\rangle}\n, the exchange-correlation potential\n⟨\nϕ\nn\nq\n(\n0\n)\n|\nV\nx\nc\n|\nϕ\nn\nq\n(\n0\n)\n⟩\n{\\displaystyle \\langle \\phi^{(0)}_{n{\\bf q}}|V_{xc} |\\phi^{(0)}_{n{\\bf q}}\\rangle}\nand the renormalization factor\nZ\nn\nq\n{\\displaystyle Z_{n{\\bf q}}}\ndefined above, respectively.\nPartially self-consistent calculations: EVGW\n0\nIn most cases, the\nbest\nresults (\ni.e.\n, closest to experiment) are obtained by iterating only\nG\n{\\displaystyle G}\nvia the spectral representation\nG\n(\ni\n)\n(\nr\n,\nr\n′\n,\nω\n)\n=\n∑\nn\nk\nϕ\nn\nk\n∗\n(\n0\n)\n(\nr\n)\nϕ\nn\nk\n(\n0\n)\n(\nr\n′\n)\nω\n−\nE\nn\nk\n(\ni\n)\n{\\displaystyle\nG^{(i)}({\\bf r},{\\bf r}',\\omega)=\\sum_{n{\\bf k}}\\frac{\\phi_{n{\\bf k}}^{*(0)}\n({\\bf r})\\phi^{(0)}_{n{\\bf k}}\n({\\bf r}')}{\\omega-E^{(i)}_{n{\\bf k}}}}\nbut keeping\nW\n{\\displaystyle W}\nand the orbitals\nϕ\nn\nq\n(\n0\n)\n{\\displaystyle \\phi^{(0)}_{n{\\bf q}}}\nfixed to the initial DFT level. This method goes back to Hybertsen and Louie\n[5]\nand can be achieved in two ways.\nIf the spectral method is not selected (\nLSPECTRAL\n=.FALSE., requiring much more compute time), the quasiparticle (QP) shifts are iterated automatically four times, and one finds four sets of QP shifts in the\nOUTCAR\nfile. The first one corresponds to the G\n0\nW\n0\ncase. The\nINCAR\nfile is simply:\nSystem\n= SiC\nNBANDS\n= 512\nISMEAR\n= 0 ;\nSIGMA\n= 0.05\nALGO\n= EVGW0 ! use \"GW0\" in VASP.5.X\nLSPECTRAL\n=.FALSE.\nTip:\nIn self-consistent GW calculations, convergence with the number of updated bands\nNBANDSGW\nmust be checked carefully.\nFor technical reasons, it is not possible to iterate\nG\n{\\displaystyle G}\nin this manner if\nLSPECTRAL\n=.TRUE. is set in the\nINCAR\nfile (this is the default). In this case, an iteration number must be supplied in the\nINCAR\nfile using the\nNELMGW\ntag. Usually, three to four iterations are sufficient to obtain accurate QP shifts.\nSystem\n= SiC\nNBANDS\n= 512\nISMEAR\n= 0 ;\nSIGMA\n= 0.05\nALGO\n= EVGW0 ! use \"GW0\" in VASP.5.X\nNELMGW\n= 4 ! use NELM in VASP.6.2 and older\nThe results are found again in the\nOUTCAR\nfile\nQP shifts <psi_nk| G(iteration)W_0 |psi_nk>: iteration 4\nk-point   1 :       0.0000    0.0000    0.0000\nband No. old QP-enery  QP-energies   sigma(KS)   T+V_ion+V_H  V^pw_x(r,r')   Z            occupation Imag(sigma)\n1      -8.6924      -8.7107     -14.2871       5.5647     -21.6681       0.6076       2.0000       1.1648\n2      -3.4692      -3.4806     -15.6742      12.1894     -21.7437       0.7304       2.0000       0.6351\n3      -3.4692      -3.4806     -15.6742      12.1894     -21.7437       0.7304       2.0000       0.6351\n4      -3.4692      -3.4806     -15.6742      12.1894     -21.7437       0.7304       2.0000       0.6351\n5      -0.6957      -0.7006     -13.6827      12.9802     -18.1531       0.7264       2.0000       0.2769\n6      -0.6957      -0.7006     -13.6827      12.9802     -18.1531       0.7264       2.0000       0.2769\n7      -0.6957      -0.7006     -13.6827      12.9802     -18.1531       0.7264       2.0000       0.2769\nIn contrast to single shot GW calculations, the second column represent now the QP-energies from the previous iteration.\nPartially self-consistent quasiparticle calculations: QPGW\n0\nIf non diagonal components of the self-energy (in the orbital basis) should be included use\nALGO\n=QPGW0. The following setting can be used:\nSystem\n= SiC\nNBANDS\n= 512\nISMEAR\n= 0 ;\nSIGMA\n= 0.05\nALGO\n= QPGW0 ! or \"scGW0\" for VASP.5.2.11 and older\nLOPTICS\n= .TRUE. ;\nLPEAD\n= .TRUE. ! ommit this lines for metals\nNELMGW\n= 4 ! use NELM for VASP.6.2 and older\nIn this case, the orbitals are updated as well by constructing a hermitian (energy independent) approximation to the self-energy\n[3]\n. The \"static\" COHSEX approximation can be selected by setting\nNOMEGA\n= 1\n[6]\n. To improve convergence to the ground-state, the charge density (and the charge density only) is mixed using a Kerker type mixing in VASP.5.3.2 and more recent versions (see\nIMIX\n). The mixing parameters\nAMIX\n,\nBMIX\n,\nAMIX_MAG\n,\nBMIX_MAG\n,\nAMIN\ncan be adjusted, if convergence problems are encountered.\nWe strongly urge the user to monitor convergence by inspecting the lines\ncharge density residual\nin the\nOUTCAR\nfiles.\nAlternatively, the mixing may be switched off by setting\nIMIX\n=0 and controlling the step width for the orbitals using the parameter\nTIME\n(which defaults to 0.4). This selects a fairly sophisticated damped MD algorithm that is also used for DFT methods when\nALGO\n=Damped. This method is generally more reliable for metals and materials with strong charge sloshing.\nAfter every iteration, VASP writes the following lines into the\nOUTCAR\nfile\nQP shifts <psi_nk| G(iteration)W_0 |psi_nk>: iteration 1\nGWSYM:  cpu time   15.8978: real time   15.9528\nk-point   1 :       0.0000    0.0000    0.0000\nband No. DFT-energies  QP-energies  QP-e(diag)   sigma(DFT)    Z            occupation\n1      -7.1626      -8.4217      -8.3038      -8.9978       0.6219       2.0000\n2      -2.0899      -3.4394      -3.4347      -3.5765       0.9047       2.0000\n3      -2.0899      -3.4394      -3.4347      -3.5765       0.9047       2.0000\n4      -2.0899      -3.4394      -3.4347      -3.5765       0.9047       2.0000\n5       0.4604      -0.4787      -0.4663      -0.7800       0.7471       2.0000\n6       0.4604      -0.4787      -0.4663      -0.7800       0.7471       2.0000\n7       0.4604      -0.4787      -0.4663      -0.7800       0.7471       2.0000\n8       5.1013       4.1883       4.2149       3.9518       0.7711       2.0000\nFor the first iteration, here, the fourth column should be identical to the third column of the G\n0\nW\n0\nresults discussed above. The third column reports the quasiparticle energies obtained from including the off-diagonal matrix elements in the eigenvalue equation.\nCaveats\nThe\nQPGW0\n(or\nscGW0\nin VASP.5.2.11 and older) must be used with great caution, particularly in combination with symmetry.\nSymmetry is handled in a rather sophisticated manner. Specifically, only the minimal number of required combinations of\nq\nand\nk\npoints is considered. In this case, symmetry must be applied to restore the full star of\nq\n. This is done by determining degenerate eigenvalue/eigenvector pairs and restoring their symmetry according to their irreducible representation. Although the procedure is generally relatively reliable, it fails to work properly if the degenerate states do not possess eigenvalues that are sufficiently close due to insufficient convergence in the preceding DFT calculations. That is because states are treated as degenerate if, and only if, their eigenenergies are within 0.01 eV.\nFor large supercells with low symmetry, we strongly recommend switching off symmetry.\nSelf-consistent EVGW and QPGW calculations\nSelf-consistent\nQPGW\ncalculations are only supported in a QP picture. As for\nQPGW\n0\n, it is possible to update the eigenvalues only (\nALGO\n=\nEVGW\nor\nGW\nfor VASP.5.X), or the eigenvalues and one-electron orbitals (\nALGO\n=\nQPGW\nor\nscGW\nin VASP.5.2.11 and older). In all cases, a QP picture is maintained,\ni.e.\n, satellite peaks (shake ups and shake downs) can not be accounted for in the self-consistency cycle. Self-consistent\nQPGW\ncalculations can be performed by simply repeatedly calling VASP using:\nSystem\n= SiC\nNBANDS\n= 512\nISMEAR\n= 0 ;\nSIGMA\n= 0.05\nALGO\n= EVGW    ! \"GW\" in VASP.5.X, eigenvalues only  or alternatively\nALGO\n= QPGW    ! \"scGW\" in VASP.5.2.11 and older, eigenvalues and one electron orbitals\nFor QPGW0 or QPGW, nondiagonal terms in the Hamiltonian are accounted for,\ne.g.\nthe linearized QP equation is diagonalized, and the one-electron orbitals are updated\n[3]\n.\nAlternatively (and preferably), the user can specify an electronic iteration counter using\nNELMGW\n(\nNELM\nin VASP.6.2 and older):\nSystem\n= SiC\nNBANDS\n= 512\nISMEAR\n= 0 ;\nSIGMA\n= 0.05\nNELMGW\n= 3   ! use NELM in VASP.6.2 and older\nALGO\n= EVGW  ! \"GW\" in VASP.5.X\n# or\nALGO\n= QPGW  ! \"scGW\" in VASP.5.2.11 and older\nIn this case, the one-electron energies (=QP energies) are updated 3 times (starting from the DFT eigenvalues) in both G and W. For\nALGO\n=\nQPGW\n(or\nALGO\n=\nscGW\nin VASP.5.2.11 and older), the one electron energies and one electron orbitals are updated 3 times\n[3]\n. As for\nALGO\n=\nQPGW0\n(or\nscGW0\nin vasp.5.2.11 and older), the \"static\" COHSEX approximation can be selected by setting\nNOMEGA\n=1\n[6]\n.\nTo improve convergence to the ground-state, the charge density is mixed using a Kerker type mixing starting with VASP.5.3.2 (see\nIMIX\n). The mixing parameters\nAMIX\n,\nBMIX\n,\nAMIX_MAG\n,\nBMIX_MAG\n,\nAMIN\ncan be adjusted, if convergence problems are encountered.\nAlternatively, the mixing may be switched off by setting\nIMIX\n=0 and controlling the step width for the orbitals using the parameter\nTIME\n(which defaults to 0.4). This selects a fairly sophisticated damped MD algorithm that is also used for DFT methods when\nALGO\n=Damped. This method is generally more reliable for metals and materials with strong charge sloshing.\nAdditional information about this method is found\nhere\n.\nCaveats\nFully self-consistent QPGW calculations with an update of the orbitals in\nG\n{\\displaystyle G}\nand\nW\n{\\displaystyle W}\n[3]\nrequire significant care and are prone to diverge (QPGW0 calculations are usually less critical). As discussed, above, one can select this mode using:\nSystem\n= SiC\nNBANDS\n= 512\nISMEAR\n= 0 ;\nSIGMA\n= 0.05\nALGO\n= QPGW  ! or \"scGW\" in VASP.5.2.11 and older, eigenvalues and one-electron orbitals\nNELMGW\n= number of steps ! use NELM for VASP.6.2 and older\nHowever, one\ncaveat\napplies to this case: when the orbitals are updated, the derivatives of the orbitals with respect to\nk\n{\\displaystyle k}\n(stored in the\nWAVEDER\nfile) will become incompatible with the orbitals.\nThis can cause severe problems and convergence to the incorrect solution.\nWarning:\nFor metals, in general, we recommend omitting the\nLOPTICS\ntag and removing the\nWAVEDER\nfile from the directory.\nFor insulators, VASP (version 5.3.2 or higher) can update the\nWAVEDER\nfile in each electronic iteration if the finite difference method is used to calculate the first derivative of the orbitals with respect to\nk\n{\\displaystyle  k }\n:\nSystem\n= SiC\nNBANDS\n= 512\nISMEAR\n= 0 ;\nSIGMA\n= 0.05\nALGO\n= QPGW ! \"scGW\" in VASP.5.2.11 and older, eigenvalues and one-electron orbitals\nNELMGW\n= 10 ! use NELM in VASP.6.2 and older\nLOPTICS\n= .TRUE. ;\nLPEAD\n= .TRUE.\nThe combination\nLOPTICS\n=.TRUE.;\nLPEAD\n=.TRUE.\nis required since\nδ\nH\n−\nϵ\nn\nk\nS\nδ\nk\ni\n{\\displaystyle \\frac{\\delta H-\\epsilon_{n{\\bf k}}S}{\\delta {k}_i}}\nis not available for\nGW\nlike methods.\nLPEAD\n=.TRUE. circumvents this problem by calculating the derivatives of the orbitals using numerical differentiation on the finite k-point grid (this option is presently limited to insulators).\nVertex corrections are presently not documented. This is a feature still under construction, and we recommend collaborating with the Vienna group if you desperately need that feature.\nLow scaling GW algorithms\nThe GW implementations in VASP described in the papers of Shishkin\net al.\n[1]\n[2]\navoids storage of the Green's function\nG\n{\\displaystyle G}\nas well as Fourier transformations between time and frequency domain entirely. That is, all calculations are performed solely on the real frequency axis using Kramers-Kronig transformations for convolutions in the equation of\nχ\n{\\displaystyle \\chi}\nand\nΣ\n{\\displaystyle \\Sigma}\nin reciprocal space.\nAs of VASP.6 a new cubic scaling GW algorithm\n[7]\n(called space-time implementation in the following) can be selected. This approach follows the idea of Rojas\net al.\n[8]\nand performs the GW self-consistency cycle on imaginary time\nt\n→\ni\nτ\n{\\displaystyle t\\to i\\tau}\nand imaginary frequency axes\nω\n→\ni\nω\n{\\displaystyle \\omega\\to i\\omega}\n.\nTip:\nUsing the low-scaling GW algorithm also calculates the total energy in the Random Phase approximation (RPA), which is described in a\nseparate article\n.\nLow scaling, single shot GW calculations: G\n0\nW\n0\nR\nThe low-scaling analogue of G\n0\nW\n0\nis selected with\nALGO\n=G0W0R.\nIn contrast to the\nsingle-shot GW calculations on the real-axes\n,\nhere the self-energy\nΣ\n=\nG\n0\nW\n0\n{\\displaystyle \\Sigma = G_0 W_0 }\nis determined on the imaginary frequency axis.\nTo this end, the overall scaling is reduced by one order of magnitude and is cubic with respect to the system size,\nbecause a small value for\nNOMEGA\ncan be used (usually <20).\nThis algorithm evaluates:\nSingle-shot GW quasiparticle energies (from an analytical continuation of the self-energy to the real axis)\n[7]\nNatural orbitals from the first order change of the density matrix (i.e.\nG\n0\nΣ\nG\n0\n{\\displaystyle G_0 \\Sigma G_0}\n), see the\nNATURALO\ntag for more information\n[9]\n.\nMind:\nThis selection ignores\nNELMGW\n.\nFollowing\nINCAR\nfile selects the low-scaling GW algorithm:\nSystem\n= SiC\nISMEAR\n= 0 ;\nSIGMA\n= 0.05\nLOPTICS\n= .TRUE.\nALGO\n= G0W0R\nNOMEGA\n= 12 ! small number of frequencies necessary\nSearch the\nOUTCAR\nfile for the following lines\nQP shifts evaluated in KS or natural orbital/ Bruckner basis\nk-point   1 :       0.0000    0.0000    0.0000\nband No.  KS-energies   sigma(KS)    QP-e(linear)    Z         QP-e(zeros)     Z        occupation    Imag(E_QP)    QP_DIFF TAG\n1      -7.1627      -8.6732      -8.2451       0.7166      -8.2346       0.7026       2.0000      -1.3101       0.0000   2\n2      -2.0901      -3.4155      -3.0350       0.7129      -3.0272       0.7011       2.0000      -0.5582      -0.0000   2\n3      -2.0901      -3.4155      -3.0350       0.7129      -3.0272       0.7011       2.0000      -0.5582       0.0000   2\n4      -2.0901      -3.4155      -3.0350       0.7129      -3.0272       0.7011       2.0000      -0.5582      -0.0000   2\n5       0.4603      -0.8219      -0.4904       0.7414      -0.4814       0.7273       2.0000      -0.1902       0.0000   2\n6       0.4603      -0.8219      -0.4904       0.7414      -0.4814       0.7273       2.0000      -0.1902      -0.0000   2\nHere column four is obtained by a linearization of the self-energy around the Kohn-Sham energies (second column) and can be compared to the third column of\nsingle-shot GW calculations on the real axis\n.\nColumn six represents another set of QP-energies that is obtained from the roots of the following equation\n⟨\nϕ\nn\nq\n(\n0\n)\n|\nT\n+\nV\ne\nx\nt\n+\nV\nh\n+\nΣ\n(\nω\n)\n|\nϕ\nn\nq\n(\n0\n)\n⟩\n−\nω\n=\n0\n{\\displaystyle\n\\langle \\phi^{(0)}_{n{\\bf q}}| T + V_{ext}+V_h+ \\Sigma(\\omega) | \\phi^{(0)}_{n{\\bf q}}\\rangle -\\omega =0\n}\nThese roots represent the poles of the Green's function in the spectral representation.\nOutput description\nThe meaning of each column is explained briefly in the following.\nband No.\nthe band index of KS orbital at given k-point\nKS-energies\neigenenergies corresponding to band index\nsigma(KS)\ndiagonal matrix elements of self-energy evaluated at KS energies\nQP-e(linear)\nquasiparticle energies obtained from linearizing frequency dependence of diagonal self-energy around KS energies\nZ\nrenormalization factor obtained from five-point stencil for derivative of self-energy w.r.t. frequency\nQP-e(zeros)\nquasiparticle energies obtained from full frequency dependence of self-energy, i.e. real part of complex pole\nω\n{\\displaystyle \\omega}\nof Green's function\nZ\nrenormalization factor obtained from central difference for derivative of self-energy w.r.t. frequency\noccupation\noccupation number for band at given k-point\nImag(E_QP)\nimaginary part of complex pole\nω\n{\\displaystyle \\omega}\n, i.e. measure for inverse lifetime of quasi-particle\nQP_DIFF\ndifference of QP energies (of linearized self-energy) obtained from Eq. 77 of Liu et. al.\n[7]\nand M. Grumets thesis\n[10]\n.\nOptional: RPA Forces\nOptionally, RPA forces can be calculated by adding following line to the\nINCAR\n:\nLRPAFORCE\n= .TRUE.\nAfter the QP-energies, VASP performs a linear-response calculation that is required for the RPA forces.\n[11]\nFollowing data block in the\nOUTCAR\nfile can be found after a successful run:\nPOSITION                                       TOTAL RPA FORCE (eV/Angst)\n-----------------------------------------------------------------------------------\n0.17542     -0.22348      0.17542        -0.292069      7.581315     -0.292069\n1.12850      1.31044      1.12850         0.304683     -7.605527      0.304683\n-----------------------------------------------------------------------------------\ntotal drift:                                0.012614     -0.024212      0.012614\nSUGGESTED UPDATED POSCAR (direct coordinates)  step\n-----------------------------------------------------------------------------------\n-0.00958461  -0.00958461   0.13485779         0.04179056   0.04179056   0.00283088\n0.25787833   0.25787833   0.22191754        -0.04337198  -0.04337198   0.00431513\nTip:\nUse\nLFOCKSTD\nto improve total energies and RPA forces as of version 6.5.2.\nWarning:\nCurrently RPA forces for metallic systems are not supported.\nLow scaling, partially self-consistent GW calculations: EVGW\n0\nR\nMind:\navailable as of vasp 6.4.0\nThe low-scaling analogue of EVGW\n0\nis selected with\nALGO\n=EVGW0R.\nFollowing\nINCAR\nfile selects this algorithm:\nSystem\n= SiC\nISMEAR\n= 0 ;\nSIGMA\n= 0.05\nLOPTICS\n= .TRUE.\nALGO\n= EVGW0R\nNELMGW\n= 4  ! number of iterations in G\nNOMEGA\n= 12 ! small number of frequencies necessary\nAfter each iteration, a similar block of data as for\nALGO\n=G0W0R calculations is written to\nOUTCAR\nshowing the\nNBANDSGW\nupdated quasi-particle energies (poles) of the Green's function.\nPartially self-consistent GW calculations: GW\n0\nR\nThe space-time implementation allows for true self-consistent GW calculations. That is, the solution of the Dyson equation for the Green's function can be obtained with a modest computational effort. The main procedure of a self-consistent GW calculation consists of four main steps\nObtain Green's function\nG\nG\nG\n′\n(\nj\n)\n(\nq\n,\ni\nω\nn\n)\n=\n[\nδ\nG\nG\n′\n−\nΣ\nG\nG\n′\n(\nj\n−\n1\n)\n(\nq\n,\ni\nω\nn\n)\nG\nG\nG\n′\n(\nj\n−\n1\n)\n(\nq\n,\ni\nω\nn\n)\n]\n−\n1\nG\nG\nG\n′\n(\nj\n−\n1\n)\n(\nq\n,\ni\nω\nn\n)\n{\\displaystyle  G^{(j)}_{\\bf G G'}({\\bf q},i\\omega_n) = \\left[ \\delta_{\\bf GG'} - \\Sigma^{(j-1)}_{\\bf GG'}({\\bf q},i\\omega_n)G^{(j-1)}_{\\bf G G'}({\\bf q},i\\omega_n)\\right]^{-1}G^{(j-1)}_{\\bf G G'}({\\bf q},i\\omega_n)}\nCompute irreducible polarizability\nχ\n(\nj\n)\n(\nr\n,\nr\n′\n,\ni\nτ\nm\n)\n=\n−\nG\n(\nj\n)\n(\nr\n,\nr\n′\n,\ni\nτ\nm\n)\nG\n(\nj\n)\n(\nr\n′\n,\nr\n,\n−\ni\nτ\nm\n)\n{\\displaystyle   \\chi^{(j)}({\\bf r},{\\bf r}',i\\tau_m) = -G^{(j)}({\\bf r},{\\bf r}',i\\tau_m)G^{(j)}({\\bf r}',{\\bf r},-i\\tau_m) }\nDetermine screened potential\nW\nG\nG\n′\n(\nj\n)\n(\nq\n,\nω\nm\n)\n=\n[\nδ\nG\nG\n′\n−\nχ\nG\nG\n′\n(\nj\n)\n(\nq\n,\nω\nm\n)\nV\nG\nG\n′\n(\nq\n)\n]\n−\n1\nV\nG\nG\n′\n(\nq\n)\n{\\displaystyle W^{(j)}_{{\\bf G}{\\bf G}'}({\\bf q},\\omega_m)=\\left[\\delta_{{\\bf G}{\\bf G}'}-\\chi^{(j)}_{{\\bf G}{\\bf G}'}({\\bf q},\\omega_m)V_{{\\bf G}{\\bf G}'}({\\bf q})\\right]^{-1}V_{{\\bf G}{\\bf G}'}({\\bf q})}\nCalculate GW self-energy\nΣ\n(\nj\n)\n(\nr\n,\nr\n′\n,\ni\nτ\nm\n)\n=\n−\nG\n(\nj\n)\n(\nr\n,\nr\n′\n,\ni\nτ\nm\n)\nW\n(\nj\n)\n(\nr\n′\n,\nr\n,\ni\nτ\nm\n)\n{\\displaystyle   \\Sigma^{(j)}({\\bf r},{\\bf r}',i\\tau_m) =- G^{(j)}({\\bf r},{\\bf r}',i\\tau_m)W^{(j)}({\\bf r}',{\\bf r},i\\tau_m) }\nThis procedure can be selected with the following\nINCAR\nsettings\nSystem\n= SiC\nISMEAR\n= 0 ;\nSIGMA\n= 0.05\nLOPTICS\n= .TRUE. ;\nLPEAD\n= .TRUE.\nNELMGW\n= number of iterations wanted ! NELM in 6.2 and older\nALGO\n= GW0R ! ALGO = scGW0R has the same effect here, that is self-consistency in G, no update in W\nThe number of self-consistency steps can be set with the\nNELMGW\ntag.\nDue to efficiency, VASP performs each step in the Hartree-Fock basis. This is the reason why there are two sets of QP-energies found after the first iteration (one for the QP-energies in the KS-basis and one for the QP energies in the HF basis)\nAfter the second iteration, only the QP energies obtained in the HF basis are printed, and a similar output as follows is found in the\nOUTCAR\nfile\nQP shifts evaluated in HF basis\nk-point   1 :       0.0000    0.0000    0.0000\nband No.  KS-energies   sigma(KS)    QP-e(linear)    Z         QP-e(zeros)     Z        occupation    Imag(E_QP)    QP_DIFF TAG\n1      -7.1626      -8.6510      -8.2275       0.7154      -8.2173       0.7017       2.0000      -1.3177       0.0000   2\n2      -2.0899      -3.4157      -3.0348       0.7127      -3.0269       0.7008       2.0000      -0.5614       0.0000   2\n3      -2.0899      -3.4157      -3.0348       0.7127      -3.0269       0.7008       2.0000      -0.5614      -0.0000   2\n4      -2.0899      -3.4157      -3.0348       0.7127      -3.0269       0.7008       2.0000      -0.5614       0.0000   2\n5       0.4604      -0.8170      -0.4857       0.7407      -0.4768       0.7266       2.0000      -0.1945       0.0000   2\n6       0.4604      -0.8170      -0.4857       0.7407      -0.4768       0.7266       2.0000      -0.1945      -0.0000   2\n7       0.4604      -0.8170      -0.4857       0.7407      -0.4768       0.7266       2.0000      -0.1945       0.0000   2\n8       5.1013       4.0069       4.2594       0.7693       4.2645       0.7598       2.0000      -0.0602       0.0000   2\nHere the meaning of each column is the same as for the other low-scaling GW algorithms.\nFully self-consistent GW caluclations: GWR\nIf the screened potential should be updated during the self-consistency circle\n[12]\nthe following\nINCAR\nfile can be used\nSystem\n= SiC\nISMEAR\n= 0 ;\nSIGMA\n= 0.05\nLOPTICS\n= .TRUE. ;\nLPEAD\n= .TRUE.\nNELMGW\n= number of iterations wanted ! use NELM in VASP.6.2 and older\nALGO\n= GWR ! ALGO = scGWR has the same effect here, that is self-consistency in G and W\nThe output is similar to partially self-consistent GW calculations, with the difference that\nKS-energies\nare replaced by the QP energies from previous iteration.\nCaveats\nUsing this option, similar caveats can be expected as for\nALGO\n=\nEVGW\nand\nQPGW\ncalculations and we recommend to leave out the\nLOPTICS\nand\nLPEAD\nline for metals.\nThe cubic scaling space-time GW algorithm requires considerably more memory than the corresponding quartic-scaling implementations, two Green's functions\nG\n(\nr\n,\nr\n′\n,\ni\nτ\nn\n)\n{\\displaystyle G({\\bf r,r'},i\\tau_n)}\nhave to be stored in real-space. To reduce the memory overhead, VASP exploits Fast Fourier Transformations (FFT) to avoid storage of the matrices on the (larger) real space grid, on the one hand. The precision of the FFT can be selected with\nPRECFOCK\n, where usually the values\nFast\nsufficient.\nOn the other hand, the code avoids storage of redundant information, i.e., both the Green's function and polarizability matrices are distributed as well as the individual imaginary grid points. The distribution of the imaginary grid points can be set by hand with the\nNTAUPAR\nand\nNOMEGAPAR\ntags, which splits the imaginary grid points\nNOMEGA\ninto\nNTAUPAR\ntime and\nNOMEGAPAR\ngroups. For this purpose both tags have to be divisors of\nNOMEGA\n.\nThe default values are usually reasonable choices provided the tag\nMAXMEM\nis set correctly and we strongly recommend to set\nMAXMEM\ninstead of\nNTAUPAR\n.\nImportant:\nAs of version 6.2,\nMAXMEM\nis estimated automatically (if not set) from the \"MemAvailable\" entry of the Linux kernel in \"/proc/meminfo\".\nThe required storage for a low-scaling RPA or GW calculation depends mostly on\nNTAUPAR\n, the number of MPI groups that share same imaginary time points. A rough estimate for the required bytes is given by\n(NGX*NGY*NGZ)*(NGX_S*NGY_S*NGZ_S) / ( NCPU  /\nNTAUPAR\n) * 16\nwhere \"NCPU\" is the number of MPI ranks used for the job,\"NGX,NGY,NGZ\" denotes the number of FFT grid points for the exact exchange and  \"NGX_S,NGY_S,NGZ_S\" the number of FFT grid points for the supercell. Note, both grids are written to the\nOUTCAR\nfile after the lines\nFFT grid for exact exchange (Hartree Fock)\nFFT grid for supercell:\nThe smaller\nNTAUPAR\nis set, the less memory per node the job requires to finish successfully.\nThe approximate memory requirement is calculated in advance and printed to screen and\nOUTCAR\nas follows:\nmin. memory requirement per mpi rank 1234 MB, per node 9872 MB\nRelated tags and articles\nALGO\nfor response functions and\nGW\ncalculations\nLOPTICS\n, derivative of wavefunction w.r.t.\nk\n{\\displaystyle k}\nLPEAD\n, derivative of wavefunction with finite differences\nLMAXFOCKAE\noverlap densities and multipoles\nMAXMEM\n, memory available to one mpi rank on each node\nNOMEGA\n,\nNOMEGAR\nnumber of frequency points\nLSPECTRAL\n, use the spectral method for the polarizability\nLSPECTRALGW\n, use the spectral method for the self-energy\nOMEGAMAX\n,\nOMEGATL\nand\nCSHIFT\nENCUTGW\n, energy cutoff for response function\nENCUTGWSOFT\n, soft cutoff for Coulomb kernel\nODDONLYGW\nand\nEVENONLYGW\n, reducing the\nk\n-grid for the response functions\nLSELFENERGY\n, the frequency dependent self energy\nLWAVE\n, self-consistent\nGW\nNOMEGAPAR\n, frequency grid parallelization\nNTAUPAR\n, time grid parallelization\nNATURALO\n, natural orbitals\nLALL_IN_ONE\n, all-in-one\nGW\nmode\nIALL_IN_ONE\n, all-in-one\nGW\nmode\nNBANDSEXACT\n, number of KS bands in all-in-one mode\nNBANDS_WAVE\n, number of bands written to\nWAVECAR\nin all-in-one mode\nLSINGLES\n, singles contribution to correlation energy\nLFOCKSTD\nexact one-centre terms in EXX part of total energy and RPA forces\nExamples that use this tag\nReferences\n↑\na\nb\nM. Shishkin and G. Kresse, Phys. Rev. B\n74\n, 035101 (2006).\n↑\na\nb\nM. Shishkin and G. Kresse, Phys. Rev. B\n75\n, 235102 (2007).\n↑\na\nb\nc\nd\ne\nM. Shishkin, M. Marsman, and G. Kresse, Phys. Rev. Lett.\n99\n, 246403 (2007).\n↑\nF. Fuchs, J. Furthmüller, F. Bechstedt, M. Shishkin, and G. Kresse, Phys. Rev. B\n76\n, 115109 (2007).\n↑\nM. S. Hybertsen and S. G. Louie, Phys. Ref. B\n34\n, 5390 (1986).\n↑\na\nb\nF. Bruneval, N. Vast, and L. Reining, Phys. Rev. B\n74\n, 45102 (2006).\n↑\na\nb\nc\nP. Liu, M. Kaltak, J. Klimes, and G. Kresse, Phys. Rev. B\n94\n, 165109 (2016).\n↑\nH. N. Rojas, R. W. Godby, and R. J. Needs, Phys. Rev. Lett.\n74\n, 1827 (1995).\n↑\nB. Ramberger, Z. Surkuma, T. Schäfer, and G. Kresse, J. Chem. Phys.\n151\n, 214106 (2019).\n↑\nM. Grumet, Thesis: Self-consistent GW calculations for solids(2017).\n↑\nB. Ramberger, T. Schäfer and G. Kresse, Phys. Rev. Lett\n118\n, 106403 (2017).\n↑\nM. Grumet, P. Liu, M. Kaltak, J. Klimeš, and G. Kresse, Phys. Rev. B\n98\n, 155143 (2018)."
  }, 
  "Preparing a POTCAR": {
    "description": "The web page explains how to select and prepare a VASP POTCAR file containing pseudopotentials for each element in a structure, emphasizing considerations such as exchange-correlation functionals, accuracy requirements, and proper ordering of elements to ensure compatibility with the POSCAR file.", 
    "detailed_description": "The\nPOTCAR\nfile is a mandatory\ninput file\nthat holds the\npseudopotential\nfor each element in the structure. The templates for each element can be downloaded from the\nVASP Portal\n.\nThere are sometimes multiple templates for one element with subtle differences.\nStep-by-step instructions\nStep 1:\nSelect the\nlatest version\nof\nPOTCAR\nfiles unless you need to use an older one to reproduce a result.\nStep 2:\nChoose\nstandard potentials\nfor calculations depending mainly on occupied states, e.g., within density-functional theory, using\nhybrid functionals\n, or\nGW variants\nif the calculation requires high accuracy for unoccupied states, i.e., for\noptical response\nand\nmany-body perturbation theory\n.\nStep 3:\nSelect a\nPOTCAR\nfor a certain family of\nexchange-correlation (XC) functionals\n.\nTip:\nThe standard choice is to use the\nPBE version\nbased on\nLEXCH\n=PE which has a high transferability to other\nXC functionals\n.\nAll potentials are constructed based on solving the scalar relativistic Schrödinger equation for a reference system with a certain\nXC functional\n. In most versions, one set is available for the LDA, and one for the GGA. The transferability to other\nXC functionals\nis seamless by specifying the\nXC\ntag in the\nINCAR\n.\nStep 4 (optional):\nChoose a\ndifferent variant (reference atomic valence configuration, etc.) specified by the suffix\n.\nTip:\nThe standard choice is to use the bold version in the\nlist of PAW potentials\n.\nSee\nchoosing pseudopotentials\n.\nImportant:\nGenerally opt for the recommended\nPOTCAR\nfiles, but test if the property of interest is sensitive to the choice of the pseudopotential. It may be possible to choose a computationally cheaper version or necessary to select a more demanding one.\nStep 5:\nFor a single element in the structure, you can copy the\nPOTCAR\nto the working directory, e.g,\ncp /path/to/pot/Al/POTCAR .\nFor structures with multiple elements, the selected\nPOTCAR\nfiles must be concatenated to create one\nPOTCAR\nfile containing all species present in the structure. Combine the potentials by entering, for instance,\ncat /path/to/pot/Al/POTCAR /path/to/pot/C/POTCAR /path/to/pot/H/POTCAR > POTCAR\nThe order of the potentials must correspond to the order of the species in the\nPOSCAR\nfile.\nTip:\nIf species names are given in the\nPOSCAR\n, and the order does not match the order in the\nPOTCAR\n, a warning is printed, but VASP will still run.\nRecommendations and advice\nImportant:\nExcept for the 1st-row elements, all PAW potentials are designed to work at an energy cutoff (\nENMAX\ntag in the\nPOTCAR\n) of roughly 250 eV. This is a key aspect of making the calculation computationally cheap. We recommend performing a convergence study of the quantity of interest with respect to the energy cutoff (\nENCUT\ntag in the\nINCAR\n).\nMind:\nMismatched order of species in the\nPOSCAR\nand\nPOTCAR\nfiles is a common mistake! Add species names to your\nPOSCAR\nto receive a warning if this happens.\nMind:\nYou can mix and match\nPOTCAR\nfamilies. Even combining pseudopotentials generated with different\nXC functionals\nis possible, however make sure to specify the\nXC functional\nin the\nINCAR\n, see\nXC\n.\nExample for preparing a\nPOTCAR\nfor the Heusler alloy TiCo\n2\nSi\nIn this example, we want to prepare a\nPOTCAR\nfor a PBE calculation of ferromagnetic TiCo\n2\nSi. We are interested in the energy difference between the ferromagnetic and the nonmagnetic solutions.\nThe structure is defined by the following\nPOSCAR\n:\nTiCo2Si\n1.0\n0.0000000000000000    2.8580789844367893    2.8580789844367893\n2.8580789844367893    0.0000000000000000    2.8580789844367893\n2.8580789844367893    2.8580789844367893    0.0000000000000000\nCo Si Ti\n2  1  1\ndirect\n0.7500000000000000    0.7500000000000000    0.7500000000000000 Co\n0.2500000000000000    0.2500000000000000    0.2500000000000000 Co\n0.0000000000000000    0.0000000000000000    0.0000000000000000 Si\n0.5000000000000000    0.5000000000000000    0.5000000000000000 Ti\nWe will use the potpaw_PBE.64 potential set, and since we are interested in small energy differences caused by different magnetic solutions, we should use potentials with additional semicore-states in the valence for the 3d metals. The Co_pv and Ti_sv potentials seem appropriate for the transition metals. We do not expect Si to become magnetic and are not interested in unoccupied states, so the Si potential is a good choice compared to the harder, computationally more demanding Si_GW or even Si_sv_GW.\nOn a UNIX machine, one can use the\ncat\ncommand to concatenate files together. One can redirect the output from\nstdout\nto a file using the\n>\noperator. The order in the\nPOSCAR\ndictates the order in the\nPOTCAR\n:\ncat ~/potpaw_PBE.64/Co_pv/POTCAR ~/potpaw_PBE.64/Si/POTCAR ~/potpaw_PBE.64/Ti_sv/POTCAR > ~/scratch/TiCo2Si/POTCAR\nRelated tags and sections\nAvailable potentials\n,\nPOTCAR\n,\nChoosing pseudopotentials\n,\nProjector-augmented-wave formalism"
  }, 
  "Preparing a Super Cell": {
    "description": "This tutorial demonstrates how to create a super cell from a smaller cell using p4vasp by multiplying the cell in each direction and saving the new system.", 
    "detailed_description": "Overview\n>\nInput\n>\nPreparing a Super Cell\n>\nOutput\n>\nList of tutorials\nTask\nThis tutorial shows how to get\nPOSCAR\nfiles containing a super cell from an initially smaller cell.\nSuper cells from p4vasp\nOpen p4vasp by typing\np4v\non the terminal.\nLoad the primitive cell by clicking on\nFile\n→\nLoad system\n:\nMultiply cell in each direction (enter 3 for each direction) by clicking on\nEdit\n→\nMultiply Cell\n:\nSave new system by clicking on\nFile\n→\nSave system as\n:\nOverview\n>\nInput\n>\nPreparing a Super Cell\n>\nOutput\n>\nList of tutorials"
  }, 
  "Pulay stress": {
    "description": "Pulay stress is an unphysical stress that arises in computational materials science due to an insufficiently converged basis set, leading to inaccuracies in volume relaxation and distorted energy-volume curves, which can be mitigated by using a sufficiently high plane-wave energy cutoff and proper k-point sampling.", 
    "detailed_description": "Pulay stress is unphysical stress resulting from unconverged calculations with respect to the basis set. It distorts the cell structure, decreasing it from the equilibrium volume and creating difficulties in volume relaxation. The resultant energy vs. volume curves, cf. Figure 1 (top), are jagged and special care must be taken to obtain reasonable structures, cf.\nVolume relaxation\n. In this article, the computational origin of this is discussed.\nFigure 1. Total energy (left y-axis) and absolute pressure (right y-axis) vs. lattice parameter. Equilibrium lattice parameters for energy and pressure are shown. These coincide when Pulay stress is eliminated. ENCUT = 250 eV (top - unconverged) and 540 eV (bottom - converged). Diamond in a primitive cell - 2x2x2 k-point mesh.\nIt is important to note that problems due to the Pulay stress can often be neglected if only volume-conserving relaxations are performed. This is because the Pulay stress is, usually, nearly uniform and only changes the diagonal elements of the stress tensor by a constant amount.\nIntroduction\nThe energy for a periodic system, e.g., band structures, is calculated using a finite number of plane waves and a finite number of k-points. A fixed number of plane waves or plane-wave energy cutoff may be used to set a constant basis\n[1]\n. In VASP, a constant energy cutoff is used, cf.\nENCUT\n. The number of plane waves\nN\nPW\n(Note: the number of plane waves in VASP can be found using by searching for\nNPLWV\nin the\nOUTCAR\nfile) is related to the energy cutoff\nE\ncutoff\nand the size of the cell\nΩ\n0\n:\nN\nP\nW\n∝\nΩ\n0\nE\nc\nu\nt\no\nf\nf\n3\n/\n2\n{\\displaystyle  N_{PW} \\propto\\ \\Omega_0\\ E_{cutoff}^{3/2} }\nN\nPW\nis constant in a relaxation calculation, which means that\nE\ncutoff\nmust change to compensate for changes in\nΩ\n0\n. All the initial G-vectors within a sphere are included in the basis. However, when comparing cells of different sizes, i.e., during a relaxation, the cell shape is relaxed, so the direct and reciprocal lattice vectors change. The number of reciprocal G-vectors in the basis is kept fixed, but the length of the G-vectors changes, indirectly changing the energy cutoff. In other words, the shape of the cutoff region changes from a sphere to an ellipsoid. This can be solved by using an infinite number of k-points and plane waves. In practice, a large enough plane wave energy cutoff and number of k-points leads to converged energies\n[2]\n. All energy changes are strictly consistent with the stress tensor; however, when the basis set is too small, i.e., prematurely truncated, this results in discontinuities in the total energy between cells of varying volumes. These discontinuities between energy and volume create stress that decreases the equilibrium volume (cf. Fig. 1 (top)), due to the diagonal components of the stress tensor being incorrect. This is called the\nPulay stress\n.\nThe pressure of the cell, being proportional to the trace of the stress tensor, can be used to visualize this. When the cell volume is below the equilibrium volume, the pressure is positive; conversely, it is negative when above the equilibrium volume, so at equilibrium, this is zero. Plotting the magnitude of the pressure vs. volume curve and the total energy allows comparison between these two minima. In Figure 1 it is clear that the the absolute pressure-volume and energy-volume minima coincide for a converged basis, while the pressure equilibrium is much lower than the energy equilibrium for the unconverged basis. This is the effect of the Pulay stress.\nFurther explanation\nAs mentioned previously,\nN\nPW\nis constant in a relaxation calculation, which means that\nE\ncutoff\nmust change to compensate for changes in\nΩ\n0\n. This is illustrated in Fig. 2. The initial G-vectors within a sphere are included within the basis.\nWhen the cell volume increases (\nV\n1\n<\nV\n1\n), the number of G-vectors in reciprocal space remains constant, but their length increases (cf. Fig. 2 (top)). This effectively results in a change of basis, leading to (\nE\ncutoff, 1\n>\nE\ncutoff, 2\n). This basis remains constant for the duration of the relaxation. However, if the calculation is then restarted, the basis is reset. This means that the number of G-vectors is greater for the larger, real-space cell. One effect of this is that there are more real-space grid points. However, the corresponding reciprocal space decreases.\nContrastingly, see Fig. 2 (bottom), when the volume decreases on relaxation (\nV\n1\n>\nV\n1\n), the length of the G-vectors decreases. The effective\nE\ncutoff\nshould increase but this does not improve the situation, as it creates an artificial pressure. The reciprocal space grid points are effectively sparser. If the calculation restarts, the basis is reset, so the number of G-vectors decreases for the smaller real space cell.\nFigure 2. Cell shape and lattice positions are kept constant, while the volume\nV\nis free to change (ISIF = 7). The initial volume\nV\n1\nchanges to the final volume\nV\n2\n. Two cases are given, one for volume increasing on relaxation (top) and one for it decreasing (bottom). The change in real space is given on the left, while the change in reciprocal space and the subsequent effect on the G-vectors is given on the right. Blue is the initial basis, while red is the new, restarted basis. The relation between\nE\ncutoff\n,\nN\nPW\n, and G-vectors is given for the initial and final volumes.\nAlternatively, the shape of the cell could change. As the shape changes, the G-vectors continue to be directed along the lattice coordinates, meaning that some shorten while others lengthen, see Fig. 3. This results in a shift from a spherical basis, where all G-vectors are of equal length, to one where some are stretched and others compressed, i.e. an ellipsoid. This changes the effective\nE\ncutoff\nalong each lattice parameter. On resetting the calculation, the cutoff is once again spherical. This draws an analogy to the symmetry breaking of the Bravais lattice seen for gradient-corrected functionals (cf.\nGGA_COMPAT\n), where the spherical symmetry of the G-vectors is broken for non-cubic cells.\nFigure 3. Cell volume and lattice positions are kept constant, while the shape is free to change (ISIF = 5). The shape changes from cubic to hexagonal. The blue spherical basis changes to the red ellipsoid basis, along the direction of the sheer. On restarting, a spherical basis returns.\nReferences\n↑\nP. Gomes Dacosta, O. Nielsen, and K. Kunc,\nStress theorem in the determination of static equilibrium by the density functional method\n, J. Phys. C: Solid State Phys.\n19\n, 3163 (1986).\n↑\nG. P. Francis and  M. C. Payne,\nFinite basis set corrections to total energy pseudopotential calculations\n, J. Condens. Matter Phys.\n2\n, 4395 (1990)."
  }, 
  "Running machine-learned force fields in LAMMPS": {
    "description": "This web page explains how to integrate pre-trained VASP machine-learned force fields into the LAMMPS molecular dynamics package by patching and compiling LAMMPS with the VASPml library, and how to set up and run LAMMPS simulations using the `pair_style vasp` command.", 
    "detailed_description": "LAMMPS\nis a very popular molecular dynamics (MD) package which implements lots of advanced simulation methods. Although VASP itself also offers\nMD simulations\nLAMMPS provides more flexibility and additional methods (e.g. thermostats/barostats, grouping atoms, etc.). This page describes how to make pre-trained VASP machine-learned force fields available within LAMMPS. On a technical level this is achieved by patching the LAMMPS source code in such way that a new\npair_style\nnamed\nvasp\nis available in the LAMMPS script language. The patched LAMMPS source is compiled and then linked to the\nVASPml library\n. The first section describes in detail how to patch and compile LAMMPS. The second section explains how the VASP\nML_FF\nfile can be loaded in a LAMMPS script.\nWarning:\nThe VASPml library available as of VASP 6.5.0 and therefore also the LAMMPS interface are experimental features. Please carefully check results and, if feasible, compare against similar VASP MD simulations.\nBuilding LAMMPS with VASPml patch\nBefore starting the LAMMPS build please either compile VASP with the\nVASPml library\n, or alternatively, keep your VASP installation untouched and perform a\nstandalone build\nof the VASPml library. To confirm that everything is ready we can check for the presence of the following files:\nFor a VASP build with VASPml:\n/path/to/vasp/build/VERSION/vaspml/lib/libvaspml.a\n/path/to/vasp/build/VERSION/vaspml/include/InterfaceLAMMPS.hpp\nwhere\nVERSION\nis any of\nstd\n,\ngam\nor\nncl\n. It does not matter which VASP build version is used because the VASPml library will be identical in all three cases.\nOr, alternatively, for a\nVASPml standalone build\nplease check:\n/path/to/vaspml/lib/libvaspml.a\n/path/to/vaspml/include/InterfaceLAMMPS.hpp\nNext, we need to obtain the LAMMPS source code with the patch for VASPml. Please clone the following repository to your hard disk and change into the LAMMPS root directory:\ngit clone\nhttps://github.com/vasp-dev/lammps\ncd lammps\nAt this point looking around in the git repository will show the files from the\ndevelop\nbranch (the main development branch of LAMMPS). However, the patch files are located in another branch, hence we need to switch with this command:\ngit checkout vasp-mlff\nThen, while still in the LAMMPS root directory we need to create a symbolic link from\nlammps/lib/vasp/vaspml\nto the actual location of the VASPml folder.\nIn case of a VASP build with VASPml:\nln -s /path/to/vasp/build/std/vaspml lib/vasp/\nAgain, it is not important which of the three VASP build directories (\nstd\n,\ngam\nor\nncl\n) is used because the VASPml library is the same.\nAlternatively, for a standalone VASPml build:\nln -s /path/to/vaspml lib/vasp/\nFor the remaining steps we need to change into the\nsrc\ndirectory:\ncd src\nThe source files for the\npair_style vasp\nare part of the optional package\nML-VASP\nwhich can be activated with this command:\nmake yes-ml-vasp\nBefore we can finally start the build process it is necessary to adapt the LAMMPS makefile in\nMAKE/Makefile.mpi\n. Modify the\nCC\nand\nLINK\nvariables to match the compiler used during the\nVASPml build process\n(\nCXX_ML\nvariable). Also match the compiler flags in\nCCFLAGS\nand\nLINKFLAGS\nto\nCXXFLAGS_ML\n. Flags do not need to be identical but at least compatible compiler features should be used. Since VASPml requires BLAS and LAPACK we may also need to complete the\nLIB\nvariable with the required libraries and their paths. For the GNU compiler with openBLAS it may look like this:\n...\nCC =    mpic++\nCCFLAGS = -g -O3 -std=c++17\n...\nLINK =    mpic++\nLINKFLAGS = -g -O3 -std=c++17\nLIB = -L${OPENBLAS_ROOT}/lib -lopenblas\nFinally, compile the LAMMPS source code with this command:\nmake mpi\nOptionally, add the\n-j\nflag to perform a parallel build (faster). If the build process succeeds the LAMMPS executable\nlmp_mpi\nwill be located in the\nlammps/src\ndirectory.\nSetting up a LAMMPS MD run\nWarning:\nPlease always review the current\nlimitations and bug reports\n.\nLAMMPS comes with its own powerful script language which allows the user to specify all relevant MD simulation parameters in a single file. Please consult the\nLAMMPS documentation\nfor details. Within the LAMMPS script language the commands\npair_style\nand\npair_coeff\nare responsible for selecting a force field. The\nML-VASP\npackage introduces a new\npair_style\ncalled\nvasp\n. The\npair_style vasp\ncommand does not have any additional arguments, all configurable settings are given as arguments to the\npair_coeff\ncommand in this format:\npair_style vasp\npair_coeff * * file types\nThe\npair_coeff\ncommand must be followed by\n* *\n, then followed by the name of the VASP force field file, typically\nML_FF\n. Finally, there comes a mapping from LAMMPS atom types to VASP force-field types, e.g.,\nH O Na Cl\nmeans that LAMMPS types\n1\n,\n2\n,\n3\nand\n4\nare mapped to VASP types\nH\n,\nO\n,\nNa\nand\nCl\n, respectively. A valid example may look like this:\npair_style vasp\npair_coeff * * ML_FF Pb Br Cs\nThis will map the LAMMPS atom types\n1\n,\n2\nand\n3\nin the\ninput data file\nto the types\nPb\n,\nBr\nand\nCs\nfor which a pre-trained machine-learned force field should be present in the\nML_FF\nfile in the execution directory. A summary of the type mapping is provided in the screen output and the\nlog.lammps\nfile, e.g. for the example above it looks like this:\nLAMMPS       pair_coeff      VASP      |             VASP force field\ntypes       names           subtypes  |     types       names        subtypes\n----------------------------------------- | -------------------------------------\n1 <---> Pb        <---> 0         |         0 <---> Pb     <---> 0\n2 <---> Br        <---> 1         |         1 <---> Br     <---> 1\n3 <---> Cs        <---> 2         |         2 <---> Cs     <---> 2\nOn the left side we find the mapping, the right side gives an overview of types present in the force field file. In this example, there is a one-to-one mapping, hence, the table looks pretty obvious and contains somewhat redundant information. However, it is also possible to leave out a mapping from specified LAMMPS types by supplying\nNULL\ninstead of a valid VASP type name. This can be helpful when multiple force fields should be combined, see\npair_style hybrid\n. Furthermore, multiple LAMMPS types may be mapped to the same VASP types. Finally, the force field file may contain types which are not used in the current MD simulation. Therefore, a more complicated example may look like this:\npair_coeff * * vasp ML_FF NULL Cs NULL Br Pb Br\nand the corresponding table could contain this information:\nLAMMPS       pair_coeff      VASP      |             VASP force field\ntypes       names           subtypes  |     types       names        subtypes\n----------------------------------------- | -------------------------------------\n1 <---> unmapped! <---> unmapped! |         0 <---> Ca     <---> unused!\n2 <---> Cs        <---> 2         |         1 <---> Pb     <---> 0\n3 <---> unmapped! <---> unmapped! |         2 <---> O      <---> unused!\n4 <---> Br        <---> 1         |         3 <---> Br     <---> 1\n5 <---> Pb        <---> 0         |         4 <---> Cs     <---> 2\n6 <---> Br        <---> 1         |\nMind:\nAlways ensure that the type mapping is correctly set up because mixed-up types may not immediately result in errors. An MD simulation may still run and only post-processing may ultimately reveal inconsistencies which can be tedious to trace back to type-mapping mistakes.\nThe\npair_style vasp\nexpects input coordinates to be in the units of Ångström and returns energies and forces with the energy unit of eV. Hence, it is only compatible with the LAMMPS setting\nunits metal\nin the input script, otherwise an error will occur."
  }, 
  "Setting up an electronic minimization": {
    "description": "This web page provides a comprehensive step-by-step guide for setting up and running an electronic minimization calculation using density-functional theory (DFT) with the VASP software, including creating input files (POSCAR, POTCAR, KPOINTS, INCAR), selecting appropriate parameters (exchange-correlation functional, k-point sampling, smearing techniques), performing a dry-run, optimizing parallel", 
    "detailed_description": "Setting up an\nelectronic minimization\ncalculation using density-functional theory requires a few steps. The\ninput files\nmust be created or copied into the execution folder. This includes making a few choices for the\nk\n-point\nsampling and\nelectronic smearing\n,\nminimization algorithm\n, and\nexchange-correlation functionals\n. A\ndry-run\ncan be used to review settings and select appropriate\nparallelization\ntags. After running the calculation, the output can be analyzed.\nStep-by-step instructions\nCreate the input files\nStep 1\n: Create a\nPOSCAR\nfile containing the structure for which you want to compute the electronic groundstate. External tools like VESTA\n[1]\n, or Python packages like the Atomic Simulation Environment (ASE)\n[2]\nor pymatgen\n[3]\ncan help with this step.\nStep 2\n:\nChoose an exchange-correlation (XC) functional\nappropriate for your material and quantity of interest.\nStep 3\n: Create a suitable\nPOTCAR\nfile by following the instructions on our\npreparing a POTCAR\npage.\nStep 4\n: Create a\nKPOINTS\nfile to define the\nintegration mesh in reciprocal space\n. Including a single k point at the origin, i.e. the Gamma point, neglects all interactions beyond the unit cell. This is appropriate for isolates systems like a single molecule or in large supercells. For bulk systems, start with a\nregular mesh\n. For shorter lattice vectors, more k points are required to achieve the same sampling density. Consult the\nsymmetry reduction section\nof the\nKPOINTS\npage to select the appropriate mesh type. Alternatively to a\nKPOINTS\nfile, the\nKSPACING\ncan be used.\nStep 5\n: Write an\nINCAR\nfile. It is recommended to start from a rather minimal file, and only specify the most important tags:\nXC\nto specify the\nexchange-correlation functional\n.\nALGO\nto select the algorithm for\nelectronic minimization\n.\nISMEAR\nto select the type of\nelectronic smearing technique\n.\nSIGMA\nto choose an appropriate smearing width of the\nelectronic smearing\n.\nENCUT\nto set the plane-wave energy cutoff.\nEDIFF\nto specify the global break condition for the electronic self-consistent loop\nOptimize your settings\nStep 6\n(optional): Select the appropriate version of the VASP executable. I.e.\nvasp_gam\nif you only want to use the Gamma point for reciprocal space integration,\nvasp_ncl\nfor\nnoncollinear magnetic\ncalculations, or\nvasp_std\nfor anything else. Then Run a\ndry-run\ncalculation to validate settings and uncover possible errors. Open a terminal, go to the calculation directory that contains all input files and run\n/path/to/your/vasp_std --dry-run\nStep 7\n(optional): Inspect the\nOUTCAR\nfile of your\ndry-run\n. Take note of the number of bands,\nNBANDS\n, and the number of\nk\n-points, NKPTS, especially. Follow the guidelines on the\noptimizing the parallelization\npage to set\nNCORE\nand/or\nKPAR\nin the\nINCAR\nfile.\nRun the calculation\nStep 8\n: Run the calculation. If you are new to VASP, or unsure about the calculation setup, run a small calculation and monitor the\nscreen output\n. For parallel execution on 4 MPI ranks, the command reads\nmpirun -np 4 /path/to/your/vasp_std\nAt an HPC center, submit your job with a submission script. Ask your system administrator for help.\nOnce the calculation is finished, you have access to the\nelectronic ground-state properties\nvia the\noutput files\nfor the selected parameters. Check the\nOUTCAR\nfile for warnings or advice. For help, consult the page about\ntroubleshooting electronic convergence\nand search our\nForum\nfor similar issues.\nStep 9\n(convergence study): Repeat Steps 4 - 8 with increasingly accurate parameter settings, e.g. higher cutoff energy and denser k-points mesh, and monitor your quantity of interest. Stop if the quantity of interest reaches the desired accuracy.\nRecommendations and advice\nMind:\nMake sure to specify the lattice vectors and ionic positions in the\nPOSCAR\nwith at least 7 digits of precision to ensure the\nsymmetry analysis\ncan function accurately.\nTips\nAdd only necessary tags to your\nINCAR\nfile. Cluttered input is a common source of mismatched settings.\nA larger smearing width\nSIGMA\nmight be required to converge the calculation if your\nKPOINTS\nmesh is sparse.\nENCUT\ndefaults to the largest\nENMAX\nvalue found in the\nPOTCAR\nfile. Still, it is always a good idea to include it in the\nINCAR\nfile to ensure comparability between different calculations.\nUse the\ndry-run\ncommand-line argument or\nALGO\n= None\nto check the feasibility of your settings and\noptimize parallelization tags\n, without wasting computational resources.\nSome warnings are a bit hidden in the\nheader\nsection of the\nscreen output\n. Redirecting the screen output to a file and saving it can simplify troubleshooting significantly.\nExample\nWe will do a small DFT calculation of GaAs in the zincblende structure, using the local-density approximation (LDA) with the Perdew-Zunger parametrization of Ceperley-Alder Monte Carlo correlation data.\n[4]\n[5]\n. Thus, our\nXC functional\nwill be set to\nXC\n= CA\n.\nSetting up the\nPOSCAR\nfile\nThe\nPOSCAR\nfile starts with a comment line and a scaling factor, which in our case corresponds to the lattice parameter of GaAs, around 5.65 Angstrom.\nZincblende GaAs\n5.65000000000\nNext we need to define the lattice vectors. Zincblende is a face-centered cubic (fcc) structure with two different elements in the unit cell. We can describe the fcc lattice with three vectors, pointing from the origin to the face-centers of the cube:\n0.0000000000000000  0.5000000000000000  0.5000000000000000\n0.5000000000000000  0.0000000000000000  0.5000000000000000\n0.5000000000000000  0.5000000000000000  0.0000000000000000\nNow, we define the ion types, and in the line below the number of ions in the structure for each type:\nGa  As\n1   1\nSpecify the positions of the atoms in direct coordinates, with Ga at the origin and As a quarter along the diagonal of the cube:\nDirect\n0.0000000000000000  0.0000000000000000  0.0000000000000000\n0.2500000000000000  0.2500000000000000  0.2500000000000000\nThis is the complete\nPOSCAR\nfile:\nZincblende GaAs\n5.65000000000\n0.0000000000000000  0.5000000000000000  0.5000000000000000\n0.5000000000000000  0.0000000000000000  0.5000000000000000\n0.5000000000000000  0.5000000000000000  0.0000000000000000\nGa  As\n1   1\nDirect\n0.0000000000000000  0.0000000000000000  0.0000000000000000\n0.2500000000000000  0.2500000000000000  0.2500000000000000\nIf you have access to\npy4vasp\n, the structure can be visualized with two lines of Python code in a Jupyter notebook.\nVisualization of the\nPOSCAR\nfile of GaAs with\npy4vasp\n.\nfrom\npy4vasp\nimport\ncalculation\ncalculation\n.\nstructure\n.\nplot\n(\nsupercell\n=\n2\n,\nselection\n=\n\"POSCAR\"\n)\nIf ASE\n[2]\nis installed, an equivalent\nPOSCAR\nfile can be created as follows:\nfrom\nase.build\nimport\nbulk\nfrom\nase.io.vasp\nimport\nwrite_vasp\natoms\n=\nbulk\n(\n\"GaAs\"\n,\ncrystalstructure\n=\n\"zincblende\"\n,\na\n=\n5.65\n)\nwrite_vasp\n(\n\"POSCAR\"\n,\natoms\n,\ndirect\n=\nTrue\n,\nsort\n=\nFalse\n)\nCreating the\nPOTCAR\nfile\nWe have already decided to use\nXC\n= CA\n, and can create the\nPOTCAR\nfile as discussed on the\npreparing a POTCAR\npage.\nCreating the\nKPOINTS\nfile\nSince our structure is face-centered cubic, we create a\nregular Gamma-centered\nk\n-point mesh according to the\nsymmetry considerations\nfor\nKPOINTS\nfiles.\nRegular k-point mesh\n0\nGamma\n7 7 7\nCreating the\nINCAR\nfile\nWe chose the efficient combination of a\nblocked-Davidson algorithm\nand the\nRMM-DIIS\nalgorithm which can be selected with\nALGO\n= Fast\n.\nALGO\n= Fast\nGaAs is a semiconductor, so we could use the tetrahedron method\nISMEAR\n= -5\n, but bandgaps are underestimated systematically by DFT and XC functional or lattice parameter may fail to reproduce experimental results. Thus, following the recommendation on\nelectronic smearing techniques\n, it is safer to select Gaussian smearing and a small smearing width:\nISMEAR\n= 0\nSIGMA\n= 0.1\nEFERMI\n= MIDGAP\nFor an initial guess of the plane-wave cutoff energy\nENCUT\n, we can search for\nENMAX\nin the\nPOTCAR\n, e.g. by\ngrep ENMAX POTCAR\n, and set the largest as a starting point. In preceding calculations this value should be increased, e.g. by increments of approximately 20%. Accordingly, in the first run we set:\nENCUT\n= 285\nFor the break condition of the self-consistent loop, we select\n1\n×\n10\n−\n6\n{\\displaystyle 1\\times10^{-6}}\neV:\nEDIFF\n= 1.0E-06\nThe complete\nINCAR\nfile is:\nXC\n= CA\nALGO\n= Fast\nISMEAR\n= 0\nEFERMI\n= MIDGAP\nSIGMA\n= 0.1\nENCUT\n= 285\nEDIFF\n= 1.0E-06\nPerforming a dryrun\nWe are not doing a\nnoncollinear\n, nor a Gamma-only calculation, thus we execute a VASP\ndry-run\nwith the standard executable:\n/your/vasp_dir/bin/vasp_std --dry-run\nWhich will print a warning about the\ndry-run\nand some information about the MPI-ranks, OMP-threads, the VASP version, and the input structure. Mistakes in the setup, e.g. if the order of elements in the\nPOSCAR\nand\nPOTCAR\ndo not match, warnings are printed.\nWe can now check the\nOUTCAR\nfile and find the total number of\nk\n-points, 20, and number of bands (\nNBANDS\n), 13. This means a relatively low number of bands and a decent number of\nk\npoints. If we want to run our calculation on 4 MPI ranks, setting\nKPAR\n= 4\nis an excellent choice for parallelization. Mind that the\nparallelization changes number of bands\n.\nRunning the calculation\nAfter adding\nKPAR\n= 4\nto the\nINCAR\nfile, we run the calculation on 4 MPI ranks:\nmpirun -np 4 /your/vasp_dir/bin/vasp_std\nConsult the page on\nscreen output\nfor details about the information VASP prints out. For this example it should be similar to this:\nrunning    4 mpi-ranks, with    1 threads/rank, on    1 nodes\ndistrk:  each k-point on    1 cores,    4 groups\ndistr:  one band on    1 cores,    1 groups\nvasp.6.5.0 16Dec24 (build Dec 18 2024 11:18:52) complex\nPOSCAR found type information on POSCAR GaAs\nPOSCAR found :  2 types and       2 ions\nReading from existing POTCAR\nscaLAPACK will be used\nReading from existing POTCAR\nLDA part: xc-table for (Slater(with rela. corr.)+CA(PZ))\n, standard interpolation\nPOSCAR, INCAR and KPOINTS ok, starting setup\nFFT: planning ... GRIDC\nFFT: planning ... GRID_SOFT\nFFT: planning ... GRID\nWAVECAR not read\nentering main loop\nN       E                     dE             d eps       ncg     rms          rms(c)\nDAV:   1     0.623500523606E+02    0.62350E+02   -0.70852E+03   528   0.135E+03\nDAV:   2    -0.533903918847E+01   -0.67689E+02   -0.65331E+02   580   0.246E+02\nDAV:   3    -0.978648308483E+01   -0.44474E+01   -0.44252E+01   635   0.613E+01\nDAV:   4    -0.985351010991E+01   -0.67027E-01   -0.67012E-01   614   0.819E+00\nDAV:   5    -0.985490478939E+01   -0.13947E-02   -0.13947E-02   641   0.931E-01    0.301E+00\nRMM:   6    -0.966994813504E+01    0.18496E+00   -0.21049E-01   715   0.453E+00    0.175E+00\nRMM:   7    -0.962995486843E+01    0.39993E-01   -0.10315E-01   701   0.182E+00    0.574E-01\nRMM:   8    -0.962647867206E+01    0.34762E-02   -0.12692E-02   740   0.127E+00    0.937E-02\nRMM:   9    -0.962642442346E+01    0.54249E-04   -0.21087E-03   757   0.536E-01    0.594E-02\nRMM:  10    -0.962647797834E+01   -0.53555E-04   -0.39237E-04   794   0.212E-01    0.167E-02\nRMM:  11    -0.962646653288E+01    0.11445E-04   -0.91747E-05   785   0.105E-01    0.529E-03\nRMM:  12    -0.962646808711E+01   -0.15542E-05   -0.17691E-05   735   0.426E-02    0.300E-03\nRMM:  13    -0.962646810096E+01   -0.13852E-07   -0.27033E-06   491   0.223E-02\n1 F= -.96264681E+01 E0= -.96264536E+01  d E =-.289650E-04\nwriting wavefunctions\nYou can now use the\noutput files\nto analyze the\nelectronic ground-state properties\n. Do not forget to perform a convergence study before reporting a value, see\nStep 9\n.\nRelated tags and articles\nInput files\n:\nINCAR\n,\nPOSCAR\n,\nKPOINTS\n,\nPOTCAR\n,\nParallelization\nOutput files\nand\nElectronic ground-state properties\nReferences\n↑\nhttps://jp-minerals.org/vesta/en/ (2025).\n↑\na\nb\nhttps://wiki.fysik.dtu.dk/ase/ (2025).\n↑\nhttps://pymatgen.org/ (2022).\n↑\nD. M. Ceperley and B. J. Alder, Phys. Rev. Lett.\n45\n, 566 (1980).\n↑\nJ. P. Perdew and A. Zunger, Phys. Rev. B\n23\n, 5048 (1981)."
  }, 
  "Slow-growth approach calculations": {
    "description": "This web page explains how to set up and perform slow-growth molecular dynamics simulations using either the Andersen or Nose-Hoover thermostat in VASP, including the necessary input tags, constraints, and considerations for stability and free-energy calculations.", 
    "detailed_description": "Anderson thermostat\nFor a slow-growth simulation, one has to perform a calcualtion very similar to\nConstrained molecular dynamics\nbut additionally the transformation velocity-related\nINCREM\n-tag for each geometric parameter with\nSTATUS=0\nhas to be specified. For a slow-growth approach run with Andersen thermostat, one has to:\nSet the standard MD-related tags:\nIBRION\n=0,\nTEBEG\n,\nPOTIM\n, and\nNSW\nSet\nMDALGO\n=1, and choose an appropriate setting for\nANDERSEN_PROB\nDefine geometric constraints in the\nICONST\nfile, and set the\nSTATUS\nparameter for the constrained coordinates to 0\nWhen the free-energy gradient is to be computed, set\nLBLUEOUT\n=.TRUE.\nSpecify the transformation velocity-related\nINCREM\n-tag for each geometric parameter with\nSTATUS=0\n.\nNose-Hoover thermostat\nFor a slow-growth approach run with Nose-Hoover thermostat, one has to:\nSet the standard MD-related tags:\nIBRION\n=0,\nTEBEG\n,\nPOTIM\n, and\nNSW\nSet\nMDALGO\n=2, and choose an appropriate setting for\nSMASS\nDefine geometric constraints in the\nICONST\n-file, and set the\nSTATUS\nparameter for the constrained coordinates to 0\nWhen the free-energy gradient is to be computed, set\nLBLUEOUT\n=.TRUE.\nSpecify the transformation velocity-related\nINCREM\n-tag for each geometric parameter with\nSTATUS=0\nVASP can handle multiple (even redundant) constraints. Note, however, that a too large number of constraints can cause problems with the stability of the\nSHAKE algorithm\n. In problematic cases, it is recommended to use a looser convergence criterion (see\nSHAKETOL\n) and to allow a larger number of iterations (see\nSHAKEMAXITER\n) in the\nSHAKE algorithm\n. Hard constraints may also be used in\nmetadynamics simulations\n(see\nMDALGO\n=11 | 21). Information about the constraints is written onto the\nREPORT\n-file: check the lines following the string:\nConst_coord"
  }, 
  "Smearing technique": {
    "description": "This web page explains various smearing methods (e.g., Gaussian, Methfessel-Paxton, Fermi-Dirac, and tetrahedron) in VASP for calculating total energy, electronic density, and density of states in materials, offering recommendations based on system type (metal, semiconductor, insulator) and computational goals like force, phonon, or DOS", 
    "detailed_description": "How to set ISMEAR\nFor the calculation of the\ntotal energy\nin bulk materials, we recommend the tetrahedron method with Blöchl corrections (\nISMEAR\n=-5). This method also gives a good account of the electronic\ndensity\n. In VASP, it is a good idea to always set a smearing method in the\nINCAR\nfile because the default choice may lead to incorrect results for some materials.\nWe recommend to default to Gaussian smearing with a relatively small smearing and to set the Fermi energy to the middle of the bandgap\nISMEAR\n= 0\nSIGMA\n= 0.1\nEFERMI\n= MIDGAP\nIf you do not know much about your system, we recommend to start with this setup.\nBelow, we explain why this is a good choice and when you should deviate from that.\nYou may also look into\nK-point integration\nfor the theory behind the methods.\nBroadening techniques\nBroading of different smearing techniques near the Fermi energy ϵ\nF\n. The energy is measured in units of the smearing σ (\nSIGMA\n). The Methfessel-Paxton method (cyan) is narrower than the Gaussian distribution (blue) but also has negative features. The smearing Fermi-Dirac distribution (purple) corresponds to a temperature but is much broader at the same value of\nSIGMA\nWith broadening techniques, each state is occupied not only if the Fermi energy exceeds its eigenvalue but also within a certain width described by\nSIGMA\n.\nSwitching from a binary filled/empty to these fractional occupations improves the numeric stability in particular for metallic systems.\nThere is a trade-off in choosing\nSIGMA\n:\nToo large values result in an incorrect total energy while too small smearing ones require a dense mesh of\nk\npoints.\nGaussian broadening\nThe Gaussian-smearing method leads to very reasonable results in most cases.\nWithin this method it is necessary to extrapolate from finite\nSIGMA\nresults to\nSIGMA\n= 0\nresults.\nYou can find an extra line in the\nOUTCAR\nfile:\nenergy( SIGMA→0 )\n, giving the extrapolated results.\nHowever, this value will not be accurate without systematically reducing\nSIGMA\n.\nTypically, you will need to use a\nSIGMA\nof 0.03 to 0.1 for converged results.\nMind:\nThe forces and stress are consistent with the free energy and not with the extrapolated energy\nSIGMA\n→0 so make sure that forces and stress are converged with respect to\nSIGMA\nas well.\nMethfessel-Paxton broadening\nThe method of Methfessel-Paxton (\nISMEAR\n) results in a very accurate description of the total energy in metals.\nNevertheless, the width of the smearing (\nSIGMA\n) must be chosen carefully.\nSIGMA\nshould be as large as possible, while keeping the difference between the free energy and the total energy (i.e. the term\nentropy T*S\n) in the\nOUTCAR\nfile negligible (1 meV/atom).\nThe Methfessel-Paxton method is somewhat easier to use than the Gaussian method since the energies can be corrected for the energy term.\nTherefore, we recommend to use this method\nISMEAR\nfor the calculation of forces and phonon frequencies in metals.\nWarning:\nAvoid using\nISMEAR\n> 0\nfor semiconductors and insulators, since this often leads to incorrect results. Since the occupancies are not monotonous Methfessel-Paxton does not guarantee deterministic results in systems with a gap. Errors for phonons frequencies can exceed 20%. These errors are very hard to spot if you do not look carefully. For insulators, use Gaussian smearing (\nISMEAR\n= 0\n) or the tetrahedron method (\nISMEAR\n= -5\n).\nFermi-Dirac broadening\nWith the Fermi-Dirac method (\nISMEAR\n= -1\n), the smearing\nSIGMA\ncorresponds to the temperature of the electronic system.\nYou should use this method, if this temperature equivalence is important for you, e.g., if you want to compute some properties based\non the occupations.\nIn all other cases, you can use the other smearing methods instead.\nTetrahedron methods\nThe density of states (DOS) obtained with Gaussian broadening (blue) has much more oscillations than the one obtained with tetrahedron interpolation (red). These spikes correspond to eigenvalue of the bands at different\nk\npoints. In the tetrahedron method the band is interpolated between the points flattening out the DOS. Another artifact of the broadening is that the DOS extends into the band gap.\nIn bulk materials, we recommend the tetrahedron method with Blöchl corrections (\nISMEAR\n=-5) for the calculation of very precise\ntotal energies\nor the electronic\ndensity of states\n(DOS).\nIn contrast to broadening methods, the tetrahedron method interpolates between\nk\npoints of a band.\nAs a consequence, if a band spans a certain energy range, the tetrahedron method will yield no contribution outside of this energy range.\nSmearing methods will always extend by a width determined by\nSIGMA\nbeyond this range.\nYou can see in the figure that the resulting onset of band edges is much better captured by the tetrahedron method.\nThe drawback of the tetrahedron method is that it is not variational with respect to the partial occupancies.\nTherefore the calculated forces and the stress tensor can be wrong by up to 5 to 10% for metals.\nOnly for semiconductors and insulators, the forces are correct because the partial occupancies do not vary and are either zero or one.\nThe occupancies in the tetrahedron method are exact for the linear extrapolation of the bands.\nPartial occupancies arise from the fact that a tetrahedron crosses the Fermi energy.\nWe provide also the option to add temperature on top of the tetrahedron method with\nISMEAR\n= -14\nand\nISMEAR\n= -15\n.\nThis is particularly relevant if accurate occupancies are required e.g. in the context of transport calculations.\nCalculation of the Fermi energy\nVASP implicitly computes the Fermi energy such that the sum over all occupations results in the number of electrons.\nIn insulators and semiconductors, this choice is not unique if\nSIGMA\nis much smaller than the gap.\nBy default\nEFERMI\n= LEGACY\n, VASP will set the Fermi energy typically close to the lower end of the bandgap.\nThis method is not deterministic, i.e., changes to the number of points for the density of states\nNEDOS\ncan lead to different values.\nIt is also fragile with the Methfessel-Paxton method if you forgot to switch to a different smearing method for a gapped system.\nTo avoid these issues, we implemented a new method\nEFERMI\n= MIDGAP\n.\nIt will compute the middle of the bandgap and use it as starting point for the interval bisection to compute the Fermi energy.\nIn systems, with a bandgap significantly larger than the smearing width\nSIGMA\nthe search will terminate immediately.\nIn all other cases, it will fall back to determine the Fermi energy iteratively.\nWhich method to use\nIf you have no prior knowledge of your system always use Gaussian smearing\nISMEAR\n= 0\nin combination with a small\nSIGMA\n= 0.03 to 0.1\n.\nThis applies in particular if you do not know whether your system is an insulator, a semiconductor or a metal and for high-throughput calculations.\nThis is not the default in VASP, so to be on the safe side, you might want to include this setting in all your\nINCAR\nfiles.\nYou can also switch to set the Fermi energy in the middle of the gap with\nEFERMI\n= MIDGAP\n.\nKeep in mind to check that your calculations are converged with respect to width\nSIGMA\nFor semiconductors or insulators, you can use the tetrahedron method (\nISMEAR\n= -5\n) if you have at least 4\nk\npoints to form a tetrahedron.\nThis eliminates the need to converge the smearing width\nSIGMA\n.\nYou need to be sure that the bandgap will not close during the relaxation or molecular dynamics calculation otherwise the forces may be inaccurate.\nFor relaxations\nin metals\n, use\nISMEAR\n=1 or\nISMEAR\n=2 and an appropriate\nSIGMA\nvalue (the entropy term should be less than 1 meV per atom).\nOften the default value\nSIGMA\n= 0.2\nis a reasonable choice for metals.\nMind again\n: Avoid using\nISMEAR\nfor semiconductors and insulators since it might cause severe problems.\nFor the calculations of the density of states (DOS) and very accurate total-energy calculations (no relaxation in metals), use the tetrahedron method (\nISMEAR\n= -5\n).\nYou would often do this at the end of a relaxation for the converged structure with a denser\nk\n-point mesh to get an accurate DOS.\nOther methods\nIf you want to keep the occupancies fixed, use\nISMEAR\n= -2\n.\nThis may be useful to constraint the electronic state.\nHowever, keep in mind that this is only an approximation and the real system would relax the occupancies.\nPlease refer to the documentation of\nFERWE\nin case you want to set the occupancies manually.\nTo compare the results of different smearings, you can use\nISMEAR\n= -3\n.\nYou could use this feature e.g. to converge the\nSIGMA\nwhen Gaussian broadening is used.\nPlease refer to the documentation of\nSMEARINGS\nhow to set the smearing methods.\nThis feature uses the relaxation engine to change the smearings so you cannot combine it with relaxations.\nRelated tags and articles\nISMEAR\n,\nSIGMA\n,\nFERWE\n,\nFERDO\n,\nSMEARINGS\n,\nIntegrating over all orbitals"
  }, 
  "Spin spirals": {
    "description": "This web page explains the generalized Bloch condition for modeling spin spirals in magnetic systems, detailing its mathematical formulation, effects on magnetization density, basis set considerations, symmetry implications, and initialization of magnetic subsystems in computational materials science.", 
    "detailed_description": "Generalized Bloch condition\nSpin spirals may be conveniently modeled using a generalization of the Bloch condition (set\nLNONCOLLINEAR\n=.TRUE.\nand\nLSPIRAL\n=.TRUE.\n):\n[\nΨ\nk\n↑\n(\nr\n)\nΨ\nk\n↓\n(\nr\n)\n]\n=\n(\ne\n−\ni\nq\n⋅\nR\n/\n2\n0\n0\ne\n+\ni\nq\n⋅\nR\n/\n2\n)\n[\nΨ\nk\n↑\n(\nr\n−\nR\n)\nΨ\nk\n↓\n(\nr\n−\nR\n)\n]\n,\n{\\displaystyle\n\\left[ \\begin{array}{c} \\Psi^{\\uparrow}_{\\bf k}(\\bf r) \\\\\n\\Psi^{\\downarrow}_{\\bf k}(\\bf r) \\end{array} \\right] = \\left(\n\\begin{array}{cc}\ne^{-i\\bf q \\cdot \\bf R / 2} & 0\\\\\n0 & e^{+i\\bf q \\cdot \\bf R / 2} \\end{array}\\right) \\left[\n\\begin{array}{c} \\Psi^{\\uparrow}_{\\bf k}(\\bf r-R) \\\\\n\\Psi^{\\downarrow}_{\\bf k}(\\bf r-R) \\end{array} \\right],\n}\ni.e.\n, from one unit cell to the next the up- and down-spinors pick up an additional phase factor of\nexp\n⁡\n(\n−\ni\nq\n⋅\nR\n/\n2\n)\n{\\displaystyle \\exp(-i{\\bf q}\\cdot {\\bf R}/2)}\nand\nexp\n⁡\n(\n+\ni\nq\n⋅\nR\n/\n2\n)\n{\\displaystyle \\exp(+i{\\bf q}\\cdot {\\bf R}/2)}\n, respectively,\nwhere\nR\nis a lattice vector of the crystalline lattice, and\nq\nis the so-called spin-spiral propagation vector.\nThe spin-spiral propagation vector is commonly chosen to lie within the first Brillouin zone of the reciprocal space lattice, and has to be specified by means of the\nQSPIRAL\n-tag.\nThe generalized Bloch condition above gives rise to the following behavior of the magnetization density:\nm\n(\nr\n+\nR\n)\n=\n(\nm\nx\n(\nr\n)\ncos\n⁡\n(\nq\n⋅\nR\n)\n−\nm\ny\n(\nr\n)\nsin\n⁡\n(\nq\n⋅\nR\n)\nm\nx\n(\nr\n)\nsin\n⁡\n(\nq\n⋅\nR\n)\n+\nm\ny\n(\nr\n)\ncos\n⁡\n(\nq\n⋅\nR\n)\nm\nz\n(\nr\n)\n)\n{\\displaystyle\n{\\bf m} ({\\bf r} + {\\bf R})= \\left(\n\\begin{array}{c}\nm_x({\\bf r}) \\cos({\\bf q} \\cdot {\\bf R}) - m_y({\\bf r}) \\sin({\\bf q} \\cdot {\\bf R}) \\\\\nm_x({\\bf r}) \\sin({\\bf q} \\cdot {\\bf R}) + m_y({\\bf r}) \\cos({\\bf q} \\cdot {\\bf R}) \\\\\nm_z({\\bf r})\n\\end{array}\n\\right)\n}\nThis is schematically depicted below:\nthe components of the magnization in the\nxy\n-plane rotate about the spin-spiral propagation vector\nq\n.\nN.B.\n: This does not mean that the magnetisation density may not have contributions along the\nz\n-direction.\nThese, however, will not be affected by the generalized Bloch condition,\ni.e.\n,\nm\nz\n(\nr\n)\n{\\displaystyle m_z ({\\bf r})}\nwill simply show the usual cell periodicity.\nIf one explicitly wants to keep the magnetisation density from developing components along the\nz\n-direction set:\nLZEROZ\n= .TRUE.\nThis will set\nm\nz\n(\nr\n)\n=\n0\n{\\displaystyle m_z ({\\bf r}) = 0}\nat each iteration step of the electronic minimisation.\nBasis set considerations\nThe generalized Bloch condition redefines the Bloch functions as follows:\nΨ\nk\n↑\n(\nr\n)\n=\n∑\nG\nC\nk\nG\n↑\ne\ni\n(\nk\n+\nG\n−\nq\n2\n)\n⋅\nr\n{\\displaystyle\n\\Psi^{\\uparrow}_{\\bf k}(\\bf r) = \\sum _{\\bf G} \\rm\nC^{\\uparrow}_{\\bf k \\bf G} e^{i(\\bf k + \\bf G -\\frac{\\bf q}{2})\\cdot \\bf r}\n}\nΨ\nk\n↓\n(\nr\n)\n=\n∑\nG\nC\nk\nG\n↓\ne\ni\n(\nk\n+\nG\n+\nq\n2\n)\n⋅\nr\n{\\displaystyle\n\\Psi^{\\downarrow}_{\\bf k}(\\bf r)\n= \\sum _{\\bf G} \\rm C^{\\downarrow}_{\\bf k \\bf G} e^{i(\\bf k + \\bf\nG +\\frac{\\bf q}{2})\\cdot \\bf r}\n}\nThis changes the Hamiltonian only minimally:\n(\nH\n↑\n↑\nV\nx\nc\n↑\n↓\nV\nx\nc\n↓\n↑\nH\n↓\n↓\n)\n→\n(\nH\n↑\n↑\nV\nx\nc\n↑\n↓\ne\n−\ni\nq\n⋅\nr\nV\nx\nc\n↓\n↑\ne\n+\ni\nq\n⋅\nr\nH\n↓\n↓\n)\n,\n{\\displaystyle\n\\left( \\begin{array}{cc}\nH^{\\uparrow\\uparrow} & V^{\\uparrow\\downarrow}_{\\rm xc} \\\\\nV^{\\downarrow\\uparrow}_{\\rm xc} & H^{\\downarrow\\downarrow} \\end{array}\\right)\n\\rightarrow\n\\left( \\begin{array}{cc}\nH^{\\uparrow\\uparrow} & V^{\\uparrow\\downarrow}_{\\rm xc} e^{-i\\bf q \\cdot \\bf r} \\\\\nV^{\\downarrow\\uparrow}_{\\rm xc}e^{+i\\bf q \\cdot \\bf r} & H^{\\downarrow\\downarrow} \\end{array}\\right),\n}\nwhere in\nH\n↑\n↑\n{\\displaystyle H^{\\uparrow\\uparrow}}\nand\nH\n↓\n↓\n{\\displaystyle H^{\\downarrow\\downarrow}}\nthe kinetic energy of a plane wave component changes to:\nH\n↑\n↑\n:\n|\nk\n+\nG\n|\n2\n→\n|\nk\n+\nG\n−\nq\n/\n2\n|\n2\n{\\displaystyle\nH^{\\uparrow\\uparrow}:\\qquad |{\\bf k} + {\\bf G}|^2 \\rightarrow |{\\bf k} + {\\bf G} - {\\bf q} /2|^2\n}\nH\n↓\n↓\n:\n|\nk\n+\nG\n|\n2\n→\n|\nk\n+\nG\n+\nq\n/\n2\n|\n2\n{\\displaystyle\nH^{\\downarrow\\downarrow}:\\qquad |{\\bf k} + {\\bf G}|^2 \\rightarrow |{\\bf k} + {\\bf G} + {\\bf q} /2|^2\n}\nIn the case of spin-spiral calculations the energy cutoff of the basis set of the individual spinor components is specified by means of the\nENINI\n-tag.\nAdditionally one needs to set\nENMAX\nappropriately:\nENMAX\nneeds to be chosen larger than\nENINI\n, and large enough so that the plane wave components of both the up-spinors as well as the components of the down-spinor all have a kinetic energy smaller than\nENMAX\n.\nThis is the case when:\nE\nN\nM\nA\nX\n≥\nℏ\n2\n2\nm\n(\nG\ni\nn\ni\n+\n|\nq\n|\n)\n2\n{\\displaystyle\n\\mathtt{ENMAX} \\geq \\frac{\\hbar^2}{2m}\\left( G_{\\rm ini} + |q| \\right)^2\n}\nwhere\nG\ni\nn\ni\n=\n2\nm\nℏ\n2\nE\nN\nI\nN\nI\n{\\displaystyle\nG_{\\rm ini}=\\sqrt{\\frac{2m}{\\hbar^2}\\mathtt{ENINI}}\n}\nIn most cases it is more than sufficient to set\nENMAX\n=\nENINI\n+100\n.\nTo judge whether\nENMAX\nwas chosen large enough one will always get a warning at runtime,\ne.g.\n-----------------------------------------------------------------------------\n|                                                                             |\n|           W    W    AA    RRRRR   N    N  II  N    N   GGGG   !!!           |\n|           W    W   A  A   R    R  NN   N  II  NN   N  G    G  !!!           |\n|           W    W  A    A  R    R  N N  N  II  N N  N  G       !!!           |\n|           W WW W  AAAAAA  RRRRR   N  N N  II  N  N N  G  GGG   !            |\n|           WW  WW  A    A  R   R   N   NN  II  N   NN  G    G                |\n|           W    W  A    A  R    R  N    N  II  N    N   GGGG   !!!           |\n|                                                                             |\n|      To represent the spin spiral you requested, with a kinetic             |\n|      energy cutoff of ENINI=  300.00 eV, choose ENMAX >  331.21 eV          |\n|      Currently ENMAX=  400.00 eV                                            |\n|                                                                             |\n-----------------------------------------------------------------------------\nSymmetry\nGenerally the introduction of a spin-spiral will lower the symmetry of the system.\nAt present VASP can not correctly account for the presence of a spin-spiral in its symmetry analysis.\nTherefore the use of symmetry has to be switched of completely:\nISYM\n= -1\nInitialization of the magnetic subsystem\nAs for all calculations on magnetic systems it is highly advisable to initialise the magnetic subsystem by means of the\nMAGMOM\ntag.\nNote that, in case one does\nnot\nspecify initial magnetic moments, the initial order of the magnetic subsystem will be ferromagnetic (see the\nMAGMOM\ndefault values),\nand even if the groundstate of your system is not ferromagnetic, the initial ferromagnetic state might very well be a local minimum in which the system can remain stuck during the electronic minimisation.\nOf course, in case of spin-spiral calculations the magnetic subsystem is not completely characterized by the magnetic configuration within the unit cell,\nbut will additionally depend on how the magnetization density changes from one unit cell to the next as determined by the spiral propagation vector.\nConsider the following two examples:\nTwo magnetic atoms per unit cell, both with initial magnetic moments\nM\nalong the\ny\n-axis and\nq\n=\n(\n0\n,\n0\n,\n1\n2\n)\n{\\displaystyle q=(0,0,\\frac{1}{2})}\n:\nMAGMOM\n= 0 M 0  0 M 0\nQSPIRAL\n= 0.0 0.0 0.5\ni.e.\n, a double layer antiferromagnet:\nTwo magnetic atoms per unit cell, both with initial magnetic moments\nM\nalong the\ny\n- and\nx\n-axis, respectively, and\nq\n=\n(\n0\n,\n0\n,\n1\n2\n)\n{\\displaystyle q=(0,0,\\frac{1}{2})}\n:\nMAGMOM\n= 0 M 0  M 0 0\nQSPIRAL\n= 0.0 0.0 0.5\ni.e.\n, a spin spiral:\nN.B.\n: both of the aforementioned magnetic arrangements obey the same generalized Bloch condition,\nq\n=\n(\n0\n,\n0\n,\n0.5\n)\n{\\displaystyle q=(0,0,0.5)}\n, and during the electronic minimisation one may transform into the other if that lowers the total energy.\nIn other words the generalized Bloch condition dictates the change in the magnetization density from one unit cell to the next, but it does not explicitly constrain the magnetic order\nwithin\nthe unit cells themselves.\nLocal magnetic moments\nAnalysing the magnetisation density from spin-spiral calculations in terms of site resolved local magnetic moments is a bit more involved than usual.\nProblems arise from the fact that in most cases the spin-spiral period will not be commensurate with the unit cell (otherwise there would be no reason to use the generalised Bloch theorem).\nThis means that\nimplicitly\nthe magnetisation density is not cell periodic, as illustrated in the figure below:\nThe usual ways to analyse the site resolved local charge density and magnetisation (\ne.g.\nsetting the\nLORBIT\n-tag: output in the\nPROCAR\nfile and at the end of the\nOUTCAR\nfile) do not account for this.\nAs a workaround one may (ab)use the infrastructure created for the\nconstrained magnetic moment\napproach, as follows:\nI_CONSTRAINED_M\n= 1\nLAMBDA\n= 0.0\ni.e.\n, one switches on the\nconstrained magnetic moment approach\n(\nI_CONSTRAINED_M\n=1\n) but sets the penalty potential to zero (\nLAMBDA\n=0.0\n).\nN.B.\n: do not forget to set\nRWIGS\nappropriately.\nThe magnetisation density will correctly integrated inside site centered sphere of radius\nRWIGS\n,\nand the resulting local magnetic moments are written under\nM_int\n, to the\nOSZICAR\nfile.\nFor instance:\nE_p =  0.00000E+00  lambda =  0.000E+00\n<lVp>=  0.00000E+00\nDBL =  0.00000E+00\nion        MW_int                 M_int\n1  1.178  0.000  0.000    1.573  0.000  0.000\nRMM:   8    -0.819213822792E+01    0.53417E-07   -0.43965E-08  2542   0.310E-03\nIn the above, the local magnetic moment on ion 1 (after iteration 8) is\nM\n=\n1.573\nx\n^\nμ\nB\n{\\displaystyle M=1.573 \\hat{x} \\;\\mu_{\\rm B}}\n.\nRelated Tags and Sections\nLSPIRAL\n,\nQSPIRAL\n,\nLZEROZ\n,\nLNONCOLLINEAR\n,\nMAGMOM\n,\nENINI\n,\nENMAX\n,\nISYM\n,\nI_CONSTRAINED_M\n,\nLAMBDA\n,\nM_CONSTR\n,\nRWIGS"
  }, 
  "Structure optimization": {
    "description": "The web page explains the process and considerations for structure optimization in VASP, including algorithms like RMM-DIIS and conjugate gradient, the importance of choosing appropriate parameters such as POTIM and IBRION, and tips for interpreting the optimization output.", 
    "detailed_description": "Overview\nStructure optimization describes the task of finding the lattice vectors and atom positions that minimize the energy of the system.\nIn its most general form, this optimization problem is extremely challenging because there are usually many local minima.\nTherefore, we typically limit ourselves to the simpler problem of finding the closest local minimum for a given starting structure.\nAs user, this limitation has two important consequences:\n(i) You need to make sure that the starting structure is close enough to a minimum for the optimizers to work.\n(ii) You may need to consider a diverse set of starting structures, if you are not sure about the most reasonable one.\nCommon considerations\nFigure 1: Heuristics for choosing a suitable structure optimization algorithm.\nTypically, optimization problems are more difficult to solve, the more free parameters they have.\nIn VASP, you can control the degrees of freedom in different ways:\nFirst, use\nISIF\nto determine whether the position of the ions, the shape of the cell, and the volume of the cell change.\nSecond, set selective dynamics in the\nPOSCAR\nfile to decide which ion positions may change.\nNext, you need to decide on an algorithm by setting the\nIBRION\ntag.\nIn Figure 1, we show some heuristic rules that may help to decide with this selection.\nThese guidelines are a compromise between speed and robustness of the algorithms.\nThe\nRMM-DIIS algorithm\n(\nIBRION\n= 1\n) is very efficient because it uses the history of many steps to obtain the best next guess.\nHowever, if your structure is still far from the minimum, it is not wise too include the information from these points far from the minimum and the algorithm struggles.\nThe\nconjugate-gradient (CG) algorithm\n(\nIBRION\n= 2\n) chooses a search direction conjugate to previous ones.\nThen it selects an optimal step size along this search direction.\nThis algorithm is a good default choice because of its robustness.\nEven simpler are\ndamped molcular dynamics\n(\nIBRION\n= 3\n).\nThis algorithm propagates through time using the forces and friction on the velocities.\nAll relaxation algorithms (\nIBRION\n=1, 2, and 3) rely on a step size\nPOTIM\n.\nThis step size has no direct physical meaning but scales the forces internally before calling the minimization routine.\nFor many systems, the optimal\nPOTIM\nis around 0.5.\nSince the RMM-DIIS algorithm and the damped molecular dynamics are sensitive this parameter, use the conjugate gradient algorithm (\nIBRION\n=2), if you are not sure how large the optimal\nPOTIM\nis.\nIn this case, the\nOUTCAR\nfile and\nstdout\nwill contain a line indicating a reliable\nPOTIM\n.\nFor\nIBRION\n= 2\n, the following lines will be written to\nstdout\nafter each corrector step (usually each odd step):\ntrial: gam= 0.20820 g(F)=  0.494E+00 g(S)=  0.000E+00 ort = 0.728E-03 (trialstep = 0.881E+00)\nThe quantity\ntrialstep\nis the size of the current trialstep.\nMultiply the current value of\nPOTIM\nwith this number to obtain the optimal step size.\nMind:\nIf you use the default value of\nISYM\n= 2\n, lower symmetry structures will be inaccessible to the relaxation algorithms. It is usually preferable to break symmetries intentionally by modifying the starting structure instead of turning symmetry operations off via\nISYM\n= 0\n.\nRMM-DIIS\nFor\nIBRION\n= 1\n, VASP uses a RMM-DIIS algorithm to relax the ions into their instantaneous groundstate.\nRMM-DIIS stands for\nresidual-minimization method, direct inversion in the iterative subspace\n.\n[1]\nThe forces and the stress tensor determine the search directions for finding the equilibrium positions; the total energy is not taken into account.\nThis algorithm is very fast and efficient close to a local minimum, but fails badly if the initial positions are a bad guess (use\nconjugate gradient\ninstead).\nRMM-DIIS implicitly calculates an approximation of the inverse Hessian matrix by taking into account information from previous iterations.\nThe approximation of the Hessian matrix requires very accurate forces, otherwise the algorithm will fail to converge.\nEnforcing a minimum of electronic steps between each ionic step (\nNELMIN\n) converges forces efficiently.\nFor simple bulk materials\nNELMIN\n= 4\nis usually adequate, whereas complex surfaces, where the charge density converges very slowly, might require\nNELMIN\n= 8\n.\nOn startup, the initial Hessian matrix is diagonal and equal to\nPOTIM\n.\nIn each iteration a new vector is added to the history.\nThe length of the history determines the rank of the Hessian and must not exceed the degrees of freedom.\nNaively, one has three degrees of freedom for every ion and nine for the unit cell, but translational invariance, symmetry arguments and constraints can reduce this number significantly.\nIf old steps lead to linear dependencies, they will be automatically removed from the iteration history.\nWhen further fine tuning is desired, you can set the\nNFREE\ntag to adjust the size of the history.\nA reasonable\nPOTIM\ncan speed up calculations significantly.\nWe recommend to find an optimal\nPOTIM\nusing\nIBRION\n= 2\nor performing a few test calculations (see above).\nUnderstanding the output\nRMM-DIIS will produce output similar to the following to\nstdout\nBRION: g(F)=  0.463E-01 g(S)=  0.000E+00 retain N=  2 mean eig= 5.94\neig:   5.940  5.940\nand the\nOUTCAR\nfile\nQuasi-Newton relaxation of ions (Broydens 2nd method)\ng(Force)  = 0.463E-01   g(Stress)= 0.000E+00\nretain information from N=  2 steps\neigenvalues of (default step * inverse Hessian matrix)\naverage eigenvalue of G=   5.9397\neigenvalue spectrum of G is  5.9397  5.9397\nThe\ng\nvalues correspond to the norm of the forces and the stress, respectively.\nVASP also reports the eigenvalues of the approximate Hessian and how many vectors are currently stored in the iteration history.\nConjugate gradient\nIn the conjugate-gradient algorithm\nIBRION\n= 2\n, we optimize the structure along a search direction.\nThe initial search direction is given by forces and stress;\nin subsequent steps, we require that the search is conjugate (perpendicular) to the previous direction.\nOnce the search direction is chosen, a line search along this direction determines the optimal step size.\nNumerical Recipes\nby Press\net al.\ncontains more details about conjugate gradient.\n[2]\nIn VASP, the line search along the search direction uses the following steps\nWe perform a\ntrial step\ninto the search direction.\nPOTIM\ncontrols the length of the trial step.\nWe recompute the energy, forces, and stress.\nBased on the initial energy, the energy after the trial step, and the change of the forces, we fit a cubic or quadratic polynomial to determine the expected minimum (\ncorrector step\n).\nWe recompute the energy, forces, and stress.\nIf after the corrector step the forces and stress parallel to the current search direction vanish, we perform the next trial step. Otherwise, we improve the line minimization by further corrector steps using a variant of Brent's algorithm.\n[2]\nTip:\nIf your structure is well suited for the conjugate-gradient algorithm, you should see one initial calculation for the structure in the\nPOSCAR\nfile. Then, VASP should alternate between trial and corrector step.\nUnderstanding the output\nIn a trial step, you will see similar output like this in the\nstdout\ntrial-energy change:   -0.415121  1 .order   -0.385587   -0.435540   -0.335634\nstep:   3.5233(harm=  3.8400)  dis= 0.29442  next Energy=  -133.730354 (dE=-0.949E+00)\nand the\nOUTCAR\nfile\nConjugate gradient step on ions:\ntrial-energy change:   -0.415121  1 .order   -0.385587   -0.435540   -0.335634\n(g-gl).g = 0.511E+00      g.g   = 0.494E+00  gl.gl    = 0.245E+01\ng(Force)  = 0.494E+00   g(Stress)= 0.000E+00 ortho     = 0.728E-03\ngamma     =   0.20820\ntrial     =   0.88083\nopt step  =   3.52334  (harmonic =   3.84000) maximal distance =0.29442102\nnext E    =  -133.730354   (d E  =  -0.94937)\nOf particular interest are the current errors\ng(Force)\nand\ng(Stress)\n, the step size (here 0.88083) in units of\nPOTIM\n, and the largest distance any ion moves (here 0.29442).\nYou can also compare the expected energy (\nnext E\nor\nnext Energy\n) with the energy you obtain in the corrector step.\nThe other values have the following meaning:\nThe\ntrial-energy change\nis the change of the energy in the trial step\nThe values after\n1 .order\ndescribe the expected energy change resulting from the inner product of gradient and change of the structure. The three different values use the average gradient, the gradient of the previous, and the gradient of the current step, respectively.\nThe values\nstep\nand\nopt step\nare the step size of a cubic interpolation;\nharm\nand\nharmonic\nuses a quadratic interpolation. Close to the minimum these values should agree.\ndE\nis the expected energy change.\nIn the corrector step, you will get only output to\nstdout\ncurvature:  -0.78 expect dE=-0.387E+00 dE for cont linesearch -0.104E-06\ntrial: gam= 0.20820 g(F)=  0.494E+00 g(S)=  0.000E+00 ort = 0.728E-03 (trialstep = 0.881E+00)\nsearch vector abs. value=  0.667E+00\nYou can look at the norm of the forces\ng(F)\nand the stress\ng(S)\n.\nThe\nort\nvalue tests whether the forces and stress are orthogonal to the previous search direction (should be small).\nAs mentioned above,\ntrialstep\nis the step size in units of\nPOTIM\n.\nOccasionally, you may get output from\nZBRENT\n.\nThis indicates that the error in the corrector step was too large and the line search is further refined.\nDamped molecular dynamics\nWith\nIBRION\n= 3\nand\nSMASS\n, VASP will execute a damped second order equation of motion for the degrees of freedom\nx\n→\n¨\n=\n−\n2\nα\nF\n→\n−\nμ\nx\n→\n˙\n,\n{\\displaystyle\n{\\ddot {\\vec x}} = -2 \\alpha {\\vec F} - \\mu  {\\dot {\\vec x}},\n}\nwhere\nSMASS\nsupplies the damping factor μ and\nPOTIM\ncontrols α.\nDiscretising the differential equation with a simple velocity Verlet algorithm yields\nv\n→\nN\n+\n1\n/\n2\n=\n(\n2\n−\nμ\n)\nv\n→\nN\n−\n1\n/\n2\n−\n4\nα\nF\n→\nN\n2\n+\nμ\nx\n→\nN\n+\n1\n=\nx\n→\nN\n+\nv\n→\nN\n+\n1\n/\n2\n{\\displaystyle\n\\begin{align}\n{\\vec v_{N+1/2}} =&  \\frac{(2-\\mu) {\\vec v_{N-1/2}} - 4\\alpha {\\vec F_N}} {2+\\mu}\\\\\n{\\vec x_{N+1}} =&  {\\vec x_{N}} + {\\vec v_{N+1/2}}\n\\end{align}\n}\nOne may immediately recognize, that μ=2 is equivalent to a simple steepest descent algorithm without line optimization.\nHence, μ=2 corresponds to maximal damping, μ=0 corresponds to no damping.\nThe optimal damping factor depends on the second derivatives of the energy with respect to the degrees of freedom.\nA reasonable first guess for μ is usually 0.4.\nMind that our implementation is particularly user-friendly, since changing μ usually does not require to re-adjust the time step\nPOTIM\n.\nTo choose an optimal time step and damping factor, we recommend the following two step procedure:\nFix μ (for instance to 1) and adjust\nPOTIM\n.\nPOTIM\nshould be chosen as large as possible without getting divergence in the total energy.\nDecrease μ and keep\nPOTIM\nfixed.\nIf\nPOTIM\nand\nSMASS\nare chosen correctly, the damped molecular dynamics mode may outperform the conjugate gradient method by a factor of two.\nIf\nSMASS\n< 0\na velocity quench algorithm is used.\nv\n→\nq\nu\ne\nn\nc\nh\n=\nm\na\nx\n(\n(\nv\n→\n+\nα\nF\n→\n)\n⋅\nF\n→\n,\n0\n)\nF\n→\nF\n2\n+\nα\nF\n→\n{\\displaystyle\n\\vec v_{\\rm quench} = \\rm{max}((\\vec v + \\alpha \\vec F) \\cdot \\vec F, 0) \\frac{\\vec F}{F^2} + \\alpha \\vec F\n}\nYou can see that velocities are projected onto the forces and only remain if that projection is a positive number.\nMind:\nFor\nIBRION\n= 3\n, a reasonable time step\nPOTIM\nmust\nbe supplied. Too large time steps will result in divergence, too small ones will slow down the convergence. A good choice is usually twice the\nsmallest\nstep size you would observe with the conjugate gradient algorithm.\nUnderstanding the output\nDamped molecular dynamics produces relatively little output compared to the other two algorithms.\nIf\nSMASS\nis set to a value larger than 0, you will see output like this in\nstdout\ndamped:  g(F)=  0.159E+01 g(S)=  0.000E+00 dE (1.order)=-0.254E+01\notherwise for the quenched velocity algorithm you get output similar to this\nsummed vel is now   0.0000000000000000        0.0000000000000000        5.5511151231257827E-017\nquench:  g(F)=  0.191E+02 g(S)=  0.000E+00 dE (1.order)=-0.311E+02\nIn both cases\ng(F)\nand\ng(S)\nare the norm of forces and stress.\nThe extra line in the latter case is a sanity check on the average velocities and should produce vanishingly small numbers.\nRelated tags and articles\nIBRION\n,\nPOTIM\n,\nNSW\n,\nSMASS\nReferences\n↑\nP. Pulay, Chem. Phys. Lett.\n73\n, 393 (1980).\n↑\na\nb\nW. H. Press, B. P. Flannery, S. A. Teukolsky, and W. T. Vetterling, em Numerical Recipes (Cambridge University Press, New York, 1986)."
  }, 
  "Supercell core-hole calculations": {
    "description": "This web page details the methodology and practical steps for performing supercell core-hole (SCH) calculations in VASP to simulate X-ray absorption spectra (XAS), including core-hole creation, supercell convergence, input file setup, and key INCAR parameters for both XCH and FCH approaches.", 
    "detailed_description": "The SCH approach\n[1]\n[2]\nis explained in detail on the following\ntheory page\n. When the core hole is explicitly introduced in one of the atoms, i.e., a core electron is removed, it is necessary to eliminate the effective interaction of the core hole with its image across the periodic boundary. That requires using a large supercell so that this interaction is negligible. After the self-consistent electronic minimization is converged in the presence of the core hole, the dielectric function is calculated using Fermi's golden rule.\nTwo different approaches can be used to treat the excited electron. The excited electron can be placed into the lowest conduction band in the\nexcited electron and core-hole (XCH)\n[3]\napproach, alternatively the excited electron can be accounted for by a negative background charge in the\nfull core-hole (FCH)\n[4]\nmethod.\nPre-calculation\nTo run a successful calculation you have to make the following preliminary steps:\nStep 1.\nMake a super cell for structure\nTo minimize the interaction between core holes from neighboring cells the supercell size has to be converged. The convergence is very material dependent and has to be in principle done every time for a new material. It is best to do a bottom-up approach, beginning with the from the small cell.\nMind:\nAlthough by increasing the cell size the k mesh is implicitly also increased it still has to be also converged since the spectrum can depend also very strongly on the k points.\nStep 2.\nSelect one atom in the file that will carry the core-hole and provide a POTCAR file for that atom\nAfter making the super cell, one atom has to be made to a new species with a single atom in it that will carry the core-hole. The initial line for the number of atoms and atoms for example can look like this\nMg O\n32 32\nIf we are for example interested in the K-edge spectrum of Mg, we would have to change the\nPOSCAR\nfile as follows\nMg Mg O\n1 31 32\nSince we create a new species this way we need the\nPOTCAR\ninformation for it. This is very easily done by taking the\nPOTCAR\nfile for the same species and concatenating it to the\nPOTCAR\ncarrying all species: i.e.\ncat POTCAR_Mg POTCAR\n.\nThe procedure for oxygen would be very similar:\nMg O O\n32 31 1\nand\ncat POTCAR POTCAR_O\n.\nMind:\nOne typical source of error is that the additional\nPOTCAR\nis not added to the main\nPOTCAR\nfile or that the order of species is not the same in the\nPOSCAR\nand\nPOTCAR\nfiles.\nWarning:\nIt is strongly recommended to use the available GW PAW potentials for the\nPOTCAR\nfiles, since many standard potentials don't have projectors with quantum numbers 2 or larger and the GW potentials are more exact for excited states than the standard potentials.\nCalculation\nThe supercell core-hole calculations (SCH) consist in principle of two steps:\nSelf-consistent electronic cycle with a core hole.\nCalculation of the dielectric function of the core electron with the band structure from the SCF run.\nIn VASP these two steps are all done in a single calculation.\nStep 3. (optional)\nChecking calculational parameters in advance\nTo check calculational paramaters such as e.g. number of bands, number of irreducible k-points, number of electrons, etc. VASP can be run in a dry mode which doesn't do any \"actual\" calculations but only does the setup up steps:\nvasp_executable --dry-run\nThis is often needed in SCH calculations, so whenever in the following one is instructed to increase or decrease a parameter it is useful to run VASP in dry mode before to get the reference value,\ne.g. grep NELECT OUTCAR\nto find the number of electrons\nNELECT\nto be specified in the\nINCAR\nfile.\nStep 4.\nCalculate the XAS spectrum for varying cell sizes\nRun a SCH calculation using for several different super cells, increasing until convergence is achieved.\nMind:\nBy default, the\nXCH method\nis selected, since VASP automatically increases the number of electrons\nNELECT\nby\nCLZ\nif\nICORELEVEL\n=2 is selected. XCH places the electron in the lowest conduction band.\nTo run an\nFCH calculation\nthe setup is completely analogous to an XCH calculation except the number of electrons\nNELECT\nneeds to be decreased by\nCLZ\n(or set to the value as it was used without\nICORELEVEL\n=2). Then VASP automatically puts a negative background charge to compensate for the missing negative charge.\nStep 5.\nCompare to experiment\nIf experimental data is available, try comparing to it. The peak maxima are unlikely to align, so you will need to shift the calculated spectra to compare with experiment.\nINCAR tags\nThere are several tags that are required to run an SCH calculation.\nExample INCAR\nAn example input for the 2s K-edge of Mg in MgO would look like the following:\nCH_LSPEC\n=.TRUE\nCH_NEDOS\n=1000\nCH_SIGMA\n=0.3\nICORELEVEL\n=2\nCLNT\n=1\nCLN\n=2\nCLL\n=0\nCLZ\n=1.0\nCH_AMPLIFICATION\n=32.0\nNBANDS\n=600\nSIMGA\n=0.1\nISMEAR\n=0\nCore hole tags\nICORELEVEL\n: To enable core-hole calculations in the final-state approximation with self-consistent field cycles (SCF) one has to set\nICORELEVEL\n=2. Core-hole calculations in the initial-state approximation (\nICORELEVEL\n=1) are also available, but they are physically less relevant and should be only used if especially needed.\nCLNT\n: This tag selects the species holding the core hole. This number corresponds to the species defined in the\nPOSCAR\nand\nPOTCAR\nfiles.\nCLN\n: Specifies the\nn\n{\\displaystyle n}\nquantum number of the excited electron.\nCLL\n: Specifies the\nl\n{\\displaystyle l}\nquantum number of the excited electron.\nCLZ\n: Specifies how much of a fraction of the chosen electron should be excited. Usually one always sets\nCLZ\n=1.0, but in some cases values lesser than 1 can lead to better agreement with experiment. However, this should be handled with caution since the physics behind is very dubious.\nXAS tags\nCH_LSPEC\n: To obtain X-ray absorption spectra (XAS) the following flag has to be set\nCH_LSPEC\n=\n.TRUE.\n.\nCH_SIGMA\n: The broadening of the spectrum is by default of Gaussian form and the broadening width in eV is set by\nCH_SIGMA\n. We recommend using a very small broadening\nCH_SIGMA\n≤\n{\\displaystyle \\le}\n0.001 in the calculations and to broaden the spectrum in post-processing. Also, the spectrum can be recalculated with different parameters without the need to redo the electronic self-consistent field cycle. For that one can use the converged\nWAVECAR\nfrom the previous calculation and set\nALGO\n=\nNone\ntogether with the new parameters for the spectrum \"CH_*\" in the\nINCAR\nfile.\nCH_NEDOS\n: Sets the number of grid points on the energy axis of the spectrum.\nCH_AMPLIFICATION\n: Scaling of the spectrum by the specified value. This tag is not important but can be useful sometimes if one needs to scale the spectrum a priori. Otherwise, it is recommended to scale the spectrum a posteriori.\nOther important tags\nNBANDS\n: Number of bands in the calculation. This parameter usually needs to be significantly increased compared to standard DFT calculations, since it sets the number of bands available in the calculation into which the core electron can be excited.\nISMEAR\n: This sets the type of smearing (broadening) in the electronic calculation. Mind that there is also a second broadening when calculating the spectrum, which is currently always of Gaussian form. Both broadenings affect the form of the spectrum.\nSIGMA\n: Sets the smearing (broadening) width in eV within the electronic calculation.\nOutput\nThe dielectric function is written to the following files:\nOUTCAR\nvaspout.h5\nvasprun.xml\nUsually for an absorption spectrum all six components of the dielectric tensor are summed up. In most cases the obtained spectrum needs further processing via an energy dependent broadening.\nOUTCAR\nThe frequency dependent dielectric tensor, which is directly proportional to the absorption spectrum, is written to the\nOUTCAR\nfile. It starts with the following lines:\nfrequency dependent IMAGINARY DIELECTRIC FUNCTION (independent particle, no local field effects) density-density\nE(ev)      X         Y         Z        XY        YZ        ZX\n--------------------------------------------------------------------------------------------------------------\nThe energies of the excitations are with respect to the energy levels of the core electron of interest.\nThe start of the output of the dielectric function with respect to excitation energy is set slightly below the first peak to avoid many zeros over a large energy range, since core states have very large binding energies.\nvaspout.h5\nThe energies of the excitations are with respect to the energy levels of the core electron of interest.\nvasprun.xml\nThe energies of the excitations are with respect to the highest occupied bands (without the core hole).\nReferences\n↑\nF. Karsai, M. Humer, E. Flage-Larsen, P. Blaha, and G. Kresse, Phys. Rev. B\n98\n, 235205 (2018).\n↑\nM. Unzog, A. Tal, G. Kresse,\nX-ray absorption using the projector augmented-wave method and the Bethe-Salpeter equation\n, Phys. Rev. B\n106\n, 155133 (2022).\n↑\nB. Hetényi, F. De Angelis, P. Giannozzi, and R. Car,\nCalculation of near-edge x-ray-absorption fine structure at finite temperatures: spectral signatures of hydrogen bond breaking in liquid water\n,  J. Chem. Phys.\n120\n, 8632 (2004).\n↑\nD. Prendergasst and G. Galli,\nX-Ray Absorption Spectra of Water from First Principles Calculations\n,  Phys. Rev. Lett.\n96\n, 215502 (2006)."
  }, 
  "Thermodynamic integration calculations": {
    "description": "This web page provides a detailed explanation of how to perform thermodynamic integration calculations in VASP, including the use of specific tags like `SCALEE`, `VCAIMAGES`, and `TILAMBDA`, the setup for reference systems such as the ideal gas and harmonic solid, and the necessary input files and ensemble considerations for accurate free energy computations.", 
    "detailed_description": "A detailed description of calculations using thermodynamic integration within VASP is given in the supplemental information of reference\n[1]\n(\ncaution\n: the tag\nISPECIAL\n=0 used in that reference is not valid anymore, instead the tag\nPHON_NSTRUCT\n=-1 is used).\nThe tag\nSCALEE\nsets the coupling parameter\nλ\n{\\displaystyle \\lambda}\nand hence controls the Hamiltonian of the calculation.\nBy default\nSCALEE\n=1 and the scaling of the energies and forces via the coupling constant is internally skipped in the code. To enable the scaling\nSCALEE\n≠\n{\\displaystyle \\ne}\n1 has to be specified. A VASP calculation outputs the integrand for a given coupling constant at every molecular dynamics step. How to choose the ensemble size and carry out the integration is described in the main text and especially in the supplementary information of reference\n[1]\n.\nTo carry out thermodyanamic integration calculations the calculation needs to be split into two images via the tag\nVCAIMAGES\n. One also needs to set how many cores are used for each image vial\nNCORE_IN_IMAGE1\n.\nTwo possible options are available for the reference system:\nIdeal gas:\nBy default the thermodynamic integration is carried out from the ideal gas to the fully interacting case  (in the case when no\nDYNMATFULL\nis present in the calculation folder). Usually the Stirling approximation is used for the free energy of the ideal gas written as\nF\n=\n−\n1\nβ\nl\nn\n[\nV\nN\nA\n3\nN\nN\n!\n]\n{\\displaystyle  F = -\\frac{1}{\\beta} \\mathrm{ln} \\left[ \\frac{V^{N}}{\\Alpha^{3N} N!} \\right] }\nwhere\nV\n{\\displaystyle V}\nis the volume of the system,\nN\n{\\displaystyle N}\nis the number of particles in the system and\nA\n{\\displaystyle \\Alpha}\nis the de Broglie wavelength. The Stirling approximation applies in principle only in the limes of infinitely many particles. In reference\n[1]\nthe exact ideal gas equation was used since it helped to speed up the convergence of the final free energy of liquid Si with respect to the system size.\nHarmonic solid:\nIf the file\nDYNMATFULL\nexists  in the calculation directory and\nSCALEE\n≠\n{\\displaystyle \\ne}\n1, the second order Hessian matrix is added to the force and thermodynamic integration from a harmonic model to a fully interacting system is carried out. The\nDYNMATFULL\nfile stores the eigenmodes and eigenvalues from diagonalizing the dynamic matrix. This file is written by a previous calculation using the\nINCAR\ntags\nIBRION\n=6 and\nPHON_NSTRUCT\n=-1.\nAlternative way of thermodynamic integration for harmonic solid\nThe TI calculations in internal coordinates are performed in NVT ensemble using any thermostat available in VASP. The coupling parameter\nλ\n{\\displaystyle \\lambda}\nis defined by setting the parameter\nTILAMBDA\nin the\nINCAR\nfile.\nThe set of internal coordinates used in the TI calculation are defined via the\nICONST\nfile by setting the status to 3. The Hesse matrix\nH\n_\nx\n{\\displaystyle \\mathbf{\\underline{H}}^\\mathbf{x}}\nis provided in the file\nHESSEMAT\nand its transformation into\nH\n_\nq\n{\\displaystyle \\mathbf{\\underline{H}}^\\mathbf{q}}\nis performed by VASP. The potential energies of the system 1 and 0,\nq\n{\\displaystyle \\mathbf{q}}\n, needed to compute\n⟨\nV\n1\n−\nV\n0\n,\nq\n⟩\n{\\displaystyle \\langle V_1 -V_{0,\\mathbf{q}}  \\rangle}\nused as integrant in the TI expression for\nΔ\nA\n0\n,\nq\n→\n1\n{\\displaystyle \\Delta A_{0,\\mathbf{q} \\rightarrow 1} }\n, are written in the file\nREPORT\nin lines introduce by a string \"e_ti>\"\nReferences\n↑\na\nb\nc\nF. Dorner, Z. Sukurma, C. Dellago, and G. Kresse, Phys. Rev. Lett.\n121\n, 195701 (2018)."
  }, 
  "Time-dependent density-functional theory calculations": {
    "description": "The web page describes how to perform time-dependent density-functional theory (TDDFT) and time-dependent Hartree-Fock (TDHF) calculations in VASP using the Casida equation to obtain the frequency-dependent dielectric function with excitonic effects, including step-by-step input examples and explanations of key parameters and approximations.", 
    "detailed_description": "VASP offers a powerful module for performing time-dependent density-functional theory (TDDFT) or time-dependent Hartree-Fock (TDHF) calculations by solving the Casida equation . This approach can be used for obtaining the frequency-dependent dielectric function with the excitonic effects and can be based on the ground-state electronic structure in the DFT, hybrid-functional or even\nGW\napproximations.\nSolving Casida equation\nThe algorithm for solving the Casida equation can be selected by setting\nALGO\n= TDHF. This approach is very similar to BSE but differs in the way the screening of the Coulomb potential is approximated. The TDHF approach uses the exchange-correlation kernel\nf\nx\nc\n{\\displaystyle f_{\\rm xc}}\n, whereas BSE requires the\nW\n(\nω\n→\n0\n)\n{\\displaystyle W(\\omega \\to 0)}\nfrom a preceding\nGW\ncalculation. Thus, in order to perform a TDHF calculation, one only needs to provide the ground-state orbitals (\nWAVECAR\n) and the derivatives of the orbitals with respect to\nk\n{\\displaystyle k}\n(\nWAVEDER\n).\nMind:\nUnlike BSE, TDHF calculations do\nnot\nrequire\nW\n(\nω\n→\n0\n)\n{\\displaystyle W(\\omega \\to 0)}\n, i.e.,\nWxxxx.tmp\nIn summary, both TDHF and BSE approaches require a preceding ground-state calculation, however, the TDHF does not need the preceding\nGW\nand can be performed with the DFT or hybrid-functional orbitals and energies.\nTime-dependent Hartree-Fock\nThe TDHF calculations can be performed in two steps:\nground-state calculation\noptical absorption calculation\nFor example, an optical absorption calculation of bulk Si can be performed using a dielectric-dependent  hybrid-functional described in Refs.\n[1]\n[2]\n[3]\n.\nSYSTEM\n= Si\nISMEAR\n= 0\nSIGMA\n= 0.05\nNBANDS\n= 16      ! or any larger desired value\nALGO\n= D       ! Damped algorithm often required for HF type calculations,\nALGO\n= Normal might work as well\nLHFCALC\n= .TRUE.\nLMODELHF\n= .TRUE.\nAEXX\n= 0.083\nHFSCREEN\n= 1.22\nLOPTICS\n= .TRUE.  ! can also be done in an additional intermediate step\nIn the second step, the dielectric function is evaluated by solving the Casida equation\nSYSTEM\n= Si\nISMEAR\n= 0\nSIGMA\n= 0.05\nNBANDS\n= 16\nALGO\n= TDHF\nIBSE\n= 0\nNBANDSO\n= 4       ! number of occupied bands\nNBANDSV\n= 8       ! number of unoccupied bands\nLHARTREE\n= .TRUE.\nLADDER\n= .TRUE.\nLFXC\n= .TRUE.\nLMODELHF\n= .TRUE.\nAEXX\n= 0.083\nHFSCREEN\n= 1.22\nTHDF calculations can be performed for non-spin-polarized, spin-polarized, and noncollinear cases, as well as the case with spin-orbit coupling. There is, however, one caveat. The local exchange-correlation kernel is approximated by the density-density part only. This makes predictions for spin-polarized systems less accurate than for non-spin-polarized systems.\nTime-dependent DFT calculation\nThe TDDFT calculation using the PBE exchange-correlation kernel can be performed by disabling the ladder diagrams\nLADDER\n= .FALSE., i.e., only the PBE exchange-correlation kernel is present in the Hamiltonian.\nSYSTEM\n= Si\nISMEAR\n= 0\nSIGMA\n= 0.05\nNBANDS\n= 16\nALGO\n= TDHF\nIBSE\n= 0\nNBANDSO\n= 4       ! determines how many occupied bands are used\nNBANDSV\n= 8       ! determines how many unoccupied (virtual) bands are used\nLFXC\n= .TRUE.\nLHARTREE\n= .TRUE.\nLADDER\n= .FALSE.\nMind:\nIn TDDFT calculation, where the ladder diagrams are not included (\nLADDER\n=.FALSE.) or the fraction of exact exchange in the kernel is zero (\nAEXX\n=0), the resulting dielectric function lacks the excitonic effects.\nVASP tries to use sensible defaults, but it is highly recommended to check the\nOUTCAR\nfile and make sure that the right bands are included.  The tag\nOMEGAMAX\nspecifies the maximum excitation energy of included electron-hole pairs and the pairs with the one-electron energy difference beyond this limit are not included in the Hamiltonian.\nThe calculated frequency-dependent dielectric function, transition energies and oscillator strength values are stored in the\nvasprun.xml\nfile.\nCalculations beyond Tamm-Dancoff approximation\nCalculations beyond Tamm-Dancoff approximation can be performed in the same manner as in the\nBSE\n.\nCalculations at finite wavevectors\nCalculations at finite wavevectors can be performed in the same manner as in the\nBSE\n.\nReferences\n↑\nW. Chen, G. Miceli, G.M. Rignanese, and A. Pasquarello,\nNonempirical dielectric-dependent hybrid functional with range separation for semiconductors and insulators\n, Phys. Rev. Mater.\n2\n, 073803 (2018).\n↑\nZ.H. Cui, Y.C. Wang, M.Y. Zhang, X. Xu, and H. Jiang,\nDoubly Screened Hybrid Functional: An Accurate First-Principles Approach for Both Narrow- and Wide-Gap Semiconductors\nJ. Phys. Chem. Lett.,\n9\n, 2338-2345  (2018).\n↑\nP. Liu, C. Franchini, M. Marsman, and G. Kresse,\nAssessing model-dielectric-dependent hybrid functionals on the antiferromagnetic transition-metal monoxides MnO, FeO, CoO, and NiO\n, J. Phys.: Condens. Matter\n32\n, 015502 (2020)."
  }, 
  "Time-evolution algorithm": {
    "description": "The web page explains how the macroscopic dielectric function, which describes a material's optical response, can be computed using either eigendecomposition of the electron-hole Hamiltonian or a more efficient time-dependent integral approach within frameworks like BSE or TDDFT, with a focus on the theoretical basis and computational considerations in VASP.", 
    "detailed_description": "The\nmacroscopic dielectric function\n,\nϵ\ni\nj\n(\nω\n)\n{\\displaystyle \\epsilon_{ij}(\\omega)}\n, measures how a given dielectric medium reacts when subject to an external electric field. From\nϵ\ni\nj\n(\nω\n)\n{\\displaystyle \\epsilon_{ij}(\\omega)}\nit is possible to extract several optical properties such as absorption, optical conductivity, and reflectance. However, it is important that the interacting electrons and holes are taken into account. This makes the evaluation of the macroscopic dielectric function more involved, since it goes beyond the single-particle level, working at the two-particle level via either the\nBethe-Salpeter equation\n(BSE) or\ntime-dependent density-functional theory\n(TDDFT).\nFor both frameworks, BSE and TDDFT, users can select two different strategies to compute\nϵ\ni\nj\n(\nω\n)\n{\\displaystyle \\epsilon_{ij}(\\omega)}\n. The first is based on the eigendecomposition of the electron-hole hamiltonian,\nH\ne\nx\nc\n{\\displaystyle H^\\mathrm{exc}}\n. It allows for the evaluation of\nϵ\ni\nj\n(\nω\n)\n{\\displaystyle \\epsilon_{ij}(\\omega)}\nby initially obtaining the eigenvalues and eigenvectors of\nH\ne\nx\nc\n{\\displaystyle H^\\mathrm{exc}}\nand then using both to evaluate\nϵ\ni\nj\n(\nω\n)\n{\\displaystyle \\epsilon_{ij}(\\omega)}\n. This strategy is based on the\nBethe-Salpeter equation\nor the\nCasida equation\n. The second strategy transforms the mathematical expression of\nϵ\ni\nj\n(\nω\n)\n{\\displaystyle \\epsilon_{ij}(\\omega)}\ninto a time-dependent integral. By propagating the dipolar moments in time and then applying a Fourier transform, VASP can compute\nϵ\ni\nj\n(\nω\n)\n{\\displaystyle \\epsilon_{ij}(\\omega)}\n.\nThe advantage of the later method in relation to the former is related to their cost. The time-dependent integral has a cost of the order\nO\n(\nN\n2\n)\n{\\displaystyle O(N^2)}\n, while the eigendecomposition has a cost of the order\nO\n(\nN\n3\n)\n{\\displaystyle O(N^3)}\n, where\nN\n{\\displaystyle N}\nis the rank of\nH\ne\nx\nc\n{\\displaystyle H^\\mathrm{exc}}\n. This means that for very large numbers of bands or k-points, the time-dependent formalism is cheaper than the eigendecomposition method.\nBelow is a brief description of the method, from its theoretical support to how calculations should be performed, with the relevant approximations needed in the two-particle Hamiltonian.\nWarning:\nIn VASP < 6.5.2 the dielectric function is not calculated correctly with\nALGO\n=TIMEEV if\nISYM\n>0.\nThe macroscopic-dielectric function as a time-dependent integral\nThe starting point is that one can re-write\nϵ\ni\nj\n(\nω\n)\n{\\displaystyle \\epsilon_{ij}(\\omega)}\nas a time-dependent integral\n[1]\n. It starts from its expression, given by\nϵ\nM\n(\nω\n)\n=\n1\n+\n4\nπ\nΩ\n0\n∑\nλ\n|\n∑\nc\nv\nk\nμ\nc\nv\nk\nA\nc\nv\nk\nλ\n|\n2\n[\n1\nω\n+\nE\nλ\n+\ni\nη\n−\n1\nω\n−\nE\nλ\n+\ni\nη\n]\n{\\displaystyle\n\\epsilon^M(\\omega)=1+\\frac{4 \\pi}{\\Omega_0} \\sum_\\lambda\\left|\\sum_{c v \\mathbf{k}} \\mu_{c v \\mathbf{k}} A_{c v \\mathbf{k}}^\\lambda\\right|^2\\left[\\frac{1}{\\omega+E_\\lambda+\\mathrm{i} \\eta}-\\frac{1}{\\omega-E_\\lambda+\\mathrm{i} \\eta}\\right]\n}\n,\nwhere\nμ\nv\nc\nk\nj\n=\n⟨\nc\nk\n|\nv\nj\n|\nv\nk\n⟩\nε\nc\n(\nk\n)\n−\nε\nv\n(\nk\n)\n{\\displaystyle \\mu_{v c \\mathbf{k}}^j=\\frac{\\left\\langle c \\mathbf{k}\\left|v_j\\right| v \\mathbf{k}\\right\\rangle}{\\varepsilon_c(\\mathbf{k})-\\varepsilon_v(\\mathbf{k})}}\nis the dipolar moment associated to the the conduction\nc\n{\\displaystyle c}\n, valence band\nv\n{\\displaystyle v}\n, and k-point\nk\n{\\displaystyle k}\n.\nλ\n{\\displaystyle \\lambda}\nis the index of the eigenstate of\nH\ne\nx\nc\n{\\displaystyle H^\\mathrm{exc}}\n, with\nA\nλ\n{\\displaystyle A^\\lambda}\nand\nE\nλ\n{\\displaystyle E_\\lambda}\nbeing the associated eigenvector and eigenvalue.\nThis definition of\nϵ\ni\nj\n(\nω\n)\n{\\displaystyle \\epsilon_{ij}(\\omega)}\ncan be brought into operational form\nϵ\nM\n(\nω\n)\n=\n1\n+\n4\nπ\nΩ\n0\n⟨\nμ\n|\n[\n1\nω\n+\ni\nη\n+\nH\n^\ne\nx\nc\n−\n1\nω\n+\ni\nη\n−\nH\n^\ne\nx\nc\n]\n|\nμ\n⟩\n{\\displaystyle\n\\epsilon^M(\\omega)=1+\\frac{4 \\pi}{\\Omega_0}\\left\\langle\\mu\\left|\\left[\\frac{1}{\\omega+\\mathrm{i} \\eta+\\hat{H}^{\\mathrm{exc}}}-\\frac{1}{\\omega+\\mathrm{i} \\eta-\\hat{H}^{\\mathrm{exc}}}\\right]\\right| \\mu\\right\\rangle\n}\nby using the spectral decomposition\n[\nH\n^\ne\nx\nc\n−\nω\n]\n−\n1\n=\n∑\nλ\n|\nA\nλ\n⟩\n⟨\nA\nλ\n|\nE\nλ\n−\nω\n{\\displaystyle \\left[\\hat{H}^{\\mathrm{exc}}-\\omega\\right]^{-1}=\\sum_\\lambda \\frac{\\left|A_\\lambda\\right\\rangle\\left\\langle A_\\lambda\\right|}{E_\\lambda-\\omega}}\n. The new expression of\nϵ\n(\nω\n)\n{\\displaystyle \\epsilon(\\omega)}\nis related to a time-dependent integral, using the fact that\n1\nω\n+\ni\nη\n−\nH\n^\ne\nx\nc\n|\nμ\n⟩\n=\n−\ni\n∫\n0\n∞\ne\n−\ni\n(\nω\n−\nH\n^\ne\nx\nc\n+\ni\nη\n)\nt\n|\nμ\n⟩\n=\n−\ni\n∫\n0\n∞\ne\n−\ni\n(\nω\n+\ni\nη\n)\nt\ne\ni\nH\n^\ne\nx\nc\nt\n|\nμ\n⟩\n{\\displaystyle\n\\frac{1}{\\omega+\\mathrm{i} \\eta-\\hat{H}^{\\mathrm{exc}}}|\\mu\\rangle=-\\mathrm{i} \\int_0^{\\infty} e^{-\\mathrm{i}\\left(\\omega-\\hat{H}^{\\mathrm{exc}}+\\mathrm{i} \\eta\\right) t}|\\mu\\rangle=-\\mathrm{i} \\int_0^{\\infty} e^{-\\mathrm{i}(\\omega+\\mathrm{i} \\eta) t} e^{\\mathrm{i} \\hat{H}^{\\mathrm{exc}}t}|\\mu\\rangle\n}\n,\nand recognizing that\ne\ni\nH\n^\ne\nx\nc\nt\n|\nμ\n⟩\n=\n|\nξ\n(\nt\n)\n⟩\n{\\displaystyle e^{\\mathrm{i} \\hat{H}^{\\mathrm{exc}}t}|\\mu\\rangle = |\\xi(t)\\rangle}\nis the exponential form of a time-dependent equation operator. These considerations allow for the expression of\nϵ\ni\nj\n(\nω\n)\n{\\displaystyle \\epsilon_{ij}(\\omega)}\nto be written as\nϵ\ni\nj\n(\nω\n)\n=\nδ\ni\nj\n−\n4\nπ\ne\n2\nΩ\n∫\n0\n∞\nd\nt\n∑\nc\n,\nv\n,\nk\n(\n⟨\nμ\nc\nv\nk\nj\n|\nξ\nc\nv\nk\ni\n(\nt\n)\n⟩\n+\nc\n.\nc\n.\n)\ne\n−\ni\n(\nω\n−\ni\nη\n)\nt\n{\\displaystyle\n\\epsilon_{ij}(\\omega)=\\delta_{ij}-\\frac{4\\pi e^2}{\\Omega}\\int_0^{\\infty} \\mathrm{d} t\n\\sum_{c,v,\\mathbf{k}}\\left(\\langle\\mu^j_{cv\\mathbf{k}}| \\xi^i_{cv\\mathbf{k}}(t)\\rangle+ \\mathrm{c.c.}\\right) e^{-\\mathrm i(\\omega-\\mathrm i \\eta) t}\n}\n.\nThe fundamental aspect behind this transformation is that the new, time-dependent vector\n∣\nξ\nj\n(\nt\n)\n⟩\n{\\displaystyle \\left.\\mid \\xi^j(t)\\right\\rangle}\nfollows the equation\ni\nd\nd\nt\n|\nξ\nj\n(\nt\n)\n⟩\n=\nH\n^\ne\nx\nc\n(\nt\n)\n|\nξ\nj\n(\nt\n)\n⟩\n,\n{\\displaystyle\n\\mathrm i \\frac{\\mathrm d}{\\mathrm d t}\\left|\\xi^j(t)\\right\\rangle=\\hat{H}^\\mathrm{exc}(t)\\left|\\xi^j(t)\\right\\rangle,\n}\nwith the initial vector given by\n|\nξ\nj\n(\n0\n)\n⟩\n=\n|\nμ\nj\n⟩\n{\\displaystyle \\left|\\xi^j(0)\\right\\rangle=\\left|\\mu^j\\right\\rangle}\n.\nTo compute the dielectric function with this method, VASP evaluates and stores at each time step the projections of\n∣\nξ\nj\n(\nt\n)\n⟩\n{\\displaystyle \\left.\\mid \\xi^j(t)\\right\\rangle}\nover\n∣\nμ\ni\n⟩\n{\\displaystyle \\left.\\mid \\mu^i\\right\\rangle}\n,\nc\nc\nv\nk\ni\nj\n(\nt\n)\n=\n⟨\nμ\nc\nv\nk\ni\n|\nξ\nc\nv\nk\ni\n(\nt\n)\n⟩\n{\\displaystyle c^{ij}_{cv\\mathbf k}(t) = \\langle \\mu^i_{cv\\mathbf k}|\\xi^i_{cv\\mathbf k}(t)\\rangle}\n. It is the fact that all these operations are of the matrix-vector type that makes this method having a cost of the order of\nO\n(\nN\n2\n)\n{\\displaystyle O(N^2)}\n.\nPerturbing all transitions with a delta-like potential\nIn order to probe all possible\nv\n→\nc\n{\\displaystyle v\\to c}\ntransitions, a time-dependent term is added to the hamiltonian\n[2]\nV\ne\nx\nt\n(\nr\n,\nt\n)\n=\nλ\nr\n⋅\nD\nδ\n(\nt\n)\n,\n{\\displaystyle\nV_\\mathrm{ext}(\\mathbf r, t) = \\lambda \\mathbf r\\cdot \\mathbf D\\delta(t),\n}\nwhere\nλ\n{\\displaystyle \\lambda}\nis the perturbation strength parameter and\nD\n{\\displaystyle \\mathbf D}\nis the electric displacement field. The narrow (in time) potential allows all bands in the occupied and unoccupied manifolds to be included in the transition space. The constant displacement field replicates the long wavelength limit (i.e.\nq\n→\n0\n{\\displaystyle \\mathbf q \\to 0}\n).\nThe many-body terms in the hamiltonian\nApproximations to the interaction between electrons and holes are controlled in the\nINCAR\nby the tags\nLHARTREE\n,\nLADDER\n, and\nLFXC\n, which can be set to either .TRUE. or .FALSE.. Below we provide an explanation of what interaction term each tag controls.\nMind:\nThe default setup for VASP is LHARTREE and LADDER set to .FALSE., while LFXC is set to .TRUE.. This means that if no tags are set in the INCAR the time-propagation run will using the TDDFT kernel.\nIndependent-particle approximation\nIn this approximation all interaction terms in the hamiltonian are turned off by setting\nLHARTREE\n,\nLADDER\n, and\nLFXC\nto .FALSE. in the\nINCAR\nfile. This means that the computed spectrum will be equal the one obtained during a ground-state calculation with\nLOPTICS\n=.TRUE.. This calculation is useful to test if everything is in order with the input files and the workflow is properly setup.\nHartree exchange potential\nWith the tag\nLHARTREE\n=.TRUE. the interaction terms in the hamiltonian will include the unscreened Coulomb exchange. These terms are also known as the bubble diagrams from many-body perturbation theory (MBPT). With both\nLFXC\nand\nLADDER\nset to .FALSE., this will be equivalent to running random-phase approximation (RPA) calculation.\nNote that at the end, the dielectric function reported in the output files is the macroscopic dielectric function, where no contributions from local fields (i.e. terms with finite\nG\n{\\displaystyle \\mathbf G}\n) are included.\nThe missing interaction between electrons and holes from either\nLFXC\nor\nLADDER\nhas as consequence that bound excitons cannot be properly described, which is a known problem of RPA. However, it can still be used to compute the electron energy-loss function,\nEELS\n.\nScreened two-particle interaction\nExchange-correlation effects from time-dependent density functional theory\nSetting\nLFXC\n=.TRUE. includes the local exchange-correlation kernel,\nf\nx\nc\n{\\displaystyle f_\\mathrm{xc}}\nin the time-propagation\nf\nx\nc\nloc\n(\nr\n,\nr\n′\n)\n=\nδ\n2\n{\nE\nc\nD\nF\nT\n+\n(\n1\n−\nc\nx\n)\nE\nx\nD\nF\nT\n}\nδ\nρ\n(\nr\n)\nδ\nρ\n(\nr\n′\n)\n,\n{\\displaystyle\nf_{\\mathrm{xc}}^{\\text {loc }}\\left(\\mathbf{r}, \\mathbf{r}^{\\prime}\\right)=\\frac{\\delta^2\\left\\{E_{\\mathrm{c}}^{\\mathrm{DFT}}+\\left(1-c_{\\mathrm{x}}\\right) E_{\\mathrm{x}}^{\\mathrm{DFT}}\\right\\}}{\\delta \\rho(\\mathbf{r}) \\delta \\rho\\left(\\mathbf{r}^{\\prime}\\right)},\n}\nwhere\nc\nX\n{\\displaystyle c_X}\ncontrols the fraction of the exchange energy functional that is included in the kernel (see\nAEXX\n). This lets users perform time-dependent calculations using hybrid functionals.\nThese kernels often lack the long-range component (which goes as\n−\n1\n/\nq\n2\n{\\displaystyle -1/q^2}\n, where\nq\n{\\displaystyle q}\nis the momentum difference between the electron and the hole). When using them in periodic or extended systems it is very likely that they will fail to properly reproduce the binding energies of electron-hole pairs.\nLadder diagrams from many-body perturbation theory\nBy setting\nLADDER\n=.TRUE. the interaction hamiltonian will include the screened exchange interaction potential,\nW\n(\nr\n,\nr\n′\n;\nω\n)\n{\\displaystyle W(\\mathbf r,\\mathbf r';\\omega)}\n. This treats the electron-hole interaction by including the ladder diagrams from MBPT\n[3]\n. This term also has the correct long-range behaviour, meaning that it can properly describe bound electron-hole pairs in solids and large molecules.\nAt the present, the screened interaction has to be computed from a\nmodel dielectric function\n, given by\nε\nG\n,\nG\n−\n1\n(\nq\n)\n=\n1\n−\n(\n1\n−\nε\n∞\n−\n1\n)\nexp\n(\n−\n|\nq\n+\nG\n|\n2\n4\nλ\n2\n)\n{\\displaystyle  {\\varepsilon}_{\\mathbf{G},\\mathbf{G}}^{-1}(\\mathbf{q})=1-(1-{{\\varepsilon}_{\\infty}^{-1}})\\text{exp}\\left(-\\frac{|\\mathbf{q+G}|^2}{4{\\lambda}^2}\\right)}\n.\nBoth\nLHFCALC\nand\nLMODELHF\nmust be set to .TRUE.. Also, VASP must be provided both with\nHFSCREEN\n(\nλ\n{\\displaystyle \\lambda}\n) and\nAEXX\n(\nε\n∞\n−\n1\n{\\displaystyle {\\varepsilon}_{\\infty}^{-1}}\n) to control the range separation parameters in the model dielectric function.\nStep-by-step instructions on bulk Si\nStep 1: ground state with extra empty states\nThe starting point is a ground-state calculation which includes extra empty states, whose number is controlled in the\nINCAR\nfile with the tag\nNBANDS\n.  In the following example\nINCAR\nfile\nSYSTEM\n= Si\nNBANDS\n= 12\nISMEAR\n= 0 ;\nSIGMA\n= 0.05\nALGO\n= N\nLOPTICS\n= .TRUE.\nKPAR\n= 4\n8 empty bands are chosen (silicon has 4 occupied bands in the pseudo-potential file, thus making a total of 12 bands for\nNBANDS\n). However, with\nALGO\n=N, VASP will employ an iterative diagonalization algorithm, meaning that the last conduction states will not be converged with the same accuracy level as the occupied states. It is possible to avoid this by setting\nALGO\n=Exact, or by increasing the number of bands to make sure that the states which will be used in the time-propagation step are converged with the same level of accuracy.\nFinally, with\nLOPTICS\n=.TRUE., VASP will compute the dipole momentum for each possible\nv\n→\nc\n{\\displaystyle v\\to c}\ntransition (recall the definition of the dipole momentum vector). These are written in the file\nWAVEDER\n, which will be used in the next step.\nMind:\nThis calculation was performed on bulk Si (primitive cell), with a gamma-centred, 4x4x4 k-point grid, using the PBE standard pseudopotential.\nStep 2: time-evolution run\nOnce the ground state with extra empty states is computed, the resulting\nWAVECAR\nand\nWAVEDER\nfiles are ready to use in a time-propagation calculation. The following will be used as an example\nINCAR\nfile:\nSYSTEM\n= Si\nALGO\n= TIMEEV\n!Information about the bands\nNBANDS\n= 12\nNBANDSO\n= 4\nNBANDSV\n= 8\n!Smearing parameters\nISMEAR\n= 0 ;\nSIGMA\n= 0.05\n!Direction of propagation\nIEPSILON\n= 1\n!Parallelization options\nKPAR\n= 4\n!Time-propagation parameters\nNELM\n= 2000\nCSHIFT\n= 0.1\nOMEGAMAX\n= 20\n!Particle interactions\nLHARTREE\n= .TRUE.\nLADDER\n= .TRUE.\nLFXC\n= .FALSE.\nLHFCALC\n= .TRUE.\nLMODELHF\n= .TRUE.\nAEXX\n= 0.088\nHFSCREEN\n= 1.26\nHere\nALGO\nis set to TIMEEV, meaning that VASP will now perform a time-propagation calculation.\nSetting up the bands\nWith\nNBANDS\n=12 informs VASP that there are 12 states in total in the\nWAVECAR\nand\nWAVEDER\n. This must be consistent with Step 1! The number of occupied and unoccupied states that are used in the propagation is controlled by the\nNBANDSO\nand\nNBANDSV\ntags, respectively. To choose which bands to use it is advisable to understand the type of property that is going to be studied. For instance, in the case of optical absorption, materials are probed within a few hundreds of milli-electronvolt of the band gap. In this case it means that only states that lie close to the band extrema are important for the time-propagation.\nIn this example VASP will use\nNBANDSO\n=4 occupied and\nNBANDSV\n=8 unoccupied states during the time propagation. There is no need to use the total number of bands set up by\nNBANDS\n, but still\nNBANDSO\n+\nNBANDSV\ncannot be larger than\nNBANDS\n.\nSetting up the time-step\nVASP is now integrating a time-dependent differential equation so the time-step used to propagate the dipole moments can be specified in the\nINCAR\n. By default, VASP will use 20000 steps, however a different number can be set with the tag\nNELM\n. Nevertheless,\nNELM\nmust be larger than 100, otherwise VASP will revert to the default value.\nThe time-step,\nΔ\nt\n{\\displaystyle \\Delta t}\n, and maximum propagation time,\nT\nm\na\nx\n{\\displaystyle T_\\mathrm{max}}\n, are not dependent on the size of the interacting hamiltonian matrix. However they are dependent on the system in case and the input tag\nCSHIFT\nand\nOMEGAMAX\n. This comes from the Fourier transform used to integrate the time-dependent dipole moments, which leads to\nT\nm\na\nx\n≈\n1\n/\nC\nS\nH\nI\nF\nT\n{\\displaystyle T_\\mathrm{max} \\approx 1/\\mathrm{CSHIFT}}\nand\nΔ\nt\n≈\n1\n/\nO\nM\nE\nG\nA\nM\nA\nX\n{\\displaystyle \\Delta t \\approx 1/\\mathrm{OMEGAMAX}}\n.\nThe tag\nCSHIFT\nalso controls the width used in the plotting of the dielectric function, since\n1\nω\n−\nE\nλ\n+\ni\nη\n=\n1\nω\n−\nE\nλ\n−\ni\nπ\nδ\n(\nω\n−\nE\nλ\n)\n{\\displaystyle\n\\frac{1}{\\omega - E_\\lambda + \\mathrm i \\eta} = \\frac{1}{\\omega - E_\\lambda} - \\mathrm i\\pi \\delta(\\omega - E_\\lambda)\n}\nand the\nδ\n{\\displaystyle \\delta}\n-function is approximated as\nδ\n(\nω\n−\nE\nλ\n)\n=\nlim\nη\n→\n0\n+\n1\nπ\nη\n(\nω\n−\nE\nλ\n)\n2\n+\nη\n2\n{\\displaystyle \\delta(\\omega - E_\\lambda) = \\lim_{\\eta\\to 0^+}\\frac{1}{\\pi}\\frac{\\eta}{(\\omega - E_\\lambda)^2+\\eta^2}}\n, with\nCSHIFT\n=\nη\n{\\displaystyle \\eta}\n.\nSetting\nCSHIFT\n= 0.1 ~ 0.01 is often a good choice, as lower values will lead to unnecessarily long propagation times and spectra with very narrow peaks.\nOMEGAMAX\nis automatically from the maximum energy difference between occupied and unoccupied states, but can be lowered to decrease the number of pairs used in the basis set and the size of the interacting hamiltonian.\nChoosing the direction of perturbation\nThe dipole momentum vector\nμ\ni\n{\\displaystyle \\mu^i}\nis direction dependent. The direction of propagation is chosen in the\nINCAR\nwith the tag\nIEPSILON\n, which can take values of 1, 2, or 3 (corresponding to x, y, and z direction, respectively), and 4 (corresponding to all directions).\nWhile choosing a single direction of propagation decreases the computing time, it is important to pay attention to the symmetries of the material in study. For example, in the case of bulk silicon, since the material has cubic symmetry propagating along one direction (x, or y, or z) is enough. However, for a material like monolayer hexagonal boron nitride, the crystal symmetries destroy the equivalency between the x and y directions. For this system propagation should happen along both x and y, and then the dielectric function should be the average of both calculations.\nAnalysing the results\nOnce the calculation is finished, the dielectric function can be plotted by executing the following script\n#!/bin/sh\nawk\n'BEGIN{i=0} /<dielectricfunction comment=\"time-propagation\">/,\\\n/<\\/dielectricfunction>/ \\\n{if ($1==\"<r>\") {a[i]=$2 ; b[i]=($3+$4+$5)/3 ; c[i]=$4 ; d[i]=$5 ; i=i+1}} \\\nEND{for (j=0;j<i/2;j++) print a[j],b[j],b[j+i/2]}'\nvasprun.xml > optics.dat\nwhich can be copied to a file (e.g. extract_optics.sh) in the same directory where the calculation was performed and then ran with\n$ sh extract_optics.sh\nThis creates a file called optics.dat with three data columns. The first column is the energy of excitation, in eV. The second and third columns correspond to the imaginary and real parts of\n1\n3\n[\nϵ\nx\nx\n(\nω\n)\n+\nϵ\ny\ny\n(\nω\n)\n+\nϵ\nz\nz\n(\nω\n)\n]\n{\\displaystyle \\frac{1}{3}[\\epsilon_{xx}(\\omega)+\\epsilon_{yy}(\\omega)+\\epsilon_{zz}(\\omega)]}\n. For the example shown here, the obtained\nI\nm\n[\nϵ\n]\n{\\displaystyle \\mathrm{Im}[\\epsilon]}\nshould be similar to the following image.\nAlternatively, if VASP was compiled with hdf5 support, the results can also be plotted with py4vasp\nimport py4vasp\n#replace path_to_calculation below with the path to the directory where the corresponding vaspout.h5 is located\ncalc\n=\npy4vasp.Calculation.from_path\n(\n\"path_to_calculation\"\n)\ncalc.dielectric_function.plot\n(\n\"TIMEEV\"\n)\nwhich will create the following figure with both the real and imaginary part of\nϵ\n(\nω\n)\n{\\displaystyle \\epsilon(\\omega)}\n.\nMind:\nIt should be stated that this is just an example, not a converged calculation! Several numerical parameters should be checked for convergence (e.g. number of k-points, number of empty states, etc).\nComparison to other methods\nVASP offers two other methods with which you can compute the macroscopic dielectric function. These are based on eigendecomposition of the two particle hamiltonian,\nH\ne\nx\nc\n{\\displaystyle H^\\mathrm{exc}}\n. While more expensive than time-evolution, both these methods are able to compute eigenvalues and eigenstates of\nH\ne\nx\nc\n{\\displaystyle H^\\mathrm{exc}}\n, thus providing direct access to the excitation energies of a system.\nBethe-Salpeter equation\nHere the full\nBethe-Salpeter equation\nis employed by setting\nALGO\n=BSE. The interaction hamiltonian is built using the dielectric function from RPA, and has the right behaviour in the long range regime. This means that it can accurately describe bound excitons in solids and large molecules. However, it is more costly than time-evolution, scaling with\nN\nr\na\nn\nk\n3\n{\\displaystyle N_\\mathrm{rank}^3}\n.\nCasida equation\nSimilar to the Bethe-Salpeter equation, the\nCasida equation\nemploys an eigensolver method to compute the dielectric function. This is chosen in the\nINCAR\nwith\nALGO\n=TDHF. The key difference is that the Casida method does not require a preceding GW run to compute the RPA screening and can be performed with either DFT or hybrid-functional orbitals and energies.\nRelated tags and articles\nNBANDSO\n,\nNBANDSV\n,\nIEPSILON\n,\nNELM\n,\nLHARTREE\n,\nLADDER\n,\nLFXC\n,\nLHFCALC\n,\nLMODELHF\n,\nAEXX\n,\nHFSCREEN\nTime-dependent density-functional theory calculations\nBethe-Salpeter-equations calculations\nReferences\n↑\nW. G. Schmidt, S. Glutsch, P. H. Hahn, and F. Bechstedt,\nEfficient O(N2) method to solve the Bethe-Salpeter equation\n, Phys. Rev. B\n67\n, 085307 (2003)\n↑\nT. Sander, G. Kresse,\nMacroscopic dielectric function within time-dependent density functional theory—Real time evolution versus the Casida approach\n, J. Chem. Phys.\n146\n, 064110 (2017)\n↑\nT. Sander, E. Maggio, and G. Kresse,\nBeyond the Tamm-Dancoff approximation for extended systems using exact diagonalization\n, Phys. Rev. B\n92\n, 045209 (2015)."
  }, 
  "Tkatchenko-Scheffler method": {
    "description": "The Tkatchenko-Scheffler method is a dispersion correction approach in density functional theory (DFT) that improves upon the DFT-D2 method by making dispersion coefficients and damping functions dependent on the local chemical environment through charge-density-based Hirshfeld partitioning, allowing for more accurate modeling of van der Waals (vdW) interactions in molecules and solids.", 
    "detailed_description": "The expression for the dispersion energy within the method of Tkatchenko and Scheffler\n[1]\nis formally identical to that of the\nDFT-D2\nmethod. The important difference is, however, that the dispersion coefficients and damping function are charge-density dependent. The Tkatchenko-Scheffler method is therefore able to take into account variations in vdW contributions of atoms due to their local chemical environment. In this method the polarizability, dispersion coefficients, and atomic radii of an atom in a molecule or a solid are computed from their free-atomic values using the following relations:\nα\ni\n=\nν\ni\nα\ni\nf\nr\ne\ne\n,\n{\\displaystyle \\alpha_{i}  = \\nu_{i}\\, \\alpha_{i}^{free},}\nC\n6\ni\ni\n=\nν\ni\n2\nC\n6\ni\ni\nf\nr\ne\ne\n,\n{\\displaystyle C_{6ii} = \\nu_{i}^{2}\\,C_{6ii}^{free},}\nR\n0\ni\n=\n(\nα\ni\nα\ni\nf\nr\ne\ne\n)\n1\n3\nR\n0\ni\nf\nr\ne\ne\n.\n{\\displaystyle  R_{0i} = \\left(\\frac{\\alpha_{i}}{\\alpha_{i}^{free}} \\right)^{\\frac{1}{3}} R_{0i}^{free}. }\nThe free-atomic quantities\nα\ni\nf\nr\ne\ne\n,\nC\n6\ni\ni\nf\nr\ne\ne\n{\\displaystyle \\alpha_{i}^{free},C_{6ii}^{free}}\nand\nR\n0\ni\nf\nr\ne\ne\n{\\displaystyle R_{0i}^{free}}\nare tabulated for all elements from the first six rows of the periodic table except for lanthanides. If a Tkatchenko-Scheffler calculation is performed for the system containing an unsupported element, the user has to define the corresponding values using the tags\nVDW_ALPHA\n,\nVDW_C6\nand\nVDW_R0\n(see below). The effective atomic volumes\nν\ni\n{\\displaystyle \\nu_{i}}\nare determined using the Hirshfeld partitioning of the all-electron density:\nν\ni\n=\n∫\nr\n3\nw\ni\n(\nr\n)\nn\n(\nr\n)\nd\n3\nr\n∫\nr\n3\nn\ni\nf\nr\ne\ne\n(\nr\n)\nd\n3\nr\n{\\displaystyle \\nu_{i} = \\frac{\\int r^3 \\,w_i({\\mathbf{r}}) n({\\mathbf{r}})\\,d^3{\\mathbf{r}}}{\\int r^3\\, n_{i}^{free}({\\mathbf{r}})\\,d^3{\\mathbf{r}}}}\nwhere\nn\n(\nr\n)\n{\\displaystyle n({\\mathbf{r}})}\nis the total electron density and\nn\ni\nf\nr\ne\ne\n(\nr\n)\n{\\displaystyle n_{i}^{free}({\\mathbf{r}})}\nis the spherically averaged electron density of the neutral free atomic species\ni\n{\\displaystyle i}\n. The Hirshfeld weight\nw\ni\n(\nr\n)\n{\\displaystyle w_i({\\mathbf{r}})}\nis defined by free atomic densities as follows:\nw\ni\n(\nr\n)\n=\nn\ni\nf\nr\ne\ne\n(\nr\n)\n∑\nj\n=\n1\nN\na\nt\nn\nj\nf\nr\ne\ne\n(\nr\n)\n.\n{\\displaystyle  w_i({\\mathbf{r}}) = \\frac{n_{i}^{free}({\\mathbf{r}})}{\\sum_{j=1}^{N_{at}} n_{j}^{free}({\\mathbf{r}})}. }\nThe combination rule to define the strength of the dipole-dipole dispersion interaction between unlike species is:\nC\n6\ni\nj\n=\n2\nC\n6\ni\ni\nC\n6\nj\nj\n[\nα\nj\nα\ni\nC\n6\ni\ni\n+\nα\ni\nα\nj\nC\n6\nj\nj\n]\n.\n{\\displaystyle  C_{6ij} = \\frac{2C_{6ii}\\,C_{6jj}}{[\\frac{\\alpha_{j}} {\\alpha_{i}}C_{6ii}+\\frac{\\alpha_{i}}{\\alpha_{j}}C_{6jj}]}. }\nThe parameter\nR\n0\ni\nj\n{\\displaystyle R_{0ij}}\nused in the damping function of the\nDFT-D2\nmethod is obtained from the atom-in-molecule vdW radii as follows:\nR\n0\ni\nj\n=\nR\n0\ni\n+\nR\n0\nj\n.\n{\\displaystyle  R_{0ij} = R_{0i} + R_{0j}. }\nThe performance of the Tkatchenko-Scheffler method in optimization of various crystalline systems has been examined in reference\n[2]\n.\nUsage\nThe Tkatchenko-Scheffler method is invoked by setting\nIVDW\n=2|20. The following parameters can be optionally defined in\nINCAR\n(the given values are the default ones):\nLVDWSCS\n=.FALSE. : activates the\nself-consistent screening in Tkatchenko-Scheffler method\nVDW_RADIUS\n=50.0 : cutoff radius (in Å) for pair interactions\nVDW_S6\n=1.00 : global scaling factor\ns\n6\n{\\displaystyle s_6}\nVDW_SR\n=0.94 : scaling factor\ns\nR\n{\\displaystyle s_R}\nVDW_D\n=20.0 : damping parameter\nd\n{\\displaystyle d}\nVDW_ALPHA\n=[real array] : free-atomic polarizabilities (atomic units) for each species defined in the\nPOSCAR\nfile\nVDW_C6AU\n=[real array] : free-atomic\nC\n6\n{\\displaystyle C_6}\nparameters (atomic units) for each species defined in the\nPOSCAR\nfile\nVDW_C6\n=[real array] : free-atomic\nC\n6\n{\\displaystyle C_6}\nparameters (\nJ\nn\nm\n6\nm\no\nl\n−\n1\n{\\displaystyle \\mathrm{Jnm}^{6}\\mathrm{mol}^{-1}}\n) for each species defined in the\nPOSCAR\nfile (this parameter overrides\nVDW_C6AU\n)\nVDW_R0AU\n=[real array] : free-atomic\nR\n0\n{\\displaystyle R_0}\nparameters (atomic units) for each species defined in the\nPOSCAR\nfile\nVDW_R0\n=[real array] :\nR\n0\n{\\displaystyle R_0}\nparameters (in Å) for each species defined in the\nPOSCAR\nfile (this parameter overrides\nVDW_R0AU\n)\nLVDW_EWALD\n=.FALSE. : the lattice summation in\nE\nd\ni\ns\np\n{\\displaystyle E_{\\mathrm{disp}}}\nexpression is computed by means of Ewald's summation (\n.TRUE.\n) or via a real space summation over all atomic pairs within cutoff radius\nVDW_RADIUS\n(\n.FALSE.\n).  (available in VASP.5.3.4 and later)\nLTSSURF\n=.FALSE.: if set to .TRUE., the standard parametrization of the Tkatchenko-Scheffler method is replaced by the one designed to enable reliable modeling of structure and stability for a broad class of organic molecules adsorbed on metal surfaces is activated\n[3]\nMind:\nThis method requires the use of\nPOTCAR\nfiles from the PAW dataset version 52 or later.\nThe input reference data for non-interacting atoms is available only for elements of the first six rows of the periodic table except for lanthanides. If the system contains other elements, the user must provide the free-atomic parameters for all atoms in the system via\nVDW_ALPHA\n,\nVDW_C6\n,\nVDW_R0\ndefined in the\nINCAR\nfile.\nThe charge-density dependence of gradients is neglected.\nThe DFT-TS method is incompatible with the setting\nADDGRID\n=\n.TRUE.\n.\nIt is essential that a sufficiently dense FFT grid (controlled via\nNGXF\n,\nNGYF\nand\nNGZF\n) is used in the DFT-TS calculation - we strongly recommend to use\nPREC\n=\nAccurate\nfor this type of calculations (in any case, avoid using\nPREC\n=\nLow\n).\nDefaults for the parameters controlling the damping function (\nVDW_S6\n,\nVDW_SR\n,\nVDW_D\n) are available for the PBE, PBE0, HSE03, HSE06, TPSS, and M06L functionals. If any other functional is used, the value of\nVDW_SR\nmust be specified in the\nINCAR\nfile.\nEwald's summation in the calculation of\nE\nd\ni\ns\np\n{\\displaystyle E_{disp}}\n(controlled via\nLVDW_EWALD\n) implemented according to reference\n[4]\nis available as of VASP.5.3.4.\nParameters\nVDW_C6AU\nand\nVDW_R0AU\nare available as of VASP.5.3.4.\nHirshfeld charges for all configurations generated in a calculation are written out in the\nOUTCAR\nfile. The corresponding table is introduced by the expression\nHirshfeld charges:\n.\nRelated tags and articles\nVDW_RADIUS\n,\nVDW_S6\n,\nVDW_SR\n,\nVDW_D\n,\nVDW_ALPHA\n,\nVDW_C6AU\n,\nVDW_C6\n,\nVDW_R0AU\n,\nVDW_R0\n,\nLVDW_EWALD\n,\nIVDW\n,\nTkatchenko-Scheffler method with iterative Hirshfeld partitioning\n,\nSelf-consistent screening in Tkatchenko-Scheffler method\n,\nMany-body dispersion energy\n,\nMany-body dispersion energy with fractionally ionic model for polarizability\nReferences\n↑\nA. Tkatchenko and M. Scheffler, Phys. Rev. Lett.\n102\n, 073005 (2009).\n↑\nT. Bučko, S. Lebègue, J. Hafner, and J. G. Ángyán, Phys. Rev. B\n87\n, 064110 (2013).\n↑\nV. G. Ruiz, W. Liu, and A. Tkatchenko, Phys. Rev. B 93, 035118 (2016).\n↑\nT. Kerber, M. Sierka, and J. Sauer, J. Comput. Chem.\n29\n, 2088 (2008)."
  }, 
  "Transport coefficients including electron-phonon scattering": {
    "description": "This webpage details the computation of electronic transport properties, such as conductivity, mobility, and thermoelectric coefficients, using the linearized Boltzmann equation and electron-phonon coupling within VASP, including input parameters, approximations like CRTA and SERTA, and considerations for metals and semiconductors.", 
    "detailed_description": "In the framework of the linearized Boltzmann equations, we can compute a few electronic transport observables.\nThe transport coefficients can be evaluated rather straightforwardly under the approximation of the constant relaxation time.\nThe most computationally demanding part of the calculation is the electronic linewidths due to the electron-phonon scattering.\nAs such, it is instructive to start by computing the transport coefficients in the constant-relaxation-time approximation (CRTA).\nThis gives us an idea of the\nk\n-point density required to obtain a precise value.\nMind:\nAvailable as of VASP 6.5.0\nThe most basic\nINCAR\nto compute the transport coefficients is\nPREC\n= Accurate\nEDIFF\n= 1e-8\nISMEAR\n= -15; SIGMA = 0.01\nLREAL\n= .FALSE.\nLWAVE\n= .FALSE.\nLCHARG\n= .FALSE.\n#run electron-phonon calculation\nELPH_MODE\n= TRANSPORT\n# for the determination of the chemical potential\nELPH_ISMEAR\n= -15 # smearing method\n# for the computation of transport coefficients\nTRANSPORT_NEDOS\n= 501\nELPH_SELFEN_TEMPS\n= 0 100 200 300 400 500\nThe final output of the code is reported for each combination of computational parameters using the concept of\nelectron-phonon accumulators\n.\nConductivity for metals\nConductivity\nσ\nα\nβ\n{\\displaystyle \\sigma_{\\alpha\\beta}}\nrelates the current to the applied electric field\nJ\nα\n=\nσ\nα\nβ\nE\nβ\n{\\displaystyle  J_\\alpha = \\sigma_{\\alpha\\beta} E_\\beta}\nConstant relaxation-time approximation\nThe constant relaxation time is often a good approximation for metals because the density of states often changes little around the Fermi level.\nWhat remains challenging is to determine a value for the constant relaxation time\nτ\n{\\displaystyle \\tau}\n. To avoid this, it is common to report the transport quantities in a different set of units, where\nτ\n=\n1\n{\\displaystyle \\tau=1}\n.\nTo perform a CRTA calculation, you need to add the following variables to the\nINCAR\nELPH_SCATTERING_APPROX\n= CRTA\nTRANSPORT_RELAXATION_TIME\n= 1e-14\nNote that this calculation can be done without the presence of the\nphelel_params.hdf5\nthat contains the derivatives of the Kohn-Sham potential.\nSelf-energy relaxation-time approximation\nThe\nk\n-mesh used in the previous calculation is a good starting point for a computation in the SERTA approximations (or MRTA) since the integral of the transport function is a requirement in both cases. This\nk\n-point mesh is, however, not a guarantee of a precise result: the calculation of the linewidth for each Kohn-Sham state requires an integration in a\nq\n-point mesh. Currently, it is not possible to choose the two separately, so we are left with the option to increase the sampling in\nKPOINTS_ELPH\nuntil the transport quantities are converged.\nThere are a few factors determining the performance of these computations, in particular the value of\nTRANSPORT_NEDOS\n.\nThis tag chooses the number of points to be used in a Gauss-Legendre integral used to integrate the spectral transport function and obtain the Onsager coefficients, which in turn are used to determine the final transport coefficients.\nThe number of points in turn determines an energy window for which the linewidths will contribute and need to be computed.\nThis selection of the states for which the linewidths are computed is crucial to attain a nearly linear scaling of the calculation with the number of k-points.\nThe size of the energy window also depends on the temperature: for larger temperatures, the required energy windows are larger, which means that VASP will compute the linewidths for more Kohn-Sham states. The states selected for computation are reported in the\nOUTCAR\nfile\nMobility for semiconductors\nIn semiconductors, it is more usual to compute the mobility instead of the conductivity.\nThis is because the conductivity is proportional to the number of free carriers, which means that by adding more free carriers, one obtains a larger conductivity.\nBy defining the mobility as the conductivity divided by the number of carriers, obtain a more intrinsic property of the material.\nσ\n=\nn\ne\nμ\ne\n+\nn\nh\nμ\nh\n{\\displaystyle \\sigma = n_e \\mu_e + n_h \\mu_h}\nwith\nn\ne\n{\\displaystyle n_e}\nbeing the density of electron carriers,\nn\nh\n{\\displaystyle n_h}\nthe density of hole carriers and\nμ\ne\n=\nσ\ne\n/\nn\ne\n{\\displaystyle \\mu_e = \\sigma_e/n_e}\nand\nμ\nh\n=\nσ\nh\n/\nn\nh\n{\\displaystyle \\mu_h = \\sigma_h/n_h}\nwith\nσ\ne\n{\\displaystyle \\sigma_e}\nbeing the contribution of the conduction bands to the electron conductivity and\nσ\nh\n{\\displaystyle \\sigma_h}\nof the valence bands.\nFor the computation of a realistic mobility, it is usual to compute the conductivity for different doping levels and extrapolate to the limit of the lowest possible carrier concentration. The value of the mobility should be relatively constant in the limit of low carrier concentrations.\nAdditionally, one can specify electron or hole doping. A convenient setting is\nELPH_SELFEN_CARRIER_DEN\n= -1e17 -1e16 -1e15 -1e14 1e14 1e15 1e16 1e17\nwith the negative values indicating hole doping and the positive values, electron doping.\nConstant relaxation-time approximation\nThe constant relaxation time is a very crude approximation in the case of semiconductors because it is proportional to the electronic density of states which have a\n∝\ne\n{\\displaystyle \\propto \\sqrt{e}}\nbehavior around the valence band maximum or conduction band minimum.\nIt is however still instructive to perform these calculations, such as to get an idea of the\nk\n-sampling required to converge the mobility.\nBecause of the sharp jump in the density of states in the regions of interest for the transport computation, it is crucial to ensure that the integration mesh\nTRANSPORT_NEDOS\nhas enough points. More points are often required for semiconductors than for metals.\nSelf-energy relaxation-time approximation\nThe same observations apply here than in the case of metals, with the particularity that it is more difficult to converge the linewidths for semiconductors. This is specially true in the case of polar materials, where the electron-phonon matrix elements have an integrable divergence when\nq\n→\n0\n{\\displaystyle q\\rightarrow0}\n.\nThermoelectric coefficients and the ZT figure of merit\nThe ZT figure of merit is given as a function of the transport coefficients and the absolute temperature,\nT\n{\\displaystyle T}\n:\nZ\nT\n=\nσ\nS\n2\nT\nκ\ne\n+\nκ\nl\n{\\displaystyle ZT=\\frac{\\sigma S^2 T}{\\kappa_e+\\kappa_l}}\nThe conductivity\nσ\n{\\displaystyle \\sigma}\n, Seebeck coefficient\nS\n{\\displaystyle S}\nand the electronic contribution to the thermal conductivity\nκ\ne\n{\\displaystyle \\kappa_e}\nare reported in the\nOUTCAR\nfile.\nHere is an example output where these values are reported for the different\ntemperatures\nin a small table for each\naccumulator\n:\nTransport for self-energy accumulator N=     1\nT K               mu eV           sigma S/m      mob cm^2/(V.s)       seebeck μV/K         peltier μV     kappa_e W/(m.K)\n0.00000000          9.79452083        153.09934046         95.55902268          0.00000000          0.00000000          0.00000000 Gauss-Legendre grids\n100.00000000          9.80301003        149.76360902         93.48293224        228.06843439      22806.84343939          0.00040952 Gauss-Legendre grids\n200.00000000          9.82655169        134.56767701         83.98822174        377.34590243      75469.18048584          0.00077142 Gauss-Legendre grids\n300.00000000          9.86137412        125.22459498         78.15905958        476.66107679     142998.32303627          0.00106949 Gauss-Legendre grids\n400.00000000          9.90446361        117.64008575         73.42946205        548.72555653     219490.22261143          0.00131031 Gauss-Legendre grids\n500.00000000          9.95389195        108.91505893         67.98526987        604.60014228     302300.07113882          0.00147236 Gauss-Legendre grids\nThe lattice thermal conductivity\nκ\nl\n{\\displaystyle \\kappa_l}\ncan be computed with an external package such as\nphono3py\n.\nBecause the Seebeck coefficient\nS\n{\\displaystyle S}\nand electronic contribution to the thermal conductivity\nκ\ne\n{\\displaystyle \\kappa_e}\ndepend on the first and second momentum of the transport function, a larger number of points (\nTRANSPORT_NEDOS\n) is often required to obtain an accurate integration of these transport quantities than for the conductivity or mobility.\nRelated tags and articles\nBand-structure renormalization\nElectron-phonon potential from supercells\nElectron-phonon accumulators\nphelel_params.hdf5\nElectron-phonon interactions from Monte-Carlo sampling"
  }, 
  "Troubleshooting electronic convergence": {
    "description": "This web page provides troubleshooting strategies and step-by-step recommendations for improving convergence in electronic structure calculations using VASP, with specific guidance for challenging cases such as magnetic systems, LDA+U, MBJ functionals, and dipole corrections.", 
    "detailed_description": "There can be many reasons why convergence to the electronic ground state fails. Below you find some general strategies to overcome convergence issues in the\nelectronic minimization\nand some recommendations for specific cases, e.g., charged systems or magnetic systems.\nStep-by-step instructions\nStep 1:\nSimplify the calculation and reduce time-to-solution. Try to create a minimal\nINCAR\nfile with as few tags as possible. If the calculation converges, then gradually add them back until you find which one was causing the problem. Try to reduce the time-to-solution as much as possible by lowering the\nk\n-point sampling (or using gamma-only calculations if applicable), lower\nENCUT\n, use\nPREC\n=Normal.\nStep 2:\nCheck the value of\nISMEAR\n. If you have partially occupied states set\nISMEAR\n=-1 or 1.\nStep 3:\nFixing the charge density (for cases where density mixing is used)\nStep 4:\nIncrease\nNBANDS\n. Check if you have enough bands. You can do this by looking at the\nOUTCAR\nfile and checking that there are enough empty states, i.e., states with zero occupation. When using an iterative solver, the last states might not be accurately described, if these are occupied, then convergence is likely to fail. Often, the VASP default setting for\nNBANDS\nis insufficient for systems with f-orbitals or calculations with meta-GGA's.\nStep 5:\nSwitch\nALGO\n.\nStep 6:\nFor\nIALGO\n=5X or 4X change\nTIME\n.\nMethod-specific recommendations\nIn the following, we will describe a few recipes that work for particular systems.\nSome of these recipes might be transferable even to other methods.\nMagnetic calculation with LDA+U\nMagnetic calculations present a lot of challenges, in particular when the energy differences between different magnetic configurations are small.\nOur recommendation is to split the calculation into multiple steps:\ngive initial magnetization only to the magnetic atoms\nuse spin-polarized calculation\nperform the calculation in 3 steps (always starting from the previous WAVECAR):\nstep 1 with\nICHARG\n=12 and\nALGO\n=Normal without any LDA+U tags\nstep 2 with\nALGO\n=All (Conjugate gradient) and a small\nTIME\nstep 0.05 instead of the default 0.4 (this is crucial)\nstep 3 add LDA+U tags keeping\nALGO\n=All and small\nTIME\nIt might be helpful to split step 1. in two by first running with a smaller\nENCUT\nand then restarting the calculation from the\nWAVECAR\nwith the desired\nENCUT\n.\nMBJ calculation\nThis exchange-correlation functional is not particularly easy to converge in some systems.\nFor these systems, we recommend that you split the calculation into multiple steps that successively bring you closer to the solution (always restarting from the WAVECAR of the previous step):\nConverge with the PBE functional\nConverge with the\nMETAGGA\n=MBJ functional with the\nCMBJ\nparameter set to some value and\nALGO\n=All and\nTIME\n=0.1\nConverge with the\nMETAGGA\n=MBJ functional without\nCMBJ\nparameter set and\nALGO\n=All and\nTIME\n=0.1\nSimilar to the\nrecipe for magnetic calculation with LDA+U\n, it might be helpful to run steps 1. to 3. with a low\nENCUT\nand then perform step 3. again with the desired\nENCUT\n.\nDipole Correction\nFirst, converge the calculation with\nLDIPOL\n=.FALSE. Store the\nWAVECAR\nin the same folder.\nUse the\nWAVECAR\nto restart the calculation with\nLDIPOL\n=.TRUE.\nMagnetic calculations\nWhat can one do when convergence is bad:\nStart from charge density of non-spin-polarized calculation using\nISTART\n=0 (or remove the\nWAVECAR\nfile) and\nICHARG\n=1.\nUse linear mixing by setting\nBMIX\n=0.0001 and\nBMIX_MAG\n=0.0001.\nMix slowly, i.e., reduce\nAMIX\nand\nAMIX_MAG\n.\nREDUCE\nMAXMIX\n, the number of steps stored in the Broyden mixer (default\nMAXMIX\n=45).\nRestart from partially converged results (stop a calculation after say 20 steps and restart from the\nWAVECAR\nfile).\nUse constraints to stabilize the magnetic configuration."
  }, 
  "Volume relaxation": {
    "description": "This web page explains how to address Pulay stress—unphysical forces arising from an unconverged basis set during volume relaxations in VASP calculations—by increasing the energy cutoff (ENCUT), using accurate FFT grids (PREC=Accurate), or applying a pressure correction (PSTRESS), and outlines procedures for volume relaxation and equation of state fitting to obtain reliable structural and", 
    "detailed_description": "Introduction\nWhen relaxing the volume of cells, care must be taken. If too small an\nENCUT\nor k-mesh are used, then discontinuities in energy vs. volume curves can be seen, cf. Fig. 1 and 2. This is due to an unconverged basis set being used. This creates unphysical forces, known as\nPulay stress\n, that distort the cell structure away from equilibrium, decreasing the volume. This Pulay stress can be neglected in volume-conserving relaxations but becomes important in volume relaxations.\nFigure 1. Total energy vs. lattice parameter for converged and unconverged plane wave energy cutoffs. Diamond in a primitive cell - 2x2x2 k-point mesh.\nFigure 2. Total energy vs. lattice parameter for converged and unconverged k-point meshes. Diamond in a primitive cell - 180 eV energy cutoff.\nHow to correct\nThe Pulay stress may be corrected in multiple ways. Generally, by calculating the relaxed structure with a larger basis set by increasing the\nENCUT\nuntil convergence is reached:\nSet\nENCUT\nto\n1.3 ×\nthe default cutoff, or\nPREC\n=\nHigh\nin VASP.4.4. Note: this is the lower recommended limit.\nRe-run VASP with the default cutoff to obtain the final relaxed positions and cell parameters.\nFurther increase the\nENCUT\nand repeat Steps 1 and 2, until the structure no longer changes, i.e. is converged.\nMind:\nThis relaxation is done along all of the lattice vectors. If you want to relax only one and keep the others fixed, e.g. for the vacuum in a surface relaxation, then\nLATTICE_CONSTRAINTS\nmay be used instead. This can constrain any of the three lattice vectors for orthorhombic cells, or specific rows and columns in the lattice matrix for non-orthorhombic cells.\nIf volume relaxations are necessary, the following two procedures may be followed:\n1. Volume relaxation\nOne way is to very accurately relax the structure in a series of calculations on one structure:\nStep 1.\nRelax from the starting structure (\nISIF\n= 7;\nIBRION\n= 1, 2, or 3) with Gaussian or Methfessel-Paxton smearing (\nISMEAR\n= 0 or 1). Note: other settings can be used for\nISIF\n, e.g.  3, 6, or 8 but it is not recommended to relax more than one degree of freedom at a time. For instance,\nISMEAR\n= 0 ;\nSIGMA\n= 0.05 # change smearing to\nISMEAR\n= 1 ;\nSIGMA\n= 0.2 for metals\nISIF\n= 7 ;\nIBRION\n= 2;\nNSW\n= 20\nStep 2.\nCopy the\nCONTCAR\nto\nPOSCAR\nand relax the structure again.\nISMEAR\n= 0 ;\nSIGMA\n= 0.05 # change smearing to\nISMEAR\n= 1 ;\nSIGMA\n= 0.2 for metals\nISIF\n= 7 ;\nIBRION\n= 2;\nNSW\n= 20\nISTART\n= 1 # this keeps that energy cut-off constant, while updating the plane wave basis for the new cell volume\nMind:\nIn this procedure, it is important to set\nISTART\n= 1 so that the basis is updated and the energy cut-off remains constant. If\nISTART\n= 2, the basis remains constant, which will also keep the artificial, Pulay, stress, i.e. it is an exact restart of the calculation in Step 1, with identically poor settings.\nStep 3.\nChange the smearing method to the tetrahedron method (i.e.\nISMEAR\n=-5) and perform a single point calculation, i.e. no relaxation of structure. These will give highly accurate energies.\nISMEAR\n= -5 # tetrahedron method\nNSW\n= 0\n(Optional)\nThe previous steps should yield good energies. If there are still problems, such as the energy vs. volume curve remaining jagged, a few more additional steps may be tried:\nStep 4a.\nTry further increasing the\nENCUT\n. Alternatively, improve the FFT grid by setting\nPREC\n=Accurate.\nStep 4b.\nTo avoid additional computational cost due to increased cutoff energy, the\nSTRESS\noutput in VASP may be corrected using\nPSTRESS\n. The Pulay stress is only weakly dependent on volume and ionic configuration; it is mainly determined by the composition and basis set. A good estimation for it is given in the output, e.g.:\nexternal pressure =    -100.29567 kB\nThe difference in this pressure (between the desired and a very large\nENCUT\n) may then be used to correct for the Pulay stress.\nPSTRESS\nis set to this difference, then all volume relaxations will take\nPSTRESS\ninto account. It is important keep in mind that\nPSTRESS\nshould only be used if increasing the cutoff is not a viable option.\nPerform two single point calculations, one for the default and one for the higher\nENCUT\n.\nFind the external pressure in the\nOUTCAR\nfile, e.g.:\nexternal pressure =    -1311.32 kB\nexternal pressure =    -95.66 kB\nFind the difference between these external pressures. This is a good approximation of the Pulay stress. E.g.\ndifference in pressure = -1215.66 kB\nSet\nPSTRESS\nequal to this difference in the OUTCAR file, i.e.:\nPSTRESS\n= -1215.66\nThis results in structures similar to the higher cutoff at the cost of the default cutoff. We reiterate that\nPSTRESS\nshould only be used if the higher cutoff is not a viable option, as this only improves the structure and not the energy.\n2. Equation of state fitting\nAn alternative way to avoid relaxing the volume is to relax the ionic positions and cell shape for a fixed set of volumes, i.e. multiple\nPOSCAR\nfiles. These are then fitted to an equation of state, e.g. Murnaghan\n[1]\n. As the Pulay stress is almost isotropic, only a constant value is added to the diagonal elements of the stress tensor. Therefore, the relaxation for a fixed volume will yield highly accurate structures. This approach has the advantage of also providing the bulk modulus, and we have found it may be used safely with the default energy cutoff.\nThe procedure is similar to the previous section. In this case, one has to do the calculations for a set of fixed volumes. The following steps have to be done in these calculations:\nStep 1.\nSelect one cell and relax it from the starting structure, keeping the volume fixed while the ionic positions and the cell shape are free to change (\nISIF\n=4;\nISMEAR\n=0 or 1). For instance,\nISMEAR\n= 0 ;\nSIGMA\n= 0.05 # change smearing to\nISMEAR\n= 1 ;\nSIGMA\n= 0.2 for metals\nISIF\n= 4 ;\nIBRION\n= 2\nStep 2.\nCopy the\nCONTCAR\nto\nPOSCAR\nand relax the structure again (if the initial cell shape was reasonable, this step can be skipped if the cell shape is kept fixed, you never have run VASP twice).\nStep 3.\nChange the smearing method to the tetrahedron method (i.e.\nISMEAR\n=-5) and perform a single point calculation, i.e. no relaxation of structure. These will give highly accurate energies.\nStep 4.\nRepeat Steps 1-3 for as many different volumes as desired and then fit the energy vs. volume curve to your chosen equation of state.\nPossible issues and advice on how to address them\nWhen producing energy vs. volume plots, improper settings may result in jagged curves, cf. Fig. 1 and 2. This is commonly due to two reasons:\nBasis set incompleteness\nThe basis set is discrete and incomplete, so when the volume changes, additional plane waves are added. That causes small discontinuous changes in the energy.\nUse a larger plane wave cutoff, cf. Fig. 1. This is usually the preferred and simplest solution.\nUse more k-points, cf. Fig. 2.\nImportant:\nThis solves the problem because the criterion for including a plane wave in the basis set is\n|\nG\n+\nk\n|\n<\nG\nc\nu\nt\n{\\displaystyle \\vert {\\bf G} + {\\bf k} \\vert < {\\bf G}_{\\rm cut}}\n. This means at each k-point a different basis set is used, and additional plane waves are added at each k-point at different volumes. In turn, the energy vs. volume curve becomes smoother.\nDiscontinuity of FFT grids\nDifferent precisions of the FFT grid defined by\nPREC\nmay be used, e.g. Normal or Accurate.\nMind:\nFor\nPREC\n=Accurate, the FFT grids are chosen such that\nH\n|\nϕ\n>\n{\\displaystyle  {\\bf H} \\vert \\phi> }\nis exactly evaluated. Whereas, for\nPREC\n=Normal the FFT grids are set to 3/4 of the value that is required for an exact evaluation of\nH\n|\nϕ\n>\n{\\displaystyle  {\\bf H} \\vert \\phi> }\n.\nThis introduces small errors when the volume changes, as the FFT grids change discontinuously. In other words, at each volume a different FFT grid is used, causing the energy to jump discontinuously between different volumes. For more details on FFT grids, see\n[2]\n.\nUse\nPREC\n=Accurate\nIncrease the plane wave cutoff.\nSet your FFT grids manually, and choose the one that is used per default for the largest volume.\nReferences\n↑\nMurnaghan Equation of State, www.wikipedia.org (2024)\n↑\nIntroduction to ab-initio simulation in VASP"
  }
}
